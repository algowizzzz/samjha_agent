2025-11-11 16:33:39,439 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-11 16:33:39,462 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-11 16:33:39,462 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-11 16:33:39,468 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-11 16:33:39,468 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-11 16:33:39,505 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 16:33:39,505 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 16:33:39,505 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 16:33:39,505 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 16:33:39,505 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-11 16:33:39,505 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-11 16:33:39,505 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-11 16:33:39,510 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-11 16:33:39,510 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-11 16:33:39,517 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-11 16:33:39,517 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-11 16:33:39,518 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-11 16:33:39,518 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-11 16:33:39,521 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-11 16:33:39,521 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-11 16:33:39,527 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-11 16:33:39,527 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-11 16:33:39,541 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-11 16:33:39,541 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-11 16:33:40,706 - DuckDbDescribeTableTool - INFO - Found 1 data files in data/duckdb
2025-11-11 16:33:40,807 - DuckDbDescribeTableTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 16:33:40,825 - DuckDbDescribeTableTool - INFO - Initialization complete: 4 views available
2025-11-11 16:33:40,825 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 16:33:40,825 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-11 16:33:40,825 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-11 16:33:40,834 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-11 16:33:40,834 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-11 16:33:42,925 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-11 16:33:42,926 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-11 16:33:42,932 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-11 16:33:42,933 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-11 16:33:42,946 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-11 16:33:42,946 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-11 16:33:42,947 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-11 16:33:42,947 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-11 16:33:42,948 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-11 16:33:42,948 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-11 16:33:42,972 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-11 16:33:42,972 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-11 16:33:42,974 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-11 16:33:42,974 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-11 16:33:43,025 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-11 16:33:43,025 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-11 16:33:43,026 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-11 16:33:43,026 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-11 16:33:43,057 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-11 16:33:43,058 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-11 16:33:43,059 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-11 16:33:43,059 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-11 16:33:43,076 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-11 16:33:43,076 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-11 16:33:43,084 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-11 16:33:43,084 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-11 16:33:43,110 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-11 16:33:43,111 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-11 16:33:43,113 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-11 16:33:43,113 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-11 16:33:43,138 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-11 16:33:43,139 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-11 16:33:43,168 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-11 16:33:43,168 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-11 16:33:43,169 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-11 16:33:43,169 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-11 16:33:43,170 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-11 16:33:43,170 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-11 16:33:43,192 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-11 16:33:43,193 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-11 16:33:43,194 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-11 16:33:43,194 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-11 16:33:43,194 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-11 16:33:43,195 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-11 16:33:43,195 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-11 16:33:43,195 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-11 16:33:43,221 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 16:33:43,221 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 16:33:43,221 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 16:33:43,221 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 16:33:43,221 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-11 16:33:43,221 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-11 16:33:43,221 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-11 16:33:43,222 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-11 16:33:43,222 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-11 16:33:43,223 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-11 16:33:43,224 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-11 16:33:43,239 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-11 16:33:43,239 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-11 16:33:43,240 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-11 16:33:43,240 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-11 16:33:43,254 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-11 16:33:43,254 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-11 16:33:43,255 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-11 16:33:43,255 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-11 16:33:43,257 - DuckDbListFilesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 16:33:43,419 - DuckDbListFilesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 16:33:43,427 - DuckDbListFilesTool - INFO - Initialization complete: 4 views available
2025-11-11 16:33:43,428 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 16:33:43,428 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-11 16:33:43,428 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-11 16:33:43,430 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-11 16:33:43,430 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-11 16:33:43,432 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-11 16:33:43,432 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-11 16:33:43,433 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-11 16:33:43,434 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-11 16:33:43,434 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-11 16:33:43,434 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-11 16:33:43,437 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-11 16:33:43,437 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-11 16:33:43,438 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-11 16:33:43,438 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-11 16:33:43,439 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-11 16:33:43,439 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-11 16:33:43,439 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-11 16:33:43,440 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-11 16:33:43,440 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-11 16:33:43,440 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-11 16:33:43,441 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-11 16:33:43,441 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-11 16:33:43,443 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-11 16:33:43,443 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-11 16:33:43,443 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-11 16:33:43,443 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-11 16:33:43,444 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-11 16:33:43,444 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-11 16:33:43,446 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-11 16:33:43,446 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-11 16:33:43,447 - DuckDbGetStatsTool - INFO - Found 1 data files in data/duckdb
2025-11-11 16:33:43,559 - DuckDbGetStatsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 16:33:43,564 - DuckDbGetStatsTool - INFO - Initialization complete: 4 views available
2025-11-11 16:33:43,564 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 16:33:43,564 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-11 16:33:43,564 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-11 16:33:43,564 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-11 16:33:43,565 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-11 16:33:43,565 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-11 16:33:43,565 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-11 16:33:43,565 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-11 16:33:43,565 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-11 16:33:43,566 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-11 16:33:43,566 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-11 16:33:43,582 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 16:33:43,582 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 16:33:43,582 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 16:33:43,582 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 16:33:43,582 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-11 16:33:43,582 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-11 16:33:43,582 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-11 16:33:43,582 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-11 16:33:43,583 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-11 16:33:43,583 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-11 16:33:43,583 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-11 16:33:43,635 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-11 16:33:43,635 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-11 16:33:43,636 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-11 16:33:43,636 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-11 16:33:43,636 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-11 16:33:43,636 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-11 16:33:43,637 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-11 16:33:43,637 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-11 16:33:43,638 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-11 16:33:43,638 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-11 16:33:43,638 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-11 16:33:43,638 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-11 16:33:43,639 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-11 16:33:43,639 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-11 16:33:43,640 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-11 16:33:43,640 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-11 16:33:43,641 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-11 16:33:43,641 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-11 16:33:43,641 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-11 16:33:43,641 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-11 16:33:43,642 - DuckDbListTablesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 16:33:43,756 - DuckDbListTablesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 16:33:43,761 - DuckDbListTablesTool - INFO - Initialization complete: 4 views available
2025-11-11 16:33:43,762 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 16:33:43,762 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-11 16:33:43,762 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-11 16:33:43,763 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-11 16:33:43,764 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-11 16:33:43,764 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-11 16:33:43,764 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-11 16:33:43,765 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-11 16:33:43,765 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-11 16:33:43,765 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-11 16:33:43,765 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-11 16:33:43,766 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-11 16:33:43,766 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-11 16:33:43,766 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-11 16:33:43,766 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-11 16:33:43,767 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-11 16:33:43,767 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-11 16:33:43,767 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-11 16:33:43,767 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-11 16:33:43,767 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-11 16:33:43,768 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-11 16:33:43,768 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-11 16:33:43,768 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-11 16:33:43,768 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-11 16:33:43,768 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-11 16:33:43,769 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-11 16:33:43,769 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-11 16:33:43,771 - DuckDbAggregateTool - INFO - Found 1 data files in data/duckdb
2025-11-11 16:33:43,869 - DuckDbAggregateTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 16:33:43,875 - DuckDbAggregateTool - INFO - Initialization complete: 4 views available
2025-11-11 16:33:43,876 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 16:33:43,876 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-11 16:33:43,877 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-11 16:33:43,878 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-11 16:33:43,878 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-11 16:33:43,879 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-11 16:33:43,879 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-11 16:33:43,880 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-11 16:33:43,881 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-11 16:33:43,882 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-11 16:33:43,882 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-11 16:33:43,883 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-11 16:33:43,883 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-11 16:33:43,883 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-11 16:33:43,883 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-11 16:33:43,906 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 16:33:43,907 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 16:33:43,907 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 16:33:43,907 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 16:33:43,907 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-11 16:33:43,907 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-11 16:33:43,907 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-11 16:33:43,908 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-11 16:33:43,908 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-11 16:33:43,908 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-11 16:33:43,908 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-11 16:33:43,909 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-11 16:33:43,909 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-11 16:33:43,910 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-11 16:33:43,910 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-11 16:33:43,910 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-11 16:33:43,910 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-11 16:33:43,911 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-11 16:33:43,911 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-11 16:33:43,911 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-11 16:33:43,911 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-11 16:33:43,912 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-11 16:33:43,912 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-11 16:33:43,912 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-11 16:33:43,913 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-11 16:33:43,914 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-11 16:33:43,914 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-11 16:33:43,915 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-11 16:33:43,915 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-11 16:33:43,916 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-11 16:33:43,916 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-11 16:33:43,917 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-11 16:33:43,917 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-11 16:33:43,918 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-11 16:33:43,918 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-11 16:33:43,918 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-11 16:33:43,918 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-11 16:33:43,919 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-11 16:33:43,919 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-11 16:33:43,919 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-11 16:33:43,919 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-11 16:33:43,919 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-11 16:33:43,920 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-11 16:33:43,920 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-11 16:33:43,920 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-11 16:33:43,921 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-11 16:33:43,922 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-11 16:33:43,922 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-11 16:33:43,922 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-11 16:33:43,923 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-11 16:33:43,923 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-11 16:33:43,924 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-11 16:33:43,924 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-11 16:33:43,924 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-11 16:33:43,924 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-11 16:33:43,925 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-11 16:33:43,925 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-11 16:33:43,926 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-11 16:33:43,926 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-11 16:33:43,926 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-11 16:33:43,926 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-11 16:33:43,927 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-11 16:33:43,927 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-11 16:33:43,944 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-11 16:33:43,945 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-11 16:33:43,945 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-11 16:33:43,945 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-11 16:33:43,946 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-11 16:33:43,946 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-11 16:33:43,946 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-11 16:33:43,946 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-11 16:33:43,946 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-11 16:33:43,947 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-11 16:33:43,947 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-11 16:33:43,947 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-11 16:33:43,962 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 16:33:43,963 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 16:33:43,964 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 16:33:43,964 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 16:33:43,964 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-11 16:33:43,964 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-11 16:33:43,964 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-11 16:33:43,965 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-11 16:33:43,965 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-11 16:33:43,967 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-11 16:33:43,967 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-11 16:33:43,968 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-11 16:33:43,968 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-11 16:33:43,968 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-11 16:33:43,968 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-11 16:33:43,969 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-11 16:33:43,969 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-11 16:33:43,970 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-11 16:33:43,970 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-11 16:33:43,971 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-11 16:33:43,971 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-11 16:33:43,971 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-11 16:33:43,971 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-11 16:33:43,972 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-11 16:33:43,972 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-11 16:33:43,972 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-11 16:33:43,972 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-11 16:33:43,973 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-11 16:33:43,973 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-11 16:33:43,975 - DuckDbQueryTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 16:33:44,075 - DuckDbQueryTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 16:33:44,079 - DuckDbQueryTool - INFO - Initialization complete: 4 views available
2025-11-11 16:33:44,080 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 16:33:44,080 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-11 16:33:44,080 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-11 16:33:44,081 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-11 16:33:44,081 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-11 16:33:44,083 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-11 16:33:44,083 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-11 16:33:44,084 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-11 16:33:44,084 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-11 16:33:44,085 - DuckDbRefreshViewsTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 16:33:44,191 - DuckDbRefreshViewsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 16:33:44,195 - DuckDbRefreshViewsTool - INFO - Initialization complete: 4 views available
2025-11-11 16:33:44,195 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 16:33:44,195 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-11 16:33:44,195 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-11 16:33:44,196 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-11 16:33:44,196 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-11 16:33:44,196 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-11 16:33:44,196 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-11 16:33:44,211 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 16:33:44,212 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 16:33:44,212 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 16:33:44,212 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 16:33:44,212 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-11 16:33:44,212 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-11 16:33:44,212 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-11 16:33:44,213 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-11 16:33:44,213 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-11 16:33:44,213 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-11 16:33:44,213 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-11 16:33:44,214 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-11 16:33:44,214 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-11 16:33:44,214 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-11 16:33:44,214 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-11 16:33:44,215 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-11 16:33:44,215 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-11 16:33:44,215 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-11 16:33:44,216 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-11 16:33:44,216 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-11 16:33:44,241 - root - INFO - All routes registered successfully
2025-11-11 16:33:44,242 - werkzeug - WARNING - Werkzeug appears to be used in a production deployment. Consider switching to a production web server instead.
‚úì LLM initialized: Anthropic claude-3-5-haiku-20241022
 * Serving Flask app 'web.app'
 * Debug mode: off
2025-11-11 16:33:44,251 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.68.51:8000
2025-11-11 16:33:44,251 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-11-11 16:33:46,073 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:33:46] "GET /socket.io/?EIO=4&transport=polling&t=PfqrixI HTTP/1.1" 200 -
2025-11-11 16:33:46,087 - root - INFO - WebSocket client connected: uCBLeRsUgmRr5U6-AAAB
2025-11-11 16:33:46,087 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:33:46] "POST /socket.io/?EIO=4&transport=polling&t=PfqrixT&sid=3kI6d0bl45DViQ1LAAAA HTTP/1.1" 200 -
2025-11-11 16:33:46,090 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:33:46] "GET /socket.io/?EIO=4&transport=polling&t=PfqrixV&sid=3kI6d0bl45DViQ1LAAAA HTTP/1.1" 200 -
2025-11-11 16:33:46,110 - root - INFO - WebSocket client disconnected: uCBLeRsUgmRr5U6-AAAB
2025-11-11 16:33:46,111 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:33:46] "POST /socket.io/?EIO=4&transport=polling&t=Pfqrixl&sid=3kI6d0bl45DViQ1LAAAA HTTP/1.1" 200 -
2025-11-11 16:33:46,112 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:33:46] "GET /socket.io/?EIO=4&transport=polling&t=Pfqrixk&sid=3kI6d0bl45DViQ1LAAAA HTTP/1.1" 200 -
2025-11-11 16:33:46,124 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:33:46] "GET /socket.io/?EIO=4&transport=websocket&sid=3kI6d0bl45DViQ1LAAAA HTTP/1.1" 200 -
2025-11-11 16:33:49,366 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:33:49] "GET /health HTTP/1.1" 200 -
2025-11-11 16:33:50,071 - root - INFO - WebSocket client connected: uRzbv3IwpULFQe3wAAAD
2025-11-11 16:33:50,074 - root - INFO - WebSocket client disconnected: uRzbv3IwpULFQe3wAAAD
2025-11-11 16:33:50,086 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:33:50] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 16:33:50,089 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 16:35:00,380 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:35:00] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 16:35:00,406 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:35:00] "GET /login?next=http://localhost:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 16:35:00,466 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:35:00] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 16:35:00,468 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:35:00] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 16:35:00,481 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:35:00] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 16:35:00,578 - root - INFO - WebSocket client connected: e54QxQoCa9zBk0DPAAAF
2025-11-11 16:35:00,581 - root - INFO - WebSocket client disconnected: e54QxQoCa9zBk0DPAAAF
2025-11-11 16:35:00,594 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:35:00] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 16:35:00,596 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 16:35:08,344 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 16:35:08,344 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 16:35:08,345 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:35:08] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 16:35:08,368 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:35:08] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 16:35:08,387 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:35:08] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 16:35:08,388 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:35:08] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 16:35:08,389 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:35:08] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 16:35:08,552 - root - INFO - WebSocket client connected: Ec-52Xxx88-e8E2lAAAH
2025-11-11 16:35:08,554 - root - INFO - WebSocket client disconnected: Ec-52Xxx88-e8E2lAAAH
2025-11-11 16:35:08,567 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:35:08] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 16:35:08,569 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 16:35:13,625 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:35:13] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 16:35:13,648 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:35:13] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 16:35:13,649 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:35:13] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 16:35:13,650 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:35:13] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 16:35:13,703 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:35:13] "GET /socket.io/?EIO=4&transport=polling&t=Pfqs2KY HTTP/1.1" 200 -
2025-11-11 16:35:13,707 - root - INFO - WebSocket client connected: 8CqWiJJ1BUFQ2UuEAAAK
2025-11-11 16:35:13,708 - root - INFO - WebSocket client connected: 8HR1zMzpV-BYdN3iAAAL
2025-11-11 16:35:13,709 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:35:13] "POST /socket.io/?EIO=4&transport=polling&t=Pfqs2Kg&sid=YrredZWg6ufmseNfAAAI HTTP/1.1" 200 -
2025-11-11 16:35:13,709 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:35:13] "GET /socket.io/?EIO=4&transport=polling&t=Pfqs2Kh&sid=YrredZWg6ufmseNfAAAI HTTP/1.1" 200 -
2025-11-11 16:35:13,715 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:35:13] "POST /socket.io/?EIO=4&transport=polling&t=Pfqs2Kl.0&sid=YrredZWg6ufmseNfAAAI HTTP/1.1" 200 -
2025-11-11 16:35:13,715 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:35:13] "GET /socket.io/?EIO=4&transport=polling&t=Pfqs2Kl&sid=YrredZWg6ufmseNfAAAI HTTP/1.1" 200 -
2025-11-11 16:35:13,719 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:35:13] "GET /socket.io/?EIO=4&transport=polling&t=Pfqs2Kr&sid=YrredZWg6ufmseNfAAAI HTTP/1.1" 200 -
2025-11-11 16:35:13,720 - root - INFO - Client 8HR1zMzpV-BYdN3iAAAL joined session room: sess-761zikh7
2025-11-11 16:35:13,721 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:35:13] "POST /socket.io/?EIO=4&transport=polling&t=Pfqs2Ks&sid=YrredZWg6ufmseNfAAAI HTTP/1.1" 200 -
2025-11-11 16:35:18,207 - root - INFO - Client 8HR1zMzpV-BYdN3iAAAL joined session room: sess-xsa592fk
2025-11-11 16:35:21,244 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 16:35:21,244 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-xsa592fk
2025-11-11 16:35:21,244 - agent.state_manager - WARNING - Session sess-xsa592fk not found
2025-11-11 16:35:21,244 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 16:35:21,250 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:35:21,250 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 16:35:21,254 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:35:24,739 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:35:24,755 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:35:24,756 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 16:35:24,756 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 16:35:24,757 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 16:35:24,757 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 16:35:24,757 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 16:35:24,757 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 16:35:24,758 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 16:35:24,758 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 16:35:24,758 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 16:35:24,758 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 16:35:24,758 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 16:35:24,758 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 16:35:24,758 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 16:35:24,758 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 16:35:24,759 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 16:35:24,759 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 16:35:28,177 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:35:30,072 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:35:33,016 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 16:35:33,016 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 16:35:33,016 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-11 16:35:33,016 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 22600 chars
2025-11-11 16:35:33,016 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 16:35:33,016 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 16:35:35,036 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:35:37,147 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 390 chars
2025-11-11 16:35:37,147 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
  "explanation": "Retrieve top primary limits for the latest date, sorted by utilization in descending order. Applied 'Primary' limit class filter since query mentioned 'primary' and used latest date as default.",
  "target_table": "limits_data"
}
2025-11-11 16:35:37,148 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 16:35:37,148 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 16:35:37,148 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 16:35:37,148 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 16:35:37,154 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:35:37,160 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:35:37,160 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 16:35:37,161 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 16:35:37,161 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 16:35:37,161 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 16:35:37,161 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 16:35:37,161 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 16:35:37,161 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 16:35:37,278 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:35:37,278 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 16:35:37,278 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 16:35:37,278 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 16:35:37,278 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 16:35:37,278 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 16:35:37,278 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 16:35:37,278 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 16:35:37,279 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4841 chars
2025-11-11 16:35:38,209 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:35:48,742 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1796 chars
2025-11-11 16:35:48,941 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 16:35:48,941 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 16:35:48,942 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 38244 chars
2025-11-11 16:35:57,104 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:35:57,109 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1079 chars
2025-11-11 16:35:57,109 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 16:35:57,109 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 16:35:57,110 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 16:35:57,110 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 16:35:57,117 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:35:57,117 - agent.streaming_agent - INFO - Agent completed for session sess-xsa592fk: 35866.761ms, 7 steps
2025-11-11 16:35:57,117 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 16:36:43,383 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'how many are financials from above'
2025-11-11 16:36:43,385 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-xsa592fk
2025-11-11 16:36:43,387 - agent.state_manager - INFO - Loaded session state for sess-xsa592fk
2025-11-11 16:36:43,388 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 1 turns
2025-11-11 16:36:43,388 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 1 conversation turns
2025-11-11 16:36:43,396 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:36:43,396 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=1, conv_history(str)=6267
2025-11-11 16:36:43,399 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:36:43,399 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 16:36:46,105 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:36:46,107 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain the full details of the 3 primary limits, including all columns like region_cd, utilization, exposure_amt, etc. No additional database query is needed to analyze or filter the existing data.
2025-11-11 16:36:46,115 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:36:51,321 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:36:51,328 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:36:51,329 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 16:36:51,330 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 16:36:51,330 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 16:36:51,330 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 16:36:51,330 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 16:36:51,330 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 16:36:51,330 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 16:36:51,331 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 16:36:51,331 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 16:36:51,331 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 16:36:51,331 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 6267 characters
2025-11-11 16:36:51,331 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 16:36:51,331 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 16:36:51,331 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 16:36:51,331 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 16:36:51,331 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 16:36:51,331 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 16:36:51,331 - tools.impl.nl_to_sql_planner - INFO -     User Query: top primary limits
2025-11-11 16:36:51,331 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 16:36:51,331 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 16:36:51,331 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 16:36:51,331 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 16:36:51,332 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-11 16:36:51,332 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_in
2025-11-11 16:36:51,332 - tools.impl.nl_to_sql_planner - INFO -     ... (5667 more characters)
2025-11-11 16:36:51,332 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 16:36:54,544 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:36:56,647 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:36:58,638 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 16:36:58,639 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 16:36:58,639 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 16:36:58,639 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 6267
2025-11-11 16:36:58,639 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 16:36:58,640 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 2 SQL code blocks, using LAST (most recent)
2025-11-11 16:36:58,640 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 16:36:58,640 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL: SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC...
2025-11-11 16:36:58,640 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 16:36:58,640 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 16:36:58,640 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 130 characters
2025-11-11 16:36:58,640 - tools.impl.nl_to_sql_planner - INFO -    Full SQL: SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 16:36:58,640 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 16:36:58,642 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 16:36:58,642 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: how many are financials from above
2025-11-11 16:36:58,642 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10559 chars
2025-11-11 16:36:58,642 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 28850 chars
2025-11-11 16:36:58,642 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 16:36:58,643 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 16:37:01,558 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:37:03,366 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 408 chars
2025-11-11 16:37:03,367 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT COUNT(*) AS financials_count FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) AND industry = 'Financials'",
    "explanation": "Counted Financials limits from the previous primary limits query, preserving the original query's date and limit_class filters. Used 'industry' column to filter for Financials.",
    "target_table": "limits_data"
}
2025-11-11 16:37:03,367 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 16:37:03,367 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 16:37:03,367 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT COUNT(*) AS financials_count FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) AND industry = 'Financials'...
2025-11-11 16:37:03,367 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT COUNT(*) AS financials_count FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) AND industry = 'Financials'
2025-11-11 16:37:03,375 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:37:03,381 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:37:03,381 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT COUNT(*) AS financials_count FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) AND industry = 'Financials'...
2025-11-11 16:37:03,381 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 157 chars
2025-11-11 16:37:03,382 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT COUNT(*) AS financials_count FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) AND industry = 'Financials'
2025-11-11 16:37:03,382 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT COUNT(*) AS financials_count FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) AND industry = 'Financials'...
2025-11-11 16:37:03,382 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT COUNT(*) AS financials_count FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) AND industry = 'Financials'...
2025-11-11 16:37:03,382 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 16:37:03,382 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT COUNT(*) AS financials_count FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) AND industry = 'Financials'...
2025-11-11 16:37:03,492 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:37:03,492 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=1, columns=1, rows=1, sql=SELECT COUNT(*) AS financials_count FROM limits_data WHERE limit_class = 'Primary' AND date = (SELEC
2025-11-11 16:37:03,492 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 16:37:03,492 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 16:37:03,492 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT COUNT(*) AS financials_count FROM limits_data WHERE limit_class = 'Primary' AND date = (SELEC
2025-11-11 16:37:03,492 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=1, columns=1, rows=1, query_length=157
2025-11-11 16:37:03,492 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 16:37:03,492 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 16:37:03,493 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 592 chars
2025-11-11 16:37:04,381 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:37:09,554 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1142 chars
2025-11-11 16:37:09,555 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 16:37:09,555 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 16:37:09,556 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 39164 chars
2025-11-11 16:37:17,079 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:37:17,081 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 827 chars
2025-11-11 16:37:17,082 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=1, columns=1, rows=1, query=SELECT COUNT(*) AS financials_count FROM limits_data WHERE limit_class = 'Primary' AND date = (SELEC
2025-11-11 16:37:17,082 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=1, columns=1, rows=1, has_query=True
2025-11-11 16:37:17,082 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT COUNT(*) AS financials_count FROM limits_data WHERE limit_class = 'Primary' AND date = (SELEC...
2025-11-11 16:37:17,082 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT COUNT(*) AS financials_count FROM limits_data WHERE limit_class = 'Primary' AND date = (SELEC...
2025-11-11 16:37:17,088 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:37:17,088 - agent.streaming_agent - INFO - Agent completed for session sess-xsa592fk: 33691.985ms, 8 steps
2025-11-11 16:37:17,088 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=1, columns=1, rows=1
2025-11-11 16:46:34,702 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'what are thise 2 limits and what are there utlisation'
2025-11-11 16:46:34,703 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-xsa592fk
2025-11-11 16:46:34,705 - agent.state_manager - INFO - Loaded session state for sess-xsa592fk
2025-11-11 16:46:34,705 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 2 turns
2025-11-11 16:46:34,705 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 2 conversation turns
2025-11-11 16:46:34,713 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:46:34,713 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=2, conv_history(str)=8604
2025-11-11 16:46:34,716 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:46:34,717 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 16:46:38,096 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:46:38,097 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contained the full details of the primary limits, including industry information. Since the previous results showed 2 Financials limits (Canadian Options and SLP BMO), and the last query already confirmed the count of 2 Financials limits, no new database query is required. The data to answer this follow-up query is already available in the existing result set.
2025-11-11 16:46:38,100 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:46:42,880 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:46:42,894 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:46:42,912 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 16:46:42,914 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 16:46:42,915 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 16:46:42,916 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 16:46:42,924 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 16:46:42,924 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 16:46:42,924 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 16:46:42,924 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 16:46:42,924 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 16:46:42,924 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 16:46:42,924 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 8604 characters
2025-11-11 16:46:42,924 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 16:46:42,924 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 16:46:42,924 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 16:46:42,924 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 16:46:42,924 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 16:46:42,924 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 16:46:42,924 - tools.impl.nl_to_sql_planner - INFO -     User Query: top primary limits
2025-11-11 16:46:42,924 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 16:46:42,925 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 16:46:42,925 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 16:46:42,925 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 16:46:42,925 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-11 16:46:42,925 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_in
2025-11-11 16:46:42,925 - tools.impl.nl_to_sql_planner - INFO -     ... (8004 more characters)
2025-11-11 16:46:42,925 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 16:46:47,270 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:46:49,183 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:46:53,286 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:46:53,289 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:46:53,289 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: -- KNOWLEDGE QUESTION...
2025-11-11 16:46:53,290 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 21 chars
2025-11-11 16:46:53,290 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: -- KNOWLEDGE QUESTION
2025-11-11 16:46:53,293 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:46:53,294 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=0, columns=0, rows=0, sql=-- KNOWLEDGE QUESTION
2025-11-11 16:46:53,294 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 16:46:53,294 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['columns', 'rows', 'row_count', 'query']
2025-11-11 16:46:53,294 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: -- KNOWLEDGE QUESTION
2025-11-11 16:46:53,294 - agent.graph_nodes - INFO - [END_NODE] Knowledge response detected: 'I apologize, but the user query is unclear. The query "what are thise 2 limits and what are there ut...'
2025-11-11 16:46:53,294 - agent.graph_nodes - INFO - [END_NODE] Returning knowledge result with response length: 953
2025-11-11 16:46:53,298 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:46:53,298 - agent.streaming_agent - INFO - Agent completed for session sess-xsa592fk: 18584.667ms, 8 steps
2025-11-11 16:46:53,298 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=0, columns=0, rows=0
2025-11-11 16:47:36,005 - root - INFO - WebSocket client disconnected: 8CqWiJJ1BUFQ2UuEAAAK
2025-11-11 16:47:36,006 - root - INFO - WebSocket client disconnected: 8HR1zMzpV-BYdN3iAAAL
2025-11-11 16:47:36,007 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:47:36] "GET /socket.io/?EIO=4&transport=websocket&sid=YrredZWg6ufmseNfAAAI HTTP/1.1" 200 -
2025-11-11 16:47:36,012 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:47:36] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 16:47:36,019 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:47:36] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 16:47:36,023 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 16:47:36,055 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:47:36] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 16:47:36,056 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:47:36] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 16:47:36,062 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:47:36] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 16:47:36,114 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:47:36] "GET /socket.io/?EIO=4&transport=polling&t=Pfqutal HTTP/1.1" 200 -
2025-11-11 16:47:36,121 - root - INFO - WebSocket client connected: maVMg-9c0vm8nhM9AAAN
2025-11-11 16:47:36,124 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:47:36] "POST /socket.io/?EIO=4&transport=polling&t=Pfqutar&sid=ZC7Pzi_uaqvXKF9fAAAM HTTP/1.1" 200 -
2025-11-11 16:47:36,124 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 16:47:36] "GET /socket.io/?EIO=4&transport=polling&t=Pfqutas&sid=ZC7Pzi_uaqvXKF9fAAAM HTTP/1.1" 200 -
2025-11-11 16:47:36,131 - root - INFO - Client maVMg-9c0vm8nhM9AAAN joined session room: sess-xsa592fk
2025-11-11 16:47:36,136 - root - INFO - WebSocket client connected: 7HfWKA4XlJnE9uWVAAAP
2025-11-11 16:47:43,043 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'primary top limits'
2025-11-11 16:47:43,043 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-xsa592fk
2025-11-11 16:47:43,045 - agent.state_manager - INFO - Loaded session state for sess-xsa592fk
2025-11-11 16:47:43,045 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 2 turns
2025-11-11 16:47:43,046 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 2 conversation turns
2025-11-11 16:47:43,050 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:47:43,051 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=2, conv_history(str)=8604
2025-11-11 16:47:43,055 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:47:43,056 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 16:47:46,008 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:47:46,010 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contained full details of the primary limits, including industry information. The last query specifically counted the Financials limits, which were 2 out of the 3 total primary limits. All the necessary data to answer any follow-up questions about these specific limits is already present in the previous results.
2025-11-11 16:47:46,016 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:47:50,044 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:47:50,051 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:47:50,051 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 16:47:50,051 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 16:47:50,051 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 16:47:50,051 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 16:47:50,052 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 16:47:50,052 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 16:47:50,052 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 16:47:50,052 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 16:47:50,052 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 16:47:50,052 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 16:47:50,052 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 8604 characters
2025-11-11 16:47:50,052 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 16:47:50,052 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 16:47:50,052 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 16:47:50,052 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 16:47:50,052 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 16:47:50,052 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 16:47:50,052 - tools.impl.nl_to_sql_planner - INFO -     User Query: top primary limits
2025-11-11 16:47:50,052 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 16:47:50,052 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 16:47:50,052 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 16:47:50,053 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 16:47:50,053 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-11 16:47:50,053 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_in
2025-11-11 16:47:50,053 - tools.impl.nl_to_sql_planner - INFO -     ... (8004 more characters)
2025-11-11 16:47:50,053 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 16:47:53,830 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:47:56,288 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:47:58,717 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 16:47:58,717 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 16:47:58,718 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 16:47:58,718 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 8604
2025-11-11 16:47:58,718 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 16:47:58,718 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 4 SQL code blocks, using LAST (most recent)
2025-11-11 16:47:58,718 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 16:47:58,718 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL: SELECT COUNT(*) AS financials_count 
FROM limits_data 
WHERE limit_class = 'Primary' 
AND date = (SELECT MAX(date) FROM limits_data) 
AND industry = 'Financials'...
2025-11-11 16:47:58,719 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 16:47:58,719 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 16:47:58,719 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 161 characters
2025-11-11 16:47:58,719 - tools.impl.nl_to_sql_planner - INFO -    Full SQL: SELECT COUNT(*) AS financials_count 
FROM limits_data 
WHERE limit_class = 'Primary' 
AND date = (SELECT MAX(date) FROM limits_data) 
AND industry = 'Financials'
2025-11-11 16:47:58,719 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 16:47:58,721 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 16:47:58,721 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: primary top limits
2025-11-11 16:47:58,721 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10621 chars
2025-11-11 16:47:58,721 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 31171 chars
2025-11-11 16:47:58,721 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 16:47:58,721 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 16:48:01,102 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:48:03,254 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 426 chars
2025-11-11 16:48:03,255 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
  "explanation": "Retrieved top primary limits for the most recent date, sorted by utilization in descending order. Assumed 'top' means all primary limits, not limited to a specific number. Used default of most recent date and primary limit class.",
  "target_table": "limits_data"
}
2025-11-11 16:48:03,255 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 16:48:03,255 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 16:48:03,255 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 16:48:03,255 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 16:48:03,260 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:48:03,264 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:48:03,265 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 16:48:03,265 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 16:48:03,265 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 16:48:03,265 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 16:48:03,265 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 16:48:03,265 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 16:48:03,266 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 16:48:03,380 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:48:03,381 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 16:48:03,381 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 16:48:03,381 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 16:48:03,381 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 16:48:03,381 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 16:48:03,381 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 16:48:03,381 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 16:48:03,382 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4841 chars
2025-11-11 16:48:04,297 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:48:14,358 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1751 chars
2025-11-11 16:48:14,359 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 16:48:14,359 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 16:48:14,360 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 41393 chars
2025-11-11 16:48:23,527 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:48:23,530 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1226 chars
2025-11-11 16:48:23,530 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 16:48:23,530 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 16:48:23,530 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 16:48:23,531 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 16:48:23,541 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:48:23,542 - agent.streaming_agent - INFO - Agent completed for session sess-xsa592fk: 40490.755ms, 8 steps
2025-11-11 16:48:23,542 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 16:49:33,195 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'how many of these above 90% ?'
2025-11-11 16:49:33,196 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-xsa592fk
2025-11-11 16:49:33,199 - agent.state_manager - INFO - Loaded session state for sess-xsa592fk
2025-11-11 16:49:33,200 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 3 turns
2025-11-11 16:49:33,201 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 3 conversation turns
2025-11-11 16:49:33,214 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:49:33,215 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=3, conv_history(str)=14950
2025-11-11 16:49:33,218 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:49:33,218 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 16:49:36,071 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:49:36,072 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain the full details of the primary limits, so no new database query is required. The results include all columns and rows for the top primary limits, which can be used to answer most follow-up questions about these specific limits.
2025-11-11 16:49:36,076 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:49:40,303 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:49:40,314 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:49:40,315 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 16:49:40,315 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 16:49:40,315 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 16:49:40,315 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 16:49:40,315 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 16:49:40,315 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 16:49:40,315 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 16:49:40,315 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 16:49:40,315 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 16:49:40,316 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 16:49:40,316 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 14950 characters
2025-11-11 16:49:40,316 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 16:49:40,316 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 16:49:40,316 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 16:49:40,316 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 16:49:40,316 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 16:49:40,316 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 16:49:40,316 - tools.impl.nl_to_sql_planner - INFO -     User Query: top primary limits
2025-11-11 16:49:40,316 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 16:49:40,316 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 16:49:40,316 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 16:49:40,316 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 16:49:40,316 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-11 16:49:40,316 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_in
2025-11-11 16:49:40,316 - tools.impl.nl_to_sql_planner - INFO -     ... (14350 more characters)
2025-11-11 16:49:40,316 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 16:49:44,321 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:49:46,724 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:49:48,581 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 16:49:48,581 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 16:49:48,581 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 16:49:48,581 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 14950
2025-11-11 16:49:48,581 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 16:49:48,582 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 6 SQL code blocks, using LAST (most recent)
2025-11-11 16:49:48,582 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 16:49:48,582 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL: SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC...
2025-11-11 16:49:48,582 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 16:49:48,582 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 16:49:48,582 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 130 characters
2025-11-11 16:49:48,582 - tools.impl.nl_to_sql_planner - INFO -    Full SQL: SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 16:49:48,582 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 16:49:48,582 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 16:49:48,582 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: how many of these above 90% ?
2025-11-11 16:49:48,582 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10559 chars
2025-11-11 16:49:48,582 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 37528 chars
2025-11-11 16:49:48,583 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 16:49:48,583 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 16:49:51,487 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:49:53,507 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 414 chars
2025-11-11 16:49:53,507 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) AND utilization >= 0.9 ORDER BY utilization DESC",
    "explanation": "Query finds all Primary limits with utilization at or above 90% for the most recent date, sorted by utilization in descending order. Assumes user wants to see limits near breach threshold.",
    "target_table": "limits_data"
}
2025-11-11 16:49:53,507 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 16:49:53,507 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 16:49:53,507 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) AND utilization >= 0.9 ORDER BY utilization DESC...
2025-11-11 16:49:53,507 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) AND utilization >= 0.9 ORDER BY utilization DESC
2025-11-11 16:49:53,511 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:49:53,515 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:49:53,515 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) AND utilization >= 0.9 ORDER BY utilization DESC...
2025-11-11 16:49:53,515 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 151 chars
2025-11-11 16:49:53,515 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) AND utilization >= 0.9 ORDER BY utilization DESC
2025-11-11 16:49:53,515 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) AND utilization >= 0.9 ORDER BY utilization DESC...
2025-11-11 16:49:53,515 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) AND utilization >= 0.9 ORDER BY utilization DESC...
2025-11-11 16:49:53,515 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 16:49:53,515 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) AND utilization >= 0.9 ORDER BY utilization DESC...
2025-11-11 16:49:53,630 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:49:53,630 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 16:49:53,631 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 16:49:53,631 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 16:49:53,631 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 16:49:53,631 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=151
2025-11-11 16:49:53,631 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 16:49:53,631 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 16:49:53,631 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4875 chars
2025-11-11 16:49:54,561 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:50:03,842 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1614 chars
2025-11-11 16:50:03,842 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 16:50:03,842 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 16:50:03,842 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 43197 chars
2025-11-11 16:50:10,983 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:50:10,985 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 875 chars
2025-11-11 16:50:10,985 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 16:50:10,986 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 16:50:10,986 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 16:50:10,986 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 16:50:10,997 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:50:10,998 - agent.streaming_agent - INFO - Agent completed for session sess-xsa592fk: 37782.981ms, 8 steps
2025-11-11 16:50:10,998 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 16:50:26,041 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'give me a list of these limits'
2025-11-11 16:50:26,042 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-xsa592fk
2025-11-11 16:50:26,045 - agent.state_manager - INFO - Loaded session state for sess-xsa592fk
2025-11-11 16:50:26,045 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 3 turns
2025-11-11 16:50:26,046 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 3 conversation turns
2025-11-11 16:50:26,055 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:50:26,055 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=3, conv_history(str)=14598
2025-11-11 16:50:26,060 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:50:26,060 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 16:50:29,176 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:50:29,178 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain the full details of the 3 primary limits above 90% utilization. Since the query is asking about the existing data (utilization, limit details, etc.), no new database query is required. The agent can directly analyze and filter the previously retrieved rows to answer any follow-up questions about these high-utilization limits.
2025-11-11 16:50:29,187 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:50:32,747 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:50:32,757 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:50:32,758 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 16:50:32,758 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 16:50:32,758 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 16:50:32,758 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 16:50:32,758 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 16:50:32,758 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 16:50:32,758 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 16:50:32,758 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 16:50:32,758 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 16:50:32,758 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 16:50:32,758 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 14598 characters
2025-11-11 16:50:32,758 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 16:50:32,758 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 16:50:32,758 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 16:50:32,758 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 16:50:32,758 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 16:50:32,759 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 16:50:32,759 - tools.impl.nl_to_sql_planner - INFO -     User Query: how many are financials from above
2025-11-11 16:50:32,759 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 16:50:32,759 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 16:50:32,759 - tools.impl.nl_to_sql_planner - INFO -     SELECT COUNT(*) AS financials_count FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) AND industry = 'Financials'
2025-11-11 16:50:32,759 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 16:50:32,759 - tools.impl.nl_to_sql_planner - INFO -     Result Table (1 row):
2025-11-11 16:50:32,759 - tools.impl.nl_to_sql_planner - INFO -     Columns: financials_count
2025-11-11 16:50:32,759 - tools.impl.nl_to_sql_planner - INFO -     Data:
2025-11-11 16:50:32,759 - tools.impl.nl_to_sql_planner - INFO -       Row 1: financials_count: 2
2025-11-11 16:50:32,759 - tools.impl.nl_to_sql_planner - INFO -     Agent Response: ```sql
2025-11-11 16:50:32,759 - tools.impl.nl_to_sql_planner - INFO -     SELECT COUNT(*) AS financials_count 
2025-11-11 16:50:32,759 - tools.impl.nl_to_sql_planner - INFO -     FROM limits_data 
2025-11-11 16:50:32,759 - tools.impl.nl_to_sql_planner - INFO -     ... (13998 more characters)
2025-11-11 16:50:32,759 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 16:50:36,805 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:50:39,387 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:50:41,478 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 16:50:41,478 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 16:50:41,479 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 16:50:41,479 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 14598
2025-11-11 16:50:41,479 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 16:50:41,479 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 6 SQL code blocks, using LAST (most recent)
2025-11-11 16:50:41,479 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 16:50:41,479 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL: SELECT * FROM limits_data 
WHERE limit_class = 'Primary' 
AND date = (SELECT MAX(date) FROM limits_data) 
AND utilization >= 0.9 
ORDER BY utilization DESC...
2025-11-11 16:50:41,479 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 16:50:41,480 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 16:50:41,480 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 155 characters
2025-11-11 16:50:41,480 - tools.impl.nl_to_sql_planner - INFO -    Full SQL: SELECT * FROM limits_data 
WHERE limit_class = 'Primary' 
AND date = (SELECT MAX(date) FROM limits_data) 
AND utilization >= 0.9 
ORDER BY utilization DESC
2025-11-11 16:50:41,480 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 16:50:41,481 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 16:50:41,481 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: give me a list of these limits
2025-11-11 16:50:41,481 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10609 chars
2025-11-11 16:50:41,481 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 37177 chars
2025-11-11 16:50:41,481 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 16:50:41,481 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 16:50:44,234 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:50:46,140 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 416 chars
2025-11-11 16:50:46,140 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
    "explanation": "Returned all primary limits for the latest date, sorted by utilization in descending order. This follows the previous context of showing primary limits, maintaining the same filtering approach from the last query.",
    "target_table": "limits_data"
}
2025-11-11 16:50:46,141 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 16:50:46,141 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 16:50:46,141 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 16:50:46,142 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 16:50:46,152 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:50:46,159 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:50:46,160 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 16:50:46,160 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 16:50:46,160 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 16:50:46,160 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 16:50:46,160 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 16:50:46,160 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 16:50:46,160 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 16:50:46,273 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:50:46,273 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 16:50:46,273 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 16:50:46,273 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 16:50:46,273 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 16:50:46,273 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 16:50:46,273 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 16:50:46,273 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 16:50:46,274 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4853 chars
2025-11-11 16:50:47,085 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:50:57,319 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1848 chars
2025-11-11 16:50:57,319 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 16:50:57,320 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 16:50:57,320 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 43016 chars
2025-11-11 16:51:04,092 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 16:51:04,094 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 805 chars
2025-11-11 16:51:04,095 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 16:51:04,095 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 16:51:04,095 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 16:51:04,095 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 16:51:04,109 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 16:51:04,109 - agent.streaming_agent - INFO - Agent completed for session sess-xsa592fk: 38054.181ms, 8 steps
2025-11-11 16:51:04,109 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 17:02:03,681 - root - INFO - WebSocket client disconnected: 7HfWKA4XlJnE9uWVAAAP
2025-11-11 17:02:03,681 - root - INFO - WebSocket client disconnected: maVMg-9c0vm8nhM9AAAN
2025-11-11 17:02:03,684 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:02:03] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 17:02:03,684 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:02:03] "GET /socket.io/?EIO=4&transport=websocket&sid=ZC7Pzi_uaqvXKF9fAAAM HTTP/1.1" 200 -
2025-11-11 17:02:03,694 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:02:03] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 17:02:03,695 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 17:02:03,726 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:02:03] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 17:02:03,729 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:02:03] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 17:02:03,730 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:02:03] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 17:02:03,807 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:02:03] "GET /socket.io/?EIO=4&transport=polling&t=PfqyBQR HTTP/1.1" 200 -
2025-11-11 17:02:03,813 - root - INFO - WebSocket client connected: 3-rH5HLpHnCMv1AlAAAS
2025-11-11 17:02:03,813 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:02:03] "POST /socket.io/?EIO=4&transport=polling&t=PfqyBQX&sid=yDtCGAruzX9YBR0FAAAQ HTTP/1.1" 200 -
2025-11-11 17:02:03,815 - root - INFO - WebSocket client connected: u9z73ddDjGlJMUcpAAAT
2025-11-11 17:02:03,816 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:02:03] "GET /socket.io/?EIO=4&transport=polling&t=PfqyBQX.0&sid=yDtCGAruzX9YBR0FAAAQ HTTP/1.1" 200 -
2025-11-11 17:02:03,825 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:02:03] "GET /socket.io/?EIO=4&transport=polling&t=PfqyBQg&sid=yDtCGAruzX9YBR0FAAAQ HTTP/1.1" 200 -
2025-11-11 17:02:03,825 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:02:03] "POST /socket.io/?EIO=4&transport=polling&t=PfqyBQh&sid=yDtCGAruzX9YBR0FAAAQ HTTP/1.1" 200 -
2025-11-11 17:02:03,828 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:02:03] "GET /socket.io/?EIO=4&transport=polling&t=PfqyBQo&sid=yDtCGAruzX9YBR0FAAAQ HTTP/1.1" 200 -
2025-11-11 17:02:03,829 - root - INFO - Client 3-rH5HLpHnCMv1AlAAAS joined session room: sess-xsa592fk
2025-11-11 17:02:03,830 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:02:03] "POST /socket.io/?EIO=4&transport=polling&t=PfqyBQp&sid=yDtCGAruzX9YBR0FAAAQ HTTP/1.1" 200 -
2025-11-11 17:02:10,236 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'what data do you have?'
2025-11-11 17:02:10,236 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-xsa592fk
2025-11-11 17:02:10,240 - agent.state_manager - INFO - Loaded session state for sess-xsa592fk
2025-11-11 17:02:10,240 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 3 turns
2025-11-11 17:02:10,240 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 3 conversation turns
2025-11-11 17:02:10,248 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:02:10,249 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=3, conv_history(str)=18295
2025-11-11 17:02:10,254 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:02:10,254 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 17:02:13,996 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:02:13,998 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain the full details of all primary limits, including all columns and data points. The query was a comprehensive retrieval of primary limits sorted by utilization, so any follow-up analysis or filtering can be done using the existing result set without needing a new database query.
2025-11-11 17:02:14,003 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:02:16,657 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:02:16,664 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:02:16,664 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 17:02:16,664 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 17:02:16,664 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 17:02:16,664 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 17:02:16,664 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 17:02:16,665 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 17:02:16,665 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 17:02:16,665 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 17:02:16,665 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 17:02:16,665 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 17:02:16,665 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 18295 characters
2025-11-11 17:02:16,665 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 17:02:16,666 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 17:02:16,666 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 17:02:16,666 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 17:02:16,666 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 17:02:16,666 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 17:02:16,666 - tools.impl.nl_to_sql_planner - INFO -     User Query: primary top limits
2025-11-11 17:02:16,666 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 17:02:16,666 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 17:02:16,666 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 17:02:16,666 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 17:02:16,666 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-11 17:02:16,666 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_in
2025-11-11 17:02:16,666 - tools.impl.nl_to_sql_planner - INFO -     ... (17695 more characters)
2025-11-11 17:02:16,666 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 17:02:20,433 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
[NLToSQLPlanner] Using LLM to plan query
[NLToSQLPlanner] STAGE 1: Classifying query type for: top primary limits
[NLToSQLPlanner] Classification result: data (confidence: high)
[NLToSQLPlanner] Reasoning: The query 'top primary limits' is clearly a data retrieval request. It uses the word 'top', which suggests ranking or retrieving a subset of data, and specifies 'primary limits', which maps directly to the 'limit_class' column in the limits_data table. This is a typical data query seeking to retrieve and potentially rank primary limits from the database.
[NLToSQLPlanner] STAGE 2b: Checking if clarification needed
[NLToSQLPlanner] Clarification gate: needs_clarification=False
[NLToSQLPlanner] STAGE 2c: Generating SQL for clear data query
[NLToSQLPlanner] Schema summary for LLM:
Available tables/views:

limits_data:
  Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt

[NLToSQLPlanner] Using LLM to plan query
[NLToSQLPlanner] STAGE 1: Classifying query type for: how many are financials from above
[NLToSQLPlanner] Classification result: data (confidence: high)
[NLToSQLPlanner] Reasoning: The query 'how many are financials from above' is a data retrieval request asking to count or filter the number of financial industry limits from the previously displayed primary limits result set. It seeks a quantitative analysis of the data, not a definition or explanation.
[NLToSQLPlanner] STAGE 2b: Checking if clarification needed
[NLToSQLPlanner] FOLLOWUP DETECTED - Adding strict followup context to clarification gate prompt
[NLToSQLPlanner] Clarification gate: needs_clarification=False
[NLToSQLPlanner] STAGE 2c: Generating SQL for clear data query

[NLToSQLPlanner] üì§ SENDING TO LLM (FILTER-ONLY MODE):
  Previous SQL extracted: SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC...
  System prompt length: 10559 chars
  Follow-up instruction added: 1268 chars
[NLToSQLPlanner] Schema summary for LLM:
Available tables/views:

limits_data:
  Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt

[NLToSQLPlanner] Using LLM to plan query
[NLToSQLPlanner] STAGE 1: Classifying query type for: what are thise 2 limits and what are there utlisation
[NLToSQLPlanner] Classification result: knowledge (confidence: medium)
[NLToSQLPlanner] Reasoning: The query 'what are thise 2 limits and what are there utlisation' appears to be asking for an explanation or description of the limits, despite some spelling errors. The user seems to want to understand the details of the two limits mentioned in the previous conversation, which suggests a request for knowledge/explanation rather than a specific data retrieval query. The phrase 'what are' typically indicates a request for information or definition.
[NLToSQLPlanner] STAGE 2a: Generating knowledge answer
[NLToSQLPlanner] Knowledge answer generated: I apologize, but the user query is unclear. The query "what are thise 2 limits and what are there ut...
[NLToSQLPlanner] Using LLM to plan query
[NLToSQLPlanner] STAGE 1: Classifying query type for: primary top limits
[NLToSQLPlanner] Classification result: data (confidence: high)
[NLToSQLPlanner] Reasoning: The query 'primary top limits' is a clear request for retrieving data from the limits database, specifically seeking the top primary limits sorted by utilization. It follows the data query pattern of requesting a list of records with a specific filtering and sorting criteria. The previous interaction confirms this is a data retrieval request focused on extracting limit information from the limits_data table.
[NLToSQLPlanner] STAGE 2b: Checking if clarification needed
[NLToSQLPlanner] FOLLOWUP DETECTED - Adding strict followup context to clarification gate prompt
[NLToSQLPlanner] Clarification gate: needs_clarification=False
[NLToSQLPlanner] STAGE 2c: Generating SQL for clear data query

[NLToSQLPlanner] üì§ SENDING TO LLM (FILTER-ONLY MODE):
  Previous SQL extracted: SELECT COUNT(*) AS financials_count 
FROM limits_data 
WHERE limit_class = 'Primary' 
AND date = (SELECT MAX(date) FROM limits_data) 
AND industry = '...
  System prompt length: 10621 chars
  Follow-up instruction added: 1330 chars
[NLToSQLPlanner] Schema summary for LLM:
Available tables/views:

limits_data:
  Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt

[NLToSQLPlanner] Using LLM to plan query
[NLToSQLPlanner] STAGE 1: Classifying query type for: how many of these above 90% ?
[NLToSQLPlanner] Classification result: data (confidence: high)
[NLToSQLPlanner] Reasoning: The query 'how many of these above 90%' is a data retrieval request, specifically asking for a count of limits with utilization above 90%. This follows the data query pattern of requesting a numeric count based on a specific condition (utilization threshold). The context of previous interactions about primary limits further supports this being a data-oriented query seeking quantitative information about limit utilization.
[NLToSQLPlanner] STAGE 2b: Checking if clarification needed
[NLToSQLPlanner] FOLLOWUP DETECTED - Adding strict followup context to clarification gate prompt
[NLToSQLPlanner] Clarification gate: needs_clarification=False
[NLToSQLPlanner] STAGE 2c: Generating SQL for clear data query

[NLToSQLPlanner] üì§ SENDING TO LLM (FILTER-ONLY MODE):
  Previous SQL extracted: SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC...
  System prompt length: 10559 chars
  Follow-up instruction added: 1268 chars
[NLToSQLPlanner] Schema summary for LLM:
Available tables/views:

limits_data:
  Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt

[NLToSQLPlanner] Using LLM to plan query
[NLToSQLPlanner] STAGE 1: Classifying query type for: give me a list of these limits
[NLToSQLPlanner] Classification result: data (confidence: high)
[NLToSQLPlanner] Reasoning: The query 'give me a list of these limits' is a direct request for data retrieval, specifically asking to list the limits from the previous conversation context. It follows the data query pattern of requesting a list of information, and is consistent with the previous interactions about primary limits and their utilization.
[NLToSQLPlanner] STAGE 2b: Checking if clarification needed
[NLToSQLPlanner] FOLLOWUP DETECTED - Adding strict followup context to clarification gate prompt
[NLToSQLPlanner] Clarification gate: needs_clarification=False
[NLToSQLPlanner] STAGE 2c: Generating SQL for clear data query

[NLToSQLPlanner] üì§ SENDING TO LLM (FILTER-ONLY MODE):
  Previous SQL extracted: SELECT * FROM limits_data 
WHERE limit_class = 'Primary' 
AND date = (SELECT MAX(date) FROM limits_data) 
AND utilization >= 0.9 
ORDER BY utilization...
  System prompt length: 10609 chars
  Follow-up instruction added: 1318 chars
[NLToSQLPlanner] Schema summary for LLM:
Available tables/views:

limits_data:
  Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt

[NLToSQLPlanner] Using LLM to plan query
[NLToSQLPlanner] STAGE 1: Classifying query type for: what data do you have?
[NLToSQLPlanner] Classification result: knowledge (confidence: medium)
[NLToSQLPlanner] Reasoning: The query 'what data do you have?' is a broad, exploratory request asking for an overview or explanation of available data, rather than a specific data retrieval request. It seeks information about the system's data capabilities, which aligns more with a knowledge-seeking intent than a precise data query.
[NLToSQLPlanner] STAGE 2a: Generating knowledge answer2025-11-11 17:02:20,989 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:02:24,414 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:02:24,420 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:02:24,422 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: -- KNOWLEDGE QUESTION...
2025-11-11 17:02:24,422 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 21 chars
2025-11-11 17:02:24,422 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: -- KNOWLEDGE QUESTION
2025-11-11 17:02:24,428 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:02:24,428 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=0, columns=0, rows=0, sql=-- KNOWLEDGE QUESTION
2025-11-11 17:02:24,429 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 17:02:24,429 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['columns', 'rows', 'row_count', 'query']
2025-11-11 17:02:24,429 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: -- KNOWLEDGE QUESTION
2025-11-11 17:02:24,429 - agent.graph_nodes - INFO - [END_NODE] Knowledge response detected: 'I apologize, but the user query "what data do you have?" is not a specific term seeking a definition...'
2025-11-11 17:02:24,429 - agent.graph_nodes - INFO - [END_NODE] Returning knowledge result with response length: 776
2025-11-11 17:02:24,433 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:02:24,433 - agent.streaming_agent - INFO - Agent completed for session sess-xsa592fk: 14184.419ms, 8 steps
2025-11-11 17:02:24,433 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=0, columns=0, rows=0
2025-11-11 17:02:46,236 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'what tables do you have access to'
2025-11-11 17:02:46,238 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-xsa592fk
2025-11-11 17:02:46,241 - agent.state_manager - INFO - Loaded session state for sess-xsa592fk
2025-11-11 17:02:46,241 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 3 turns
2025-11-11 17:02:46,242 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 3 conversation turns
2025-11-11 17:02:46,251 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:02:46,252 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=3, conv_history(str)=18295
2025-11-11 17:02:46,258 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:02:46,258 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 17:02:49,736 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:02:49,739 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain the full details of all primary limits, including all columns and data points. Any follow-up query about filtering, analyzing, or examining these specific limits can be done using the existing result set without needing a new database query.
2025-11-11 17:02:49,754 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:02:53,114 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:02:53,126 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:02:53,127 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 17:02:53,127 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 17:02:53,127 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 17:02:53,127 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 17:02:53,127 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 17:02:53,127 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 17:02:53,127 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 17:02:53,127 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 17:02:53,127 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 17:02:53,128 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 17:02:53,128 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 18295 characters
2025-11-11 17:02:53,128 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 17:02:53,128 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 17:02:53,128 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 17:02:53,128 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 17:02:53,128 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 17:02:53,128 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 17:02:53,128 - tools.impl.nl_to_sql_planner - INFO -     User Query: primary top limits
2025-11-11 17:02:53,128 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 17:02:53,128 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 17:02:53,128 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 17:02:53,128 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 17:02:53,128 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-11 17:02:53,128 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_in
2025-11-11 17:02:53,128 - tools.impl.nl_to_sql_planner - INFO -     ... (17695 more characters)
2025-11-11 17:02:53,128 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 17:02:57,443 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:03:00,179 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:03:01,393 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 17:03:01,394 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 17:03:01,394 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 17:03:01,394 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 18295
2025-11-11 17:03:01,395 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 17:03:01,395 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 6 SQL code blocks, using LAST (most recent)
2025-11-11 17:03:01,395 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 17:03:01,395 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL: SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC...
2025-11-11 17:03:01,395 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 17:03:01,396 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 17:03:01,396 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 130 characters
2025-11-11 17:03:01,396 - tools.impl.nl_to_sql_planner - INFO -    Full SQL: SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 17:03:01,396 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 17:03:01,398 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 17:03:01,398 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: what tables do you have access to
2025-11-11 17:03:01,398 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10559 chars
2025-11-11 17:03:01,398 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 40877 chars
2025-11-11 17:03:01,398 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 17:03:01,399 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 17:03:04,276 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:03:05,593 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 285 chars
2025-11-11 17:03:05,593 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT table_name FROM information_schema.tables WHERE table_schema = 'main'",
    "explanation": "Query to list all available tables in the database schema. Uses standard SQL information schema to retrieve table names.",
    "target_table": "information_schema.tables"
}
2025-11-11 17:03:05,594 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 17:03:05,594 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 17:03:05,594 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT table_name FROM information_schema.tables WHERE table_schema = 'main'...
2025-11-11 17:03:05,594 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT table_name FROM information_schema.tables WHERE table_schema = 'main'
2025-11-11 17:03:05,603 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:03:05,610 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:03:05,610 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT table_name FROM information_schema.tables WHERE table_schema = 'main'...
2025-11-11 17:03:05,610 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 76 chars
2025-11-11 17:03:05,610 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT table_name FROM information_schema.tables WHERE table_schema = 'main'
2025-11-11 17:03:05,610 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT table_name FROM information_schema.tables WHERE table_schema = 'main'...
2025-11-11 17:03:05,611 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT table_name FROM information_schema.tables WHERE table_schema = 'main' LIMIT 100...
2025-11-11 17:03:05,611 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: True
2025-11-11 17:03:05,611 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT table_name FROM information_schema.tables WHERE table_schema = 'main' LIMIT 100...
2025-11-11 17:03:05,674 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:03:05,674 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=1, columns=1, rows=1, sql=SELECT table_name FROM information_schema.tables WHERE table_schema = 'main'
2025-11-11 17:03:05,675 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 17:03:05,675 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 17:03:05,675 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT table_name FROM information_schema.tables WHERE table_schema = 'main' LIMIT 100
2025-11-11 17:03:05,675 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=1, columns=1, rows=1, query_length=76
2025-11-11 17:03:05,675 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 17:03:05,675 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 17:03:05,676 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 510 chars
2025-11-11 17:03:06,325 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:03:12,039 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1118 chars
2025-11-11 17:03:12,039 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 17:03:12,039 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 17:03:12,040 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 42033 chars
2025-11-11 17:03:19,264 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:03:19,267 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 965 chars
2025-11-11 17:03:19,267 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=1, columns=1, rows=1, query=SELECT table_name FROM information_schema.tables WHERE table_schema = 'main' LIMIT 100
2025-11-11 17:03:19,267 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=1, columns=1, rows=1, has_query=True
2025-11-11 17:03:19,267 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT table_name FROM information_schema.tables WHERE table_schema = 'main'...
2025-11-11 17:03:19,267 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT table_name FROM information_schema.tables WHERE table_schema = 'main' LIMIT 100...
2025-11-11 17:03:19,280 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:03:19,281 - agent.streaming_agent - INFO - Agent completed for session sess-xsa592fk: 33029.547ms, 8 steps
2025-11-11 17:03:19,281 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=1, columns=1, rows=1
2025-11-11 17:03:44,232 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'show me the limits whcih have 80% exposure?'
2025-11-11 17:03:44,232 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-xsa592fk
2025-11-11 17:03:44,236 - agent.state_manager - INFO - Loaded session state for sess-xsa592fk
2025-11-11 17:03:44,236 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 3 turns
2025-11-11 17:03:44,236 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 3 conversation turns
2025-11-11 17:03:44,244 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:03:44,245 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=3, conv_history(str)=14316
2025-11-11 17:03:44,249 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:03:44,250 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 17:03:47,182 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:03:47,183 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already showed the full details of the `limits_data` table, including all columns and rows. Since the query was about table information and we have the complete table name, no additional database query is required.
2025-11-11 17:03:47,190 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:03:51,681 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:03:51,696 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:03:51,696 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 17:03:51,696 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 17:03:51,696 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 17:03:51,696 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 17:03:51,697 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 17:03:51,697 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 17:03:51,697 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 17:03:51,697 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 17:03:51,697 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 17:03:51,697 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 17:03:51,697 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 14316 characters
2025-11-11 17:03:51,697 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 17:03:51,697 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 17:03:51,697 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 17:03:51,697 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 17:03:51,697 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 17:03:51,697 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 17:03:51,697 - tools.impl.nl_to_sql_planner - INFO -     User Query: how many of these above 90% ?
2025-11-11 17:03:51,698 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 17:03:51,698 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 17:03:51,698 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) AND utilization >= 0.9 ORDER BY utilization DESC
2025-11-11 17:03:51,698 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 17:03:51,698 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-11 17:03:51,698 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, ind
2025-11-11 17:03:51,698 - tools.impl.nl_to_sql_planner - INFO -     ... (13716 more characters)
2025-11-11 17:03:51,698 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 17:03:55,886 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:03:58,764 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:04:00,825 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 17:04:00,825 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 17:04:00,825 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 17:04:00,825 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 14316
2025-11-11 17:04:00,826 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 17:04:00,826 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 6 SQL code blocks, using LAST (most recent)
2025-11-11 17:04:00,826 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 17:04:00,826 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL: SELECT table_name FROM information_schema.tables WHERE table_schema = 'main'...
2025-11-11 17:04:00,826 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 17:04:00,826 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 17:04:00,826 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 76 characters
2025-11-11 17:04:00,826 - tools.impl.nl_to_sql_planner - INFO -    Full SQL: SELECT table_name FROM information_schema.tables WHERE table_schema = 'main'
2025-11-11 17:04:00,826 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 17:04:00,830 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 17:04:00,830 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: show me the limits whcih have 80% exposure?
2025-11-11 17:04:00,830 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10451 chars
2025-11-11 17:04:00,830 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 36908 chars
2025-11-11 17:04:00,830 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 17:04:00,830 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 17:04:04,078 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:04:05,753 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 395 chars
2025-11-11 17:04:05,753 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT * FROM limits_data WHERE exposure_amt >= 0.8 * effective_limit AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
    "explanation": "Retrieved limits with exposure at or above 80% of their effective limit, sorted by utilization in descending order. Used latest date snapshot and focused on high exposure limits.",
    "target_table": "limits_data"
}
2025-11-11 17:04:05,753 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 17:04:05,753 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 17:04:05,753 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE exposure_amt >= 0.8 * effective_limit AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:04:05,753 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE exposure_amt >= 0.8 * effective_limit AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 17:04:05,760 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:04:05,767 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:04:05,767 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE exposure_amt >= 0.8 * effective_limit AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:04:05,768 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 142 chars
2025-11-11 17:04:05,768 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE exposure_amt >= 0.8 * effective_limit AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 17:04:05,768 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE exposure_amt >= 0.8 * effective_limit AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:04:05,768 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE exposure_amt >= 0.8 * effective_limit AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:04:05,768 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 17:04:05,768 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE exposure_amt >= 0.8 * effective_limit AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:04:05,890 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:04:05,890 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=10, columns=41, rows=10, sql=SELECT * FROM limits_data WHERE exposure_amt >= 0.8 * effective_limit AND date = (SELECT MAX(date) F
2025-11-11 17:04:05,890 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 17:04:05,890 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 17:04:05,890 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE exposure_amt >= 0.8 * effective_limit AND date = (SELECT MAX(date) F
2025-11-11 17:04:05,890 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=10, columns=41, rows=10, query_length=142
2025-11-11 17:04:05,890 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 17:04:05,890 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 17:04:05,891 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 13520 chars
2025-11-11 17:04:07,557 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:04:17,675 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1642 chars
2025-11-11 17:04:17,675 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 17:04:17,675 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 17:04:17,676 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 42646 chars
2025-11-11 17:04:26,813 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:04:26,823 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1299 chars
2025-11-11 17:04:26,826 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=10, columns=41, rows=10, query=SELECT * FROM limits_data WHERE exposure_amt >= 0.8 * effective_limit AND date = (SELECT MAX(date) F
2025-11-11 17:04:26,827 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=10, columns=41, rows=10, has_query=True
2025-11-11 17:04:26,830 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE exposure_amt >= 0.8 * effective_limit AND date = (SELECT MAX(date) F...
2025-11-11 17:04:26,835 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE exposure_amt >= 0.8 * effective_limit AND date = (SELECT MAX(date) F...
2025-11-11 17:04:26,888 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:04:26,888 - agent.streaming_agent - INFO - Agent completed for session sess-xsa592fk: 42643.519ms, 8 steps
2025-11-11 17:04:26,888 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=10, columns=41, rows=10
2025-11-11 17:05:05,374 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'Securitized Credit Trading what is the exposure and limit value for this one'
2025-11-11 17:05:05,374 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-xsa592fk
2025-11-11 17:05:05,376 - agent.state_manager - INFO - Loaded session state for sess-xsa592fk
2025-11-11 17:05:05,376 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 3 turns
2025-11-11 17:05:05,377 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 3 conversation turns
2025-11-11 17:05:05,387 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:05:05,387 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=3, conv_history(str)=21029
2025-11-11 17:05:05,391 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:05:05,391 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 17:05:09,101 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:05:09,102 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain comprehensive details about limits with 80% or higher exposure, including full row data across 40 columns. Any follow-up analysis or filtering can be done directly on these existing 10 rows without requiring a new database query.
2025-11-11 17:05:09,107 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:05:13,187 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:05:13,192 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:05:13,192 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 17:05:13,192 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 17:05:13,192 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 17:05:13,192 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 17:05:13,192 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 17:05:13,192 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 17:05:13,192 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 17:05:13,192 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 17:05:13,192 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 17:05:13,192 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 17:05:13,192 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 21029 characters
2025-11-11 17:05:13,192 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 17:05:13,192 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 17:05:13,192 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 17:05:13,192 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 17:05:13,192 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 17:05:13,192 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 17:05:13,192 - tools.impl.nl_to_sql_planner - INFO -     User Query: give me a list of these limits
2025-11-11 17:05:13,193 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 17:05:13,193 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 17:05:13,193 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 17:05:13,193 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 17:05:13,193 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-11 17:05:13,193 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, regi
2025-11-11 17:05:13,193 - tools.impl.nl_to_sql_planner - INFO -     ... (20429 more characters)
2025-11-11 17:05:13,193 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 17:05:18,310 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:05:21,189 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:05:23,235 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 17:05:23,235 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 17:05:23,235 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 17:05:23,235 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 21029
2025-11-11 17:05:23,235 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 17:05:23,235 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 6 SQL code blocks, using LAST (most recent)
2025-11-11 17:05:23,235 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 17:05:23,235 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL: SELECT * FROM limits_data 
WHERE exposure_amt >= 0.8 * effective_limit 
AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC...
2025-11-11 17:05:23,235 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 17:05:23,235 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 17:05:23,235 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 145 characters
2025-11-11 17:05:23,235 - tools.impl.nl_to_sql_planner - INFO -    Full SQL: SELECT * FROM limits_data 
WHERE exposure_amt >= 0.8 * effective_limit 
AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 17:05:23,235 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 17:05:23,236 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 17:05:23,236 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: Securitized Credit Trading what is the exposure and limit value for this one
2025-11-11 17:05:23,236 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10589 chars
2025-11-11 17:05:23,236 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 43654 chars
2025-11-11 17:05:23,236 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 17:05:23,236 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 17:05:27,022 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:05:28,851 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 367 chars
2025-11-11 17:05:28,851 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT * FROM limits_data WHERE letter_nm = 'Securitized Credit Trading' AND date = (SELECT MAX(date) FROM limits_data)",
    "explanation": "Retrieved the latest limit data for Securitized Credit Trading desk, showing all columns. Assumed user wants the most recent snapshot of this specific trading desk's limits.",
    "target_table": "limits_data"
}
2025-11-11 17:05:28,851 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 17:05:28,851 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 17:05:28,851 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE letter_nm = 'Securitized Credit Trading' AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 17:05:28,851 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE letter_nm = 'Securitized Credit Trading' AND date = (SELECT MAX(date) FROM limits_data)
2025-11-11 17:05:28,858 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:05:28,862 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:05:28,862 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE letter_nm = 'Securitized Credit Trading' AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 17:05:28,862 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 119 chars
2025-11-11 17:05:28,862 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE letter_nm = 'Securitized Credit Trading' AND date = (SELECT MAX(date) FROM limits_data)
2025-11-11 17:05:28,862 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE letter_nm = 'Securitized Credit Trading' AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 17:05:28,862 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE letter_nm = 'Securitized Credit Trading' AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 17:05:28,862 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 17:05:28,862 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE letter_nm = 'Securitized Credit Trading' AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 17:05:28,979 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:05:28,979 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=1, columns=41, rows=1, sql=SELECT * FROM limits_data WHERE letter_nm = 'Securitized Credit Trading' AND date = (SELECT MAX(date
2025-11-11 17:05:28,979 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 17:05:28,979 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 17:05:28,979 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE letter_nm = 'Securitized Credit Trading' AND date = (SELECT MAX(date
2025-11-11 17:05:28,979 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=1, columns=41, rows=1, query_length=119
2025-11-11 17:05:28,979 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 17:05:28,979 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 17:05:28,980 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 2482 chars
2025-11-11 17:05:29,685 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:05:36,220 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1170 chars
2025-11-11 17:05:36,221 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 17:05:36,221 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 17:05:36,223 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 43093 chars
2025-11-11 17:05:45,482 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:05:45,484 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1256 chars
2025-11-11 17:05:45,484 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=1, columns=41, rows=1, query=SELECT * FROM limits_data WHERE letter_nm = 'Securitized Credit Trading' AND date = (SELECT MAX(date
2025-11-11 17:05:45,484 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=1, columns=41, rows=1, has_query=True
2025-11-11 17:05:45,484 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE letter_nm = 'Securitized Credit Trading' AND date = (SELECT MAX(date...
2025-11-11 17:05:45,484 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE letter_nm = 'Securitized Credit Trading' AND date = (SELECT MAX(date...
2025-11-11 17:05:45,501 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:05:45,501 - agent.streaming_agent - INFO - Agent completed for session sess-xsa592fk: 40114.489ms, 8 steps
2025-11-11 17:05:45,502 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=1, columns=41, rows=1
2025-11-11 17:09:56,595 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:09:56] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 17:09:56,597 - root - INFO - WebSocket client disconnected: u9z73ddDjGlJMUcpAAAT
2025-11-11 17:09:56,607 - root - INFO - WebSocket client disconnected: 3-rH5HLpHnCMv1AlAAAS
2025-11-11 17:09:56,672 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:09:56] "GET /socket.io/?EIO=4&transport=websocket&sid=yDtCGAruzX9YBR0FAAAQ HTTP/1.1" 200 -
2025-11-11 17:09:56,687 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:09:56] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 17:09:56,690 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 17:09:56,696 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:09:56] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 17:09:56,740 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:09:56] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 17:09:56,761 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:09:56] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 17:09:56,869 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:09:56] "GET /socket.io/?EIO=4&transport=polling&t=Pfqz-v7 HTTP/1.1" 200 -
2025-11-11 17:09:57,006 - root - INFO - WebSocket client connected: 2mWtQWEzamWC6y0yAAAW
2025-11-11 17:09:57,015 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:09:57] "POST /socket.io/?EIO=4&transport=polling&t=Pfqz-wB&sid=-s5z0A8u5KS5srReAAAU HTTP/1.1" 200 -
2025-11-11 17:09:57,023 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:09:57] "GET /socket.io/?EIO=4&transport=polling&t=Pfqz-wC&sid=-s5z0A8u5KS5srReAAAU HTTP/1.1" 200 -
2025-11-11 17:09:57,206 - root - INFO - WebSocket client connected: LEl5Ecm15tPs5tZxAAAX
2025-11-11 17:09:57,214 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:09:57] "POST /socket.io/?EIO=4&transport=polling&t=Pfqz-zh&sid=-s5z0A8u5KS5srReAAAU HTTP/1.1" 200 -
2025-11-11 17:09:57,216 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:09:57] "GET /socket.io/?EIO=4&transport=polling&t=Pfqz-zg&sid=-s5z0A8u5KS5srReAAAU HTTP/1.1" 200 -
2025-11-11 17:09:57,241 - root - INFO - Client 2mWtQWEzamWC6y0yAAAW joined session room: sess-xsa592fk
2025-11-11 17:10:13,067 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top 20 limits by utlisation'
2025-11-11 17:10:13,068 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-xsa592fk
2025-11-11 17:10:13,072 - agent.state_manager - INFO - Loaded session state for sess-xsa592fk
2025-11-11 17:10:13,072 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 3 turns
2025-11-11 17:10:13,073 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 3 conversation turns
2025-11-11 17:10:13,086 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:10:13,086 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=3, conv_history(str)=19110
2025-11-11 17:10:13,094 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:10:13,094 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 17:10:17,039 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:10:17,043 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query already returned the full row for Securitized Credit Trading, which contains all the exposure and limit values requested. The result includes exposure_amt ($5,500,000), Original_limit ($6,000,000), effective_limit ($6,000,000), and utilization (0.92 or 92%) in the single row retrieved. No additional database query is required to answer this specific follow-up query.
2025-11-11 17:10:17,049 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:10:21,852 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:10:21,867 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:10:21,867 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 17:10:21,867 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 17:10:21,867 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 17:10:21,867 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 17:10:21,868 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 17:10:21,868 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 17:10:21,868 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 17:10:21,868 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 17:10:21,868 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 17:10:21,868 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 17:10:21,868 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 19110 characters
2025-11-11 17:10:21,868 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 17:10:21,870 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 17:10:21,870 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 17:10:21,870 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 17:10:21,870 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 17:10:21,870 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 17:10:21,870 - tools.impl.nl_to_sql_planner - INFO -     User Query: what tables do you have access to
2025-11-11 17:10:21,870 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 17:10:21,870 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 17:10:21,870 - tools.impl.nl_to_sql_planner - INFO -     SELECT table_name FROM information_schema.tables WHERE table_schema = 'main'
2025-11-11 17:10:21,870 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 17:10:21,870 - tools.impl.nl_to_sql_planner - INFO -     Result Table (1 row):
2025-11-11 17:10:21,870 - tools.impl.nl_to_sql_planner - INFO -     Columns: table_name
2025-11-11 17:10:21,870 - tools.impl.nl_to_sql_planner - INFO -     Data:
2025-11-11 17:10:21,870 - tools.impl.nl_to_sql_planner - INFO -       Row 1: table_name: limits_data
2025-11-11 17:10:21,870 - tools.impl.nl_to_sql_planner - INFO -     Agent Response: ```sql
2025-11-11 17:10:21,870 - tools.impl.nl_to_sql_planner - INFO -     SELECT table_name FROM information_schema.tables WHERE table_schema = 'main'
2025-11-11 17:10:21,870 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 17:10:21,870 - tools.impl.nl_to_sql_planner - INFO -     ... (18510 more characters)
2025-11-11 17:10:21,870 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 17:10:26,206 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:10:29,123 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:10:31,262 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 17:10:31,262 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 17:10:31,263 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 17:10:31,263 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 19110
2025-11-11 17:10:31,263 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 17:10:31,264 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 6 SQL code blocks, using LAST (most recent)
2025-11-11 17:10:31,264 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 17:10:31,264 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL: SELECT * FROM limits_data 
WHERE letter_nm = 'Securitized Credit Trading' 
AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 17:10:31,264 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 17:10:31,264 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 17:10:31,264 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 121 characters
2025-11-11 17:10:31,265 - tools.impl.nl_to_sql_planner - INFO -    Full SQL: SELECT * FROM limits_data 
WHERE letter_nm = 'Securitized Credit Trading' 
AND date = (SELECT MAX(date) FROM limits_data)
2025-11-11 17:10:31,265 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 17:10:31,267 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 17:10:31,267 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top 20 limits by utlisation
2025-11-11 17:10:31,267 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10541 chars
2025-11-11 17:10:31,267 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 41686 chars
2025-11-11 17:10:31,267 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 17:10:31,267 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 17:10:34,651 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:10:36,605 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 421 chars
2025-11-11 17:10:36,606 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC LIMIT 20",
    "explanation": "Retrieved top 20 limits by utilization for the latest date snapshot. Used default sorting by utilization in descending order to highlight highest utilized limits. No specific desk or metric filter applied, so returned all primary limits.",
    "target_table": "limits_data"
}
2025-11-11 17:10:36,606 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 17:10:36,606 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 17:10:36,607 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC LIMIT 20...
2025-11-11 17:10:36,607 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC LIMIT 20
2025-11-11 17:10:36,618 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:10:36,628 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:10:36,628 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC LIMIT 20...
2025-11-11 17:10:36,628 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 109 chars
2025-11-11 17:10:36,628 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC LIMIT 20
2025-11-11 17:10:36,629 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC LIMIT 20...
2025-11-11 17:10:36,629 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC LIMIT 20...
2025-11-11 17:10:36,629 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 17:10:36,629 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC LIMIT 20...
2025-11-11 17:10:36,749 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:10:36,750 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=10, columns=41, rows=10, sql=SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 17:10:36,750 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 17:10:36,750 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 17:10:36,750 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 17:10:36,750 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=10, columns=41, rows=10, query_length=109
2025-11-11 17:10:36,750 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 17:10:36,750 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 17:10:36,751 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 13470 chars
2025-11-11 17:10:38,085 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:10:48,336 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1696 chars
2025-11-11 17:10:48,338 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 17:10:48,338 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 17:10:48,339 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 43598 chars
2025-11-11 17:10:58,201 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:10:58,203 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1338 chars
2025-11-11 17:10:58,203 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=10, columns=41, rows=10, query=SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 17:10:58,203 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=10, columns=41, rows=10, has_query=True
2025-11-11 17:10:58,203 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:10:58,203 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:10:58,218 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:10:58,219 - agent.streaming_agent - INFO - Agent completed for session sess-xsa592fk: 45132.115ms, 8 steps
2025-11-11 17:10:58,219 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=10, columns=41, rows=10
2025-11-11 17:11:58,980 - root - INFO - WebSocket client disconnected: 2mWtQWEzamWC6y0yAAAW
2025-11-11 17:11:58,981 - root - INFO - WebSocket client disconnected: LEl5Ecm15tPs5tZxAAAX
2025-11-11 17:11:58,987 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:11:58] "GET /socket.io/?EIO=4&transport=websocket&sid=-s5z0A8u5KS5srReAAAU HTTP/1.1" 200 -
2025-11-11 17:11:58,993 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:11:58] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 17:11:58,994 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 17:12:00,608 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:00] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 17:12:00,651 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:00] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 17:12:00,653 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:00] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 17:12:00,714 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:00] "GET /socket.io/?EIO=4&transport=polling&t=Pfq-T95 HTTP/1.1" 200 -
2025-11-11 17:12:00,719 - root - INFO - WebSocket client connected: U8PA0JOwObMN93DHAAAa
2025-11-11 17:12:00,720 - root - INFO - WebSocket client connected: B13byfDLKO0EoXDuAAAb
2025-11-11 17:12:00,720 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:00] "POST /socket.io/?EIO=4&transport=polling&t=Pfq-T9D&sid=rvFJuqlqcdYdwfslAAAY HTTP/1.1" 200 -
2025-11-11 17:12:00,721 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:00] "GET /socket.io/?EIO=4&transport=polling&t=Pfq-T9E&sid=rvFJuqlqcdYdwfslAAAY HTTP/1.1" 200 -
2025-11-11 17:12:00,724 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:00] "POST /socket.io/?EIO=4&transport=polling&t=Pfq-T9I.0&sid=rvFJuqlqcdYdwfslAAAY HTTP/1.1" 200 -
2025-11-11 17:12:00,724 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:00] "GET /socket.io/?EIO=4&transport=polling&t=Pfq-T9I&sid=rvFJuqlqcdYdwfslAAAY HTTP/1.1" 200 -
2025-11-11 17:12:00,726 - root - INFO - Client B13byfDLKO0EoXDuAAAb joined session room: sess-xsa592fk
2025-11-11 17:12:00,726 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:00] "POST /socket.io/?EIO=4&transport=polling&t=Pfq-T9L.0&sid=rvFJuqlqcdYdwfslAAAY HTTP/1.1" 200 -
2025-11-11 17:12:00,726 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:00] "GET /socket.io/?EIO=4&transport=polling&t=Pfq-T9L&sid=rvFJuqlqcdYdwfslAAAY HTTP/1.1" 200 -
2025-11-11 17:12:00,728 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:00] "GET /socket.io/?EIO=4&transport=polling&t=Pfq-T9N&sid=rvFJuqlqcdYdwfslAAAY HTTP/1.1" 200 -
2025-11-11 17:12:06,536 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 17:12:06,536 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-xsa592fk
2025-11-11 17:12:06,541 - agent.state_manager - INFO - Loaded session state for sess-xsa592fk
2025-11-11 17:12:06,541 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 3 turns
2025-11-11 17:12:06,541 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 3 conversation turns
2025-11-11 17:12:06,551 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:12:06,551 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=3, conv_history(str)=29392
2025-11-11 17:12:06,556 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:12:06,557 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 17:12:10,722 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:12:10,729 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain the full details for the top 10 limits by utilization, including all columns and comprehensive information. Any follow-up analysis or filtering can be done directly on these existing results without needing a new database query.
2025-11-11 17:12:10,779 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:12:14,903 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:12:14,917 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:12:14,919 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 17:12:14,920 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 17:12:14,920 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 17:12:14,920 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 17:12:14,920 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 17:12:14,920 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 17:12:14,920 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 17:12:14,920 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 17:12:14,920 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 17:12:14,920 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 17:12:14,920 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 29392 characters
2025-11-11 17:12:14,920 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 17:12:14,920 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 17:12:14,920 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 17:12:14,920 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 17:12:14,920 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 17:12:14,920 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 17:12:14,920 - tools.impl.nl_to_sql_planner - INFO -     User Query: show me the limits whcih have 80% exposure?
2025-11-11 17:12:14,921 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 17:12:14,921 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 17:12:14,921 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE exposure_amt >= 0.8 * effective_limit AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 17:12:14,921 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 17:12:14,921 - tools.impl.nl_to_sql_planner - INFO -     Result Table (10 rows):
2025-11-11 17:12:14,921 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_i
2025-11-11 17:12:14,921 - tools.impl.nl_to_sql_planner - INFO -     ... (28792 more characters)
2025-11-11 17:12:14,921 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 17:12:19,798 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:12:23,628 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:12:26,065 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 17:12:26,065 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 17:12:26,065 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 17:12:26,065 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 29392
2025-11-11 17:12:26,065 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 17:12:26,065 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 6 SQL code blocks, using LAST (most recent)
2025-11-11 17:12:26,066 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 17:12:26,066 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL: SELECT * FROM limits_data 
WHERE date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC 
LIMIT 20...
2025-11-11 17:12:26,066 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 17:12:26,066 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 17:12:26,066 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 112 characters
2025-11-11 17:12:26,066 - tools.impl.nl_to_sql_planner - INFO -    Full SQL: SELECT * FROM limits_data 
WHERE date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC 
LIMIT 20
2025-11-11 17:12:26,066 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 17:12:26,068 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 17:12:26,068 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 17:12:26,068 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10523 chars
2025-11-11 17:12:26,068 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 51959 chars
2025-11-11 17:12:26,068 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 17:12:26,068 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 17:12:29,649 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:12:31,552 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 403 chars
2025-11-11 17:12:31,553 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primary' ORDER BY utilization DESC LIMIT 20",
    "explanation": "Retrieved top 20 primary limits by utilization, focusing on the most recent date snapshot. Applied 'Primary' limit class filter as query mentioned 'primary limits' and was somewhat ambiguous.",
    "target_table": "limits_data"
}
2025-11-11 17:12:31,553 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 17:12:31,553 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 17:12:31,553 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primary' ORDER BY utilization DESC LIMIT 20...
2025-11-11 17:12:31,553 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primary' ORDER BY utilization DESC LIMIT 20
2025-11-11 17:12:31,566 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:12:31,574 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:12:31,574 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primary' ORDER BY utilization DESC LIMIT 20...
2025-11-11 17:12:31,574 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 137 chars
2025-11-11 17:12:31,574 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primary' ORDER BY utilization DESC LIMIT 20
2025-11-11 17:12:31,575 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primary' ORDER BY utilization DESC LIMIT 20...
2025-11-11 17:12:31,575 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primary' ORDER BY utilization DESC LIMIT 20...
2025-11-11 17:12:31,575 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 17:12:31,575 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primary' ORDER BY utilization DESC LIMIT 20...
2025-11-11 17:12:31,692 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:12:31,692 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primar
2025-11-11 17:12:31,692 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 17:12:31,692 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 17:12:31,692 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primar
2025-11-11 17:12:31,692 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=137
2025-11-11 17:12:31,692 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 17:12:31,692 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 17:12:31,693 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4850 chars
2025-11-11 17:12:32,561 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:12:42,684 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1911 chars
2025-11-11 17:12:42,684 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 17:12:42,684 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 17:12:42,685 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 43977 chars
2025-11-11 17:12:47,478 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:47] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 17:12:47,478 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:47] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 17:12:51,051 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:12:51,055 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1051 chars
2025-11-11 17:12:51,055 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primar
2025-11-11 17:12:51,055 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 17:12:51,056 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primar...
2025-11-11 17:12:51,056 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primar...
2025-11-11 17:12:51,072 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:12:51,072 - agent.streaming_agent - INFO - Agent completed for session sess-xsa592fk: 44521.439ms, 8 steps
2025-11-11 17:12:51,072 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 17:12:59,054 - root - INFO - WebSocket client disconnected: U8PA0JOwObMN93DHAAAa
2025-11-11 17:12:59,055 - root - INFO - WebSocket client disconnected: B13byfDLKO0EoXDuAAAb
2025-11-11 17:12:59,055 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:59] "GET /socket.io/?EIO=4&transport=websocket&sid=rvFJuqlqcdYdwfslAAAY HTTP/1.1" 200 -
2025-11-11 17:12:59,059 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:59] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 17:12:59,064 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:59] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 17:12:59,065 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 17:12:59,078 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:59] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 17:12:59,079 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:59] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 17:12:59,081 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:59] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 17:12:59,140 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:59] "GET /socket.io/?EIO=4&transport=polling&t=Pfq-hPw HTTP/1.1" 200 -
2025-11-11 17:12:59,147 - root - INFO - WebSocket client connected: S1g6lWhU5aBlyQh6AAAe
2025-11-11 17:12:59,148 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:59] "POST /socket.io/?EIO=4&transport=polling&t=Pfq-hQ7&sid=_A86B3XZzMgCg0TYAAAc HTTP/1.1" 200 -
2025-11-11 17:12:59,149 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:59] "GET /socket.io/?EIO=4&transport=polling&t=Pfq-hQ8&sid=_A86B3XZzMgCg0TYAAAc HTTP/1.1" 200 -
2025-11-11 17:12:59,150 - root - INFO - WebSocket client connected: EkzYKBMFb1NP0BYRAAAf
2025-11-11 17:12:59,154 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:59] "POST /socket.io/?EIO=4&transport=polling&t=Pfq-hQF.0&sid=_A86B3XZzMgCg0TYAAAc HTTP/1.1" 200 -
2025-11-11 17:12:59,154 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:59] "GET /socket.io/?EIO=4&transport=polling&t=Pfq-hQF&sid=_A86B3XZzMgCg0TYAAAc HTTP/1.1" 200 -
2025-11-11 17:12:59,158 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:59] "GET /socket.io/?EIO=4&transport=polling&t=Pfq-hQJ&sid=_A86B3XZzMgCg0TYAAAc HTTP/1.1" 200 -
2025-11-11 17:12:59,160 - root - INFO - Client S1g6lWhU5aBlyQh6AAAe joined session room: sess-xsa592fk
2025-11-11 17:12:59,160 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:12:59] "POST /socket.io/?EIO=4&transport=polling&t=Pfq-hQJ.0&sid=_A86B3XZzMgCg0TYAAAc HTTP/1.1" 200 -
2025-11-11 17:13:05,133 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 17:13:05,133 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-xsa592fk
2025-11-11 17:13:05,137 - agent.state_manager - INFO - Loaded session state for sess-xsa592fk
2025-11-11 17:13:05,137 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 3 turns
2025-11-11 17:13:05,138 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 3 conversation turns
2025-11-11 17:13:05,158 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:13:05,158 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=3, conv_history(str)=23127
2025-11-11 17:13:05,164 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:13:05,165 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 17:13:08,561 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:13:08,563 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=True, reasoning=The follow-up query is not specified, so I cannot definitively determine if additional data is required. Please provide the specific follow-up query so I can analyze whether the existing results contain sufficient information to answer it.
2025-11-11 17:13:08,578 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:13:12,076 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:13:12,093 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:13:12,093 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=True, passing to planner
2025-11-11 17:13:12,093 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 17:13:12,093 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 17:13:12,093 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 17:13:12,094 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 17:13:12,094 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 17:13:12,094 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: True
2025-11-11 17:13:12,094 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü° NEW QUERY WITH CONTEXT (different data needed)
2025-11-11 17:13:12,094 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 17:13:12,094 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 17:13:12,094 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 23127 characters
2025-11-11 17:13:12,094 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 17:13:12,095 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 17:13:12,095 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 17:13:12,095 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 17:13:12,095 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 17:13:12,095 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 17:13:12,095 - tools.impl.nl_to_sql_planner - INFO -     User Query: Securitized Credit Trading what is the exposure and limit value for this one
2025-11-11 17:13:12,095 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 17:13:12,095 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 17:13:12,095 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE letter_nm = 'Securitized Credit Trading' AND date = (SELECT MAX(date) FROM limits_data)
2025-11-11 17:13:12,095 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 17:13:12,096 - tools.impl.nl_to_sql_planner - INFO -     Result Table (1 row):
2025-11-11 17:13:12,096 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind
2025-11-11 17:13:12,096 - tools.impl.nl_to_sql_planner - INFO -     ... (22527 more characters)
2025-11-11 17:13:12,096 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 17:13:17,059 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:13:20,307 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"

[NLToSQLPlanner] Knowledge answer generated: I apologize, but the user query "what data do you have?" is not a specific term seeking a definition...
[NLToSQLPlanner] Using LLM to plan query
[NLToSQLPlanner] STAGE 1: Classifying query type for: what tables do you have access to
[NLToSQLPlanner] Classification result: data (confidence: high)
[NLToSQLPlanner] Reasoning: The query 'what tables do you have access to' is a direct request for database metadata/table information, which is a data retrieval query. It seeks to understand the available database objects, not a definition or explanation of a concept. The phrasing indicates a desire to explore the database schema, which is characteristic of a data-oriented query.
[NLToSQLPlanner] STAGE 2b: Checking if clarification needed
[NLToSQLPlanner] FOLLOWUP DETECTED - Adding strict followup context to clarification gate prompt
[NLToSQLPlanner] Clarification gate: needs_clarification=False
[NLToSQLPlanner] STAGE 2c: Generating SQL for clear data query

[NLToSQLPlanner] üì§ SENDING TO LLM (FILTER-ONLY MODE):
  Previous SQL extracted: SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC...
  System prompt length: 10559 chars
  Follow-up instruction added: 1268 chars
[NLToSQLPlanner] Schema summary for LLM:
Available tables/views:

limits_data:
  Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt

[NLToSQLPlanner] Using LLM to plan query
[NLToSQLPlanner] STAGE 1: Classifying query type for: show me the limits whcih have 80% exposure?
[NLToSQLPlanner] Classification result: data (confidence: high)
[NLToSQLPlanner] Reasoning: The query 'show me the limits which have 80% exposure?' is a data retrieval request seeking specific database records filtered by exposure percentage. It follows the DATA QUERY pattern of 'show me [data] where [condition]', requesting a list of limits with 80% exposure. The user is looking to retrieve actual limit records, not seeking a definition or explanation.
[NLToSQLPlanner] STAGE 2b: Checking if clarification needed
[NLToSQLPlanner] FOLLOWUP DETECTED - Adding strict followup context to clarification gate prompt
[NLToSQLPlanner] Clarification gate: needs_clarification=False
[NLToSQLPlanner] STAGE 2c: Generating SQL for clear data query

[NLToSQLPlanner] üì§ SENDING TO LLM (FILTER-ONLY MODE):
  Previous SQL extracted: SELECT table_name FROM information_schema.tables WHERE table_schema = 'main'...
  System prompt length: 10451 chars
  Follow-up instruction added: 1160 chars
[NLToSQLPlanner] Schema summary for LLM:
Available tables/views:

limits_data:
  Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt

[NLToSQLPlanner] Using LLM to plan query
[NLToSQLPlanner] STAGE 1: Classifying query type for: Securitized Credit Trading what is the exposure and limit value for this one
[NLToSQLPlanner] Classification result: data (confidence: high)
[NLToSQLPlanner] Reasoning: The query 'Securitized Credit Trading what is the exposure and limit value for this one' is requesting specific data about a particular trading desk's limits. It seeks concrete numeric values (exposure and limit) for the Securitized Credit Trading desk, which requires querying the limits_data table. The phrase 'what is the' suggests a data retrieval request, not a definitional query. The context of previous interactions also reinforces this as a data-driven query focused on retrieving specific limit information.
[NLToSQLPlanner] STAGE 2b: Checking if clarification needed
[NLToSQLPlanner] FOLLOWUP DETECTED - Adding strict followup context to clarification gate prompt
[NLToSQLPlanner] Clarification gate: needs_clarification=False
[NLToSQLPlanner] STAGE 2c: Generating SQL for clear data query

[NLToSQLPlanner] üì§ SENDING TO LLM (FILTER-ONLY MODE):
  Previous SQL extracted: SELECT * FROM limits_data 
WHERE exposure_amt >= 0.8 * effective_limit 
AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC...
  System prompt length: 10589 chars
  Follow-up instruction added: 1298 chars
[NLToSQLPlanner] Schema summary for LLM:
Available tables/views:

limits_data:
  Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt

[NLToSQLPlanner] Using LLM to plan query
[NLToSQLPlanner] STAGE 1: Classifying query type for: top 20 limits by utlisation
[NLToSQLPlanner] Classification result: data (confidence: high)
[NLToSQLPlanner] Reasoning: The query 'top 20 limits by utlisation' is clearly a data retrieval request seeking to list and rank limits based on their utilization. It follows the classic data query pattern of 'top N [data] by [attribute]', which indicates a desire to fetch and order database records, not seek a definition or explanation.
[NLToSQLPlanner] STAGE 2b: Checking if clarification needed
[NLToSQLPlanner] FOLLOWUP DETECTED - Adding strict followup context to clarification gate prompt
[NLToSQLPlanner] Clarification gate: needs_clarification=False
[NLToSQLPlanner] STAGE 2c: Generating SQL for clear data query

[NLToSQLPlanner] üì§ SENDING TO LLM (FILTER-ONLY MODE):
  Previous SQL extracted: SELECT * FROM limits_data 
WHERE letter_nm = 'Securitized Credit Trading' 
AND date = (SELECT MAX(date) FROM limits_data)...
  System prompt length: 10541 chars
  Follow-up instruction added: 1250 chars
[NLToSQLPlanner] Schema summary for LLM:
Available tables/views:

limits_data:
  Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt

[NLToSQLPlanner] Using LLM to plan query
[NLToSQLPlanner] STAGE 1: Classifying query type for: top primary limits
[NLToSQLPlanner] Classification result: data (confidence: high)
[NLToSQLPlanner] Reasoning: The query 'top primary limits' is a clear request for retrieving database records, specifically the top limits sorted by some ranking criteria (likely utilization). The phrase 'top' indicates a data retrieval operation with sorting, which is characteristic of a database query rather than a request for definition or explanation.
[NLToSQLPlanner] STAGE 2b: Checking if clarification needed
[NLToSQLPlanner] FOLLOWUP DETECTED - Adding strict followup context to clarification gate prompt
[NLToSQLPlanner] Clarification gate: needs_clarification=False
[NLToSQLPlanner] STAGE 2c: Generating SQL for clear data query

[NLToSQLPlanner] üì§ SENDING TO LLM (FILTER-ONLY MODE):
  Previous SQL extracted: SELECT * FROM limits_data 
WHERE date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC 
LIMIT 20...
  System prompt length: 10523 chars
  Follow-up instruction added: 1232 chars
[NLToSQLPlanner] Schema summary for LLM:
Available tables/views:

limits_data:
  Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt

[NLToSQLPlanner] Using LLM to plan query
[NLToSQLPlanner] STAGE 1: Classifying query type for: top primary limits
[NLToSQLPlanner] Classification result: data (confidence: high)
[NLToSQLPlanner] Reasoning: The query 'top primary limits' is a clear request for database retrieval, specifically seeking the top primary market risk limits sorted by utilization. This is a data-driven query that requires filtering and ranking limits from the limits_data table, focusing on primary limit class and sorting by utilization in descending order. The user is looking to retrieve actual limit records, not seeking a definition or explanation of limits.
[NLToSQLPlanner] STAGE 2b: Checking if clarification needed
[NLToSQLPlanner] FOLLOWUP DETECTED - Adding strict followup context to clarification gate prompt
[NLToSQLPlanner] Clarification gate: needs_clarification=False
[NLToSQLPlanner] STAGE 2c: Generating SQL for clear data query2025-11-11 17:13:22,374 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 17:13:22,374 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 17:13:22,374 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10307 chars
2025-11-11 17:13:22,375 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 45694 chars
2025-11-11 17:13:22,375 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 17:13:22,375 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 17:13:25,763 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:13:28,035 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 451 chars
2025-11-11 17:13:28,035 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primary' ORDER BY utilization DESC LIMIT 20",
    "explanation": "Retrieved top primary limits by utilization for the most recent date, sorted from highest to lowest. Filtered for 'Primary' limit class as query specified 'primary limits'. Defaulted to latest date snapshot and added LIMIT 20 as requested.",
    "target_table": "limits_data"
}
2025-11-11 17:13:28,035 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 17:13:28,035 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 17:13:28,035 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primary' ORDER BY utilization DESC LIMIT 20...
2025-11-11 17:13:28,035 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primary' ORDER BY utilization DESC LIMIT 20
2025-11-11 17:13:28,046 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:13:28,054 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:13:28,055 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primary' ORDER BY utilization DESC LIMIT 20...
2025-11-11 17:13:28,055 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 137 chars
2025-11-11 17:13:28,055 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primary' ORDER BY utilization DESC LIMIT 20
2025-11-11 17:13:28,055 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primary' ORDER BY utilization DESC LIMIT 20...
2025-11-11 17:13:28,055 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primary' ORDER BY utilization DESC LIMIT 20...
2025-11-11 17:13:28,055 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 17:13:28,055 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primary' ORDER BY utilization DESC LIMIT 20...
2025-11-11 17:13:28,174 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:13:28,174 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primar
2025-11-11 17:13:28,174 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 17:13:28,174 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 17:13:28,174 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primar
2025-11-11 17:13:28,174 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=137
2025-11-11 17:13:28,174 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 17:13:28,174 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 17:13:28,175 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4850 chars
2025-11-11 17:13:29,040 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:13:40,294 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 2008 chars
2025-11-11 17:13:40,296 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 17:13:40,296 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 17:13:40,297 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 43731 chars
2025-11-11 17:13:48,702 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:13:48,704 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1042 chars
2025-11-11 17:13:48,705 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primar
2025-11-11 17:13:48,705 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 17:13:48,705 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primar...
2025-11-11 17:13:48,705 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primar...
2025-11-11 17:13:48,719 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:13:48,720 - agent.streaming_agent - INFO - Agent completed for session sess-xsa592fk: 43561.681ms, 8 steps
2025-11-11 17:13:48,720 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
.
2025-11-11 17:13:48,705 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primar...
2025-11-11 17:13:48,719 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:13:48,720 - agent.streaming_agent - INFO - Agent completed for session sess-xsa592fk: 43561.681ms, 8 steps
2025-11-11 17:13:48,720 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 17:22:21,003 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-11 17:22:21,055 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-11 17:22:21,057 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-11 17:22:21,061 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-11 17:22:21,061 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-11 17:22:21,109 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 17:22:21,110 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 17:22:21,111 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 17:22:21,111 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 17:22:21,111 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-11 17:22:21,111 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-11 17:22:21,111 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-11 17:22:21,112 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-11 17:22:21,112 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-11 17:22:21,113 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-11 17:22:21,114 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-11 17:22:21,114 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-11 17:22:21,114 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-11 17:22:21,116 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-11 17:22:21,116 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-11 17:22:21,117 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-11 17:22:21,118 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-11 17:22:21,120 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-11 17:22:21,120 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-11 17:22:22,936 - DuckDbDescribeTableTool - INFO - Found 1 data files in data/duckdb
2025-11-11 17:22:23,055 - DuckDbDescribeTableTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 17:22:23,080 - DuckDbDescribeTableTool - INFO - Initialization complete: 4 views available
2025-11-11 17:22:23,083 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 17:22:23,090 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-11 17:22:23,099 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-11 17:22:23,101 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-11 17:22:23,101 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-11 17:22:24,544 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-11 17:22:24,544 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-11 17:22:24,548 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-11 17:22:24,550 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-11 17:22:24,552 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-11 17:22:24,552 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-11 17:22:24,553 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-11 17:22:24,554 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-11 17:22:24,554 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-11 17:22:24,554 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-11 17:22:24,562 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-11 17:22:24,562 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-11 17:22:24,563 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-11 17:22:24,563 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-11 17:22:24,566 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-11 17:22:24,566 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-11 17:22:24,567 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-11 17:22:24,567 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-11 17:22:24,568 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-11 17:22:24,568 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-11 17:22:24,568 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-11 17:22:24,568 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-11 17:22:24,570 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-11 17:22:24,570 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-11 17:22:24,571 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-11 17:22:24,571 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-11 17:22:24,572 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-11 17:22:24,573 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-11 17:22:24,573 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-11 17:22:24,573 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-11 17:22:24,574 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-11 17:22:24,574 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-11 17:22:24,576 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-11 17:22:24,576 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-11 17:22:24,577 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-11 17:22:24,577 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-11 17:22:24,577 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-11 17:22:24,577 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-11 17:22:24,583 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-11 17:22:24,584 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-11 17:22:24,584 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-11 17:22:24,584 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-11 17:22:24,584 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-11 17:22:24,585 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-11 17:22:24,585 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-11 17:22:24,585 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-11 17:22:24,602 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 17:22:24,603 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 17:22:24,603 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 17:22:24,603 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 17:22:24,603 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-11 17:22:24,603 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-11 17:22:24,603 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-11 17:22:24,604 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-11 17:22:24,604 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-11 17:22:24,605 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-11 17:22:24,605 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-11 17:22:24,609 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-11 17:22:24,610 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-11 17:22:24,610 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-11 17:22:24,611 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-11 17:22:24,612 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-11 17:22:24,612 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-11 17:22:24,613 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-11 17:22:24,613 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-11 17:22:24,615 - DuckDbListFilesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 17:22:24,719 - DuckDbListFilesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 17:22:24,724 - DuckDbListFilesTool - INFO - Initialization complete: 4 views available
2025-11-11 17:22:24,724 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 17:22:24,725 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-11 17:22:24,725 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-11 17:22:24,725 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-11 17:22:24,725 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-11 17:22:24,726 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-11 17:22:24,726 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-11 17:22:24,727 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-11 17:22:24,727 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-11 17:22:24,728 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-11 17:22:24,728 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-11 17:22:24,728 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-11 17:22:24,728 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-11 17:22:24,729 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-11 17:22:24,729 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-11 17:22:24,729 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-11 17:22:24,729 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-11 17:22:24,730 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-11 17:22:24,730 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-11 17:22:24,740 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-11 17:22:24,740 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-11 17:22:24,740 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-11 17:22:24,740 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-11 17:22:24,740 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-11 17:22:24,741 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-11 17:22:24,741 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-11 17:22:24,741 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-11 17:22:24,741 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-11 17:22:24,741 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-11 17:22:24,742 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-11 17:22:24,742 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-11 17:22:24,743 - DuckDbGetStatsTool - INFO - Found 1 data files in data/duckdb
2025-11-11 17:22:24,826 - DuckDbGetStatsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 17:22:24,829 - DuckDbGetStatsTool - INFO - Initialization complete: 4 views available
2025-11-11 17:22:24,829 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 17:22:24,829 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-11 17:22:24,830 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-11 17:22:24,830 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-11 17:22:24,830 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-11 17:22:24,830 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-11 17:22:24,830 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-11 17:22:24,831 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-11 17:22:24,831 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-11 17:22:24,831 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-11 17:22:24,831 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-11 17:22:24,842 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 17:22:24,842 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 17:22:24,842 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 17:22:24,842 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 17:22:24,842 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-11 17:22:24,842 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-11 17:22:24,842 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-11 17:22:24,842 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-11 17:22:24,842 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-11 17:22:24,843 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-11 17:22:24,843 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-11 17:22:24,855 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-11 17:22:24,855 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-11 17:22:24,855 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-11 17:22:24,855 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-11 17:22:24,856 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-11 17:22:24,856 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-11 17:22:24,856 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-11 17:22:24,856 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-11 17:22:24,856 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-11 17:22:24,856 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-11 17:22:24,856 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-11 17:22:24,856 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-11 17:22:24,856 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-11 17:22:24,856 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-11 17:22:24,857 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-11 17:22:24,857 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-11 17:22:24,857 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-11 17:22:24,857 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-11 17:22:24,857 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-11 17:22:24,857 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-11 17:22:24,858 - DuckDbListTablesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 17:22:24,932 - DuckDbListTablesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 17:22:24,935 - DuckDbListTablesTool - INFO - Initialization complete: 4 views available
2025-11-11 17:22:24,935 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 17:22:24,936 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-11 17:22:24,936 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-11 17:22:24,936 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-11 17:22:24,936 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-11 17:22:24,936 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-11 17:22:24,936 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-11 17:22:24,936 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-11 17:22:24,937 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-11 17:22:24,937 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-11 17:22:24,937 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-11 17:22:24,937 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-11 17:22:24,937 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-11 17:22:24,937 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-11 17:22:24,937 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-11 17:22:24,938 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-11 17:22:24,938 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-11 17:22:24,938 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-11 17:22:24,938 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-11 17:22:24,938 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-11 17:22:24,938 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-11 17:22:24,939 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-11 17:22:24,939 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-11 17:22:24,939 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-11 17:22:24,939 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-11 17:22:24,939 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-11 17:22:24,940 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-11 17:22:24,940 - DuckDbAggregateTool - INFO - Found 1 data files in data/duckdb
2025-11-11 17:22:25,015 - DuckDbAggregateTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 17:22:25,018 - DuckDbAggregateTool - INFO - Initialization complete: 4 views available
2025-11-11 17:22:25,018 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 17:22:25,018 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-11 17:22:25,018 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-11 17:22:25,019 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-11 17:22:25,019 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-11 17:22:25,019 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-11 17:22:25,019 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-11 17:22:25,019 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-11 17:22:25,019 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-11 17:22:25,020 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-11 17:22:25,020 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-11 17:22:25,020 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-11 17:22:25,020 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-11 17:22:25,020 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-11 17:22:25,020 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-11 17:22:25,031 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 17:22:25,031 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 17:22:25,031 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 17:22:25,031 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 17:22:25,031 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-11 17:22:25,031 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-11 17:22:25,031 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-11 17:22:25,031 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-11 17:22:25,031 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-11 17:22:25,032 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-11 17:22:25,032 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-11 17:22:25,032 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-11 17:22:25,032 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-11 17:22:25,032 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-11 17:22:25,032 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-11 17:22:25,033 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-11 17:22:25,033 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-11 17:22:25,033 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-11 17:22:25,033 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-11 17:22:25,033 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-11 17:22:25,033 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-11 17:22:25,033 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-11 17:22:25,033 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-11 17:22:25,033 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-11 17:22:25,034 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-11 17:22:25,034 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-11 17:22:25,034 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-11 17:22:25,034 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-11 17:22:25,034 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-11 17:22:25,035 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-11 17:22:25,035 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-11 17:22:25,035 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-11 17:22:25,035 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-11 17:22:25,035 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-11 17:22:25,035 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-11 17:22:25,035 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-11 17:22:25,035 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-11 17:22:25,036 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-11 17:22:25,036 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-11 17:22:25,036 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-11 17:22:25,036 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-11 17:22:25,036 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-11 17:22:25,036 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-11 17:22:25,036 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-11 17:22:25,036 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-11 17:22:25,037 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-11 17:22:25,037 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-11 17:22:25,037 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-11 17:22:25,037 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-11 17:22:25,037 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-11 17:22:25,037 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-11 17:22:25,037 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-11 17:22:25,037 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-11 17:22:25,037 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-11 17:22:25,037 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-11 17:22:25,038 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-11 17:22:25,038 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-11 17:22:25,038 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-11 17:22:25,038 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-11 17:22:25,038 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-11 17:22:25,038 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-11 17:22:25,039 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-11 17:22:25,039 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-11 17:22:25,040 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-11 17:22:25,040 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-11 17:22:25,040 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-11 17:22:25,040 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-11 17:22:25,040 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-11 17:22:25,040 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-11 17:22:25,040 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-11 17:22:25,040 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-11 17:22:25,040 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-11 17:22:25,040 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-11 17:22:25,041 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-11 17:22:25,041 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-11 17:22:25,051 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 17:22:25,051 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 17:22:25,051 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 17:22:25,052 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 17:22:25,052 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-11 17:22:25,052 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-11 17:22:25,052 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-11 17:22:25,052 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-11 17:22:25,052 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-11 17:22:25,052 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-11 17:22:25,052 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-11 17:22:25,053 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-11 17:22:25,053 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-11 17:22:25,053 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-11 17:22:25,053 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-11 17:22:25,053 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-11 17:22:25,053 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-11 17:22:25,053 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-11 17:22:25,053 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-11 17:22:25,054 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-11 17:22:25,054 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-11 17:22:25,054 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-11 17:22:25,054 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-11 17:22:25,054 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-11 17:22:25,054 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-11 17:22:25,054 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-11 17:22:25,054 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-11 17:22:25,054 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-11 17:22:25,054 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-11 17:22:25,055 - DuckDbQueryTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 17:22:25,130 - DuckDbQueryTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 17:22:25,134 - DuckDbQueryTool - INFO - Initialization complete: 4 views available
2025-11-11 17:22:25,134 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 17:22:25,134 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-11 17:22:25,134 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-11 17:22:25,135 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-11 17:22:25,135 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-11 17:22:25,135 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-11 17:22:25,135 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-11 17:22:25,135 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-11 17:22:25,135 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-11 17:22:25,136 - DuckDbRefreshViewsTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 17:22:25,241 - DuckDbRefreshViewsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 17:22:25,245 - DuckDbRefreshViewsTool - INFO - Initialization complete: 4 views available
2025-11-11 17:22:25,246 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 17:22:25,246 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-11 17:22:25,246 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-11 17:22:25,247 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-11 17:22:25,247 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-11 17:22:25,248 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-11 17:22:25,248 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-11 17:22:25,269 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 17:22:25,269 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 17:22:25,269 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 17:22:25,269 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 17:22:25,270 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-11 17:22:25,270 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-11 17:22:25,270 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-11 17:22:25,270 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-11 17:22:25,270 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-11 17:22:25,271 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-11 17:22:25,271 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-11 17:22:25,272 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-11 17:22:25,273 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-11 17:22:25,273 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-11 17:22:25,274 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-11 17:22:25,274 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-11 17:22:25,274 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-11 17:22:25,274 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-11 17:22:25,274 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-11 17:22:25,275 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-11 17:22:25,306 - root - INFO - All routes registered successfully
2025-11-11 17:22:25,307 - werkzeug - WARNING - Werkzeug appears to be used in a production deployment. Consider switching to a production web server instead.
2025-11-11 17:22:25,318 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.68.51:8000
2025-11-11 17:22:25,318 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-11-11 17:22:30,186 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:22:30] "GET /socket.io/?EIO=4&transport=polling&t=Pfr0spT HTTP/1.1" 200 -
2025-11-11 17:22:30,363 - root - INFO - WebSocket client connected: yaq_9dQwgni-VjMSAAAC
2025-11-11 17:22:30,414 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:22:30] "GET /socket.io/?EIO=4&transport=polling&t=Pfr0ssX&sid=D8ewNznaurHzl8GtAAAB HTTP/1.1" 200 -
2025-11-11 17:22:30,415 - root - INFO - WebSocket client disconnected: yaq_9dQwgni-VjMSAAAC
2025-11-11 17:22:30,431 - root - INFO - WebSocket client connected: QCBZ_9i7dczcbv_5AAAD
2025-11-11 17:22:30,431 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:22:30] "POST /socket.io/?EIO=4&transport=polling&t=Pfr0ssW&sid=D8ewNznaurHzl8GtAAAB HTTP/1.1" 200 -
2025-11-11 17:22:30,464 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:22:30] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 17:22:30,466 - root - INFO - WebSocket client disconnected: QCBZ_9i7dczcbv_5AAAD
2025-11-11 17:22:30,474 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:22:30] "GET /socket.io/?EIO=4&transport=websocket&sid=D8ewNznaurHzl8GtAAAB HTTP/1.1" 200 -
2025-11-11 17:22:30,479 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 17:27:10,808 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:27:10] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 17:27:10,852 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:27:10] "GET /login?next=http://localhost:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 17:27:11,012 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:27:11] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 17:27:11,016 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:27:11] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 17:27:11,043 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:27:11] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 17:27:11,229 - root - INFO - WebSocket client connected: aLMXQxWw43aTFUWkAAAF
2025-11-11 17:27:11,240 - root - INFO - WebSocket client disconnected: aLMXQxWw43aTFUWkAAAF
2025-11-11 17:27:11,264 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:27:11] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 17:27:11,269 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 17:27:16,988 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 17:27:16,992 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 17:27:16,994 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:27:16] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 17:27:17,040 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:27:17] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 17:27:17,134 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:27:17] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 17:27:17,139 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:27:17] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 17:27:17,147 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:27:17] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 17:27:17,506 - root - INFO - WebSocket client connected: P0c6j-1BUZsFIsopAAAH
2025-11-11 17:27:17,522 - root - INFO - WebSocket client disconnected: P0c6j-1BUZsFIsopAAAH
2025-11-11 17:27:17,538 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:27:17] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 17:27:17,540 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 17:27:22,408 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:27:22] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 17:27:22,446 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:27:22] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 17:27:22,450 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:27:22] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 17:27:22,458 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:27:22] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 17:27:22,517 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:27:22] "GET /socket.io/?EIO=4&transport=polling&t=Pfr1-C8 HTTP/1.1" 200 -
2025-11-11 17:27:22,533 - root - INFO - WebSocket client connected: U00seCkBcYPTadXxAAAK
2025-11-11 17:27:22,554 - root - INFO - WebSocket client connected: P8ZmJrvYbB4tDpGxAAAL
2025-11-11 17:27:22,569 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:27:22] "POST /socket.io/?EIO=4&transport=polling&t=Pfr1-CS&sid=wNRgSxKhQuijrTm7AAAJ HTTP/1.1" 200 -
2025-11-11 17:27:22,569 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:27:22] "GET /socket.io/?EIO=4&transport=polling&t=Pfr1-CS.0&sid=wNRgSxKhQuijrTm7AAAJ HTTP/1.1" 200 -
2025-11-11 17:27:22,576 - root - INFO - Client P8ZmJrvYbB4tDpGxAAAL joined session room: sess-xsa592fk
2025-11-11 17:27:29,954 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 17:27:29,954 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-xsa592fk
2025-11-11 17:27:29,958 - agent.state_manager - INFO - Loaded session state for sess-xsa592fk
2025-11-11 17:27:29,958 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 3 turns
2025-11-11 17:27:29,958 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 3 conversation turns
2025-11-11 17:27:29,969 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:27:29,969 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 17:27:29,969 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 17:27:29,969 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 17:27:29,970 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=3, conv_history(str)=25440
2025-11-11 17:27:29,970 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output']
2025-11-11 17:27:29,970 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 3 data keys
2025-11-11 17:27:29,971 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 17:27:29,975 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:27:29,975 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 17:27:34,164 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:27:34,181 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=True, reasoning=The response depends on the specific follow-up query, which was not provided in the context. Without knowing the exact details of the new query, I cannot definitively determine if the previous results would be sufficient. The previous results only showed 3 primary limits with high utilization, so any query requiring broader or different data would likely require a new database fetch.
2025-11-11 17:27:34,181 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output']
2025-11-11 17:27:34,181 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 3 data keys
2025-11-11 17:27:34,181 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 17:27:34,187 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:27:37,249 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:27:37,251 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output']
2025-11-11 17:27:37,251 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 2 data keys
2025-11-11 17:27:37,251 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 17:27:37,260 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:27:37,261 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=True, passing to planner
2025-11-11 17:27:37,261 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 17:27:37,261 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 17:27:37,261 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 17:27:37,261 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 17:27:37,261 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 17:27:37,261 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: True
2025-11-11 17:27:37,261 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü° NEW QUERY WITH CONTEXT (different data needed)
2025-11-11 17:27:37,261 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 17:27:37,261 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 17:27:37,261 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 25440 characters
2025-11-11 17:27:37,261 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 17:27:37,262 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 17:27:37,262 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 17:27:37,262 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 17:27:37,262 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 17:27:37,262 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 17:27:37,262 - tools.impl.nl_to_sql_planner - INFO -     User Query: top 20 limits by utlisation
2025-11-11 17:27:37,262 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 17:27:37,262 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 17:27:37,262 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC LIMIT 20
2025-11-11 17:27:37,262 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 17:27:37,263 - tools.impl.nl_to_sql_planner - INFO -     Result Table (10 rows):
2025-11-11 17:27:37,263 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_instance_id
2025-11-11 17:27:37,263 - tools.impl.nl_to_sql_planner - INFO -     ... (24840 more characters)
2025-11-11 17:27:37,263 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 17:27:41,837 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:27:44,908 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:27:47,494 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 17:27:47,494 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 17:27:47,494 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10307 chars
2025-11-11 17:27:47,494 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 48007 chars
2025-11-11 17:27:47,494 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 17:27:47,494 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 17:27:50,847 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:27:52,757 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 397 chars
2025-11-11 17:27:52,758 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primary' ORDER BY utilization DESC LIMIT 20",
  "explanation": "Retrieved top primary limits by utilization for the most recent date, focusing on limits with highest exposure risk. Filtered for primary limits and sorted by utilization in descending order.",
  "target_table": "limits_data"
}
2025-11-11 17:27:52,758 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 17:27:52,759 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 17:27:52,759 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primary' ORDER BY utilization DESC LIMIT 20...
2025-11-11 17:27:52,759 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primary' ORDER BY utilization DESC LIMIT 20
2025-11-11 17:27:52,761 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output']
2025-11-11 17:27:52,761 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 3 data keys
2025-11-11 17:27:52,761 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 17:27:52,784 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:27:52,784 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output']
2025-11-11 17:27:52,785 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 4 data keys
2025-11-11 17:27:52,785 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 17:27:52,791 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:27:52,791 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primary' ORDER BY utilization DESC LIMIT 20...
2025-11-11 17:27:52,792 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 137 chars
2025-11-11 17:27:52,792 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primary' ORDER BY utilization DESC LIMIT 20
2025-11-11 17:27:52,792 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primary' ORDER BY utilization DESC LIMIT 20...
2025-11-11 17:27:52,792 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primary' ORDER BY utilization DESC LIMIT 20...
2025-11-11 17:27:52,792 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 17:27:52,792 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primary' ORDER BY utilization DESC LIMIT 20...
2025-11-11 17:27:52,901 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output']
2025-11-11 17:27:52,901 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 3 data keys
2025-11-11 17:27:52,902 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 17:27:52,906 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:27:52,906 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primar
2025-11-11 17:27:52,906 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 17:27:52,906 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 17:27:52,907 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primar
2025-11-11 17:27:52,907 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=137
2025-11-11 17:27:52,907 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 17:27:52,907 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 17:27:52,907 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4850 chars
2025-11-11 17:27:53,663 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:28:03,576 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1825 chars
2025-11-11 17:28:03,578 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 17:28:03,578 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 17:28:03,579 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 43419 chars
2025-11-11 17:28:11,841 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:28:11,843 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1051 chars
2025-11-11 17:28:11,843 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primar
2025-11-11 17:28:11,843 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 17:28:11,844 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primar...
2025-11-11 17:28:11,844 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) AND limit_class = 'Primar...
2025-11-11 17:28:11,844 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output']
2025-11-11 17:28:11,845 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 2 data keys
2025-11-11 17:28:11,846 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 17:28:11,862 - agent.state_manager - INFO - Saved session state for sess-xsa592fk (user: admin)
2025-11-11 17:28:11,862 - agent.streaming_agent - INFO - Agent completed for session sess-xsa592fk: 41892.649ms, 8 steps
2025-11-11 17:28:11,862 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 17:33:50,244 - root - INFO - Client P8ZmJrvYbB4tDpGxAAAL joined session room: sess-0t1b6z7j
2025-11-11 17:34:06,643 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 17:34:06,644 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-0t1b6z7j
2025-11-11 17:34:06,645 - agent.state_manager - WARNING - Session sess-0t1b6z7j not found
2025-11-11 17:34:06,645 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 17:34:06,651 - agent.state_manager - INFO - Saved session state for sess-0t1b6z7j (user: admin)
2025-11-11 17:34:06,651 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 17:34:06,651 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 17:34:06,651 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 17:34:06,653 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 17:34:06,654 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output']
2025-11-11 17:34:06,654 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 3 data keys
2025-11-11 17:34:06,654 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 17:34:06,657 - agent.state_manager - INFO - Saved session state for sess-0t1b6z7j (user: admin)
2025-11-11 17:34:10,248 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:34:10,251 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output']
2025-11-11 17:34:10,252 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 2 data keys
2025-11-11 17:34:10,253 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 17:34:10,258 - agent.state_manager - INFO - Saved session state for sess-0t1b6z7j (user: admin)
2025-11-11 17:34:10,259 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 17:34:10,259 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 17:34:10,259 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 17:34:10,259 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 17:34:10,264 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 17:34:10,264 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 17:34:10,264 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 17:34:10,264 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 17:34:10,264 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 17:34:10,265 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 17:34:10,265 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 17:34:10,265 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 17:34:10,265 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 17:34:10,265 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 17:34:10,265 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 17:34:10,265 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 17:34:13,098 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:34:14,711 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:34:17,432 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 17:34:17,432 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 17:34:17,432 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-11 17:34:17,432 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 22600 chars
2025-11-11 17:34:17,433 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 17:34:17,433 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 17:34:19,971 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:34:22,634 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 365 chars
2025-11-11 17:34:22,634 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
  "explanation": "Retrieve top primary limits for the latest date, sorted by utilization in descending order. Assumed 'top' means all primary limits, sorted by highest utilization first.",
  "target_table": "limits_data"
}
2025-11-11 17:34:22,635 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 17:34:22,635 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 17:34:22,635 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:34:22,635 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 17:34:22,635 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output']
2025-11-11 17:34:22,636 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 3 data keys
2025-11-11 17:34:22,636 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 17:34:22,641 - agent.state_manager - INFO - Saved session state for sess-0t1b6z7j (user: admin)
2025-11-11 17:34:22,641 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output']
2025-11-11 17:34:22,642 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 4 data keys
2025-11-11 17:34:22,642 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 17:34:22,649 - agent.state_manager - INFO - Saved session state for sess-0t1b6z7j (user: admin)
2025-11-11 17:34:22,649 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:34:22,649 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 17:34:22,650 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 17:34:22,650 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:34:22,650 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:34:22,650 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 17:34:22,650 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:34:22,760 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output']
2025-11-11 17:34:22,760 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 3 data keys
2025-11-11 17:34:22,760 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 17:34:22,763 - agent.state_manager - INFO - Saved session state for sess-0t1b6z7j (user: admin)
2025-11-11 17:34:22,764 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 17:34:22,764 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 17:34:22,764 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 17:34:22,764 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 17:34:22,764 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 17:34:22,764 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 17:34:22,765 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 17:34:22,766 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4840 chars
2025-11-11 17:34:23,907 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:34:34,020 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1748 chars
2025-11-11 17:34:34,022 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 17:34:34,022 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 17:34:34,023 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 38218 chars
2025-11-11 17:34:40,947 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:34:40,949 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 798 chars
2025-11-11 17:34:40,950 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 17:34:40,950 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 17:34:40,950 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 17:34:40,950 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 17:34:40,950 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output']
2025-11-11 17:34:40,951 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 2 data keys
2025-11-11 17:34:40,952 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 17:34:40,959 - agent.state_manager - INFO - Saved session state for sess-0t1b6z7j (user: admin)
2025-11-11 17:34:40,960 - agent.streaming_agent - INFO - Agent completed for session sess-0t1b6z7j: 34306.604999999996ms, 7 steps
2025-11-11 17:34:40,960 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 17:42:49,617 - root - INFO - WebSocket client disconnected: U00seCkBcYPTadXxAAAK
2025-11-11 17:42:49,618 - root - INFO - WebSocket client disconnected: P8ZmJrvYbB4tDpGxAAAL
2025-11-11 17:42:49,624 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:42:49] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 17:42:49,625 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:42:49] "GET /socket.io/?EIO=4&transport=websocket&sid=wNRgSxKhQuijrTm7AAAJ HTTP/1.1" 200 -
2025-11-11 17:42:49,633 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:42:49] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 17:42:49,636 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 17:42:49,668 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:42:49] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 17:42:49,669 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:42:49] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 17:42:49,683 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:42:49] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 17:42:49,757 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:42:49] "GET /socket.io/?EIO=4&transport=polling&t=Pfr5WaJ HTTP/1.1" 200 -
2025-11-11 17:42:49,848 - root - INFO - WebSocket client connected: yDEliAlwHyuVtTBFAAAO
2025-11-11 17:42:49,849 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:42:49] "POST /socket.io/?EIO=4&transport=polling&t=Pfr5WaW&sid=Ce_1vDUtM_unt8ySAAAM HTTP/1.1" 200 -
2025-11-11 17:42:49,849 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:42:49] "GET /socket.io/?EIO=4&transport=polling&t=Pfr5WaX&sid=Ce_1vDUtM_unt8ySAAAM HTTP/1.1" 200 -
2025-11-11 17:42:49,856 - root - INFO - WebSocket client connected: pkYdeyELWDcsCvj2AAAP
2025-11-11 17:42:49,861 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:42:49] "POST /socket.io/?EIO=4&transport=polling&t=Pfr5Wb_&sid=Ce_1vDUtM_unt8ySAAAM HTTP/1.1" 200 -
2025-11-11 17:42:49,862 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:42:49] "GET /socket.io/?EIO=4&transport=polling&t=Pfr5Wb-&sid=Ce_1vDUtM_unt8ySAAAM HTTP/1.1" 200 -
2025-11-11 17:42:49,866 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:42:49] "GET /socket.io/?EIO=4&transport=polling&t=Pfr5Wc8&sid=Ce_1vDUtM_unt8ySAAAM HTTP/1.1" 200 -
2025-11-11 17:42:49,877 - root - INFO - Client yDEliAlwHyuVtTBFAAAO joined session room: sess-0t1b6z7j
2025-11-11 17:42:49,878 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:42:49] "POST /socket.io/?EIO=4&transport=polling&t=Pfr5Wc8.0&sid=Ce_1vDUtM_unt8ySAAAM HTTP/1.1" 200 -
2025-11-11 17:42:49,879 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:42:49] "GET /socket.io/?EIO=4&transport=polling&t=Pfr5WcB&sid=Ce_1vDUtM_unt8ySAAAM HTTP/1.1" 200 -
2025-11-11 17:42:53,140 - root - INFO - Client yDEliAlwHyuVtTBFAAAO joined session room: sess-ond1icsu
2025-11-11 17:43:02,104 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 17:43:02,105 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-ond1icsu
2025-11-11 17:43:02,105 - agent.state_manager - WARNING - Session sess-ond1icsu not found
2025-11-11 17:43:02,105 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 17:43:02,109 - agent.state_manager - INFO - Saved session state for sess-ond1icsu (user: admin)
2025-11-11 17:43:02,109 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 17:43:02,109 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 17:43:02,109 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 17:43:02,109 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 17:43:02,109 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output']
2025-11-11 17:43:02,109 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 3 data keys
2025-11-11 17:43:02,109 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 17:43:02,111 - agent.state_manager - INFO - Saved session state for sess-ond1icsu (user: admin)
2025-11-11 17:43:05,564 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:43:05,565 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output']
2025-11-11 17:43:05,565 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 2 data keys
2025-11-11 17:43:05,565 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 17:43:05,567 - agent.state_manager - INFO - Saved session state for sess-ond1icsu (user: admin)
2025-11-11 17:43:05,567 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 17:43:05,567 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 17:43:05,567 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 17:43:05,567 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 17:43:05,567 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 17:43:05,567 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 17:43:05,567 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 17:43:05,567 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 17:43:05,567 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 17:43:05,568 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 17:43:05,568 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 17:43:05,568 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 17:43:05,568 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 17:43:05,568 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 17:43:05,568 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 17:43:05,568 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 17:43:08,740 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:43:10,380 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:43:12,310 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 17:43:12,310 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 17:43:12,310 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-11 17:43:12,310 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 22600 chars
2025-11-11 17:43:12,311 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 17:43:12,311 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 17:43:14,476 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:43:16,727 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 364 chars
2025-11-11 17:43:16,727 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
  "explanation": "Retrieved top primary limits for the latest date, sorted by utilization in descending order. Applied 'Primary' limit class filter and used most recent date as default.",
  "target_table": "limits_data"
}
2025-11-11 17:43:16,728 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 17:43:16,728 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 17:43:16,728 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:43:16,728 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 17:43:16,729 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output']
2025-11-11 17:43:16,729 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 3 data keys
2025-11-11 17:43:16,729 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 17:43:16,737 - agent.state_manager - INFO - Saved session state for sess-ond1icsu (user: admin)
2025-11-11 17:43:16,738 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output']
2025-11-11 17:43:16,738 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 4 data keys
2025-11-11 17:43:16,738 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 17:43:16,742 - agent.state_manager - INFO - Saved session state for sess-ond1icsu (user: admin)
2025-11-11 17:43:16,742 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:43:16,742 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 17:43:16,742 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 17:43:16,742 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:43:16,742 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:43:16,742 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 17:43:16,743 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:43:16,856 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output']
2025-11-11 17:43:16,856 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 3 data keys
2025-11-11 17:43:16,856 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 17:43:16,858 - agent.state_manager - INFO - Saved session state for sess-ond1icsu (user: admin)
2025-11-11 17:43:16,858 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 17:43:16,858 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 17:43:16,858 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 17:43:16,858 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 17:43:16,858 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 17:43:16,858 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 17:43:16,858 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 17:43:16,859 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4840 chars
2025-11-11 17:43:17,749 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:43:27,316 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1775 chars
2025-11-11 17:43:27,317 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 17:43:27,317 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 17:43:27,318 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 38217 chars
2025-11-11 17:43:34,380 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:43:34,385 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 828 chars
2025-11-11 17:43:34,386 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 17:43:34,386 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 17:43:34,386 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 17:43:34,386 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 17:43:34,390 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output']
2025-11-11 17:43:34,390 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 2 data keys
2025-11-11 17:43:34,391 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 17:43:34,399 - agent.state_manager - INFO - Saved session state for sess-ond1icsu (user: admin)
2025-11-11 17:43:34,399 - agent.streaming_agent - INFO - Agent completed for session sess-ond1icsu: 32290.450999999997ms, 7 steps
2025-11-11 17:43:34,399 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 17:44:10,383 - root - INFO - Client yDEliAlwHyuVtTBFAAAO joined session room: sess-vydcj0eb
2025-11-11 17:44:17,061 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 17:44:17,061 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-vydcj0eb
2025-11-11 17:44:17,062 - agent.state_manager - WARNING - Session sess-vydcj0eb not found
2025-11-11 17:44:17,062 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 17:44:17,066 - agent.state_manager - INFO - Saved session state for sess-vydcj0eb (user: admin)
2025-11-11 17:44:17,067 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 17:44:17,067 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 17:44:17,067 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 17:44:17,067 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 17:44:17,067 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output']
2025-11-11 17:44:17,067 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 3 data keys
2025-11-11 17:44:17,068 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 17:44:17,070 - agent.state_manager - INFO - Saved session state for sess-vydcj0eb (user: admin)
2025-11-11 17:44:21,657 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:44:21,662 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output']
2025-11-11 17:44:21,663 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 2 data keys
2025-11-11 17:44:21,663 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 17:44:21,667 - agent.state_manager - INFO - Saved session state for sess-vydcj0eb (user: admin)
2025-11-11 17:44:21,668 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 17:44:21,668 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 17:44:21,668 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 17:44:21,668 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 17:44:21,668 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 17:44:21,668 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 17:44:21,668 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 17:44:21,669 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 17:44:21,669 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 17:44:21,669 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 17:44:21,669 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 17:44:21,669 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 17:44:21,669 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 17:44:21,669 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 17:44:21,669 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 17:44:21,669 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 17:44:24,618 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:44:26,350 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:44:28,495 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 17:44:28,496 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 17:44:28,496 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-11 17:44:28,496 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 22600 chars
2025-11-11 17:44:28,496 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 17:44:28,496 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 17:44:30,351 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:44:32,264 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 363 chars
2025-11-11 17:44:32,265 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
  "explanation": "Retrieve top primary limits for the latest date, sorted by utilization in descending order. Applied 'Primary' limit class filter and used most recent date as default.",
  "target_table": "limits_data"
}
2025-11-11 17:44:32,265 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 17:44:32,265 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 17:44:32,265 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:44:32,265 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 17:44:32,266 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output']
2025-11-11 17:44:32,266 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 3 data keys
2025-11-11 17:44:32,266 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 17:44:32,270 - agent.state_manager - INFO - Saved session state for sess-vydcj0eb (user: admin)
2025-11-11 17:44:32,270 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output']
2025-11-11 17:44:32,270 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 4 data keys
2025-11-11 17:44:32,270 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 17:44:32,273 - agent.state_manager - INFO - Saved session state for sess-vydcj0eb (user: admin)
2025-11-11 17:44:32,273 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:44:32,273 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 17:44:32,273 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 17:44:32,274 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:44:32,274 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:44:32,274 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 17:44:32,274 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:44:32,409 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output']
2025-11-11 17:44:32,410 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 3 data keys
2025-11-11 17:44:32,410 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 17:44:32,413 - agent.state_manager - INFO - Saved session state for sess-vydcj0eb (user: admin)
2025-11-11 17:44:32,413 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 17:44:32,413 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 17:44:32,414 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 17:44:32,414 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 17:44:32,414 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 17:44:32,414 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 17:44:32,414 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 17:44:32,415 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4840 chars
2025-11-11 17:44:34,274 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:44:42,744 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1603 chars
2025-11-11 17:44:42,744 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 17:44:42,744 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 17:44:42,745 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 38216 chars
2025-11-11 17:44:51,593 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:44:51,596 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1159 chars
2025-11-11 17:44:51,597 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 17:44:51,597 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 17:44:51,597 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 17:44:51,597 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 17:44:51,598 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output']
2025-11-11 17:44:51,598 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 2 data keys
2025-11-11 17:44:51,599 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 17:44:51,615 - agent.state_manager - INFO - Saved session state for sess-vydcj0eb (user: admin)
2025-11-11 17:44:51,615 - agent.streaming_agent - INFO - Agent completed for session sess-vydcj0eb: 34548.008ms, 7 steps
2025-11-11 17:44:51,615 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 17:48:38,815 - root - INFO - WebSocket client disconnected: yDEliAlwHyuVtTBFAAAO
2025-11-11 17:48:38,825 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:48:38] "GET /socket.io/?EIO=4&transport=websocket&sid=Ce_1vDUtM_unt8ySAAAM HTTP/1.1" 200 -
2025-11-11 17:48:38,827 - root - INFO - WebSocket client disconnected: pkYdeyELWDcsCvj2AAAP
2025-11-11 17:48:38,902 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:48:38] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 17:48:38,906 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:48:38] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 17:48:38,914 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 17:48:39,021 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:48:39] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 17:48:39,111 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:48:39] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 17:48:39,334 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:48:39] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 17:48:39,337 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:48:39] "GET /socket.io/?EIO=4&transport=polling&t=Pfr6ru6 HTTP/1.1" 200 -
2025-11-11 17:48:39,352 - root - INFO - WebSocket client connected: w6LEP8B3YftN7SuiAAAS
2025-11-11 17:48:39,353 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:48:39] "POST /socket.io/?EIO=4&transport=polling&t=Pfr6rwl&sid=wVeBMXYTU6VwVURuAAAR HTTP/1.1" 200 -
2025-11-11 17:48:39,358 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:48:39] "GET /socket.io/?EIO=4&transport=polling&t=Pfr6rwm&sid=wVeBMXYTU6VwVURuAAAR HTTP/1.1" 200 -
2025-11-11 17:48:39,362 - root - INFO - WebSocket client connected: D9HBReLrLVbp0HTKAAAT
2025-11-11 17:48:39,371 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:48:39] "GET /socket.io/?EIO=4&transport=polling&t=Pfr6rx3&sid=wVeBMXYTU6VwVURuAAAR HTTP/1.1" 200 -
2025-11-11 17:48:39,378 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:48:39] "POST /socket.io/?EIO=4&transport=polling&t=Pfr6rx4&sid=wVeBMXYTU6VwVURuAAAR HTTP/1.1" 200 -
2025-11-11 17:48:39,385 - root - INFO - Client w6LEP8B3YftN7SuiAAAS joined session room: sess-vydcj0eb
2025-11-11 17:50:15,775 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-11 17:50:15,797 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-11 17:50:15,797 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-11 17:50:15,799 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-11 17:50:15,799 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-11 17:50:15,831 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 17:50:15,831 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 17:50:15,831 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 17:50:15,831 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 17:50:15,831 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-11 17:50:15,831 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-11 17:50:15,831 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-11 17:50:15,832 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-11 17:50:15,832 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-11 17:50:15,833 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-11 17:50:15,833 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-11 17:50:15,833 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-11 17:50:15,833 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-11 17:50:15,834 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-11 17:50:15,834 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-11 17:50:15,835 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-11 17:50:15,835 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-11 17:50:15,836 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-11 17:50:15,836 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-11 17:50:16,318 - DuckDbDescribeTableTool - INFO - Found 1 data files in data/duckdb
2025-11-11 17:50:16,386 - DuckDbDescribeTableTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 17:50:16,400 - DuckDbDescribeTableTool - INFO - Initialization complete: 4 views available
2025-11-11 17:50:16,400 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 17:50:16,400 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-11 17:50:16,400 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-11 17:50:16,402 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-11 17:50:16,402 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-11 17:50:16,890 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-11 17:50:16,890 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-11 17:50:16,891 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-11 17:50:16,891 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-11 17:50:16,892 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-11 17:50:16,892 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-11 17:50:16,892 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-11 17:50:16,892 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-11 17:50:16,893 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-11 17:50:16,893 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-11 17:50:16,897 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-11 17:50:16,897 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-11 17:50:16,897 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-11 17:50:16,897 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-11 17:50:16,898 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-11 17:50:16,898 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-11 17:50:16,899 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-11 17:50:16,899 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-11 17:50:16,899 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-11 17:50:16,899 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-11 17:50:16,900 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-11 17:50:16,900 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-11 17:50:16,900 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-11 17:50:16,900 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-11 17:50:16,901 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-11 17:50:16,901 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-11 17:50:16,902 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-11 17:50:16,902 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-11 17:50:16,902 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-11 17:50:16,902 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-11 17:50:16,903 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-11 17:50:16,903 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-11 17:50:16,904 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-11 17:50:16,904 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-11 17:50:16,904 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-11 17:50:16,904 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-11 17:50:16,905 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-11 17:50:16,905 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-11 17:50:16,908 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-11 17:50:16,908 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-11 17:50:16,908 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-11 17:50:16,908 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-11 17:50:16,909 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-11 17:50:16,909 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-11 17:50:16,909 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-11 17:50:16,909 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-11 17:50:16,920 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 17:50:16,920 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 17:50:16,920 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 17:50:16,920 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 17:50:16,920 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-11 17:50:16,920 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-11 17:50:16,920 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-11 17:50:16,921 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-11 17:50:16,921 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-11 17:50:16,921 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-11 17:50:16,921 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-11 17:50:16,922 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-11 17:50:16,922 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-11 17:50:16,922 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-11 17:50:16,922 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-11 17:50:16,923 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-11 17:50:16,923 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-11 17:50:16,924 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-11 17:50:16,924 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-11 17:50:16,925 - DuckDbListFilesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 17:50:16,986 - DuckDbListFilesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 17:50:16,989 - DuckDbListFilesTool - INFO - Initialization complete: 4 views available
2025-11-11 17:50:16,989 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 17:50:16,989 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-11 17:50:16,989 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-11 17:50:16,990 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-11 17:50:16,990 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-11 17:50:16,990 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-11 17:50:16,990 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-11 17:50:16,990 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-11 17:50:16,990 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-11 17:50:16,991 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-11 17:50:16,991 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-11 17:50:16,991 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-11 17:50:16,991 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-11 17:50:16,992 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-11 17:50:16,992 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-11 17:50:16,992 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-11 17:50:16,992 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-11 17:50:16,993 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-11 17:50:16,993 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-11 17:50:16,993 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-11 17:50:16,993 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-11 17:50:16,993 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-11 17:50:16,993 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-11 17:50:16,994 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-11 17:50:16,994 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-11 17:50:16,994 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-11 17:50:16,994 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-11 17:50:16,994 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-11 17:50:16,994 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-11 17:50:16,994 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-11 17:50:16,994 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-11 17:50:16,995 - DuckDbGetStatsTool - INFO - Found 1 data files in data/duckdb
2025-11-11 17:50:17,055 - DuckDbGetStatsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 17:50:17,057 - DuckDbGetStatsTool - INFO - Initialization complete: 4 views available
2025-11-11 17:50:17,057 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 17:50:17,057 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-11 17:50:17,057 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-11 17:50:17,058 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-11 17:50:17,058 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-11 17:50:17,058 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-11 17:50:17,058 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-11 17:50:17,058 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-11 17:50:17,058 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-11 17:50:17,059 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-11 17:50:17,059 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-11 17:50:17,068 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 17:50:17,068 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 17:50:17,068 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 17:50:17,068 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 17:50:17,068 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-11 17:50:17,068 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-11 17:50:17,068 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-11 17:50:17,069 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-11 17:50:17,069 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-11 17:50:17,069 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-11 17:50:17,069 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-11 17:50:17,073 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-11 17:50:17,073 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-11 17:50:17,074 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-11 17:50:17,074 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-11 17:50:17,074 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-11 17:50:17,074 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-11 17:50:17,074 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-11 17:50:17,074 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-11 17:50:17,075 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-11 17:50:17,075 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-11 17:50:17,075 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-11 17:50:17,075 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-11 17:50:17,075 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-11 17:50:17,076 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-11 17:50:17,076 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-11 17:50:17,076 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-11 17:50:17,076 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-11 17:50:17,076 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-11 17:50:17,077 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-11 17:50:17,077 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-11 17:50:17,077 - DuckDbListTablesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 17:50:17,137 - DuckDbListTablesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 17:50:17,139 - DuckDbListTablesTool - INFO - Initialization complete: 4 views available
2025-11-11 17:50:17,139 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 17:50:17,139 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-11 17:50:17,139 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-11 17:50:17,140 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-11 17:50:17,140 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-11 17:50:17,140 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-11 17:50:17,140 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-11 17:50:17,141 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-11 17:50:17,141 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-11 17:50:17,141 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-11 17:50:17,141 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-11 17:50:17,141 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-11 17:50:17,142 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-11 17:50:17,142 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-11 17:50:17,142 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-11 17:50:17,142 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-11 17:50:17,142 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-11 17:50:17,142 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-11 17:50:17,142 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-11 17:50:17,143 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-11 17:50:17,143 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-11 17:50:17,143 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-11 17:50:17,143 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-11 17:50:17,143 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-11 17:50:17,143 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-11 17:50:17,143 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-11 17:50:17,143 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-11 17:50:17,144 - DuckDbAggregateTool - INFO - Found 1 data files in data/duckdb
2025-11-11 17:50:17,216 - DuckDbAggregateTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 17:50:17,218 - DuckDbAggregateTool - INFO - Initialization complete: 4 views available
2025-11-11 17:50:17,218 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 17:50:17,218 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-11 17:50:17,218 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-11 17:50:17,219 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-11 17:50:17,219 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-11 17:50:17,220 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-11 17:50:17,220 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-11 17:50:17,220 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-11 17:50:17,220 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-11 17:50:17,220 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-11 17:50:17,220 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-11 17:50:17,220 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-11 17:50:17,220 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-11 17:50:17,221 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-11 17:50:17,221 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-11 17:50:17,230 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 17:50:17,230 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 17:50:17,230 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 17:50:17,230 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 17:50:17,230 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-11 17:50:17,231 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-11 17:50:17,231 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-11 17:50:17,231 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-11 17:50:17,231 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-11 17:50:17,231 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-11 17:50:17,231 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-11 17:50:17,231 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-11 17:50:17,231 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-11 17:50:17,232 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-11 17:50:17,232 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-11 17:50:17,232 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-11 17:50:17,232 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-11 17:50:17,232 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-11 17:50:17,232 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-11 17:50:17,233 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-11 17:50:17,233 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-11 17:50:17,233 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-11 17:50:17,233 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-11 17:50:17,233 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-11 17:50:17,233 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-11 17:50:17,233 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-11 17:50:17,233 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-11 17:50:17,234 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-11 17:50:17,234 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-11 17:50:17,234 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-11 17:50:17,234 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-11 17:50:17,234 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-11 17:50:17,234 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-11 17:50:17,234 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-11 17:50:17,234 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-11 17:50:17,235 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-11 17:50:17,235 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-11 17:50:17,235 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-11 17:50:17,235 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-11 17:50:17,236 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-11 17:50:17,236 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-11 17:50:17,236 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-11 17:50:17,236 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-11 17:50:17,236 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-11 17:50:17,236 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-11 17:50:17,236 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-11 17:50:17,236 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-11 17:50:17,236 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-11 17:50:17,236 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-11 17:50:17,237 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-11 17:50:17,237 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-11 17:50:17,237 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-11 17:50:17,237 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-11 17:50:17,237 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-11 17:50:17,237 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-11 17:50:17,238 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-11 17:50:17,238 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-11 17:50:17,238 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-11 17:50:17,238 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-11 17:50:17,238 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-11 17:50:17,238 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-11 17:50:17,238 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-11 17:50:17,238 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-11 17:50:17,239 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-11 17:50:17,239 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-11 17:50:17,239 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-11 17:50:17,240 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-11 17:50:17,240 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-11 17:50:17,240 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-11 17:50:17,240 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-11 17:50:17,240 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-11 17:50:17,240 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-11 17:50:17,240 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-11 17:50:17,240 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-11 17:50:17,240 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-11 17:50:17,250 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 17:50:17,250 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 17:50:17,250 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 17:50:17,250 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 17:50:17,250 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-11 17:50:17,250 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-11 17:50:17,250 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-11 17:50:17,251 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-11 17:50:17,251 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-11 17:50:17,252 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-11 17:50:17,252 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-11 17:50:17,252 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-11 17:50:17,252 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-11 17:50:17,252 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-11 17:50:17,252 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-11 17:50:17,253 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-11 17:50:17,253 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-11 17:50:17,253 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-11 17:50:17,253 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-11 17:50:17,253 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-11 17:50:17,253 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-11 17:50:17,253 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-11 17:50:17,253 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-11 17:50:17,254 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-11 17:50:17,254 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-11 17:50:17,254 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-11 17:50:17,254 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-11 17:50:17,254 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-11 17:50:17,254 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-11 17:50:17,255 - DuckDbQueryTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 17:50:17,315 - DuckDbQueryTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 17:50:17,317 - DuckDbQueryTool - INFO - Initialization complete: 4 views available
2025-11-11 17:50:17,317 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 17:50:17,317 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-11 17:50:17,317 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-11 17:50:17,318 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-11 17:50:17,318 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-11 17:50:17,318 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-11 17:50:17,318 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-11 17:50:17,318 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-11 17:50:17,318 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-11 17:50:17,319 - DuckDbRefreshViewsTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 17:50:17,408 - DuckDbRefreshViewsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 17:50:17,415 - DuckDbRefreshViewsTool - INFO - Initialization complete: 4 views available
2025-11-11 17:50:17,415 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 17:50:17,416 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-11 17:50:17,416 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-11 17:50:17,417 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-11 17:50:17,418 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-11 17:50:17,420 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-11 17:50:17,420 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-11 17:50:17,446 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 17:50:17,446 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 17:50:17,446 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 17:50:17,446 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 17:50:17,446 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-11 17:50:17,446 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-11 17:50:17,446 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-11 17:50:17,447 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-11 17:50:17,447 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-11 17:50:17,447 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-11 17:50:17,447 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-11 17:50:17,447 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-11 17:50:17,448 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-11 17:50:17,448 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-11 17:50:17,448 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-11 17:50:17,450 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-11 17:50:17,450 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-11 17:50:17,450 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-11 17:50:17,450 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-11 17:50:17,451 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-11 17:50:17,546 - root - INFO - All routes registered successfully
2025-11-11 17:50:17,574 - werkzeug - WARNING - Werkzeug appears to be used in a production deployment. Consider switching to a production web server instead.
2025-11-11 17:50:17,683 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.68.51:8000
2025-11-11 17:50:17,684 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-11-11 17:51:10,321 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:51:10] "[32mGET / HTTP/1.1[0m" 302 -
2025-11-11 17:51:10,327 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:51:10] "[32mGET /dashboard HTTP/1.1[0m" 302 -
2025-11-11 17:51:10,345 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:51:10] "GET /login?next=http://127.0.0.1:8000/dashboard HTTP/1.1" 200 -
2025-11-11 17:51:10,416 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:51:10] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 17:51:10,416 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:51:10] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 17:51:10,508 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:51:10] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-11-11 17:51:18,208 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 17:51:18,209 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 17:51:18,210 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:51:18] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 17:51:18,232 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:51:18] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 17:51:18,246 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:51:18] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 17:51:18,247 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:51:18] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 17:51:22,032 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:51:22] "[33mGET /agen HTTP/1.1[0m" 404 -
2025-11-11 17:51:22,044 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:51:22] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 17:51:22,045 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:51:22] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 17:51:25,465 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:51:25] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 17:51:25,477 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:51:25] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 17:51:25,478 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:51:25] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 17:51:25,544 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:51:25] "GET /socket.io/?EIO=4&transport=polling&t=Pfr7UVa HTTP/1.1" 200 -
2025-11-11 17:51:25,548 - root - INFO - WebSocket client connected: T8lOX-OZEhtjs142AAAC
2025-11-11 17:51:25,550 - root - INFO - WebSocket client connected: keGXK9UxLI-YvQvaAAAD
2025-11-11 17:51:25,550 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:51:25] "POST /socket.io/?EIO=4&transport=polling&t=Pfr7UVg&sid=6UO7M1_tmyU3zY3VAAAA HTTP/1.1" 200 -
2025-11-11 17:51:25,550 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:51:25] "GET /socket.io/?EIO=4&transport=polling&t=Pfr7UVg.0&sid=6UO7M1_tmyU3zY3VAAAA HTTP/1.1" 200 -
2025-11-11 17:51:25,554 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:51:25] "POST /socket.io/?EIO=4&transport=polling&t=Pfr7UVm.0&sid=6UO7M1_tmyU3zY3VAAAA HTTP/1.1" 200 -
2025-11-11 17:51:25,554 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:51:25] "GET /socket.io/?EIO=4&transport=polling&t=Pfr7UVm&sid=6UO7M1_tmyU3zY3VAAAA HTTP/1.1" 200 -
2025-11-11 17:51:25,556 - root - INFO - Client T8lOX-OZEhtjs142AAAC joined session room: sess-l4j0l4rk
2025-11-11 17:51:25,556 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:51:25] "POST /socket.io/?EIO=4&transport=polling&t=Pfr7UVo.0&sid=6UO7M1_tmyU3zY3VAAAA HTTP/1.1" 200 -
2025-11-11 17:51:25,556 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:51:25] "GET /socket.io/?EIO=4&transport=polling&t=Pfr7UVo&sid=6UO7M1_tmyU3zY3VAAAA HTTP/1.1" 200 -
2025-11-11 17:51:25,560 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 17:51:25] "GET /socket.io/?EIO=4&transport=polling&t=Pfr7UVt&sid=6UO7M1_tmyU3zY3VAAAA HTTP/1.1" 200 -
2025-11-11 17:51:34,734 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 17:51:34,735 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-l4j0l4rk
2025-11-11 17:51:34,735 - agent.state_manager - WARNING - Session sess-l4j0l4rk not found
2025-11-11 17:51:34,735 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 17:51:34,740 - agent.state_manager - INFO - Saved session state for sess-l4j0l4rk (user: admin)
2025-11-11 17:51:34,740 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 17:51:34,740 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 17:51:34,740 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 17:51:34,740 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 17:51:34,740 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 17:51:34,741 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 17:51:34,741 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 17:51:34,742 - agent.state_manager - INFO - Saved session state for sess-l4j0l4rk (user: admin)
2025-11-11 17:51:38,062 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:51:38,080 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 17:51:38,080 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 17:51:38,081 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 17:51:38,082 - agent.state_manager - INFO - Saved session state for sess-l4j0l4rk (user: admin)
2025-11-11 17:51:38,083 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 17:51:38,083 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 17:51:38,083 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 17:51:38,083 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 17:51:38,083 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 17:51:38,083 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 17:51:38,083 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 17:51:38,083 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 17:51:38,083 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 17:51:38,083 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 17:51:38,083 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 17:51:38,083 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 17:51:38,083 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 17:51:38,083 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 17:51:38,083 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 17:51:38,084 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 17:51:41,049 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:51:42,891 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:51:45,314 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 17:51:45,314 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 17:51:45,315 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-11 17:51:45,315 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 22600 chars
2025-11-11 17:51:45,315 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 17:51:45,315 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 17:51:47,270 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:51:49,387 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 364 chars
2025-11-11 17:51:49,388 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
  "explanation": "Retrieved top primary limits for the latest date, sorted by utilization in descending order. Applied 'Primary' limit class filter and used most recent date as default.",
  "target_table": "limits_data"
}
2025-11-11 17:51:49,388 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 17:51:49,388 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 17:51:49,388 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:51:49,388 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 17:51:49,389 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 17:51:49,389 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 17:51:49,389 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 17:51:49,394 - agent.state_manager - INFO - Saved session state for sess-l4j0l4rk (user: admin)
2025-11-11 17:51:49,394 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 17:51:49,394 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 17:51:49,394 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 17:51:49,398 - agent.state_manager - INFO - Saved session state for sess-l4j0l4rk (user: admin)
2025-11-11 17:51:49,398 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:51:49,399 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 17:51:49,399 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 17:51:49,399 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:51:49,399 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:51:49,399 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 17:51:49,399 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 17:51:49,511 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 17:51:49,511 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 17:51:49,512 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 17:51:49,514 - agent.state_manager - INFO - Saved session state for sess-l4j0l4rk (user: admin)
2025-11-11 17:51:49,514 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 17:51:49,514 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 17:51:49,515 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 17:51:49,515 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 17:51:49,515 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 17:51:49,515 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 17:51:49,515 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 17:51:49,515 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4841 chars
2025-11-11 17:51:50,775 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:51:59,090 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1400 chars
2025-11-11 17:51:59,091 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 17:51:59,091 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 17:51:59,092 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 38218 chars
2025-11-11 17:52:06,341 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 17:52:06,343 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 955 chars
2025-11-11 17:52:06,343 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 17:52:06,343 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 17:52:06,343 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 17:52:06,343 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 17:52:06,344 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 17:52:06,344 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 17:52:06,345 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 17:52:06,352 - agent.state_manager - INFO - Saved session state for sess-l4j0l4rk (user: admin)
2025-11-11 17:52:06,353 - agent.streaming_agent - INFO - Agent completed for session sess-l4j0l4rk: 31612.537ms, 7 steps
2025-11-11 17:52:06,353 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 18:06:49,233 - root - INFO - WebSocket client disconnected: T8lOX-OZEhtjs142AAAC
2025-11-11 18:06:49,237 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:06:49] "GET /socket.io/?EIO=4&transport=websocket&sid=6UO7M1_tmyU3zY3VAAAA HTTP/1.1" 200 -
2025-11-11 18:06:49,238 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:06:49] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 18:06:49,240 - root - INFO - WebSocket client disconnected: keGXK9UxLI-YvQvaAAAD
2025-11-11 18:06:49,248 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:06:49] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 18:06:49,254 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 18:06:49,277 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:06:49] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 18:06:49,279 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:06:49] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 18:06:49,351 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:06:49] "GET /socket.io/?EIO=4&transport=polling&t=PfrB01q HTTP/1.1" 200 -
2025-11-11 18:06:49,372 - root - INFO - WebSocket client connected: elp1gWknDe2x8pwmAAAG
2025-11-11 18:06:49,372 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:06:49] "POST /socket.io/?EIO=4&transport=polling&t=PfrB02C&sid=6OuiLEZhzd1N9xPHAAAE HTTP/1.1" 200 -
2025-11-11 18:06:49,373 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:06:49] "GET /socket.io/?EIO=4&transport=polling&t=PfrB02C.0&sid=6OuiLEZhzd1N9xPHAAAE HTTP/1.1" 200 -
2025-11-11 18:06:49,378 - root - INFO - WebSocket client connected: YIYzVNKPNFUEt6-GAAAH
2025-11-11 18:06:49,387 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:06:49] "GET /socket.io/?EIO=4&transport=polling&t=PfrB02W&sid=6OuiLEZhzd1N9xPHAAAE HTTP/1.1" 200 -
2025-11-11 18:06:49,388 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:06:49] "POST /socket.io/?EIO=4&transport=polling&t=PfrB02Y&sid=6OuiLEZhzd1N9xPHAAAE HTTP/1.1" 200 -
2025-11-11 18:06:49,394 - root - INFO - Client elp1gWknDe2x8pwmAAAG joined session room: sess-l4j0l4rk
2025-11-11 18:06:55,603 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 18:06:55,607 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-l4j0l4rk
2025-11-11 18:06:55,622 - agent.state_manager - INFO - Loaded session state for sess-l4j0l4rk
2025-11-11 18:06:55,625 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 1 turns
2025-11-11 18:06:55,634 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 1 conversation turns
2025-11-11 18:06:55,686 - agent.state_manager - INFO - Saved session state for sess-l4j0l4rk (user: admin)
2025-11-11 18:06:55,686 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 18:06:55,687 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 18:06:55,687 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 18:06:55,687 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=1, conv_history(str)=5747
2025-11-11 18:06:55,687 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 18:06:55,687 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 18:06:55,688 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 18:06:55,690 - agent.state_manager - INFO - Saved session state for sess-l4j0l4rk (user: admin)
2025-11-11 18:06:55,690 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 18:06:59,594 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:06:59,596 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain the full details of the top primary limits, including all columns like region_cd, utilization, exposure_amt, etc. Since the previous results returned the complete dataset of primary limits, any follow-up analysis or filtering can be done directly on these existing results without needing a new database query.
2025-11-11 18:06:59,596 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 18:06:59,596 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 18:06:59,596 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 18:06:59,598 - agent.state_manager - INFO - Saved session state for sess-l4j0l4rk (user: admin)
2025-11-11 18:07:03,036 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:07:03,038 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 18:07:03,039 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 18:07:03,039 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 18:07:03,043 - agent.state_manager - INFO - Saved session state for sess-l4j0l4rk (user: admin)
2025-11-11 18:07:03,044 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 18:07:03,044 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 18:07:03,044 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 18:07:03,044 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 18:07:03,044 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 18:07:03,044 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 18:07:03,044 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 18:07:03,044 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 18:07:03,045 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 18:07:03,045 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 18:07:03,045 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 5747 characters
2025-11-11 18:07:03,045 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 18:07:03,045 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 18:07:03,045 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 18:07:03,045 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 18:07:03,045 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 18:07:03,045 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 18:07:03,045 - tools.impl.nl_to_sql_planner - INFO -     User Query: top primary limits
2025-11-11 18:07:03,045 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 18:07:03,045 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 18:07:03,045 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:07:03,045 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 18:07:03,045 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-11 18:07:03,045 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_in
2025-11-11 18:07:03,045 - tools.impl.nl_to_sql_planner - INFO -     ... (5147 more characters)
2025-11-11 18:07:03,045 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 18:07:06,866 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:07:09,039 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:07:11,113 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 18:07:11,113 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 18:07:11,114 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 18:07:11,114 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 5747
2025-11-11 18:07:11,114 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 18:07:11,114 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 2 SQL code blocks, using LAST (most recent)
2025-11-11 18:07:11,114 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 18:07:11,115 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC...
2025-11-11 18:07:11,115 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 130 characters
2025-11-11 18:07:11,115 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 18:07:11,115 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 18:07:11,115 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 130 characters
2025-11-11 18:07:11,115 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 18:07:11,115 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 18:07:11,115 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 18:07:11,117 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 18:07:11,117 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 18:07:11,117 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10559 chars
2025-11-11 18:07:11,117 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 28314 chars
2025-11-11 18:07:11,118 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 18:07:11,118 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 18:07:13,624 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:07:15,827 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 429 chars
2025-11-11 18:07:15,828 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
    "explanation": "Retrieved top Primary limits at the most recent date, sorted by highest utilization. Assumed 'top' means all rows, sorted by utilization in descending order. Applied default filters for primary limits and latest date snapshot.",
    "target_table": "limits_data"
}
2025-11-11 18:07:15,828 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 18:07:15,828 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 18:07:15,829 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:07:15,829 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:07:15,830 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 18:07:15,830 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 18:07:15,830 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 18:07:15,836 - agent.state_manager - INFO - Saved session state for sess-l4j0l4rk (user: admin)
2025-11-11 18:07:15,837 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 18:07:15,837 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 18:07:15,837 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 18:07:15,841 - agent.state_manager - INFO - Saved session state for sess-l4j0l4rk (user: admin)
2025-11-11 18:07:15,841 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:07:15,841 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 18:07:15,841 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:07:15,842 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:07:15,842 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:07:15,842 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 18:07:15,842 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:07:15,951 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 18:07:15,951 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 18:07:15,951 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 18:07:15,954 - agent.state_manager - INFO - Saved session state for sess-l4j0l4rk (user: admin)
2025-11-11 18:07:15,954 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:07:15,954 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 18:07:15,954 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 18:07:15,954 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:07:15,954 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 18:07:15,954 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 18:07:15,955 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 18:07:15,955 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4841 chars
2025-11-11 18:07:17,209 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:07:26,103 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1562 chars
2025-11-11 18:07:26,104 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 18:07:26,105 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 18:07:26,106 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 39805 chars
2025-11-11 18:07:34,399 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:07:34,401 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1129 chars
2025-11-11 18:07:34,401 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:07:34,402 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 18:07:34,402 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:07:34,402 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:07:34,403 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 18:07:34,403 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 18:07:34,404 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 18:07:34,413 - agent.state_manager - INFO - Saved session state for sess-l4j0l4rk (user: admin)
2025-11-11 18:07:34,413 - agent.streaming_agent - INFO - Agent completed for session sess-l4j0l4rk: 38726.543ms, 8 steps
2025-11-11 18:07:34,414 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 18:12:09,972 - root - INFO - WebSocket client disconnected: elp1gWknDe2x8pwmAAAG
2025-11-11 18:12:10,007 - root - INFO - WebSocket client disconnected: YIYzVNKPNFUEt6-GAAAH
2025-11-11 18:12:10,010 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:12:10] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 18:12:10,011 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:12:10] "GET /socket.io/?EIO=4&transport=websocket&sid=6OuiLEZhzd1N9xPHAAAE HTTP/1.1" 200 -
2025-11-11 18:12:10,035 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:12:10] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 18:12:10,044 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 18:12:10,163 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:12:10] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 18:12:10,212 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:12:10] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 18:12:10,311 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:12:10] "GET /socket.io/?EIO=4&transport=polling&t=PfrCEOD HTTP/1.1" 200 -
2025-11-11 18:12:10,337 - root - INFO - WebSocket client connected: IHZPfGcduGXX2Uk8AAAK
2025-11-11 18:12:10,339 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:12:10] "POST /socket.io/?EIO=4&transport=polling&t=PfrCEPC&sid=_sn4x__37eRBlVVPAAAI HTTP/1.1" 200 -
2025-11-11 18:12:10,350 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:12:10] "GET /socket.io/?EIO=4&transport=polling&t=PfrCEPD&sid=_sn4x__37eRBlVVPAAAI HTTP/1.1" 200 -
2025-11-11 18:12:10,388 - root - INFO - WebSocket client connected: IrmV6o2Ns63WupdxAAAL
2025-11-11 18:12:10,413 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:12:10] "POST /socket.io/?EIO=4&transport=polling&t=PfrCEPt&sid=_sn4x__37eRBlVVPAAAI HTTP/1.1" 200 -
2025-11-11 18:12:10,415 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:12:10] "GET /socket.io/?EIO=4&transport=polling&t=PfrCEPs&sid=_sn4x__37eRBlVVPAAAI HTTP/1.1" 200 -
2025-11-11 18:12:10,455 - root - INFO - Client IHZPfGcduGXX2Uk8AAAK joined session room: sess-l4j0l4rk
2025-11-11 18:12:15,633 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 18:12:15,633 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-l4j0l4rk
2025-11-11 18:12:15,635 - agent.state_manager - INFO - Loaded session state for sess-l4j0l4rk
2025-11-11 18:12:15,635 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 2 turns
2025-11-11 18:12:15,635 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 2 conversation turns
2025-11-11 18:12:15,641 - agent.state_manager - INFO - Saved session state for sess-l4j0l4rk (user: admin)
2025-11-11 18:12:15,642 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 18:12:15,642 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 18:12:15,642 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 18:12:15,642 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=2, conv_history(str)=11807
2025-11-11 18:12:15,642 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 18:12:15,642 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 18:12:15,643 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 18:12:15,645 - agent.state_manager - INFO - Saved session state for sess-l4j0l4rk (user: admin)
2025-11-11 18:12:15,645 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 18:12:18,821 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:12:18,824 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain the full details of the top primary limits, including all columns like limit_id, utilization, region_cd, industry, exposure_amt, etc. Any follow-up analysis or filtering can be done directly on these existing results without needing a new database query.
2025-11-11 18:12:18,825 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 18:12:18,825 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 18:12:18,825 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 18:12:18,831 - agent.state_manager - INFO - Saved session state for sess-l4j0l4rk (user: admin)
2025-11-11 18:12:22,393 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:12:22,396 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 18:12:22,396 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 18:12:22,396 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 18:12:22,408 - agent.state_manager - INFO - Saved session state for sess-l4j0l4rk (user: admin)
2025-11-11 18:12:22,409 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 18:12:22,409 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 18:12:22,409 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 18:12:22,409 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 18:12:22,409 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 18:12:22,409 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 18:12:22,409 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 18:12:22,409 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 18:12:22,409 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 18:12:22,409 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 18:12:22,409 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 11807 characters
2025-11-11 18:12:22,409 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 18:12:22,410 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 18:12:22,410 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 18:12:22,410 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 18:12:22,410 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 18:12:22,410 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 18:12:22,410 - tools.impl.nl_to_sql_planner - INFO -     User Query: top primary limits
2025-11-11 18:12:22,410 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 18:12:22,410 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 18:12:22,410 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:12:22,410 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 18:12:22,410 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-11 18:12:22,410 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_in
2025-11-11 18:12:22,410 - tools.impl.nl_to_sql_planner - INFO -     ... (11207 more characters)
2025-11-11 18:12:22,410 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 18:12:25,977 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:12:28,287 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:12:30,446 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 18:12:30,447 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 18:12:30,447 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 18:12:30,447 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 11807
2025-11-11 18:12:30,447 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 18:12:30,447 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 4 SQL code blocks, using LAST (most recent)
2025-11-11 18:12:30,447 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 18:12:30,448 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC...
2025-11-11 18:12:30,448 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 130 characters
2025-11-11 18:12:30,448 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 18:12:30,448 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 18:12:30,448 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 130 characters
2025-11-11 18:12:30,448 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 18:12:30,449 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 18:12:30,449 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 18:12:30,454 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 18:12:30,455 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 18:12:30,455 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10559 chars
2025-11-11 18:12:30,455 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 34374 chars
2025-11-11 18:12:30,455 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 18:12:30,455 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 18:12:33,630 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:12:35,629 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 397 chars
2025-11-11 18:12:35,629 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
  "explanation": "Retrieved top primary limits at the most recent date, sorted by highest utilization. Assumed 'top' means all primary limits, sorted by utilization in descending order, focusing on the latest snapshot.",
  "target_table": "limits_data"
}
2025-11-11 18:12:35,630 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 18:12:35,630 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 18:12:35,630 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:12:35,630 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:12:35,631 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 18:12:35,631 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 18:12:35,632 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 18:12:35,647 - agent.state_manager - INFO - Saved session state for sess-l4j0l4rk (user: admin)
2025-11-11 18:12:35,647 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 18:12:35,647 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 18:12:35,648 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 18:12:35,651 - agent.state_manager - INFO - Saved session state for sess-l4j0l4rk (user: admin)
2025-11-11 18:12:35,651 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:12:35,651 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 18:12:35,651 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:12:35,652 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:12:35,652 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:12:35,652 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 18:12:35,652 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:12:35,770 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 18:12:35,770 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 18:12:35,770 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 18:12:35,774 - agent.state_manager - INFO - Saved session state for sess-l4j0l4rk (user: admin)
2025-11-11 18:12:35,774 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:12:35,775 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 18:12:35,775 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 18:12:35,775 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:12:35,775 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 18:12:35,775 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 18:12:35,775 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 18:12:35,775 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4841 chars
2025-11-11 18:12:36,590 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:12:46,638 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1745 chars
2025-11-11 18:12:46,640 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 18:12:46,640 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 18:12:46,641 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 41491 chars
2025-11-11 18:12:53,493 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:12:53,495 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 832 chars
2025-11-11 18:12:53,495 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:12:53,496 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 18:12:53,496 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:12:53,496 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:12:53,497 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 18:12:53,498 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 18:12:53,499 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 18:12:53,513 - agent.state_manager - INFO - Saved session state for sess-l4j0l4rk (user: admin)
2025-11-11 18:12:53,513 - agent.streaming_agent - INFO - Agent completed for session sess-l4j0l4rk: 37870.913ms, 8 steps
2025-11-11 18:12:53,513 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 18:14:20,388 - root - INFO - WebSocket client disconnected: IHZPfGcduGXX2Uk8AAAK
2025-11-11 18:14:20,403 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:14:20] "GET /socket.io/?EIO=4&transport=websocket&sid=_sn4x__37eRBlVVPAAAI HTTP/1.1" 200 -
2025-11-11 18:14:20,411 - root - INFO - WebSocket client disconnected: IrmV6o2Ns63WupdxAAAL
2025-11-11 18:14:20,414 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:14:20] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 18:14:20,452 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 18:14:28,055 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:14:28] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 18:14:28,072 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:14:28] "GET /login?next=http://127.0.0.1:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 18:14:28,513 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:14:28] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 18:14:28,516 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:14:28] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 18:14:35,718 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 18:14:35,719 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 18:14:35,722 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:14:35] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 18:14:35,735 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:14:35] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 18:14:35,749 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:14:35] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 18:14:35,749 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:14:35] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 18:14:44,940 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:14:44] "[33mGET /agentchat HTTP/1.1[0m" 404 -
2025-11-11 18:14:44,953 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:14:44] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 18:14:44,956 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:14:44] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 18:14:49,240 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:14:49] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 18:14:49,253 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:14:49] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 18:14:49,255 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:14:49] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 18:14:49,326 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:14:49] "GET /socket.io/?EIO=4&transport=polling&t=PfrCrDh HTTP/1.1" 200 -
2025-11-11 18:14:49,333 - root - INFO - WebSocket client connected: FfQoDIqOvNGlcnVvAAAO
2025-11-11 18:14:49,334 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:14:49] "POST /socket.io/?EIO=4&transport=polling&t=PfrCrDn&sid=ChOYrSjUAid1npBHAAAM HTTP/1.1" 200 -
2025-11-11 18:14:49,335 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:14:49] "GET /socket.io/?EIO=4&transport=polling&t=PfrCrDn.0&sid=ChOYrSjUAid1npBHAAAM HTTP/1.1" 200 -
2025-11-11 18:14:49,337 - root - INFO - WebSocket client connected: -uhhPPWcp-YtOBArAAAP
2025-11-11 18:14:49,339 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:14:49] "POST /socket.io/?EIO=4&transport=polling&t=PfrCrDv&sid=ChOYrSjUAid1npBHAAAM HTTP/1.1" 200 -
2025-11-11 18:14:49,339 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:14:49] "GET /socket.io/?EIO=4&transport=polling&t=PfrCrDu&sid=ChOYrSjUAid1npBHAAAM HTTP/1.1" 200 -
2025-11-11 18:14:49,342 - root - INFO - Client FfQoDIqOvNGlcnVvAAAO joined session room: sess-rjxbjuda
2025-11-11 18:14:49,343 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:14:49] "POST /socket.io/?EIO=4&transport=polling&t=PfrCrDz&sid=ChOYrSjUAid1npBHAAAM HTTP/1.1" 200 -
2025-11-11 18:14:49,344 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:14:49] "GET /socket.io/?EIO=4&transport=polling&t=PfrCrDy&sid=ChOYrSjUAid1npBHAAAM HTTP/1.1" 200 -
2025-11-11 18:14:49,346 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:14:49] "GET /socket.io/?EIO=4&transport=polling&t=PfrCrE1&sid=ChOYrSjUAid1npBHAAAM HTTP/1.1" 200 -
2025-11-11 18:14:56,853 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 18:14:56,854 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-rjxbjuda
2025-11-11 18:14:56,854 - agent.state_manager - WARNING - Session sess-rjxbjuda not found
2025-11-11 18:14:56,855 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 18:14:56,861 - agent.state_manager - INFO - Saved session state for sess-rjxbjuda (user: admin)
2025-11-11 18:14:56,861 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 18:14:56,861 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 18:14:56,861 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 18:14:56,862 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 18:14:56,862 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 18:14:56,862 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 18:14:56,862 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 18:14:56,865 - agent.state_manager - INFO - Saved session state for sess-rjxbjuda (user: admin)
2025-11-11 18:15:00,539 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:15:00,545 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 18:15:00,546 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 18:15:00,547 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 18:15:00,549 - agent.state_manager - INFO - Saved session state for sess-rjxbjuda (user: admin)
2025-11-11 18:15:00,549 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 18:15:00,550 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 18:15:00,550 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 18:15:00,550 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 18:15:00,550 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 18:15:00,550 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 18:15:00,550 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 18:15:00,550 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 18:15:00,550 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 18:15:00,550 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 18:15:00,550 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 18:15:00,550 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 18:15:00,550 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 18:15:00,550 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 18:15:00,550 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 18:15:00,550 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 18:15:03,951 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:15:06,066 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:15:09,105 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 18:15:09,105 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 18:15:09,106 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-11 18:15:09,106 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 22600 chars
2025-11-11 18:15:09,106 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 18:15:09,106 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 18:15:10,998 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:15:13,271 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 417 chars
2025-11-11 18:15:13,271 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
  "explanation": "Retrieved top primary limits for the latest date, sorted by utilization in descending order. Assumed 'top' means all primary limits, sorted by highest utilization. Used default of limit_class = 'Primary' and latest date.",
  "target_table": "limits_data"
}
2025-11-11 18:15:13,272 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 18:15:13,272 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 18:15:13,272 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:15:13,273 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:15:13,274 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 18:15:13,274 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 18:15:13,274 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 18:15:13,279 - agent.state_manager - INFO - Saved session state for sess-rjxbjuda (user: admin)
2025-11-11 18:15:13,279 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 18:15:13,279 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 18:15:13,279 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 18:15:13,285 - agent.state_manager - INFO - Saved session state for sess-rjxbjuda (user: admin)
2025-11-11 18:15:13,286 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:15:13,286 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 18:15:13,286 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:15:13,286 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:15:13,286 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:15:13,286 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 18:15:13,286 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:15:13,400 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 18:15:13,400 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 18:15:13,400 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 18:15:13,403 - agent.state_manager - INFO - Saved session state for sess-rjxbjuda (user: admin)
2025-11-11 18:15:13,403 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:15:13,403 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 18:15:13,403 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 18:15:13,403 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:15:13,403 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 18:15:13,403 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 18:15:13,403 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 18:15:13,404 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4840 chars
2025-11-11 18:15:14,398 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:15:24,377 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1666 chars
2025-11-11 18:15:24,378 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 18:15:24,378 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 18:15:24,379 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 38270 chars
2025-11-11 18:15:32,030 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:15:32,121 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1004 chars
2025-11-11 18:15:32,165 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:15:32,165 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 18:15:32,166 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:15:32,166 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:15:32,189 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 18:15:32,189 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 18:15:32,190 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 18:15:32,238 - agent.state_manager - INFO - Saved session state for sess-rjxbjuda (user: admin)
2025-11-11 18:15:32,238 - agent.streaming_agent - INFO - Agent completed for session sess-rjxbjuda: 35376.259ms, 7 steps
2025-11-11 18:15:32,240 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 18:15:33,514 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:15:33] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 18:15:33,517 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:15:33] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 18:16:45,175 - root - INFO - WebSocket client disconnected: FfQoDIqOvNGlcnVvAAAO
2025-11-11 18:16:45,187 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:16:45] "GET /socket.io/?EIO=4&transport=websocket&sid=ChOYrSjUAid1npBHAAAM HTTP/1.1" 200 -
2025-11-11 18:16:45,185 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:16:45] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 18:16:45,186 - root - INFO - WebSocket client disconnected: -uhhPPWcp-YtOBArAAAP
2025-11-11 18:16:45,196 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:16:45] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 18:16:45,200 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 18:16:45,286 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:16:45] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 18:16:45,287 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:16:45] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 18:16:45,292 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:16:45] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 18:16:45,386 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:16:45] "GET /socket.io/?EIO=4&transport=polling&t=PfrDHYE HTTP/1.1" 200 -
2025-11-11 18:16:45,395 - root - INFO - WebSocket client connected: iwVlwkvbAPu2HL7jAAAS
2025-11-11 18:16:45,396 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:16:45] "POST /socket.io/?EIO=4&transport=polling&t=PfrDHZF&sid=pLQy4s35g6HUoFUtAAAQ HTTP/1.1" 200 -
2025-11-11 18:16:45,399 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:16:45] "GET /socket.io/?EIO=4&transport=polling&t=PfrDHZG&sid=pLQy4s35g6HUoFUtAAAQ HTTP/1.1" 200 -
2025-11-11 18:16:45,401 - root - INFO - WebSocket client connected: IZ0gcf59Bw2Uk7ieAAAT
2025-11-11 18:16:45,403 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:16:45] "GET /socket.io/?EIO=4&transport=polling&t=PfrDHZO&sid=pLQy4s35g6HUoFUtAAAQ HTTP/1.1" 200 -
2025-11-11 18:16:45,404 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:16:45] "POST /socket.io/?EIO=4&transport=polling&t=PfrDHZP&sid=pLQy4s35g6HUoFUtAAAQ HTTP/1.1" 200 -
2025-11-11 18:16:45,412 - root - INFO - Client iwVlwkvbAPu2HL7jAAAS joined session room: sess-rjxbjuda
2025-11-11 18:16:45,413 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:16:45] "GET /socket.io/?EIO=4&transport=polling&t=PfrDHZT&sid=pLQy4s35g6HUoFUtAAAQ HTTP/1.1" 200 -
2025-11-11 18:16:45,414 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:16:45] "POST /socket.io/?EIO=4&transport=polling&t=PfrDHZT.0&sid=pLQy4s35g6HUoFUtAAAQ HTTP/1.1" 200 -
2025-11-11 18:16:45,418 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:16:45] "GET /socket.io/?EIO=4&transport=polling&t=PfrDHZd&sid=pLQy4s35g6HUoFUtAAAQ HTTP/1.1" 200 -
2025-11-11 18:16:50,628 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top limits'
2025-11-11 18:16:50,629 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-rjxbjuda
2025-11-11 18:16:50,630 - agent.state_manager - INFO - Loaded session state for sess-rjxbjuda
2025-11-11 18:16:50,630 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 1 turns
2025-11-11 18:16:50,630 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 1 conversation turns
2025-11-11 18:16:50,635 - agent.state_manager - INFO - Saved session state for sess-rjxbjuda (user: admin)
2025-11-11 18:16:50,635 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 18:16:50,635 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 18:16:50,635 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 18:16:50,636 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=1, conv_history(str)=6062
2025-11-11 18:16:50,636 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 18:16:50,636 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 18:16:50,636 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 18:16:50,642 - agent.state_manager - INFO - Saved session state for sess-rjxbjuda (user: admin)
2025-11-11 18:16:50,642 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 18:16:53,535 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:16:53,538 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain all the columns and details for the primary limits, including full metadata like region, industry, utilization, limit details, etc. Since the previous results returned the complete dataset of top primary limits, any further analysis or filtering can be done directly on these existing results without needing a new database query.
2025-11-11 18:16:53,538 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 18:16:53,538 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 18:16:53,538 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 18:16:53,544 - agent.state_manager - INFO - Saved session state for sess-rjxbjuda (user: admin)
2025-11-11 18:16:57,125 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:16:57,128 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 18:16:57,128 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 18:16:57,129 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 18:16:57,144 - agent.state_manager - INFO - Saved session state for sess-rjxbjuda (user: admin)
2025-11-11 18:16:57,145 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 18:16:57,146 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 18:16:57,146 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 18:16:57,146 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 18:16:57,146 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 18:16:57,146 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 18:16:57,146 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 18:16:57,146 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 18:16:57,146 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 18:16:57,146 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 18:16:57,146 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 6062 characters
2025-11-11 18:16:57,147 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 18:16:57,147 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 18:16:57,147 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 18:16:57,147 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 18:16:57,147 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 18:16:57,147 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 18:16:57,147 - tools.impl.nl_to_sql_planner - INFO -     User Query: top primary limits
2025-11-11 18:16:57,147 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 18:16:57,148 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 18:16:57,148 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:16:57,148 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 18:16:57,148 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-11 18:16:57,148 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_in
2025-11-11 18:16:57,148 - tools.impl.nl_to_sql_planner - INFO -     ... (5462 more characters)
2025-11-11 18:16:57,148 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 18:17:00,998 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:17:03,266 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:17:05,579 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 18:17:05,579 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 18:17:05,579 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 18:17:05,579 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 6062
2025-11-11 18:17:05,579 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 18:17:05,579 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 2 SQL code blocks, using LAST (most recent)
2025-11-11 18:17:05,579 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 18:17:05,579 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC...
2025-11-11 18:17:05,579 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 130 characters
2025-11-11 18:17:05,579 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 18:17:05,579 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 18:17:05,579 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 130 characters
2025-11-11 18:17:05,579 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 18:17:05,579 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 18:17:05,580 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 18:17:05,580 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 18:17:05,580 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top limits
2025-11-11 18:17:05,580 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10559 chars
2025-11-11 18:17:05,580 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 28621 chars
2025-11-11 18:17:05,580 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 18:17:05,581 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 18:17:07,914 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:17:10,099 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 378 chars
2025-11-11 18:17:10,101 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
  "explanation": "Retrieved top Primary limits for the latest date, sorted by highest utilization. Assumed 'top limits' means Primary limits with highest utilization, using most recent date snapshot.",
  "target_table": "limits_data"
}
2025-11-11 18:17:10,101 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 18:17:10,101 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 18:17:10,101 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:17:10,101 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:17:10,103 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 18:17:10,106 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 18:17:10,106 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 18:17:10,415 - agent.state_manager - INFO - Saved session state for sess-rjxbjuda (user: admin)
2025-11-11 18:17:10,416 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 18:17:10,416 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 18:17:10,416 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 18:17:10,504 - agent.state_manager - INFO - Saved session state for sess-rjxbjuda (user: admin)
2025-11-11 18:17:10,509 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:17:10,509 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 18:17:10,509 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:17:10,510 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:17:10,511 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:17:10,511 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 18:17:10,511 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:17:11,362 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 18:17:11,363 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 18:17:11,365 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 18:17:11,371 - agent.state_manager - INFO - Saved session state for sess-rjxbjuda (user: admin)
2025-11-11 18:17:11,394 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:17:11,394 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 18:17:11,394 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 18:17:11,394 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:17:11,395 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 18:17:11,395 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 18:17:11,395 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 18:17:11,398 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4832 chars
2025-11-11 18:17:12,340 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:17:22,373 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1726 chars
2025-11-11 18:17:22,375 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 18:17:22,375 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 18:17:22,376 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 39815 chars
2025-11-11 18:17:30,398 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:17:30,466 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1001 chars
2025-11-11 18:17:30,557 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:17:30,572 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 18:17:30,572 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:17:30,572 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:17:30,574 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 18:17:30,574 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 18:17:30,575 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 18:17:30,845 - agent.state_manager - INFO - Saved session state for sess-rjxbjuda (user: admin)
2025-11-11 18:17:30,874 - agent.streaming_agent - INFO - Agent completed for session sess-rjxbjuda: 40209.597ms, 8 steps
2025-11-11 18:17:30,875 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 18:17:55,632 - root - INFO - WebSocket client disconnected: iwVlwkvbAPu2HL7jAAAS
2025-11-11 18:17:55,633 - root - INFO - WebSocket client disconnected: IZ0gcf59Bw2Uk7ieAAAT
2025-11-11 18:17:55,637 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:17:55] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 18:17:55,638 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:17:55] "GET /socket.io/?EIO=4&transport=websocket&sid=pLQy4s35g6HUoFUtAAAQ HTTP/1.1" 200 -
2025-11-11 18:17:55,644 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:17:55] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 18:17:55,646 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 18:17:55,671 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:17:55] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 18:17:55,673 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:17:55] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 18:17:55,681 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:17:55] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 18:17:55,748 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:17:55] "GET /socket.io/?EIO=4&transport=polling&t=PfrDYkW HTTP/1.1" 200 -
2025-11-11 18:17:55,779 - root - INFO - WebSocket client connected: hdmfzG45Ppe9XLXlAAAW
2025-11-11 18:17:55,782 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:17:55] "POST /socket.io/?EIO=4&transport=polling&t=PfrDYke&sid=dUvLg-Vnp-AZwk5cAAAU HTTP/1.1" 200 -
2025-11-11 18:17:55,783 - root - INFO - WebSocket client connected: N702FgYRyjuAlx50AAAX
2025-11-11 18:17:55,784 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:17:55] "GET /socket.io/?EIO=4&transport=polling&t=PfrDYkf&sid=dUvLg-Vnp-AZwk5cAAAU HTTP/1.1" 200 -
2025-11-11 18:17:55,791 - root - INFO - Client hdmfzG45Ppe9XLXlAAAW joined session room: sess-rjxbjuda
2025-11-11 18:17:58,369 - root - INFO - WebSocket client disconnected: N702FgYRyjuAlx50AAAX
2025-11-11 18:17:58,370 - root - INFO - WebSocket client disconnected: hdmfzG45Ppe9XLXlAAAW
2025-11-11 18:17:58,370 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:17:58] "GET /socket.io/?EIO=4&transport=websocket&sid=dUvLg-Vnp-AZwk5cAAAU HTTP/1.1" 200 -
2025-11-11 18:17:58,376 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:17:58] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 18:17:58,382 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:17:58] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 18:17:58,383 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 18:17:58,392 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:17:58] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 18:17:58,397 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:17:58] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 18:17:58,399 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:17:58] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 18:17:58,458 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:17:58] "GET /socket.io/?EIO=4&transport=polling&t=PfrDZOu HTTP/1.1" 200 -
2025-11-11 18:17:58,467 - root - INFO - WebSocket client connected: H_yrWvfkv2vzK22TAAAZ
2025-11-11 18:17:58,467 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:17:58] "POST /socket.io/?EIO=4&transport=polling&t=PfrDZOz&sid=t8YiKhJ_PwNNX6tBAAAY HTTP/1.1" 200 -
2025-11-11 18:17:58,470 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:17:58] "GET /socket.io/?EIO=4&transport=polling&t=PfrDZO-&sid=t8YiKhJ_PwNNX6tBAAAY HTTP/1.1" 200 -
2025-11-11 18:17:58,477 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:17:58] "GET /socket.io/?EIO=4&transport=polling&t=PfrDZPA&sid=t8YiKhJ_PwNNX6tBAAAY HTTP/1.1" 200 -
2025-11-11 18:17:58,494 - root - INFO - WebSocket client connected: 7Z5pmv2AeDX2I_IzAAAb
2025-11-11 18:17:58,500 - root - INFO - Client H_yrWvfkv2vzK22TAAAZ joined session room: sess-rjxbjuda
2025-11-11 18:18:01,358 - root - INFO - Client H_yrWvfkv2vzK22TAAAZ joined session room: sess-c5wknfqu
2025-11-11 18:18:07,857 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 18:18:07,858 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-c5wknfqu
2025-11-11 18:18:07,860 - agent.state_manager - WARNING - Session sess-c5wknfqu not found
2025-11-11 18:18:07,861 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 18:18:07,866 - agent.state_manager - INFO - Saved session state for sess-c5wknfqu (user: admin)
2025-11-11 18:18:07,866 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 18:18:07,866 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 18:18:07,866 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 18:18:07,866 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 18:18:07,867 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 18:18:07,867 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 18:18:07,867 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 18:18:07,871 - agent.state_manager - INFO - Saved session state for sess-c5wknfqu (user: admin)
2025-11-11 18:18:11,429 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:18:11,437 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 18:18:11,437 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 18:18:11,438 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 18:18:11,443 - agent.state_manager - INFO - Saved session state for sess-c5wknfqu (user: admin)
2025-11-11 18:18:11,444 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 18:18:11,444 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 18:18:11,445 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 18:18:11,445 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 18:18:11,445 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 18:18:11,445 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 18:18:11,445 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 18:18:11,445 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 18:18:11,446 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 18:18:11,446 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 18:18:11,446 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 18:18:11,446 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 18:18:11,447 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 18:18:11,447 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 18:18:11,447 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 18:18:11,447 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 18:18:14,643 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:18:16,429 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:18:19,222 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 18:18:19,222 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 18:18:19,222 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-11 18:18:19,222 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 22600 chars
2025-11-11 18:18:19,222 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 18:18:19,222 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 18:18:21,283 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:18:23,644 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 440 chars
2025-11-11 18:18:23,644 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
  "explanation": "Retrieved top primary limits for the latest date, sorted by utilization in descending order. Assumed 'top' means all primary limits, sorted by highest utilization. Used default of limit_class = 'Primary' since query mentioned 'primary limits'.",
  "target_table": "limits_data"
}
2025-11-11 18:18:23,644 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 18:18:23,645 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 18:18:23,645 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:18:23,645 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:18:23,645 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 18:18:23,646 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 18:18:23,646 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 18:18:23,648 - agent.state_manager - INFO - Saved session state for sess-c5wknfqu (user: admin)
2025-11-11 18:18:23,649 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 18:18:23,649 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 18:18:23,649 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 18:18:23,650 - agent.state_manager - INFO - Saved session state for sess-c5wknfqu (user: admin)
2025-11-11 18:18:23,651 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:18:23,651 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 18:18:23,651 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:18:23,651 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:18:23,651 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:18:23,651 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 18:18:23,651 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:18:23,757 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 18:18:23,757 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 18:18:23,758 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 18:18:23,760 - agent.state_manager - INFO - Saved session state for sess-c5wknfqu (user: admin)
2025-11-11 18:18:23,760 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:18:23,760 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 18:18:23,760 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 18:18:23,760 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:18:23,761 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 18:18:23,761 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 18:18:23,761 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 18:18:23,761 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4841 chars
2025-11-11 18:18:24,655 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:18:35,184 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1934 chars
2025-11-11 18:18:35,224 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 18:18:35,225 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 18:18:35,226 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 38294 chars
2025-11-11 18:18:42,696 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:18:42,698 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 958 chars
2025-11-11 18:18:42,698 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:18:42,698 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 18:18:42,698 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:18:42,698 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:18:42,698 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 18:18:42,698 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 18:18:42,699 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 18:18:42,708 - agent.state_manager - INFO - Saved session state for sess-c5wknfqu (user: admin)
2025-11-11 18:18:42,708 - agent.streaming_agent - INFO - Agent completed for session sess-c5wknfqu: 34841.999ms, 7 steps
2025-11-11 18:18:42,708 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 18:18:52,652 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-11 18:18:52,725 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-11 18:18:52,725 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-11 18:18:52,735 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-11 18:18:52,735 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-11 18:18:52,773 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 18:18:52,774 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 18:18:52,774 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 18:18:52,774 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 18:18:52,774 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-11 18:18:52,774 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-11 18:18:52,774 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-11 18:18:52,775 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-11 18:18:52,775 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-11 18:18:52,776 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-11 18:18:52,777 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-11 18:18:52,777 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-11 18:18:52,777 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-11 18:18:52,778 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-11 18:18:52,778 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-11 18:18:52,779 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-11 18:18:52,779 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-11 18:18:52,781 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-11 18:18:52,781 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-11 18:18:59,640 - DuckDbDescribeTableTool - INFO - Found 1 data files in data/duckdb
2025-11-11 18:18:59,871 - DuckDbDescribeTableTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 18:18:59,921 - DuckDbDescribeTableTool - INFO - Initialization complete: 4 views available
2025-11-11 18:18:59,923 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 18:18:59,923 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-11 18:18:59,923 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-11 18:18:59,938 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-11 18:18:59,938 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-11 18:19:04,229 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-11 18:19:04,229 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-11 18:19:04,232 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-11 18:19:04,233 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-11 18:19:04,238 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-11 18:19:04,238 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-11 18:19:04,239 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-11 18:19:04,240 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-11 18:19:04,240 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-11 18:19:04,240 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-11 18:19:04,252 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-11 18:19:04,252 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-11 18:19:04,254 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-11 18:19:04,254 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-11 18:19:04,256 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-11 18:19:04,256 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-11 18:19:04,257 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-11 18:19:04,258 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-11 18:19:04,260 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-11 18:19:04,260 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-11 18:19:04,261 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-11 18:19:04,261 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-11 18:19:04,263 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-11 18:19:04,263 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-11 18:19:04,264 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-11 18:19:04,265 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-11 18:19:04,267 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-11 18:19:04,268 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-11 18:19:04,268 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-11 18:19:04,268 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-11 18:19:04,270 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-11 18:19:04,270 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-11 18:19:04,273 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-11 18:19:04,273 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-11 18:19:04,274 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-11 18:19:04,274 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-11 18:19:04,275 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-11 18:19:04,275 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-11 18:19:04,285 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-11 18:19:04,286 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-11 18:19:04,287 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-11 18:19:04,287 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-11 18:19:04,288 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-11 18:19:04,288 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-11 18:19:04,288 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-11 18:19:04,289 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-11 18:19:04,311 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 18:19:04,311 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 18:19:04,311 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 18:19:04,311 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 18:19:04,311 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-11 18:19:04,311 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-11 18:19:04,312 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-11 18:19:04,317 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-11 18:19:04,317 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-11 18:19:04,318 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-11 18:19:04,318 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-11 18:19:04,321 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-11 18:19:04,321 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-11 18:19:04,325 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-11 18:19:04,326 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-11 18:19:04,328 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-11 18:19:04,328 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-11 18:19:04,329 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-11 18:19:04,329 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-11 18:19:04,331 - DuckDbListFilesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 18:19:05,575 - DuckDbListFilesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 18:19:05,599 - DuckDbListFilesTool - INFO - Initialization complete: 4 views available
2025-11-11 18:19:05,616 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 18:19:05,617 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-11 18:19:05,617 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-11 18:19:05,622 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-11 18:19:05,622 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-11 18:19:05,682 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-11 18:19:05,684 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-11 18:19:05,689 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-11 18:19:05,690 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-11 18:19:05,693 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-11 18:19:05,694 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-11 18:19:05,701 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-11 18:19:05,703 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-11 18:19:05,706 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-11 18:19:05,755 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-11 18:19:05,778 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-11 18:19:05,784 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-11 18:19:05,794 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-11 18:19:05,794 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-11 18:19:05,795 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-11 18:19:05,796 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-11 18:19:05,796 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-11 18:19:05,797 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-11 18:19:05,797 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-11 18:19:05,797 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-11 18:19:05,798 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-11 18:19:05,798 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-11 18:19:05,798 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-11 18:19:05,798 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-11 18:19:05,801 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-11 18:19:05,801 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-11 18:19:05,814 - DuckDbGetStatsTool - INFO - Found 1 data files in data/duckdb
2025-11-11 18:19:06,138 - DuckDbGetStatsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 18:19:06,149 - DuckDbGetStatsTool - INFO - Initialization complete: 4 views available
2025-11-11 18:19:06,156 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 18:19:06,157 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-11 18:19:06,157 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-11 18:19:06,161 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-11 18:19:06,161 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-11 18:19:06,165 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-11 18:19:06,165 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-11 18:19:06,169 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-11 18:19:06,171 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-11 18:19:06,173 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-11 18:19:06,173 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-11 18:19:06,205 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 18:19:06,205 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 18:19:06,205 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 18:19:06,205 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 18:19:06,206 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-11 18:19:06,206 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-11 18:19:06,206 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-11 18:19:06,209 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-11 18:19:06,210 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-11 18:19:06,211 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-11 18:19:06,211 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-11 18:19:06,227 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-11 18:19:06,227 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-11 18:19:06,238 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-11 18:19:06,238 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-11 18:19:06,240 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-11 18:19:06,240 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-11 18:19:06,242 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-11 18:19:06,242 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-11 18:19:06,244 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-11 18:19:06,244 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-11 18:19:06,246 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-11 18:19:06,246 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-11 18:19:06,255 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-11 18:19:06,255 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-11 18:19:06,256 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-11 18:19:06,256 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-11 18:19:06,259 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-11 18:19:06,259 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-11 18:19:06,260 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-11 18:19:06,260 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-11 18:19:06,263 - DuckDbListTablesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 18:19:06,547 - DuckDbListTablesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 18:19:06,556 - DuckDbListTablesTool - INFO - Initialization complete: 4 views available
2025-11-11 18:19:06,559 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 18:19:06,563 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-11 18:19:06,563 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-11 18:19:06,569 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-11 18:19:06,570 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-11 18:19:06,573 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-11 18:19:06,574 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-11 18:19:06,577 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-11 18:19:06,577 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-11 18:19:06,579 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-11 18:19:06,581 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-11 18:19:06,584 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-11 18:19:06,585 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-11 18:19:06,587 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-11 18:19:06,591 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-11 18:19:06,605 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-11 18:19:06,606 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-11 18:19:06,624 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-11 18:19:06,626 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-11 18:19:06,631 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-11 18:19:06,632 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-11 18:19:06,637 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-11 18:19:06,638 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-11 18:19:06,639 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-11 18:19:06,639 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-11 18:19:06,644 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-11 18:19:06,645 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-11 18:19:06,650 - DuckDbAggregateTool - INFO - Found 1 data files in data/duckdb
2025-11-11 18:19:06,879 - DuckDbAggregateTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 18:19:06,894 - DuckDbAggregateTool - INFO - Initialization complete: 4 views available
2025-11-11 18:19:06,895 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 18:19:06,895 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-11 18:19:06,895 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-11 18:19:06,896 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-11 18:19:06,896 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-11 18:19:06,899 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-11 18:19:06,899 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-11 18:19:06,906 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-11 18:19:06,907 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-11 18:19:06,908 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-11 18:19:06,908 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-11 18:19:06,923 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-11 18:19:06,924 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-11 18:19:06,927 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-11 18:19:06,927 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-11 18:19:06,974 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 18:19:06,974 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 18:19:06,975 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 18:19:06,975 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 18:19:06,975 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-11 18:19:06,975 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-11 18:19:06,975 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-11 18:19:06,977 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-11 18:19:06,977 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-11 18:19:06,977 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-11 18:19:06,978 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-11 18:19:06,981 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-11 18:19:06,981 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-11 18:19:06,988 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-11 18:19:06,988 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-11 18:19:06,989 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-11 18:19:06,989 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-11 18:19:06,990 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-11 18:19:06,990 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-11 18:19:06,995 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-11 18:19:06,995 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-11 18:19:06,996 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-11 18:19:06,998 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-11 18:19:07,000 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-11 18:19:07,000 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-11 18:19:07,004 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-11 18:19:07,005 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-11 18:19:07,006 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-11 18:19:07,006 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-11 18:19:07,007 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-11 18:19:07,007 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-11 18:19:07,009 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-11 18:19:07,009 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-11 18:19:07,010 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-11 18:19:07,010 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-11 18:19:07,013 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-11 18:19:07,013 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-11 18:19:07,017 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-11 18:19:07,017 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-11 18:19:07,019 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-11 18:19:07,019 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-11 18:19:07,020 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-11 18:19:07,020 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-11 18:19:07,020 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-11 18:19:07,021 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-11 18:19:07,021 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-11 18:19:07,021 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-11 18:19:07,038 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-11 18:19:07,038 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-11 18:19:07,042 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-11 18:19:07,043 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-11 18:19:07,044 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-11 18:19:07,044 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-11 18:19:07,055 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-11 18:19:07,055 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-11 18:19:07,056 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-11 18:19:07,057 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-11 18:19:07,074 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-11 18:19:07,078 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-11 18:19:07,080 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-11 18:19:07,080 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-11 18:19:07,081 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-11 18:19:07,081 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-11 18:19:07,083 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-11 18:19:07,083 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-11 18:19:07,084 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-11 18:19:07,085 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-11 18:19:07,089 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-11 18:19:07,092 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-11 18:19:07,094 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-11 18:19:07,098 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-11 18:19:07,103 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-11 18:19:07,103 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-11 18:19:07,105 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-11 18:19:07,115 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-11 18:19:07,141 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 18:19:07,141 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 18:19:07,141 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 18:19:07,142 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 18:19:07,142 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-11 18:19:07,142 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-11 18:19:07,142 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-11 18:19:07,143 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-11 18:19:07,143 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-11 18:19:07,154 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-11 18:19:07,154 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-11 18:19:07,161 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-11 18:19:07,161 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-11 18:19:07,171 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-11 18:19:07,171 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-11 18:19:07,176 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-11 18:19:07,176 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-11 18:19:07,179 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-11 18:19:07,179 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-11 18:19:07,180 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-11 18:19:07,180 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-11 18:19:07,182 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-11 18:19:07,183 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-11 18:19:07,185 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-11 18:19:07,185 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-11 18:19:07,186 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-11 18:19:07,186 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-11 18:19:07,186 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-11 18:19:07,186 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-11 18:19:07,205 - DuckDbQueryTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 18:19:07,450 - DuckDbQueryTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 18:19:07,458 - DuckDbQueryTool - INFO - Initialization complete: 4 views available
2025-11-11 18:19:07,459 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 18:19:07,459 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-11 18:19:07,459 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-11 18:19:07,460 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-11 18:19:07,460 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-11 18:19:07,461 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-11 18:19:07,461 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-11 18:19:07,462 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-11 18:19:07,462 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-11 18:19:07,464 - DuckDbRefreshViewsTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 18:19:07,664 - DuckDbRefreshViewsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 18:19:07,670 - DuckDbRefreshViewsTool - INFO - Initialization complete: 4 views available
2025-11-11 18:19:07,670 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 18:19:07,672 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-11 18:19:07,672 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-11 18:19:07,673 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-11 18:19:07,674 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-11 18:19:07,674 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-11 18:19:07,674 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-11 18:19:07,696 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 18:19:07,696 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 18:19:07,696 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 18:19:07,696 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 18:19:07,696 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-11 18:19:07,696 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-11 18:19:07,696 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-11 18:19:07,697 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-11 18:19:07,698 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-11 18:19:07,698 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-11 18:19:07,698 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-11 18:19:07,699 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-11 18:19:07,699 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-11 18:19:07,700 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-11 18:19:07,700 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-11 18:19:07,701 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-11 18:19:07,701 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-11 18:19:07,702 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-11 18:19:07,702 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-11 18:19:07,703 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-11 18:19:07,742 - root - INFO - All routes registered successfully
2025-11-11 18:19:07,744 - werkzeug - WARNING - Werkzeug appears to be used in a production deployment. Consider switching to a production web server instead.
2025-11-11 18:19:07,754 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.68.51:8000
2025-11-11 18:19:07,754 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-11-11 18:19:09,026 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:09] "GET /socket.io/?EIO=4&transport=polling&t=PfrDqdS HTTP/1.1" 200 -
2025-11-11 18:19:09,029 - root - INFO - WebSocket client connected: xu3-2ejWAc8kAhfiAAAC
2025-11-11 18:19:09,033 - root - INFO - WebSocket client connected: zebERdqfvtSGzM-eAAAD
2025-11-11 18:19:09,033 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:09] "POST /socket.io/?EIO=4&transport=polling&t=PfrDqda&sid=UH-IP1vTE8GtlpkYAAAB HTTP/1.1" 200 -
2025-11-11 18:19:09,035 - root - INFO - WebSocket client disconnected: xu3-2ejWAc8kAhfiAAAC
2025-11-11 18:19:09,036 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:09] "GET /socket.io/?EIO=4&transport=polling&t=PfrDqdc&sid=UH-IP1vTE8GtlpkYAAAB HTTP/1.1" 200 -
2025-11-11 18:19:09,044 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:09] "GET /socket.io/?EIO=4&transport=polling&t=PfrDqdn&sid=UH-IP1vTE8GtlpkYAAAB HTTP/1.1" 200 -
2025-11-11 18:19:09,046 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:09] "POST /socket.io/?EIO=4&transport=polling&t=PfrDqdo&sid=UH-IP1vTE8GtlpkYAAAB HTTP/1.1" 200 -
2025-11-11 18:19:09,046 - root - INFO - WebSocket client disconnected: zebERdqfvtSGzM-eAAAD
2025-11-11 18:19:09,051 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:09] "GET /socket.io/?EIO=4&transport=websocket&sid=UH-IP1vTE8GtlpkYAAAB HTTP/1.1" 200 -
2025-11-11 18:19:09,052 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:09] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 18:19:09,056 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 18:19:38,070 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:38] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 18:19:38,095 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:38] "GET /login?next=http://127.0.0.1:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 18:19:38,142 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:38] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 18:19:38,149 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:38] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 18:19:38,165 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:38] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 18:19:38,202 - root - INFO - WebSocket client connected: hmKXHHWGWz266ahaAAAF
2025-11-11 18:19:38,205 - root - INFO - WebSocket client disconnected: hmKXHHWGWz266ahaAAAF
2025-11-11 18:19:38,219 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:38] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 18:19:38,222 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 18:19:44,687 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 18:19:44,687 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 18:19:44,689 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:44] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 18:19:44,712 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:44] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 18:19:44,734 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:44] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 18:19:44,735 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:44] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 18:19:44,735 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:44] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 18:19:44,901 - root - INFO - WebSocket client connected: BWGm2C8SDXesyp-eAAAH
2025-11-11 18:19:44,905 - root - INFO - WebSocket client disconnected: BWGm2C8SDXesyp-eAAAH
2025-11-11 18:19:44,919 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:44] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 18:19:44,920 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 18:19:53,204 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:53] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 18:19:53,225 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:53] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 18:19:53,226 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:53] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 18:19:53,227 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:53] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 18:19:53,263 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:53] "GET /socket.io/?EIO=4&transport=polling&t=PfrD_Qh HTTP/1.1" 200 -
2025-11-11 18:19:53,276 - root - INFO - WebSocket client connected: 1e1G4fIWbdCleWRuAAAK
2025-11-11 18:19:53,276 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:53] "POST /socket.io/?EIO=4&transport=polling&t=PfrD_Qs&sid=lw9OV4FyemMDnjHhAAAI HTTP/1.1" 200 -
2025-11-11 18:19:53,276 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:53] "GET /socket.io/?EIO=4&transport=polling&t=PfrD_Qt&sid=lw9OV4FyemMDnjHhAAAI HTTP/1.1" 200 -
2025-11-11 18:19:53,281 - root - INFO - WebSocket client connected: rATMUKTz1GR_6nTDAAAL
2025-11-11 18:19:53,287 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:53] "GET /socket.io/?EIO=4&transport=polling&t=PfrD_R1&sid=lw9OV4FyemMDnjHhAAAI HTTP/1.1" 200 -
2025-11-11 18:19:53,288 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:19:53] "POST /socket.io/?EIO=4&transport=polling&t=PfrD_R2&sid=lw9OV4FyemMDnjHhAAAI HTTP/1.1" 200 -
2025-11-11 18:19:53,290 - root - INFO - Client 1e1G4fIWbdCleWRuAAAK joined session room: sess-c5wknfqu
2025-11-11 18:19:56,625 - root - INFO - Client 1e1G4fIWbdCleWRuAAAK joined session room: sess-ltgth05u
2025-11-11 18:20:03,814 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 18:20:03,815 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-ltgth05u
2025-11-11 18:20:03,816 - agent.state_manager - WARNING - Session sess-ltgth05u not found
2025-11-11 18:20:03,816 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 18:20:03,824 - agent.state_manager - INFO - Saved session state for sess-ltgth05u (user: admin)
2025-11-11 18:20:03,824 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 18:20:03,825 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 18:20:03,825 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 18:20:03,826 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 18:20:03,828 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 18:20:03,828 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 18:20:03,829 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 18:20:03,834 - agent.state_manager - INFO - Saved session state for sess-ltgth05u (user: admin)
2025-11-11 18:20:07,469 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:20:07,487 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 18:20:07,488 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 18:20:07,488 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 18:20:07,490 - agent.state_manager - INFO - Saved session state for sess-ltgth05u (user: admin)
2025-11-11 18:20:07,490 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 18:20:07,490 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 18:20:07,490 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 18:20:07,490 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 18:20:07,490 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 18:20:07,490 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 18:20:07,490 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 18:20:07,491 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 18:20:07,491 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 18:20:07,491 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 18:20:07,491 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 18:20:07,491 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 18:20:07,491 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 18:20:07,491 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 18:20:07,491 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 18:20:07,491 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 18:20:10,780 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:20:12,487 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:20:14,963 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 18:20:14,963 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 18:20:14,963 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-11 18:20:14,964 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 22600 chars
2025-11-11 18:20:14,964 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 18:20:14,964 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 18:20:16,944 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:20:19,193 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 403 chars
2025-11-11 18:20:19,193 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
  "explanation": "Retrieved top primary limits for the latest date, sorted by utilization in descending order. Applied 'Primary' limit class filter since query mentioned 'primary limits' and used most recent date as default.",
  "target_table": "limits_data"
}
2025-11-11 18:20:19,194 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 18:20:19,194 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 18:20:19,194 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:20:19,195 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:20:19,195 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 18:20:19,196 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 18:20:19,196 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 18:20:19,204 - agent.state_manager - INFO - Saved session state for sess-ltgth05u (user: admin)
2025-11-11 18:20:19,205 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 18:20:19,206 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 18:20:19,206 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 18:20:19,214 - agent.state_manager - INFO - Saved session state for sess-ltgth05u (user: admin)
2025-11-11 18:20:19,214 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:20:19,215 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 18:20:19,215 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:20:19,215 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:20:19,216 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:20:19,216 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 18:20:19,216 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:20:19,353 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 18:20:19,354 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 18:20:19,355 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 18:20:19,357 - agent.state_manager - INFO - Saved session state for sess-ltgth05u (user: admin)
2025-11-11 18:20:19,358 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:20:19,358 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 18:20:19,358 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 18:20:19,358 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:20:19,358 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 18:20:19,358 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 18:20:19,358 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 18:20:19,359 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4841 chars
2025-11-11 18:20:20,224 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:20:29,838 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1768 chars
2025-11-11 18:20:29,838 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 18:20:29,839 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 18:20:29,840 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 38257 chars
2025-11-11 18:20:37,063 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:20:37,064 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 847 chars
2025-11-11 18:20:37,065 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:20:37,065 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 18:20:37,065 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:20:37,065 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:20:37,065 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 18:20:37,065 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 18:20:37,066 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 18:20:37,076 - agent.state_manager - INFO - Saved session state for sess-ltgth05u (user: admin)
2025-11-11 18:20:37,076 - agent.streaming_agent - INFO - Agent completed for session sess-ltgth05u: 33250.011ms, 7 steps
2025-11-11 18:20:37,076 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 18:24:54,244 - root - INFO - WebSocket client disconnected: 1e1G4fIWbdCleWRuAAAK
2025-11-11 18:24:54,247 - root - INFO - WebSocket client disconnected: rATMUKTz1GR_6nTDAAAL
2025-11-11 18:24:54,271 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:24:54] "GET /socket.io/?EIO=4&transport=websocket&sid=lw9OV4FyemMDnjHhAAAI HTTP/1.1" 200 -
2025-11-11 18:24:54,278 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:24:54] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 18:24:54,287 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:24:54] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 18:24:54,301 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 18:24:54,352 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:24:54] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 18:24:54,353 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:24:54] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 18:24:54,400 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:24:54] "GET /socket.io/?EIO=4&transport=polling&t=PfrF8xq HTTP/1.1" 200 -
2025-11-11 18:24:54,409 - root - INFO - WebSocket client connected: kV4pF9ph6Li2ZxTZAAAO
2025-11-11 18:24:54,411 - root - INFO - WebSocket client connected: rhwOTgsZQblcqzTyAAAP
2025-11-11 18:24:54,411 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:24:54] "POST /socket.io/?EIO=4&transport=polling&t=PfrF8y4&sid=FlOM6FrMBeVM9pVFAAAM HTTP/1.1" 200 -
2025-11-11 18:24:54,412 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:24:54] "GET /socket.io/?EIO=4&transport=polling&t=PfrF8y4.0&sid=FlOM6FrMBeVM9pVFAAAM HTTP/1.1" 200 -
2025-11-11 18:24:54,420 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:24:54] "GET /socket.io/?EIO=4&transport=polling&t=PfrF8yI&sid=FlOM6FrMBeVM9pVFAAAM HTTP/1.1" 200 -
2025-11-11 18:24:54,421 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:24:54] "POST /socket.io/?EIO=4&transport=polling&t=PfrF8yJ&sid=FlOM6FrMBeVM9pVFAAAM HTTP/1.1" 200 -
2025-11-11 18:24:54,425 - root - INFO - Client kV4pF9ph6Li2ZxTZAAAO joined session room: sess-ltgth05u
2025-11-11 18:24:59,291 - root - INFO - Client kV4pF9ph6Li2ZxTZAAAO joined session room: sess-8s37kzw0
2025-11-11 18:25:05,522 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 18:25:05,525 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-8s37kzw0
2025-11-11 18:25:05,526 - agent.state_manager - WARNING - Session sess-8s37kzw0 not found
2025-11-11 18:25:05,526 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 18:25:05,532 - agent.state_manager - INFO - Saved session state for sess-8s37kzw0 (user: admin)
2025-11-11 18:25:05,532 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 18:25:05,532 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 18:25:05,532 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 18:25:05,533 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 18:25:05,533 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 18:25:05,533 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 18:25:05,533 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 18:25:05,537 - agent.state_manager - INFO - Saved session state for sess-8s37kzw0 (user: admin)
2025-11-11 18:25:09,083 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:25:09,086 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 18:25:09,086 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 18:25:09,087 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 18:25:09,090 - agent.state_manager - INFO - Saved session state for sess-8s37kzw0 (user: admin)
2025-11-11 18:25:09,090 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 18:25:09,090 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 18:25:09,090 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 18:25:09,090 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 18:25:09,090 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 18:25:09,090 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 18:25:09,091 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 18:25:09,091 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 18:25:09,091 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 18:25:09,091 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 18:25:09,091 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 18:25:09,091 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 18:25:09,091 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 18:25:09,091 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 18:25:09,091 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 18:25:09,091 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 18:25:12,200 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:25:13,849 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:25:13,888 - root - INFO - WebSocket client disconnected: rhwOTgsZQblcqzTyAAAP
2025-11-11 18:25:13,889 - root - INFO - WebSocket client disconnected: kV4pF9ph6Li2ZxTZAAAO
2025-11-11 18:25:13,891 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:25:13] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 18:25:13,892 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:25:13] "GET /socket.io/?EIO=4&transport=websocket&sid=FlOM6FrMBeVM9pVFAAAM HTTP/1.1" 200 -
2025-11-11 18:25:13,896 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:25:13] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 18:25:13,897 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 18:25:13,907 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:25:13] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 18:25:13,908 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:25:13] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 18:25:13,917 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:25:13] "GET /socket.io/?EIO=4&transport=polling&t=PfrFDix HTTP/1.1" 200 -
2025-11-11 18:25:13,924 - root - INFO - WebSocket client connected: -ul0MOCTUqLEQcjjAAAR
2025-11-11 18:25:13,924 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:25:13] "POST /socket.io/?EIO=4&transport=polling&t=PfrFDj1&sid=tO4zFYfWa-AV3Va1AAAQ HTTP/1.1" 200 -
2025-11-11 18:25:13,925 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:25:13] "GET /socket.io/?EIO=4&transport=polling&t=PfrFDj2&sid=tO4zFYfWa-AV3Va1AAAQ HTTP/1.1" 200 -
2025-11-11 18:25:13,927 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:25:13] "GET /socket.io/?EIO=4&transport=polling&t=PfrFDj6&sid=tO4zFYfWa-AV3Va1AAAQ HTTP/1.1" 200 -
2025-11-11 18:25:13,928 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:25:13] "POST /socket.io/?EIO=4&transport=polling&t=PfrFDj7&sid=tO4zFYfWa-AV3Va1AAAQ HTTP/1.1" 200 -
2025-11-11 18:25:13,931 - root - INFO - Client -ul0MOCTUqLEQcjjAAAR joined session room: sess-8s37kzw0
2025-11-11 18:25:13,940 - root - INFO - WebSocket client connected: 65Gd-lz6yX4oL8ZNAAAT
2025-11-11 18:25:16,344 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 18:25:16,344 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 18:25:16,344 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-11 18:25:16,344 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 22600 chars
2025-11-11 18:25:16,345 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 18:25:16,345 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 18:25:18,663 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:25:20,914 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 417 chars
2025-11-11 18:25:20,914 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
  "explanation": "Retrieved top primary limits for the latest date, sorted by utilization in descending order. Assumed 'top' means all primary limits, sorted by highest utilization. Used default of limit_class = 'Primary' and latest date.",
  "target_table": "limits_data"
}
2025-11-11 18:25:20,914 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 18:25:20,914 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 18:25:20,914 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:25:20,914 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:25:20,915 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 18:25:20,915 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 18:25:20,915 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 18:25:20,918 - agent.state_manager - INFO - Saved session state for sess-8s37kzw0 (user: admin)
2025-11-11 18:25:20,918 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 18:25:20,918 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 18:25:20,918 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 18:25:20,920 - agent.state_manager - INFO - Saved session state for sess-8s37kzw0 (user: admin)
2025-11-11 18:25:20,920 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:25:20,920 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 18:25:20,920 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:25:20,920 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:25:20,920 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:25:20,920 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 18:25:20,921 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:25:21,064 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 18:25:21,065 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 18:25:21,065 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 18:25:21,068 - agent.state_manager - INFO - Saved session state for sess-8s37kzw0 (user: admin)
2025-11-11 18:25:21,068 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:25:21,068 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 18:25:21,068 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 18:25:21,069 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:25:21,069 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 18:25:21,069 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 18:25:21,069 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 18:25:21,070 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4841 chars
2025-11-11 18:25:22,064 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:25:31,619 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1826 chars
2025-11-11 18:25:31,619 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 18:25:31,619 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 18:25:31,620 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 38271 chars
2025-11-11 18:25:35,520 - root - INFO - WebSocket client disconnected: -ul0MOCTUqLEQcjjAAAR
2025-11-11 18:25:35,521 - root - INFO - WebSocket client disconnected: 65Gd-lz6yX4oL8ZNAAAT
2025-11-11 18:25:35,522 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:25:35] "GET /socket.io/?EIO=4&transport=websocket&sid=tO4zFYfWa-AV3Va1AAAQ HTTP/1.1" 200 -
2025-11-11 18:25:35,532 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:25:35] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 18:25:35,535 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:25:35] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 18:25:35,545 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 18:25:35,560 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:25:35] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 18:25:35,560 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:25:35] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 18:25:35,628 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:25:35] "GET /socket.io/?EIO=4&transport=polling&t=PfrFJ0B HTTP/1.1" 200 -
2025-11-11 18:25:35,641 - root - INFO - WebSocket client connected: Z6hhgVpCpqD6Zb_qAAAV
2025-11-11 18:25:35,642 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:25:35] "POST /socket.io/?EIO=4&transport=polling&t=PfrFJ0K&sid=dJn6-_kLIcBaCe-9AAAU HTTP/1.1" 200 -
2025-11-11 18:25:35,642 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:25:35] "GET /socket.io/?EIO=4&transport=polling&t=PfrFJ0K.0&sid=dJn6-_kLIcBaCe-9AAAU HTTP/1.1" 200 -
2025-11-11 18:25:35,645 - root - INFO - WebSocket client connected: zrNHUFol37QWfw8VAAAX
2025-11-11 18:25:35,647 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:25:35] "POST /socket.io/?EIO=4&transport=polling&t=PfrFJ0R.0&sid=dJn6-_kLIcBaCe-9AAAU HTTP/1.1" 200 -
2025-11-11 18:25:35,647 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:25:35] "GET /socket.io/?EIO=4&transport=polling&t=PfrFJ0R&sid=dJn6-_kLIcBaCe-9AAAU HTTP/1.1" 200 -
2025-11-11 18:25:35,649 - root - INFO - Client Z6hhgVpCpqD6Zb_qAAAV joined session room: sess-8s37kzw0
2025-11-11 18:25:35,649 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:25:35] "POST /socket.io/?EIO=4&transport=polling&t=PfrFJ0W.0&sid=dJn6-_kLIcBaCe-9AAAU HTTP/1.1" 200 -
2025-11-11 18:25:35,649 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:25:35] "GET /socket.io/?EIO=4&transport=polling&t=PfrFJ0W&sid=dJn6-_kLIcBaCe-9AAAU HTTP/1.1" 200 -
2025-11-11 18:25:35,655 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:25:35] "GET /socket.io/?EIO=4&transport=polling&t=PfrFJ0Y&sid=dJn6-_kLIcBaCe-9AAAU HTTP/1.1" 200 -
2025-11-11 18:25:39,989 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:25:39,992 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1041 chars
2025-11-11 18:25:39,992 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:25:39,992 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 18:25:39,992 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:25:39,992 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:25:39,993 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 18:25:39,993 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 18:25:39,993 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 18:25:39,998 - root - INFO - Client Z6hhgVpCpqD6Zb_qAAAV joined session room: sess-hzhnmho3
2025-11-11 18:25:39,999 - agent.state_manager - INFO - Saved session state for sess-8s37kzw0 (user: admin)
2025-11-11 18:25:39,999 - agent.streaming_agent - INFO - Agent completed for session sess-8s37kzw0: 34466.191ms, 7 steps
2025-11-11 18:25:39,999 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 18:25:46,349 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 18:25:46,349 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-hzhnmho3
2025-11-11 18:25:46,349 - agent.state_manager - WARNING - Session sess-hzhnmho3 not found
2025-11-11 18:25:46,349 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 18:25:46,351 - agent.state_manager - INFO - Saved session state for sess-hzhnmho3 (user: admin)
2025-11-11 18:25:46,352 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 18:25:46,352 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 18:25:46,352 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 18:25:46,352 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 18:25:46,352 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 18:25:46,352 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 18:25:46,352 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 18:25:46,353 - agent.state_manager - INFO - Saved session state for sess-hzhnmho3 (user: admin)
2025-11-11 18:25:50,177 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:25:50,178 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 18:25:50,179 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 18:25:50,179 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 18:25:50,180 - agent.state_manager - INFO - Saved session state for sess-hzhnmho3 (user: admin)
2025-11-11 18:25:50,180 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 18:25:50,180 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 18:25:50,180 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 18:25:50,180 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 18:25:50,180 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 18:25:50,180 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 18:25:50,180 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 18:25:50,180 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 18:25:50,180 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 18:25:50,181 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 18:25:50,181 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 18:25:50,181 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 18:25:50,181 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 18:25:50,181 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 18:25:50,181 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 18:25:50,181 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 18:25:53,179 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:25:54,703 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:25:57,149 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 18:25:57,149 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 18:25:57,149 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-11 18:25:57,149 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 22600 chars
2025-11-11 18:25:57,150 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 18:25:57,150 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 18:25:59,251 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:26:01,471 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 419 chars
2025-11-11 18:26:01,472 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
  "explanation": "Retrieve top primary limits for the latest date, sorted by utilization in descending order. Applied 'Primary' limit class filter since query mentioned 'primary' and sorted by utilization to show most utilized limits first.",
  "target_table": "limits_data"
}
2025-11-11 18:26:01,472 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 18:26:01,472 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 18:26:01,472 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:26:01,472 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:26:01,473 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 18:26:01,473 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 18:26:01,473 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 18:26:01,477 - agent.state_manager - INFO - Saved session state for sess-hzhnmho3 (user: admin)
2025-11-11 18:26:01,477 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 18:26:01,477 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 18:26:01,478 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 18:26:01,480 - agent.state_manager - INFO - Saved session state for sess-hzhnmho3 (user: admin)
2025-11-11 18:26:01,480 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:26:01,480 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 18:26:01,480 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:26:01,480 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:26:01,481 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:26:01,481 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 18:26:01,481 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:26:01,594 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 18:26:01,594 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 18:26:01,595 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 18:26:01,597 - agent.state_manager - INFO - Saved session state for sess-hzhnmho3 (user: admin)
2025-11-11 18:26:01,597 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:26:01,597 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 18:26:01,597 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 18:26:01,597 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:26:01,597 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 18:26:01,597 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 18:26:01,597 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 18:26:01,598 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4840 chars
2025-11-11 18:26:02,426 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:26:12,392 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1794 chars
2025-11-11 18:26:12,393 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 18:26:12,393 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 18:26:12,393 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 38272 chars
2025-11-11 18:26:19,688 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:26:19,691 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 870 chars
2025-11-11 18:26:19,691 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:26:19,691 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 18:26:19,691 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:26:19,691 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:26:19,692 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 18:26:19,692 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 18:26:19,692 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 18:26:19,702 - agent.state_manager - INFO - Saved session state for sess-hzhnmho3 (user: admin)
2025-11-11 18:26:19,702 - agent.streaming_agent - INFO - Agent completed for session sess-hzhnmho3: 33350.393ms, 7 steps
2025-11-11 18:26:19,702 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 18:26:24,820 - root - INFO - Client Z6hhgVpCpqD6Zb_qAAAV joined session room: sess-hmw5yq8n
2025-11-11 18:26:29,033 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 18:26:29,034 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-hmw5yq8n
2025-11-11 18:26:29,035 - agent.state_manager - WARNING - Session sess-hmw5yq8n not found
2025-11-11 18:26:29,035 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 18:26:29,042 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:26:29,042 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 18:26:29,042 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 18:26:29,043 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 18:26:29,043 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 18:26:29,043 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 18:26:29,043 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 18:26:29,043 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 18:26:29,046 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:26:32,665 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:26:32,667 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 18:26:32,667 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 18:26:32,667 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 18:26:32,669 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:26:32,670 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 18:26:32,670 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 18:26:32,670 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 18:26:32,670 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 18:26:32,670 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 18:26:32,670 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 18:26:32,670 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 18:26:32,670 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 18:26:32,670 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 18:26:32,670 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 18:26:32,670 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 18:26:32,670 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 18:26:32,671 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 18:26:32,671 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 18:26:32,671 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 18:26:32,671 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 18:26:32,848 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:26:32] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 18:26:32,853 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:26:32] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 18:26:35,561 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:26:37,521 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:26:40,640 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 18:26:40,640 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 18:26:40,640 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-11 18:26:40,641 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 22600 chars
2025-11-11 18:26:40,641 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 18:26:40,641 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 18:26:42,524 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:26:44,646 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 390 chars
2025-11-11 18:26:44,647 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
  "explanation": "Retrieve top primary limits for the latest date, sorted by utilization in descending order. Applied 'Primary' limit class filter since query mentioned 'primary' and used latest date as default.",
  "target_table": "limits_data"
}
2025-11-11 18:26:44,647 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 18:26:44,647 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 18:26:44,647 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:26:44,647 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:26:44,648 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 18:26:44,648 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 18:26:44,648 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 18:26:44,651 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:26:44,652 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 18:26:44,652 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 18:26:44,652 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 18:26:44,655 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:26:44,655 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:26:44,655 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 18:26:44,655 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:26:44,656 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:26:44,656 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:26:44,656 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 18:26:44,656 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:26:44,805 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 18:26:44,805 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 18:26:44,806 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 18:26:44,810 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:26:44,811 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:26:44,811 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 18:26:44,811 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 18:26:44,811 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:26:44,811 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 18:26:44,811 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 18:26:44,812 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 18:26:44,813 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4841 chars
2025-11-11 18:26:45,696 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:26:55,191 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1774 chars
2025-11-11 18:26:55,192 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 18:26:55,192 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 18:26:55,193 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 38244 chars
2025-11-11 18:27:02,094 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:27:02,097 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 868 chars
2025-11-11 18:27:02,097 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:27:02,097 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 18:27:02,097 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:27:02,097 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:27:02,098 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 18:27:02,098 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 18:27:02,099 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 18:27:02,108 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:27:02,108 - agent.streaming_agent - INFO - Agent completed for session sess-hmw5yq8n: 33065.725999999995ms, 7 steps
2025-11-11 18:27:02,109 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 18:29:05,468 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-11 18:29:05,491 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-11 18:29:05,491 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-11 18:29:05,493 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-11 18:29:05,493 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-11 18:29:05,676 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 18:29:05,676 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 18:29:05,676 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 18:29:05,676 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 18:29:05,676 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-11 18:29:05,676 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-11 18:29:05,676 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-11 18:29:05,678 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-11 18:29:05,678 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-11 18:29:05,680 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-11 18:29:05,680 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-11 18:29:05,680 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-11 18:29:05,681 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-11 18:29:05,682 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-11 18:29:05,682 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-11 18:29:05,685 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-11 18:29:05,685 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-11 18:29:05,687 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-11 18:29:05,687 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-11 18:29:06,165 - DuckDbDescribeTableTool - INFO - Found 1 data files in data/duckdb
2025-11-11 18:29:06,242 - DuckDbDescribeTableTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 18:29:06,257 - DuckDbDescribeTableTool - INFO - Initialization complete: 4 views available
2025-11-11 18:29:06,257 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 18:29:06,257 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-11 18:29:06,257 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-11 18:29:06,258 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-11 18:29:06,258 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-11 18:29:06,583 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-11 18:29:06,583 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-11 18:29:06,584 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-11 18:29:06,584 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-11 18:29:06,585 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-11 18:29:06,585 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-11 18:29:06,586 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-11 18:29:06,586 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-11 18:29:06,586 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-11 18:29:06,586 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-11 18:29:06,590 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-11 18:29:06,590 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-11 18:29:06,591 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-11 18:29:06,591 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-11 18:29:06,592 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-11 18:29:06,592 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-11 18:29:06,592 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-11 18:29:06,592 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-11 18:29:06,593 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-11 18:29:06,593 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-11 18:29:06,593 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-11 18:29:06,593 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-11 18:29:06,594 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-11 18:29:06,594 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-11 18:29:06,595 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-11 18:29:06,595 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-11 18:29:06,596 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-11 18:29:06,596 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-11 18:29:06,597 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-11 18:29:06,597 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-11 18:29:06,597 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-11 18:29:06,597 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-11 18:29:06,599 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-11 18:29:06,599 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-11 18:29:06,599 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-11 18:29:06,599 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-11 18:29:06,599 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-11 18:29:06,600 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-11 18:29:06,603 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-11 18:29:06,603 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-11 18:29:06,603 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-11 18:29:06,603 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-11 18:29:06,603 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-11 18:29:06,603 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-11 18:29:06,604 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-11 18:29:06,604 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-11 18:29:06,614 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 18:29:06,614 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 18:29:06,614 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 18:29:06,614 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 18:29:06,614 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-11 18:29:06,614 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-11 18:29:06,614 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-11 18:29:06,614 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-11 18:29:06,614 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-11 18:29:06,614 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-11 18:29:06,614 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-11 18:29:06,615 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-11 18:29:06,615 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-11 18:29:06,615 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-11 18:29:06,615 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-11 18:29:06,616 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-11 18:29:06,616 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-11 18:29:06,616 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-11 18:29:06,616 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-11 18:29:06,617 - DuckDbListFilesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 18:29:06,676 - DuckDbListFilesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 18:29:06,679 - DuckDbListFilesTool - INFO - Initialization complete: 4 views available
2025-11-11 18:29:06,679 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 18:29:06,679 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-11 18:29:06,679 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-11 18:29:06,679 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-11 18:29:06,679 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-11 18:29:06,680 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-11 18:29:06,680 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-11 18:29:06,680 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-11 18:29:06,680 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-11 18:29:06,680 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-11 18:29:06,680 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-11 18:29:06,681 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-11 18:29:06,681 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-11 18:29:06,681 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-11 18:29:06,681 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-11 18:29:06,681 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-11 18:29:06,682 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-11 18:29:06,682 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-11 18:29:06,682 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-11 18:29:06,682 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-11 18:29:06,683 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-11 18:29:06,683 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-11 18:29:06,683 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-11 18:29:06,683 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-11 18:29:06,683 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-11 18:29:06,683 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-11 18:29:06,683 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-11 18:29:06,684 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-11 18:29:06,684 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-11 18:29:06,684 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-11 18:29:06,684 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-11 18:29:06,684 - DuckDbGetStatsTool - INFO - Found 1 data files in data/duckdb
2025-11-11 18:29:06,745 - DuckDbGetStatsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 18:29:06,748 - DuckDbGetStatsTool - INFO - Initialization complete: 4 views available
2025-11-11 18:29:06,748 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 18:29:06,748 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-11 18:29:06,748 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-11 18:29:06,748 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-11 18:29:06,748 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-11 18:29:06,748 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-11 18:29:06,748 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-11 18:29:06,749 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-11 18:29:06,749 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-11 18:29:06,749 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-11 18:29:06,749 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-11 18:29:06,759 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 18:29:06,759 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 18:29:06,759 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 18:29:06,759 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 18:29:06,759 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-11 18:29:06,759 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-11 18:29:06,759 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-11 18:29:06,759 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-11 18:29:06,759 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-11 18:29:06,760 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-11 18:29:06,760 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-11 18:29:06,764 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-11 18:29:06,764 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-11 18:29:06,764 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-11 18:29:06,764 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-11 18:29:06,765 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-11 18:29:06,765 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-11 18:29:06,769 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-11 18:29:06,773 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-11 18:29:06,781 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-11 18:29:06,782 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-11 18:29:06,786 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-11 18:29:06,787 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-11 18:29:06,818 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-11 18:29:06,822 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-11 18:29:06,824 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-11 18:29:06,825 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-11 18:29:06,826 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-11 18:29:06,826 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-11 18:29:06,870 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-11 18:29:06,870 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-11 18:29:06,886 - DuckDbListTablesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 18:29:07,552 - DuckDbListTablesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 18:29:07,560 - DuckDbListTablesTool - INFO - Initialization complete: 4 views available
2025-11-11 18:29:07,561 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 18:29:07,561 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-11 18:29:07,561 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-11 18:29:07,562 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-11 18:29:07,562 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-11 18:29:07,564 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-11 18:29:07,564 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-11 18:29:07,566 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-11 18:29:07,566 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-11 18:29:07,568 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-11 18:29:07,568 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-11 18:29:07,570 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-11 18:29:07,571 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-11 18:29:07,572 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-11 18:29:07,572 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-11 18:29:07,573 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-11 18:29:07,573 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-11 18:29:07,574 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-11 18:29:07,574 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-11 18:29:07,575 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-11 18:29:07,575 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-11 18:29:07,576 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-11 18:29:07,576 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-11 18:29:07,577 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-11 18:29:07,577 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-11 18:29:07,578 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-11 18:29:07,578 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-11 18:29:07,580 - DuckDbAggregateTool - INFO - Found 1 data files in data/duckdb
2025-11-11 18:29:07,711 - DuckDbAggregateTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 18:29:07,715 - DuckDbAggregateTool - INFO - Initialization complete: 4 views available
2025-11-11 18:29:07,715 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 18:29:07,715 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-11 18:29:07,715 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-11 18:29:07,716 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-11 18:29:07,716 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-11 18:29:07,717 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-11 18:29:07,717 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-11 18:29:07,717 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-11 18:29:07,717 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-11 18:29:07,718 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-11 18:29:07,718 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-11 18:29:07,718 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-11 18:29:07,718 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-11 18:29:07,719 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-11 18:29:07,719 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-11 18:29:07,735 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 18:29:07,735 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 18:29:07,735 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 18:29:07,735 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 18:29:07,735 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-11 18:29:07,735 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-11 18:29:07,735 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-11 18:29:07,736 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-11 18:29:07,736 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-11 18:29:07,736 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-11 18:29:07,736 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-11 18:29:07,737 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-11 18:29:07,737 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-11 18:29:07,737 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-11 18:29:07,737 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-11 18:29:07,738 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-11 18:29:07,738 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-11 18:29:07,738 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-11 18:29:07,738 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-11 18:29:07,739 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-11 18:29:07,739 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-11 18:29:07,739 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-11 18:29:07,739 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-11 18:29:07,740 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-11 18:29:07,740 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-11 18:29:07,740 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-11 18:29:07,740 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-11 18:29:07,741 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-11 18:29:07,741 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-11 18:29:07,741 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-11 18:29:07,741 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-11 18:29:07,742 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-11 18:29:07,742 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-11 18:29:07,742 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-11 18:29:07,742 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-11 18:29:07,743 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-11 18:29:07,743 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-11 18:29:07,743 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-11 18:29:07,743 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-11 18:29:07,743 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-11 18:29:07,744 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-11 18:29:07,744 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-11 18:29:07,744 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-11 18:29:07,744 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-11 18:29:07,744 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-11 18:29:07,744 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-11 18:29:07,744 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-11 18:29:07,745 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-11 18:29:07,745 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-11 18:29:07,745 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-11 18:29:07,745 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-11 18:29:07,745 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-11 18:29:07,745 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-11 18:29:07,746 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-11 18:29:07,746 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-11 18:29:07,746 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-11 18:29:07,746 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-11 18:29:07,746 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-11 18:29:07,746 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-11 18:29:07,747 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-11 18:29:07,747 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-11 18:29:07,747 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-11 18:29:07,747 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-11 18:29:07,748 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-11 18:29:07,748 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-11 18:29:07,748 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-11 18:29:07,748 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-11 18:29:07,748 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-11 18:29:07,748 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-11 18:29:07,749 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-11 18:29:07,749 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-11 18:29:07,749 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-11 18:29:07,749 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-11 18:29:07,749 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-11 18:29:07,749 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-11 18:29:07,765 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 18:29:07,765 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 18:29:07,765 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 18:29:07,765 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 18:29:07,765 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-11 18:29:07,765 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-11 18:29:07,765 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-11 18:29:07,766 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-11 18:29:07,766 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-11 18:29:07,766 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-11 18:29:07,766 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-11 18:29:07,766 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-11 18:29:07,766 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-11 18:29:07,767 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-11 18:29:07,767 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-11 18:29:07,767 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-11 18:29:07,767 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-11 18:29:07,768 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-11 18:29:07,768 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-11 18:29:07,768 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-11 18:29:07,768 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-11 18:29:07,768 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-11 18:29:07,768 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-11 18:29:07,768 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-11 18:29:07,769 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-11 18:29:07,769 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-11 18:29:07,769 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-11 18:29:07,769 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-11 18:29:07,769 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-11 18:29:07,770 - DuckDbQueryTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 18:29:07,858 - DuckDbQueryTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 18:29:07,861 - DuckDbQueryTool - INFO - Initialization complete: 4 views available
2025-11-11 18:29:07,862 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 18:29:07,862 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-11 18:29:07,862 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-11 18:29:07,862 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-11 18:29:07,862 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-11 18:29:07,862 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-11 18:29:07,862 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-11 18:29:07,863 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-11 18:29:07,863 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-11 18:29:07,863 - DuckDbRefreshViewsTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 18:29:07,954 - DuckDbRefreshViewsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 18:29:07,962 - DuckDbRefreshViewsTool - INFO - Initialization complete: 4 views available
2025-11-11 18:29:07,963 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 18:29:07,963 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-11 18:29:07,963 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-11 18:29:07,963 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-11 18:29:07,963 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-11 18:29:07,963 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-11 18:29:07,964 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-11 18:29:08,027 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 18:29:08,029 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 18:29:08,029 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 18:29:08,030 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 18:29:08,030 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-11 18:29:08,031 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-11 18:29:08,031 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-11 18:29:08,119 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-11 18:29:08,120 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-11 18:29:08,128 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-11 18:29:08,128 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-11 18:29:08,133 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-11 18:29:08,133 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-11 18:29:08,138 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-11 18:29:08,138 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-11 18:29:08,151 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-11 18:29:08,151 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-11 18:29:08,153 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-11 18:29:08,153 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-11 18:29:08,153 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-11 18:29:08,194 - root - INFO - All routes registered successfully
2025-11-11 18:29:08,195 - werkzeug - WARNING - Werkzeug appears to be used in a production deployment. Consider switching to a production web server instead.
2025-11-11 18:29:08,204 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.68.51:8000
2025-11-11 18:29:08,204 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-11-11 18:29:22,849 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:29:22] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 18:29:22,877 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:29:22] "GET /login?next=http://127.0.0.1:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 18:29:22,910 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:29:22] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 18:29:22,916 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:29:22] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 18:29:22,916 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:29:22] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 18:29:22,963 - root - INFO - WebSocket client connected: p6lFUhXgh1pWaxNeAAAB
2025-11-11 18:29:22,966 - root - INFO - WebSocket client disconnected: p6lFUhXgh1pWaxNeAAAB
2025-11-11 18:29:22,979 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:29:22] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 18:29:22,982 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 18:29:53,246 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 18:29:53,247 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 18:29:53,249 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:29:53] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 18:29:53,279 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:29:53] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 18:29:53,298 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:29:53] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 18:29:53,303 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:29:53] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 18:29:53,306 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:29:53] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 18:29:53,426 - root - INFO - WebSocket client connected: Olz7a-jK78yAU5WyAAAD
2025-11-11 18:29:53,429 - root - INFO - WebSocket client disconnected: Olz7a-jK78yAU5WyAAAD
2025-11-11 18:29:53,441 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:29:53] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 18:29:53,445 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 18:30:04,090 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:30:04] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 18:30:04,109 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:30:04] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 18:30:04,110 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:30:04] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 18:30:04,111 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:30:04] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 18:30:04,169 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:30:04] "GET /socket.io/?EIO=4&transport=polling&t=PfrGKa6 HTTP/1.1" 200 -
2025-11-11 18:30:04,177 - root - INFO - WebSocket client connected: OzrXQnziQNy6ezhVAAAG
2025-11-11 18:30:04,178 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:30:04] "POST /socket.io/?EIO=4&transport=polling&t=PfrGKaD&sid=Gr6yts7jqu-0jgMnAAAE HTTP/1.1" 200 -
2025-11-11 18:30:04,179 - root - INFO - WebSocket client connected: FxT3dmMQ1EZGWBO5AAAH
2025-11-11 18:30:04,179 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:30:04] "GET /socket.io/?EIO=4&transport=polling&t=PfrGKaE&sid=Gr6yts7jqu-0jgMnAAAE HTTP/1.1" 200 -
2025-11-11 18:30:04,184 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:30:04] "POST /socket.io/?EIO=4&transport=polling&t=PfrGKaL.0&sid=Gr6yts7jqu-0jgMnAAAE HTTP/1.1" 200 -
2025-11-11 18:30:04,185 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:30:04] "GET /socket.io/?EIO=4&transport=polling&t=PfrGKaL&sid=Gr6yts7jqu-0jgMnAAAE HTTP/1.1" 200 -
2025-11-11 18:30:04,189 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:30:04] "GET /socket.io/?EIO=4&transport=polling&t=PfrGKaR&sid=Gr6yts7jqu-0jgMnAAAE HTTP/1.1" 200 -
2025-11-11 18:30:04,189 - root - INFO - Client OzrXQnziQNy6ezhVAAAG joined session room: sess-hmw5yq8n
2025-11-11 18:30:04,190 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:30:04] "POST /socket.io/?EIO=4&transport=polling&t=PfrGKaR.0&sid=Gr6yts7jqu-0jgMnAAAE HTTP/1.1" 200 -
2025-11-11 18:30:11,425 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 18:30:11,426 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-hmw5yq8n
2025-11-11 18:30:11,430 - agent.state_manager - INFO - Loaded session state for sess-hmw5yq8n
2025-11-11 18:30:11,430 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 1 turns
2025-11-11 18:30:11,431 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 1 conversation turns
2025-11-11 18:30:11,442 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:30:11,443 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 18:30:11,443 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 18:30:11,444 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 18:30:11,445 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=1, conv_history(str)=6034
2025-11-11 18:30:11,445 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 18:30:11,446 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 18:30:11,447 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 18:30:11,450 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:30:11,450 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 18:30:14,580 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:30:14,599 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain the full details of the top primary limits, including all columns like region_cd, utilization, limit_id, etc. Since no specific new information is being requested that isn't already present in the existing result set, no additional database query is needed.
2025-11-11 18:30:14,600 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 18:30:14,600 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 18:30:14,600 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 18:30:14,603 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:30:18,053 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:30:18,057 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 18:30:18,057 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 18:30:18,057 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 18:30:18,063 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:30:18,063 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 18:30:18,063 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 18:30:18,063 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 18:30:18,063 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 18:30:18,064 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 18:30:18,064 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 18:30:18,064 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 18:30:18,064 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 18:30:18,064 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 18:30:18,064 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 18:30:18,064 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 6034 characters
2025-11-11 18:30:18,064 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 18:30:18,064 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 18:30:18,064 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 18:30:18,064 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 18:30:18,064 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 18:30:18,064 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 18:30:18,064 - tools.impl.nl_to_sql_planner - INFO -     User Query: top primary limits
2025-11-11 18:30:18,064 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 18:30:18,064 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 18:30:18,064 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:30:18,064 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 18:30:18,064 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-11 18:30:18,064 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_in
2025-11-11 18:30:18,065 - tools.impl.nl_to_sql_planner - INFO -     ... (5434 more characters)
2025-11-11 18:30:18,065 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 18:30:21,656 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:30:23,617 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:30:25,169 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 18:30:25,169 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 18:30:25,169 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 18:30:25,170 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 6034
2025-11-11 18:30:25,170 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 18:30:25,170 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 2 SQL code blocks, using LAST (most recent)
2025-11-11 18:30:25,170 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 18:30:25,170 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC...
2025-11-11 18:30:25,170 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 130 characters
2025-11-11 18:30:25,170 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 18:30:25,170 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 18:30:25,170 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 130 characters
2025-11-11 18:30:25,170 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 18:30:25,171 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 18:30:25,171 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 18:30:25,172 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 18:30:25,173 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 18:30:25,173 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10559 chars
2025-11-11 18:30:25,173 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 28601 chars
2025-11-11 18:30:25,173 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 18:30:25,173 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 18:30:27,871 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:30:30,679 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 431 chars
2025-11-11 18:30:30,680 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
    "explanation": "Retrieved top Primary limits for the most recent date, sorted by highest utilization. Assumed 'top' means all results sorted by utilization, not a specific number limit. Used defaults of Primary limit class and most recent date.",
    "target_table": "limits_data"
}
2025-11-11 18:30:30,681 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 18:30:30,681 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 18:30:30,681 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:30:30,682 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:30:30,682 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 18:30:30,682 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 18:30:30,683 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 18:30:30,698 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:30:30,698 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 18:30:30,699 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 18:30:30,699 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 18:30:30,706 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:30:30,707 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:30:30,707 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 18:30:30,708 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:30:30,709 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:30:30,709 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:30:30,709 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 18:30:30,709 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:30:30,833 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 18:30:30,833 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 18:30:30,834 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 18:30:30,837 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:30:30,838 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:30:30,838 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 18:30:30,838 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 18:30:30,838 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:30:30,838 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 18:30:30,839 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 18:30:30,839 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 18:30:30,839 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4841 chars
2025-11-11 18:30:31,690 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:30:41,540 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1884 chars
2025-11-11 18:30:41,540 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 18:30:41,540 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 18:30:41,541 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 39722 chars
2025-11-11 18:30:48,951 - root - INFO - WebSocket client disconnected: OzrXQnziQNy6ezhVAAAG
2025-11-11 18:30:48,952 - root - INFO - WebSocket client disconnected: FxT3dmMQ1EZGWBO5AAAH
2025-11-11 18:30:48,952 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:30:48] "GET /socket.io/?EIO=4&transport=websocket&sid=Gr6yts7jqu-0jgMnAAAE HTTP/1.1" 200 -
2025-11-11 18:30:48,964 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:30:48] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 18:30:48,965 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 18:30:48,987 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:30:48] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 18:30:49,016 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:30:49] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 18:30:49,016 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:30:49] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 18:30:49,093 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:30:49,100 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 868 chars
2025-11-11 18:30:49,101 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:30:49,101 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 18:30:49,101 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:30:49,101 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:30:49,102 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 18:30:49,102 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 18:30:49,102 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 18:30:49,109 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:30:49,109 - agent.streaming_agent - INFO - Agent completed for session sess-hmw5yq8n: 37665.393000000004ms, 8 steps
2025-11-11 18:30:49,110 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 18:37:06,565 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:37:06] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 18:37:06,626 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:37:06] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 18:37:06,646 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:37:06] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 18:37:06,648 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:37:06] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 18:37:06,876 - root - INFO - WebSocket client connected: B8wBZM7ZS3EyinGbAAAJ
2025-11-11 18:37:13,667 - root - INFO - WebSocket client disconnected: B8wBZM7ZS3EyinGbAAAJ
2025-11-11 18:37:13,683 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:37:13] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 18:37:13,686 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:37:13] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 18:37:13,688 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 18:37:13,708 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:37:13] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 18:37:13,728 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:37:13] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 18:37:13,728 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:37:13] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 18:37:13,798 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:37:13] "GET /socket.io/?EIO=4&transport=polling&t=PfrHzSy HTTP/1.1" 200 -
2025-11-11 18:37:13,808 - root - INFO - WebSocket client connected: RXIxmnpldFGwPfAHAAAM
2025-11-11 18:37:13,810 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:37:13] "POST /socket.io/?EIO=4&transport=polling&t=PfrHzT8&sid=DyYnSidaNJjRniIRAAAK HTTP/1.1" 200 -
2025-11-11 18:37:13,810 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:37:13] "GET /socket.io/?EIO=4&transport=polling&t=PfrHzT9&sid=DyYnSidaNJjRniIRAAAK HTTP/1.1" 200 -
2025-11-11 18:37:13,811 - root - INFO - WebSocket client connected: UlXq_EYygOsuny60AAAN
2025-11-11 18:37:13,817 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:37:13] "POST /socket.io/?EIO=4&transport=polling&t=PfrHzTL.0&sid=DyYnSidaNJjRniIRAAAK HTTP/1.1" 200 -
2025-11-11 18:37:13,818 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:37:13] "GET /socket.io/?EIO=4&transport=polling&t=PfrHzTL&sid=DyYnSidaNJjRniIRAAAK HTTP/1.1" 200 -
2025-11-11 18:37:13,821 - root - INFO - Client RXIxmnpldFGwPfAHAAAM joined session room: sess-hmw5yq8n
2025-11-11 18:37:19,468 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 18:37:19,469 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-hmw5yq8n
2025-11-11 18:37:19,472 - agent.state_manager - INFO - Loaded session state for sess-hmw5yq8n
2025-11-11 18:37:19,473 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 2 turns
2025-11-11 18:37:19,473 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 2 conversation turns
2025-11-11 18:37:19,483 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:37:19,484 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 18:37:19,484 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 18:37:19,484 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 18:37:19,485 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=2, conv_history(str)=12155
2025-11-11 18:37:19,485 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 18:37:19,486 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 18:37:19,487 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 18:37:19,493 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:37:19,493 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 18:37:22,900 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:37:22,904 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain the full details of the top primary limits, including all columns and data points. Since the previous results were a comprehensive view of primary limits with full row details, any follow-up analysis or filtering can be done using the existing data without needing a new database query.
2025-11-11 18:37:22,904 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 18:37:22,904 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 18:37:22,905 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 18:37:22,908 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:37:26,036 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:37:26,038 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 18:37:26,038 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 18:37:26,039 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 18:37:26,047 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:37:26,048 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 18:37:26,048 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 18:37:26,049 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 18:37:26,049 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 18:37:26,049 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 18:37:26,049 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 18:37:26,049 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 18:37:26,049 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 18:37:26,049 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 18:37:26,049 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 18:37:26,049 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 12155 characters
2025-11-11 18:37:26,049 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 18:37:26,049 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 18:37:26,049 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 18:37:26,049 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 18:37:26,050 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 18:37:26,050 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 18:37:26,050 - tools.impl.nl_to_sql_planner - INFO -     User Query: top primary limits
2025-11-11 18:37:26,050 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 18:37:26,050 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 18:37:26,050 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:37:26,050 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 18:37:26,050 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-11 18:37:26,050 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_in
2025-11-11 18:37:26,050 - tools.impl.nl_to_sql_planner - INFO -     ... (11555 more characters)
2025-11-11 18:37:26,050 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 18:37:29,785 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:37:32,134 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:37:33,907 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 18:37:33,908 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 18:37:33,908 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 18:37:33,908 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 12155
2025-11-11 18:37:33,908 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 18:37:33,908 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 4 SQL code blocks, using LAST (most recent)
2025-11-11 18:37:33,908 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 18:37:33,908 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC...
2025-11-11 18:37:33,908 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 130 characters
2025-11-11 18:37:33,908 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 18:37:33,908 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 18:37:33,908 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 130 characters
2025-11-11 18:37:33,908 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 18:37:33,908 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 18:37:33,908 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 18:37:33,909 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 18:37:33,909 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 18:37:33,909 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10559 chars
2025-11-11 18:37:33,909 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 34722 chars
2025-11-11 18:37:33,909 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 18:37:33,909 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 18:37:36,849 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:37:39,091 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 442 chars
2025-11-11 18:37:39,091 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
    "explanation": "Retrieved top primary limits for the most recent date, sorted by highest utilization. Assumed 'top' means all results, not a specific number. Filtered for Primary limits and latest date snapshot, ordered by utilization in descending order.",
    "target_table": "limits_data"
}
2025-11-11 18:37:39,092 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 18:37:39,092 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 18:37:39,092 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:37:39,092 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:37:39,094 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 18:37:39,094 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 18:37:39,094 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 18:37:39,104 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:37:39,105 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 18:37:39,105 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 18:37:39,105 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 18:37:39,111 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:37:39,111 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:37:39,112 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 18:37:39,112 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:37:39,112 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:37:39,113 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:37:39,113 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 18:37:39,113 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:37:39,221 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 18:37:39,221 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 18:37:39,222 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 18:37:39,225 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:37:39,225 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:37:39,225 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 18:37:39,225 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 18:37:39,225 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:37:39,225 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 18:37:39,225 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 18:37:39,225 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 18:37:39,226 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4841 chars
2025-11-11 18:37:40,230 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:37:49,732 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1842 chars
2025-11-11 18:37:49,754 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 18:37:49,754 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 18:37:49,767 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 41174 chars
2025-11-11 18:37:56,641 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:37:56,643 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 868 chars
2025-11-11 18:37:56,644 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:37:56,644 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 18:37:56,644 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:37:56,644 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:37:56,644 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 18:37:56,645 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 18:37:56,645 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 18:37:56,651 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:37:56,651 - agent.streaming_agent - INFO - Agent completed for session sess-hmw5yq8n: 37166.686ms, 8 steps
2025-11-11 18:37:56,651 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 18:45:09,394 - root - INFO - WebSocket client disconnected: UlXq_EYygOsuny60AAAN
2025-11-11 18:45:09,417 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:45:09] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 18:45:09,445 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:45:09] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 18:45:09,446 - root - INFO - WebSocket client disconnected: RXIxmnpldFGwPfAHAAAM
2025-11-11 18:45:09,560 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 18:45:09,564 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:45:09] "GET /socket.io/?EIO=4&transport=websocket&sid=DyYnSidaNJjRniIRAAAK HTTP/1.1" 200 -
2025-11-11 18:45:09,604 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:45:09] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 18:45:09,622 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:45:09] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 18:45:09,610 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:45:09] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 18:45:09,762 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:45:09] "GET /socket.io/?EIO=4&transport=polling&t=PfrJnf4 HTTP/1.1" 200 -
2025-11-11 18:45:09,991 - root - INFO - WebSocket client connected: ACGDuG-Mkfg0G-AuAAAQ
2025-11-11 18:45:09,992 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:45:09] "POST /socket.io/?EIO=4&transport=polling&t=PfrJng9&sid=s7TCVdJkpao4ZjiJAAAO HTTP/1.1" 200 -
2025-11-11 18:45:09,993 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:45:09] "GET /socket.io/?EIO=4&transport=polling&t=PfrJngA&sid=s7TCVdJkpao4ZjiJAAAO HTTP/1.1" 200 -
2025-11-11 18:45:10,006 - root - INFO - WebSocket client connected: _UB5S4LH9nLjTdwHAAAR
2025-11-11 18:45:10,012 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:45:10] "GET /socket.io/?EIO=4&transport=polling&t=PfrJnji&sid=s7TCVdJkpao4ZjiJAAAO HTTP/1.1" 200 -
2025-11-11 18:45:10,046 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:45:10] "POST /socket.io/?EIO=4&transport=polling&t=PfrJnjj&sid=s7TCVdJkpao4ZjiJAAAO HTTP/1.1" 200 -
2025-11-11 18:45:10,053 - root - INFO - Client ACGDuG-Mkfg0G-AuAAAQ joined session room: sess-hmw5yq8n
2025-11-11 18:45:17,484 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'primary top limits'
2025-11-11 18:45:17,485 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-hmw5yq8n
2025-11-11 18:45:17,495 - agent.state_manager - INFO - Loaded session state for sess-hmw5yq8n
2025-11-11 18:45:17,496 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 3 turns
2025-11-11 18:45:17,496 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 3 conversation turns
2025-11-11 18:45:17,505 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:45:17,505 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 18:45:17,506 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 18:45:17,506 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 18:45:17,507 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=3, conv_history(str)=18234
2025-11-11 18:45:17,507 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 18:45:17,507 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 18:45:17,508 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 18:45:17,516 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:45:17,517 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 18:45:20,573 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:45:20,576 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain the full details of the top primary limits, including all columns and data points. Any follow-up analysis, filtering, counting, or aggregation can be done using the existing result set without needing a new database query.
2025-11-11 18:45:20,577 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 18:45:20,577 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 18:45:20,578 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 18:45:20,586 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:45:24,191 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:45:24,194 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 18:45:24,194 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 18:45:24,194 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 18:45:24,207 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:45:24,208 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 18:45:24,209 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 18:45:24,209 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 18:45:24,210 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 18:45:24,210 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 18:45:24,210 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 18:45:24,210 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 18:45:24,210 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 18:45:24,211 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 18:45:24,211 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 18:45:24,211 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 18234 characters
2025-11-11 18:45:24,211 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 18:45:24,211 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 18:45:24,211 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 18:45:24,211 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 18:45:24,211 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 18:45:24,211 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 18:45:24,212 - tools.impl.nl_to_sql_planner - INFO -     User Query: top primary limits
2025-11-11 18:45:24,212 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 18:45:24,212 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 18:45:24,212 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:45:24,212 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 18:45:24,212 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-11 18:45:24,212 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_in
2025-11-11 18:45:24,212 - tools.impl.nl_to_sql_planner - INFO -     ... (17634 more characters)
2025-11-11 18:45:24,212 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 18:45:29,003 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:45:31,665 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:45:33,393 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 18:45:33,394 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 18:45:33,395 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 18:45:33,395 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 18234
2025-11-11 18:45:33,395 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 18:45:33,395 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 6 SQL code blocks, using LAST (most recent)
2025-11-11 18:45:33,395 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 18:45:33,395 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC...
2025-11-11 18:45:33,395 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 130 characters
2025-11-11 18:45:33,396 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 18:45:33,396 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 18:45:33,396 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 130 characters
2025-11-11 18:45:33,396 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 18:45:33,396 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 18:45:33,396 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 18:45:33,398 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 18:45:33,398 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: primary top limits
2025-11-11 18:45:33,398 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10559 chars
2025-11-11 18:45:33,399 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 40801 chars
2025-11-11 18:45:33,399 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 18:45:33,399 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 18:45:36,681 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:45:38,766 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 404 chars
2025-11-11 18:45:38,766 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
    "explanation": "Retrieved top Primary limits for the most recent date, sorted by utilization in descending order. Assumed 'top limits' means highest utilized primary limits, defaulting to all columns and no row limit.",
    "target_table": "limits_data"
}
2025-11-11 18:45:38,766 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 18:45:38,766 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 18:45:38,766 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:45:38,767 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:45:38,767 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 18:45:38,767 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 18:45:38,768 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 18:45:38,782 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:45:38,782 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 18:45:38,782 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 18:45:38,783 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 18:45:38,788 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:45:38,788 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:45:38,789 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 18:45:38,789 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:45:38,789 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:45:38,789 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:45:38,789 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 18:45:38,789 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:45:38,954 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 18:45:38,954 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 18:45:38,956 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 18:45:38,964 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:45:38,964 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:45:38,965 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 18:45:38,965 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 18:45:38,965 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:45:38,965 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 18:45:38,965 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 18:45:38,966 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 18:45:38,967 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4841 chars
2025-11-11 18:45:39,815 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:45:49,771 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1720 chars
2025-11-11 18:45:49,772 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 18:45:49,772 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 18:45:49,773 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 42577 chars
2025-11-11 18:45:56,244 - root - INFO - Client ACGDuG-Mkfg0G-AuAAAQ joined session room: sess-4qd6uaed
2025-11-11 18:45:57,061 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:45:57,063 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 868 chars
2025-11-11 18:45:57,063 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:45:57,063 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 18:45:57,063 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:45:57,064 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:45:57,064 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 18:45:57,064 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 18:45:57,067 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 18:45:57,080 - agent.state_manager - INFO - Saved session state for sess-hmw5yq8n (user: admin)
2025-11-11 18:45:57,081 - agent.streaming_agent - INFO - Agent completed for session sess-hmw5yq8n: 39574.18ms, 8 steps
2025-11-11 18:45:57,081 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 18:46:10,781 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limit'
2025-11-11 18:46:10,782 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-4qd6uaed
2025-11-11 18:46:10,783 - agent.state_manager - WARNING - Session sess-4qd6uaed not found
2025-11-11 18:46:10,783 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 18:46:10,791 - agent.state_manager - INFO - Saved session state for sess-4qd6uaed (user: admin)
2025-11-11 18:46:10,791 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 18:46:10,792 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 18:46:10,792 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 18:46:10,792 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 18:46:10,793 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 18:46:10,793 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 18:46:10,793 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 18:46:10,797 - agent.state_manager - INFO - Saved session state for sess-4qd6uaed (user: admin)
2025-11-11 18:46:14,673 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:46:14,676 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 18:46:14,676 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 18:46:14,681 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 18:46:14,686 - agent.state_manager - INFO - Saved session state for sess-4qd6uaed (user: admin)
2025-11-11 18:46:14,687 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 18:46:14,687 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 18:46:14,687 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 18:46:14,687 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 18:46:14,687 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 18:46:14,687 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 18:46:14,687 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 18:46:14,687 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 18:46:14,687 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 18:46:14,687 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 18:46:14,688 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 18:46:14,688 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 18:46:14,688 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 18:46:14,688 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 18:46:14,688 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 18:46:14,688 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 18:46:18,478 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:46:20,306 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:46:22,577 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 18:46:22,577 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limit
2025-11-11 18:46:22,577 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-11 18:46:22,578 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 22599 chars
2025-11-11 18:46:22,578 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 18:46:22,578 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 18:46:25,092 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:46:26,909 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 387 chars
2025-11-11 18:46:26,909 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
  "explanation": "Retrieved top primary limits for the latest date, sorted by utilization in descending order. Applied 'Primary' limit class default since query mentioned 'primary' and was somewhat ambiguous.",
  "target_table": "limits_data"
}
2025-11-11 18:46:26,909 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 18:46:26,909 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 18:46:26,909 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:46:26,909 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:46:26,910 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 18:46:26,910 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 18:46:26,910 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 18:46:26,916 - agent.state_manager - INFO - Saved session state for sess-4qd6uaed (user: admin)
2025-11-11 18:46:26,917 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 18:46:26,917 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 18:46:26,917 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 18:46:26,922 - agent.state_manager - INFO - Saved session state for sess-4qd6uaed (user: admin)
2025-11-11 18:46:26,924 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:46:26,924 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 18:46:26,924 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:46:26,925 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:46:26,925 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:46:26,925 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 18:46:26,925 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:46:27,782 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 18:46:27,824 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 18:46:27,825 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 18:46:27,842 - agent.state_manager - INFO - Saved session state for sess-4qd6uaed (user: admin)
2025-11-11 18:46:27,843 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:46:27,844 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 18:46:27,844 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 18:46:27,844 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:46:27,844 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 18:46:27,844 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 18:46:27,844 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 18:46:27,846 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4839 chars
2025-11-11 18:46:28,802 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:46:36,608 - root - INFO - WebSocket client disconnected: _UB5S4LH9nLjTdwHAAAR
2025-11-11 18:46:36,611 - root - INFO - WebSocket client disconnected: ACGDuG-Mkfg0G-AuAAAQ
2025-11-11 18:46:36,653 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:46:36] "GET /socket.io/?EIO=4&transport=websocket&sid=s7TCVdJkpao4ZjiJAAAO HTTP/1.1" 200 -
2025-11-11 18:46:36,658 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:46:36] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 18:46:36,703 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 18:46:38,030 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1583 chars
2025-11-11 18:46:38,031 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 18:46:38,032 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 18:46:38,033 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 38239 chars
2025-11-11 18:46:46,311 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:46:46,316 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1166 chars
2025-11-11 18:46:46,316 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:46:46,316 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 18:46:46,316 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:46:46,317 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:46:46,317 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 18:46:46,317 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 18:46:46,317 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 18:46:46,327 - agent.state_manager - INFO - Saved session state for sess-4qd6uaed (user: admin)
2025-11-11 18:46:46,327 - agent.streaming_agent - INFO - Agent completed for session sess-4qd6uaed: 35534.525ms, 7 steps
2025-11-11 18:46:46,327 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 18:46:54,288 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:46:54] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 18:46:54,294 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:46:54] "GET /login?next=http://127.0.0.1:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 18:46:54,397 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:46:54] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 18:46:54,397 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:46:54] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 18:47:06,334 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 18:47:06,334 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 18:47:06,335 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:47:06] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 18:47:06,344 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:47:06] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 18:47:06,357 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:47:06] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 18:47:06,358 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:47:06] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 18:47:11,950 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:47:11] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 18:47:11,993 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:47:11] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 18:47:12,060 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:47:12] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 18:47:12,165 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:47:12] "GET /socket.io/?EIO=4&transport=polling&t=PfrKFY9 HTTP/1.1" 200 -
2025-11-11 18:47:12,174 - root - INFO - WebSocket client connected: 09oaCuWQPo7ATfiOAAAU
2025-11-11 18:47:12,176 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:47:12] "POST /socket.io/?EIO=4&transport=polling&t=PfrKFYg&sid=i2fFR9FUKYvGMHX8AAAS HTTP/1.1" 200 -
2025-11-11 18:47:12,183 - root - INFO - WebSocket client connected: K7yAV11W5s2cO9S1AAAV
2025-11-11 18:47:12,229 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:47:12] "GET /socket.io/?EIO=4&transport=polling&t=PfrKFYg.0&sid=i2fFR9FUKYvGMHX8AAAS HTTP/1.1" 200 -
2025-11-11 18:47:12,261 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:47:12] "GET /socket.io/?EIO=4&transport=polling&t=PfrKFZd&sid=i2fFR9FUKYvGMHX8AAAS HTTP/1.1" 200 -
2025-11-11 18:47:12,303 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:47:12] "POST /socket.io/?EIO=4&transport=polling&t=PfrKFZd.0&sid=i2fFR9FUKYvGMHX8AAAS HTTP/1.1" 200 -
2025-11-11 18:47:12,304 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:47:12] "GET /socket.io/?EIO=4&transport=polling&t=PfrKFai&sid=i2fFR9FUKYvGMHX8AAAS HTTP/1.1" 200 -
2025-11-11 18:47:12,307 - root - INFO - Client 09oaCuWQPo7ATfiOAAAU joined session room: sess-g6igj3bv
2025-11-11 18:47:19,234 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 18:47:19,235 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-g6igj3bv
2025-11-11 18:47:19,235 - agent.state_manager - WARNING - Session sess-g6igj3bv not found
2025-11-11 18:47:19,235 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 18:47:19,238 - agent.state_manager - INFO - Saved session state for sess-g6igj3bv (user: admin)
2025-11-11 18:47:19,238 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 18:47:19,238 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 18:47:19,238 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 18:47:19,239 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 18:47:19,239 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 18:47:19,239 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 18:47:19,239 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 18:47:19,240 - agent.state_manager - INFO - Saved session state for sess-g6igj3bv (user: admin)
2025-11-11 18:47:22,220 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:47:22,229 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 18:47:22,230 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 18:47:22,230 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 18:47:22,235 - agent.state_manager - INFO - Saved session state for sess-g6igj3bv (user: admin)
2025-11-11 18:47:22,235 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 18:47:22,236 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 18:47:22,236 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 18:47:22,236 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 18:47:22,236 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 18:47:22,236 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 18:47:22,236 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 18:47:22,237 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 18:47:22,237 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 18:47:22,237 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 18:47:22,237 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 18:47:22,237 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 18:47:22,237 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 18:47:22,238 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 18:47:22,238 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 18:47:22,238 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 18:47:25,314 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:47:26,958 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:47:29,696 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 18:47:29,696 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 18:47:29,696 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-11 18:47:29,696 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 22600 chars
2025-11-11 18:47:29,697 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 18:47:29,697 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 18:47:31,744 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:47:33,931 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 417 chars
2025-11-11 18:47:33,940 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
  "explanation": "Retrieved top primary limits for the latest date, sorted by utilization in descending order. Assumed 'top' means all primary limits, sorted by highest utilization. Used default of limit_class = 'Primary' and latest date.",
  "target_table": "limits_data"
}
2025-11-11 18:47:33,941 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 18:47:33,945 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 18:47:33,945 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:47:33,946 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:47:33,960 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 18:47:33,961 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 18:47:33,962 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 18:47:33,968 - agent.state_manager - INFO - Saved session state for sess-g6igj3bv (user: admin)
2025-11-11 18:47:33,969 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 18:47:33,969 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 18:47:33,969 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 18:47:33,974 - agent.state_manager - INFO - Saved session state for sess-g6igj3bv (user: admin)
2025-11-11 18:47:33,975 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:47:33,975 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 18:47:33,975 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:47:33,976 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:47:33,976 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:47:33,977 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 18:47:33,977 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:47:34,222 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 18:47:34,222 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 18:47:34,222 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 18:47:34,225 - agent.state_manager - INFO - Saved session state for sess-g6igj3bv (user: admin)
2025-11-11 18:47:34,225 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:47:34,225 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 18:47:34,226 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 18:47:34,226 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:47:34,226 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 18:47:34,226 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 18:47:34,226 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 18:47:34,227 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4841 chars
2025-11-11 18:47:35,266 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:47:44,857 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1764 chars
2025-11-11 18:47:44,858 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 18:47:44,858 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 18:47:44,858 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 38271 chars
2025-11-11 18:47:51,377 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:47:51,395 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 806 chars
2025-11-11 18:47:51,396 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:47:51,396 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 18:47:51,396 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:47:51,396 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:47:51,400 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 18:47:51,400 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 18:47:51,400 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 18:47:51,425 - agent.state_manager - INFO - Saved session state for sess-g6igj3bv (user: admin)
2025-11-11 18:47:51,426 - agent.streaming_agent - INFO - Agent completed for session sess-g6igj3bv: 32187.201999999997ms, 7 steps
2025-11-11 18:47:51,426 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 18:48:20,010 - root - INFO - WebSocket client disconnected: K7yAV11W5s2cO9S1AAAV
2025-11-11 18:48:20,012 - root - INFO - WebSocket client disconnected: 09oaCuWQPo7ATfiOAAAU
2025-11-11 18:48:20,013 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:48:20] "GET /socket.io/?EIO=4&transport=websocket&sid=i2fFR9FUKYvGMHX8AAAS HTTP/1.1" 200 -
2025-11-11 18:48:20,018 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:48:20] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 18:48:20,023 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:48:20] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 18:48:20,036 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 18:48:20,057 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:48:20] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 18:48:20,057 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:48:20] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 18:48:20,135 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:48:20] "GET /socket.io/?EIO=4&transport=polling&t=PfrKW8b HTTP/1.1" 200 -
2025-11-11 18:48:20,140 - root - INFO - WebSocket client connected: FOB0pN2k4YEvKFNxAAAY
2025-11-11 18:48:20,141 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:48:20] "POST /socket.io/?EIO=4&transport=polling&t=PfrKW8g&sid=Xb31ZNC3hB1ynN1_AAAW HTTP/1.1" 200 -
2025-11-11 18:48:20,141 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:48:20] "GET /socket.io/?EIO=4&transport=polling&t=PfrKW8g.0&sid=Xb31ZNC3hB1ynN1_AAAW HTTP/1.1" 200 -
2025-11-11 18:48:20,142 - root - INFO - WebSocket client connected: 1Ukj5Q6iViZSVyARAAAZ
2025-11-11 18:48:20,146 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:48:20] "POST /socket.io/?EIO=4&transport=polling&t=PfrKW8l.0&sid=Xb31ZNC3hB1ynN1_AAAW HTTP/1.1" 200 -
2025-11-11 18:48:20,146 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:48:20] "GET /socket.io/?EIO=4&transport=polling&t=PfrKW8l&sid=Xb31ZNC3hB1ynN1_AAAW HTTP/1.1" 200 -
2025-11-11 18:48:20,150 - root - INFO - Client FOB0pN2k4YEvKFNxAAAY joined session room: sess-g6igj3bv
2025-11-11 18:48:20,150 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:48:20] "POST /socket.io/?EIO=4&transport=polling&t=PfrKW8p.0&sid=Xb31ZNC3hB1ynN1_AAAW HTTP/1.1" 200 -
2025-11-11 18:48:20,150 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:48:20] "GET /socket.io/?EIO=4&transport=polling&t=PfrKW8p&sid=Xb31ZNC3hB1ynN1_AAAW HTTP/1.1" 200 -
2025-11-11 18:48:20,153 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:48:20] "GET /socket.io/?EIO=4&transport=polling&t=PfrKW8u&sid=Xb31ZNC3hB1ynN1_AAAW HTTP/1.1" 200 -
2025-11-11 18:48:27,793 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 18:48:27,793 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-g6igj3bv
2025-11-11 18:48:27,795 - agent.state_manager - INFO - Loaded session state for sess-g6igj3bv
2025-11-11 18:48:27,795 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 1 turns
2025-11-11 18:48:27,795 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 1 conversation turns
2025-11-11 18:48:27,800 - agent.state_manager - INFO - Saved session state for sess-g6igj3bv (user: admin)
2025-11-11 18:48:27,800 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 18:48:27,800 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 18:48:27,800 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 18:48:27,800 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=1, conv_history(str)=5962
2025-11-11 18:48:27,800 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 18:48:27,800 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 18:48:27,800 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 18:48:27,803 - agent.state_manager - INFO - Saved session state for sess-g6igj3bv (user: admin)
2025-11-11 18:48:27,803 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 18:48:30,819 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:48:30,822 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain all the columns and details for the primary limits, so no additional database query is required. The full result set includes comprehensive information about each limit, including region, utilization, exposure amounts, and other relevant details that would likely support further analysis or filtering of the existing data.
2025-11-11 18:48:30,822 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 18:48:30,822 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 18:48:30,823 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 18:48:30,829 - agent.state_manager - INFO - Saved session state for sess-g6igj3bv (user: admin)
2025-11-11 18:48:32,687 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:48:32] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 18:48:32,696 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 18:48:32] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 18:48:34,236 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:48:34,238 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 18:48:34,239 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 18:48:34,239 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 18:48:34,243 - agent.state_manager - INFO - Saved session state for sess-g6igj3bv (user: admin)
2025-11-11 18:48:34,243 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 18:48:34,243 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 18:48:34,243 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 18:48:34,244 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 18:48:34,244 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 18:48:34,244 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 18:48:34,244 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 18:48:34,244 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 18:48:34,244 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 18:48:34,244 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 18:48:34,244 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 5962 characters
2025-11-11 18:48:34,244 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 18:48:34,244 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 18:48:34,244 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 18:48:34,244 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 18:48:34,244 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 18:48:34,244 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 18:48:34,244 - tools.impl.nl_to_sql_planner - INFO -     User Query: top primary limits
2025-11-11 18:48:34,244 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 18:48:34,244 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 18:48:34,244 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:48:34,245 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 18:48:34,245 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-11 18:48:34,245 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_in
2025-11-11 18:48:34,245 - tools.impl.nl_to_sql_planner - INFO -     ... (5362 more characters)
2025-11-11 18:48:34,245 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 18:48:37,702 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:48:39,969 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:48:41,497 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 18:48:41,498 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 18:48:41,498 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 18:48:41,498 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 5962
2025-11-11 18:48:41,498 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 18:48:41,498 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 2 SQL code blocks, using LAST (most recent)
2025-11-11 18:48:41,498 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 18:48:41,498 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC...
2025-11-11 18:48:41,499 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 130 characters
2025-11-11 18:48:41,499 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 18:48:41,499 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 18:48:41,499 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 130 characters
2025-11-11 18:48:41,499 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 18:48:41,500 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 18:48:41,500 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 18:48:41,503 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 18:48:41,503 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 18:48:41,503 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10559 chars
2025-11-11 18:48:41,503 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 28529 chars
2025-11-11 18:48:41,503 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 18:48:41,503 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 18:48:43,831 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:48:46,002 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 396 chars
2025-11-11 18:48:46,009 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
  "explanation": "Retrieved all primary limits for the latest date, sorted by highest utilization. Assumed 'top' means sorting by utilization in descending order, and applied 'Primary' limit class filter as a default.",
  "target_table": "limits_data"
}
2025-11-11 18:48:46,011 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 18:48:46,011 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 18:48:46,012 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:48:46,012 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:48:46,034 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 18:48:46,034 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 18:48:46,039 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 18:48:46,062 - agent.state_manager - INFO - Saved session state for sess-g6igj3bv (user: admin)
2025-11-11 18:48:46,062 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 18:48:46,062 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 18:48:46,062 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 18:48:46,088 - agent.state_manager - INFO - Saved session state for sess-g6igj3bv (user: admin)
2025-11-11 18:48:46,092 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:48:46,092 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 18:48:46,093 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 18:48:46,093 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:48:46,093 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:48:46,094 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 18:48:46,094 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 18:48:46,395 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 18:48:46,395 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 18:48:46,396 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 18:48:46,399 - agent.state_manager - INFO - Saved session state for sess-g6igj3bv (user: admin)
2025-11-11 18:48:46,399 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:48:46,399 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 18:48:46,399 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 18:48:46,399 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:48:46,399 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 18:48:46,399 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 18:48:46,399 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 18:48:46,401 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4840 chars
2025-11-11 18:48:47,225 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:48:57,366 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1724 chars
2025-11-11 18:48:57,367 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 18:48:57,367 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 18:48:57,368 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 39629 chars
2025-11-11 18:49:04,137 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 18:49:04,140 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 802 chars
2025-11-11 18:49:04,140 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 18:49:04,141 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 18:49:04,141 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:49:04,141 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 18:49:04,141 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 18:49:04,142 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 18:49:04,143 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 18:49:04,148 - agent.state_manager - INFO - Saved session state for sess-g6igj3bv (user: admin)
2025-11-11 18:49:04,148 - agent.streaming_agent - INFO - Agent completed for session sess-g6igj3bv: 36348.294ms, 8 steps
2025-11-11 18:49:04,148 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 19:00:05,658 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-11 19:00:05,683 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-11 19:00:05,683 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-11 19:00:05,685 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-11 19:00:05,685 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-11 19:00:05,718 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 19:00:05,718 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 19:00:05,718 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 19:00:05,718 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 19:00:05,718 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-11 19:00:05,718 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-11 19:00:05,718 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-11 19:00:05,719 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-11 19:00:05,719 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-11 19:00:05,720 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-11 19:00:05,720 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-11 19:00:05,721 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-11 19:00:05,721 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-11 19:00:05,721 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-11 19:00:05,721 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-11 19:00:05,722 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-11 19:00:05,722 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-11 19:00:05,724 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-11 19:00:05,724 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-11 19:00:06,178 - DuckDbDescribeTableTool - INFO - Found 1 data files in data/duckdb
2025-11-11 19:00:06,242 - DuckDbDescribeTableTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:00:06,253 - DuckDbDescribeTableTool - INFO - Initialization complete: 4 views available
2025-11-11 19:00:06,253 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:00:06,253 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-11 19:00:06,253 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-11 19:00:06,254 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-11 19:00:06,255 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-11 19:00:06,545 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-11 19:00:06,545 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-11 19:00:06,546 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-11 19:00:06,546 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-11 19:00:06,547 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-11 19:00:06,547 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-11 19:00:06,548 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-11 19:00:06,548 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-11 19:00:06,548 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-11 19:00:06,548 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-11 19:00:06,552 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-11 19:00:06,552 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-11 19:00:06,552 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-11 19:00:06,552 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-11 19:00:06,553 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-11 19:00:06,553 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-11 19:00:06,554 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-11 19:00:06,554 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-11 19:00:06,555 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-11 19:00:06,555 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-11 19:00:06,555 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-11 19:00:06,555 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-11 19:00:06,555 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-11 19:00:06,555 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-11 19:00:06,556 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-11 19:00:06,556 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-11 19:00:06,557 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-11 19:00:06,557 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-11 19:00:06,557 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-11 19:00:06,557 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-11 19:00:06,558 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-11 19:00:06,558 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-11 19:00:06,559 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-11 19:00:06,559 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-11 19:00:06,559 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-11 19:00:06,559 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-11 19:00:06,560 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-11 19:00:06,560 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-11 19:00:06,563 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-11 19:00:06,563 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-11 19:00:06,563 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-11 19:00:06,563 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-11 19:00:06,563 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-11 19:00:06,564 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-11 19:00:06,564 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-11 19:00:06,564 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-11 19:00:06,573 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 19:00:06,573 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 19:00:06,573 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 19:00:06,573 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 19:00:06,573 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-11 19:00:06,573 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-11 19:00:06,573 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-11 19:00:06,574 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-11 19:00:06,574 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-11 19:00:06,574 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-11 19:00:06,574 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-11 19:00:06,575 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-11 19:00:06,575 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-11 19:00:06,575 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-11 19:00:06,575 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-11 19:00:06,576 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-11 19:00:06,576 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-11 19:00:06,576 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-11 19:00:06,576 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-11 19:00:06,577 - DuckDbListFilesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 19:00:06,636 - DuckDbListFilesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:00:06,639 - DuckDbListFilesTool - INFO - Initialization complete: 4 views available
2025-11-11 19:00:06,639 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:00:06,639 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-11 19:00:06,639 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-11 19:00:06,639 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-11 19:00:06,639 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-11 19:00:06,639 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-11 19:00:06,639 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-11 19:00:06,640 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-11 19:00:06,640 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-11 19:00:06,640 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-11 19:00:06,640 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-11 19:00:06,641 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-11 19:00:06,641 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-11 19:00:06,641 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-11 19:00:06,641 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-11 19:00:06,641 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-11 19:00:06,641 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-11 19:00:06,642 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-11 19:00:06,642 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-11 19:00:06,642 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-11 19:00:06,642 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-11 19:00:06,642 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-11 19:00:06,642 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-11 19:00:06,643 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-11 19:00:06,643 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-11 19:00:06,643 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-11 19:00:06,643 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-11 19:00:06,643 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-11 19:00:06,643 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-11 19:00:06,643 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-11 19:00:06,643 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-11 19:00:06,644 - DuckDbGetStatsTool - INFO - Found 1 data files in data/duckdb
2025-11-11 19:00:06,702 - DuckDbGetStatsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:00:06,705 - DuckDbGetStatsTool - INFO - Initialization complete: 4 views available
2025-11-11 19:00:06,705 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:00:06,705 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-11 19:00:06,705 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-11 19:00:06,705 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-11 19:00:06,705 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-11 19:00:06,705 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-11 19:00:06,705 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-11 19:00:06,706 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-11 19:00:06,706 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-11 19:00:06,706 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-11 19:00:06,706 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-11 19:00:06,715 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 19:00:06,715 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 19:00:06,715 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 19:00:06,715 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 19:00:06,715 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-11 19:00:06,715 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-11 19:00:06,716 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-11 19:00:06,716 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-11 19:00:06,716 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-11 19:00:06,716 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-11 19:00:06,716 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-11 19:00:06,720 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-11 19:00:06,720 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-11 19:00:06,721 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-11 19:00:06,721 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-11 19:00:06,721 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-11 19:00:06,721 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-11 19:00:06,721 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-11 19:00:06,721 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-11 19:00:06,721 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-11 19:00:06,721 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-11 19:00:06,722 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-11 19:00:06,722 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-11 19:00:06,722 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-11 19:00:06,722 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-11 19:00:06,722 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-11 19:00:06,722 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-11 19:00:06,722 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-11 19:00:06,722 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-11 19:00:06,722 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-11 19:00:06,722 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-11 19:00:06,723 - DuckDbListTablesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 19:00:06,781 - DuckDbListTablesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:00:06,784 - DuckDbListTablesTool - INFO - Initialization complete: 4 views available
2025-11-11 19:00:06,784 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:00:06,784 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-11 19:00:06,784 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-11 19:00:06,784 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-11 19:00:06,784 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-11 19:00:06,785 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-11 19:00:06,785 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-11 19:00:06,785 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-11 19:00:06,785 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-11 19:00:06,785 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-11 19:00:06,785 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-11 19:00:06,786 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-11 19:00:06,786 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-11 19:00:06,786 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-11 19:00:06,786 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-11 19:00:06,786 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-11 19:00:06,787 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-11 19:00:06,787 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-11 19:00:06,787 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-11 19:00:06,787 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-11 19:00:06,787 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-11 19:00:06,787 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-11 19:00:06,787 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-11 19:00:06,788 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-11 19:00:06,788 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-11 19:00:06,788 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-11 19:00:06,788 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-11 19:00:06,789 - DuckDbAggregateTool - INFO - Found 1 data files in data/duckdb
2025-11-11 19:00:06,847 - DuckDbAggregateTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:00:06,849 - DuckDbAggregateTool - INFO - Initialization complete: 4 views available
2025-11-11 19:00:06,849 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:00:06,849 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-11 19:00:06,849 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-11 19:00:06,850 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-11 19:00:06,850 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-11 19:00:06,850 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-11 19:00:06,850 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-11 19:00:06,850 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-11 19:00:06,850 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-11 19:00:06,850 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-11 19:00:06,850 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-11 19:00:06,851 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-11 19:00:06,851 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-11 19:00:06,851 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-11 19:00:06,851 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-11 19:00:06,861 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 19:00:06,861 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 19:00:06,861 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 19:00:06,861 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 19:00:06,861 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-11 19:00:06,861 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-11 19:00:06,861 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-11 19:00:06,861 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-11 19:00:06,861 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-11 19:00:06,861 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-11 19:00:06,861 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-11 19:00:06,862 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-11 19:00:06,862 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-11 19:00:06,862 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-11 19:00:06,862 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-11 19:00:06,862 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-11 19:00:06,862 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-11 19:00:06,862 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-11 19:00:06,862 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-11 19:00:06,863 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-11 19:00:06,863 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-11 19:00:06,863 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-11 19:00:06,863 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-11 19:00:06,863 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-11 19:00:06,863 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-11 19:00:06,863 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-11 19:00:06,863 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-11 19:00:06,864 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-11 19:00:06,864 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-11 19:00:06,864 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-11 19:00:06,864 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-11 19:00:06,864 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-11 19:00:06,864 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-11 19:00:06,865 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-11 19:00:06,865 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-11 19:00:06,865 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-11 19:00:06,865 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-11 19:00:06,865 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-11 19:00:06,865 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-11 19:00:06,866 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-11 19:00:06,866 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-11 19:00:06,866 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-11 19:00:06,866 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-11 19:00:06,866 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-11 19:00:06,866 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-11 19:00:06,866 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-11 19:00:06,866 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-11 19:00:06,866 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-11 19:00:06,866 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-11 19:00:06,866 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-11 19:00:06,867 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-11 19:00:06,867 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-11 19:00:06,867 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-11 19:00:06,867 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-11 19:00:06,867 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-11 19:00:06,867 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-11 19:00:06,867 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-11 19:00:06,868 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-11 19:00:06,868 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-11 19:00:06,868 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-11 19:00:06,868 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-11 19:00:06,868 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-11 19:00:06,868 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-11 19:00:06,869 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-11 19:00:06,869 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-11 19:00:06,869 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-11 19:00:06,869 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-11 19:00:06,869 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-11 19:00:06,869 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-11 19:00:06,870 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-11 19:00:06,870 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-11 19:00:06,870 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-11 19:00:06,870 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-11 19:00:06,870 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-11 19:00:06,870 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-11 19:00:06,879 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 19:00:06,879 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 19:00:06,879 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 19:00:06,879 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 19:00:06,879 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-11 19:00:06,880 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-11 19:00:06,880 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-11 19:00:06,880 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-11 19:00:06,880 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-11 19:00:06,880 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-11 19:00:06,880 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-11 19:00:06,880 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-11 19:00:06,880 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-11 19:00:06,880 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-11 19:00:06,880 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-11 19:00:06,881 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-11 19:00:06,881 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-11 19:00:06,881 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-11 19:00:06,881 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-11 19:00:06,881 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-11 19:00:06,881 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-11 19:00:06,881 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-11 19:00:06,882 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-11 19:00:06,882 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-11 19:00:06,882 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-11 19:00:06,882 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-11 19:00:06,882 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-11 19:00:06,882 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-11 19:00:06,882 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-11 19:00:06,883 - DuckDbQueryTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 19:00:06,941 - DuckDbQueryTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:00:06,943 - DuckDbQueryTool - INFO - Initialization complete: 4 views available
2025-11-11 19:00:06,943 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:00:06,944 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-11 19:00:06,944 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-11 19:00:06,944 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-11 19:00:06,944 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-11 19:00:06,944 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-11 19:00:06,944 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-11 19:00:06,944 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-11 19:00:06,944 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-11 19:00:06,945 - DuckDbRefreshViewsTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 19:00:07,004 - DuckDbRefreshViewsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:00:07,007 - DuckDbRefreshViewsTool - INFO - Initialization complete: 4 views available
2025-11-11 19:00:07,007 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:00:07,007 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-11 19:00:07,007 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-11 19:00:07,007 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-11 19:00:07,008 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-11 19:00:07,008 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-11 19:00:07,008 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-11 19:00:07,018 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 19:00:07,018 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 19:00:07,018 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 19:00:07,018 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 19:00:07,018 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-11 19:00:07,018 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-11 19:00:07,018 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-11 19:00:07,018 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-11 19:00:07,018 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-11 19:00:07,019 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-11 19:00:07,019 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-11 19:00:07,019 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-11 19:00:07,019 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-11 19:00:07,019 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-11 19:00:07,019 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-11 19:00:07,020 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-11 19:00:07,020 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-11 19:00:07,020 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-11 19:00:07,020 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-11 19:00:07,020 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-11 19:00:07,033 - root - INFO - All routes registered successfully
2025-11-11 19:00:07,033 - werkzeug - WARNING - Werkzeug appears to be used in a production deployment. Consider switching to a production web server instead.
2025-11-11 19:00:07,038 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.68.51:8000
2025-11-11 19:00:07,038 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-11-11 19:00:12,968 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:00:12] "GET /socket.io/?EIO=4&transport=polling&t=PfrNEAZ HTTP/1.1" 200 -
2025-11-11 19:00:12,974 - root - INFO - WebSocket client connected: Ld-BQVESxLwyDAtYAAAC
2025-11-11 19:00:12,975 - root - INFO - WebSocket client connected: GcqUsa1FAHrskDBMAAAD
2025-11-11 19:00:12,976 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:00:12] "POST /socket.io/?EIO=4&transport=polling&t=PfrNEAh&sid=Pg1ASUNSOig9QNKiAAAB HTTP/1.1" 200 -
2025-11-11 19:00:12,977 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:00:12] "GET /socket.io/?EIO=4&transport=polling&t=PfrNEAi&sid=Pg1ASUNSOig9QNKiAAAB HTTP/1.1" 200 -
2025-11-11 19:00:12,977 - root - INFO - WebSocket client disconnected: Ld-BQVESxLwyDAtYAAAC
2025-11-11 19:00:12,982 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:00:12] "GET /socket.io/?EIO=4&transport=polling&t=PfrNEAp&sid=Pg1ASUNSOig9QNKiAAAB HTTP/1.1" 200 -
2025-11-11 19:00:12,983 - root - INFO - WebSocket client disconnected: GcqUsa1FAHrskDBMAAAD
2025-11-11 19:00:12,984 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:00:12] "POST /socket.io/?EIO=4&transport=polling&t=PfrNEAq&sid=Pg1ASUNSOig9QNKiAAAB HTTP/1.1" 200 -
2025-11-11 19:00:12,986 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:00:12] "GET /socket.io/?EIO=4&transport=websocket&sid=Pg1ASUNSOig9QNKiAAAB HTTP/1.1" 200 -
2025-11-11 19:00:12,993 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:00:12] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 19:00:12,995 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 19:00:59,573 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:00:59] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 19:00:59,605 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:00:59] "GET /login?next=http://127.0.0.1:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 19:00:59,639 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:00:59] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 19:00:59,645 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:00:59] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 19:00:59,670 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:00:59] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 19:00:59,732 - root - INFO - WebSocket client connected: d21DnAgjnR8qTLA1AAAF
2025-11-11 19:00:59,736 - root - INFO - WebSocket client disconnected: d21DnAgjnR8qTLA1AAAF
2025-11-11 19:00:59,749 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:00:59] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 19:00:59,752 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 19:01:09,136 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 19:01:09,137 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 19:01:09,139 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:01:09] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 19:01:09,160 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:01:09] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 19:01:09,184 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:01:09] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 19:01:09,192 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:01:09] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 19:01:09,195 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:01:09] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 19:01:09,362 - root - INFO - WebSocket client connected: 9FVo7jZ7z4jGhezIAAAH
2025-11-11 19:01:09,365 - root - INFO - WebSocket client disconnected: 9FVo7jZ7z4jGhezIAAAH
2025-11-11 19:01:09,378 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:01:09] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 19:01:09,379 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 19:01:16,172 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:01:16] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 19:01:16,195 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:01:16] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 19:01:16,196 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:01:16] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 19:01:16,196 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:01:16] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 19:01:16,254 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:01:16] "GET /socket.io/?EIO=4&transport=polling&t=PfrNTdK HTTP/1.1" 200 -
2025-11-11 19:01:16,266 - root - INFO - WebSocket client connected: -l992fjLCgqIbOndAAAK
2025-11-11 19:01:16,270 - root - INFO - WebSocket client connected: b3SMQOiT96bIU7uAAAAL
2025-11-11 19:01:16,271 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:01:16] "POST /socket.io/?EIO=4&transport=polling&t=PfrNTdY&sid=G__5FcIXcbUH22CHAAAI HTTP/1.1" 200 -
2025-11-11 19:01:16,273 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:01:16] "GET /socket.io/?EIO=4&transport=polling&t=PfrNTdY.0&sid=G__5FcIXcbUH22CHAAAI HTTP/1.1" 200 -
2025-11-11 19:01:16,277 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:01:16] "GET /socket.io/?EIO=4&transport=polling&t=PfrNTdo&sid=G__5FcIXcbUH22CHAAAI HTTP/1.1" 200 -
2025-11-11 19:01:16,279 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:01:16] "POST /socket.io/?EIO=4&transport=polling&t=PfrNTdo.0&sid=G__5FcIXcbUH22CHAAAI HTTP/1.1" 200 -
2025-11-11 19:01:16,281 - root - INFO - Client b3SMQOiT96bIU7uAAAAL joined session room: sess-g6igj3bv
2025-11-11 19:01:23,332 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 19:01:23,333 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-g6igj3bv
2025-11-11 19:01:23,336 - agent.state_manager - INFO - Loaded session state for sess-g6igj3bv
2025-11-11 19:01:23,336 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 2 turns
2025-11-11 19:01:23,336 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 2 conversation turns
2025-11-11 19:01:23,347 - agent.state_manager - INFO - Saved session state for sess-g6igj3bv (user: admin)
2025-11-11 19:01:23,348 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 19:01:23,348 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 19:01:23,348 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 19:01:23,349 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=2, conv_history(str)=11857
2025-11-11 19:01:23,349 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 19:01:23,350 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 19:01:23,350 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 19:01:23,356 - agent.state_manager - INFO - Saved session state for sess-g6igj3bv (user: admin)
2025-11-11 19:01:23,357 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 19:01:26,544 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:01:26,562 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain all the columns and data needed to answer the follow-up query. The results include comprehensive details about the top primary limits, including full row information for each limit. Since the previous query returned the complete dataset of primary limits with all relevant columns, no additional database query is required.
2025-11-11 19:01:26,562 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 19:01:26,563 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 19:01:26,563 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 19:01:26,568 - agent.state_manager - INFO - Saved session state for sess-g6igj3bv (user: admin)
2025-11-11 19:01:30,254 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:01:30,258 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 19:01:30,259 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 19:01:30,259 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 19:01:30,263 - agent.state_manager - INFO - Saved session state for sess-g6igj3bv (user: admin)
2025-11-11 19:01:30,264 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 19:01:30,264 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:01:30,264 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 19:01:30,264 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:01:30,264 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 19:01:30,264 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 19:01:30,264 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 19:01:30,264 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 19:01:30,264 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 19:01:30,264 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 19:01:30,264 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 11857 characters
2025-11-11 19:01:30,265 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 19:01:30,265 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 19:01:30,265 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 19:01:30,265 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 19:01:30,265 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 19:01:30,266 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 19:01:30,266 - tools.impl.nl_to_sql_planner - INFO -     User Query: top primary limits
2025-11-11 19:01:30,266 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 19:01:30,266 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 19:01:30,266 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 19:01:30,266 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 19:01:30,266 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-11 19:01:30,266 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_in
2025-11-11 19:01:30,266 - tools.impl.nl_to_sql_planner - INFO -     ... (11257 more characters)
2025-11-11 19:01:30,266 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:01:34,324 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:01:36,985 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:01:38,939 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:01:38,939 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 19:01:38,939 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:01:38,939 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 11857
2025-11-11 19:01:38,939 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 19:01:38,939 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 4 SQL code blocks, using LAST (most recent)
2025-11-11 19:01:38,939 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 19:01:38,940 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC...
2025-11-11 19:01:38,940 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 130 characters
2025-11-11 19:01:38,940 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 19:01:38,940 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 19:01:38,940 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 130 characters
2025-11-11 19:01:38,940 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 19:01:38,940 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 19:01:38,940 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:01:38,942 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 19:01:38,942 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 19:01:38,942 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10559 chars
2025-11-11 19:01:38,942 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 34424 chars
2025-11-11 19:01:38,942 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 19:01:38,942 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 19:01:41,583 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:01:43,732 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 411 chars
2025-11-11 19:01:43,733 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
    "explanation": "Retrieved top Primary limits at the most recent date, sorted by highest utilization. Assumed 'top' means all rows, sorted by utilization descending. Applied default filters for Primary limits and latest date.",
    "target_table": "limits_data"
}
2025-11-11 19:01:43,733 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 19:01:43,733 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 19:01:43,734 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:01:43,735 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 19:01:43,736 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 19:01:43,736 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 19:01:43,738 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 19:01:43,745 - agent.state_manager - INFO - Saved session state for sess-g6igj3bv (user: admin)
2025-11-11 19:01:43,746 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 19:01:43,746 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 19:01:43,747 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 19:01:43,752 - agent.state_manager - INFO - Saved session state for sess-g6igj3bv (user: admin)
2025-11-11 19:01:43,752 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:01:43,752 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 19:01:43,753 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 19:01:43,753 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:01:43,753 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:01:43,753 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 19:01:43,753 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:01:43,861 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 19:01:43,861 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 19:01:43,862 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 19:01:43,866 - agent.state_manager - INFO - Saved session state for sess-g6igj3bv (user: admin)
2025-11-11 19:01:43,866 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 19:01:43,866 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 19:01:43,866 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 19:01:43,866 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 19:01:43,866 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 19:01:43,866 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 19:01:43,866 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 19:01:43,867 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4841 chars
2025-11-11 19:01:44,748 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:01:53,897 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1705 chars
2025-11-11 19:01:53,898 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 19:01:53,898 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 19:01:53,899 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 41013 chars
2025-11-11 19:02:00,538 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:02:00,539 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 802 chars
2025-11-11 19:02:00,539 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 19:02:00,540 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 19:02:00,540 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 19:02:00,540 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 19:02:00,541 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 19:02:00,541 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 19:02:00,542 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 19:02:00,564 - agent.state_manager - INFO - Saved session state for sess-g6igj3bv (user: admin)
2025-11-11 19:02:00,565 - agent.streaming_agent - INFO - Agent completed for session sess-g6igj3bv: 37216.093ms, 8 steps
2025-11-11 19:02:00,565 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 19:02:45,465 - root - INFO - Client b3SMQOiT96bIU7uAAAAL joined session room: sess-8ch652p6
2025-11-11 19:02:47,418 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 19:02:47,419 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-8ch652p6
2025-11-11 19:02:47,419 - agent.state_manager - WARNING - Session sess-8ch652p6 not found
2025-11-11 19:02:47,419 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 19:02:47,424 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:02:47,424 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 19:02:47,424 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 19:02:47,424 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 19:02:47,425 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 19:02:47,425 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 19:02:47,425 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 19:02:47,425 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 19:02:47,429 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:02:50,614 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:02:50,619 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 19:02:50,619 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 19:02:50,620 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 19:02:50,627 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:02:50,628 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 19:02:50,629 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:02:50,629 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 19:02:50,629 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:02:50,629 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 19:02:50,629 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 19:02:50,629 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 19:02:50,629 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 19:02:50,629 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 19:02:50,629 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 19:02:50,629 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 19:02:50,630 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 19:02:50,630 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 19:02:50,630 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 19:02:50,630 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 19:02:50,630 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:02:53,639 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:02:55,614 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:02:57,885 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 19:02:57,886 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 19:02:57,886 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-11 19:02:57,886 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 22600 chars
2025-11-11 19:02:57,886 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 19:02:57,886 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 19:02:59,956 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:03:02,323 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 443 chars
2025-11-11 19:03:02,324 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
  "explanation": "Retrieve top primary limits for the latest date, sorted by utilization in descending order. Assumed 'top' means all primary limits, sorted by highest utilization. Used default of 'Primary' limit class since query specifically mentioned 'primary'.",
  "target_table": "limits_data"
}
2025-11-11 19:03:02,324 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 19:03:02,324 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 19:03:02,325 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:03:02,326 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 19:03:02,326 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 19:03:02,327 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 19:03:02,327 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 19:03:02,334 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:03:02,336 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 19:03:02,337 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 19:03:02,337 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 19:03:02,343 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:03:02,343 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:03:02,344 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 19:03:02,344 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 19:03:02,345 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:03:02,345 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:03:02,345 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 19:03:02,345 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:03:02,481 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 19:03:02,481 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 19:03:02,482 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 19:03:02,486 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:03:02,486 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 19:03:02,487 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 19:03:02,487 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 19:03:02,487 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 19:03:02,487 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 19:03:02,487 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 19:03:02,487 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 19:03:02,488 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4840 chars
2025-11-11 19:03:03,412 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:03:13,055 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1848 chars
2025-11-11 19:03:13,056 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 19:03:13,057 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 19:03:13,058 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 38296 chars
2025-11-11 19:03:21,537 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:03:21,539 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1043 chars
2025-11-11 19:03:21,539 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 19:03:21,539 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 19:03:21,539 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 19:03:21,539 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 19:03:21,539 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 19:03:21,539 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 19:03:21,539 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 19:03:21,545 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:03:21,545 - agent.streaming_agent - INFO - Agent completed for session sess-8ch652p6: 34120.578ms, 7 steps
2025-11-11 19:03:21,545 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 19:06:58,712 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-11 19:06:58,752 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-11 19:06:58,752 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-11 19:06:58,755 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-11 19:06:58,755 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-11 19:06:58,805 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 19:06:58,805 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 19:06:58,805 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 19:06:58,805 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 19:06:58,805 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-11 19:06:58,805 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-11 19:06:58,805 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-11 19:06:58,806 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-11 19:06:58,807 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-11 19:06:58,808 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-11 19:06:58,808 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-11 19:06:58,808 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-11 19:06:58,808 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-11 19:06:58,809 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-11 19:06:58,809 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-11 19:06:58,811 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-11 19:06:58,811 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-11 19:06:58,813 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-11 19:06:58,813 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-11 19:06:59,472 - DuckDbDescribeTableTool - INFO - Found 1 data files in data/duckdb
2025-11-11 19:06:59,556 - DuckDbDescribeTableTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:06:59,572 - DuckDbDescribeTableTool - INFO - Initialization complete: 4 views available
2025-11-11 19:06:59,572 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:06:59,573 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-11 19:06:59,573 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-11 19:06:59,575 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-11 19:06:59,575 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-11 19:07:00,519 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-11 19:07:00,519 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-11 19:07:00,523 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-11 19:07:00,523 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-11 19:07:00,525 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-11 19:07:00,525 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-11 19:07:00,526 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-11 19:07:00,526 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-11 19:07:00,526 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-11 19:07:00,527 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-11 19:07:00,534 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-11 19:07:00,534 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-11 19:07:00,535 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-11 19:07:00,535 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-11 19:07:00,537 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-11 19:07:00,538 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-11 19:07:00,538 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-11 19:07:00,538 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-11 19:07:00,539 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-11 19:07:00,539 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-11 19:07:00,540 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-11 19:07:00,540 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-11 19:07:00,542 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-11 19:07:00,542 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-11 19:07:00,544 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-11 19:07:00,544 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-11 19:07:00,546 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-11 19:07:00,546 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-11 19:07:00,547 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-11 19:07:00,547 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-11 19:07:00,548 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-11 19:07:00,549 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-11 19:07:00,551 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-11 19:07:00,552 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-11 19:07:00,552 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-11 19:07:00,552 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-11 19:07:00,553 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-11 19:07:00,553 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-11 19:07:00,559 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-11 19:07:00,559 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-11 19:07:00,559 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-11 19:07:00,560 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-11 19:07:00,560 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-11 19:07:00,560 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-11 19:07:00,561 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-11 19:07:00,561 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-11 19:07:00,579 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 19:07:00,579 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 19:07:00,579 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 19:07:00,579 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 19:07:00,579 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-11 19:07:00,580 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-11 19:07:00,580 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-11 19:07:00,580 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-11 19:07:00,580 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-11 19:07:00,581 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-11 19:07:00,581 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-11 19:07:00,583 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-11 19:07:00,584 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-11 19:07:00,584 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-11 19:07:00,584 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-11 19:07:00,585 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-11 19:07:00,585 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-11 19:07:00,586 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-11 19:07:00,586 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-11 19:07:00,587 - DuckDbListFilesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 19:07:01,708 - DuckDbListFilesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:07:01,718 - DuckDbListFilesTool - INFO - Initialization complete: 4 views available
2025-11-11 19:07:01,719 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:07:01,719 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-11 19:07:01,719 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-11 19:07:01,721 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-11 19:07:01,721 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-11 19:07:01,726 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-11 19:07:01,728 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-11 19:07:01,730 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-11 19:07:01,730 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-11 19:07:01,737 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-11 19:07:01,737 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-11 19:07:01,738 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-11 19:07:01,739 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-11 19:07:01,756 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-11 19:07:01,756 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-11 19:07:01,763 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-11 19:07:01,786 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-11 19:07:01,806 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-11 19:07:01,808 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-11 19:07:01,879 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-11 19:07:01,880 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-11 19:07:01,882 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-11 19:07:01,882 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-11 19:07:01,887 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-11 19:07:01,897 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-11 19:07:01,922 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-11 19:07:01,923 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-11 19:07:01,924 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-11 19:07:01,924 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-11 19:07:01,926 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-11 19:07:01,926 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-11 19:07:01,929 - DuckDbGetStatsTool - INFO - Found 1 data files in data/duckdb
2025-11-11 19:07:02,081 - DuckDbGetStatsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:07:02,087 - DuckDbGetStatsTool - INFO - Initialization complete: 4 views available
2025-11-11 19:07:02,087 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:07:02,087 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-11 19:07:02,087 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-11 19:07:02,088 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-11 19:07:02,088 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-11 19:07:02,089 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-11 19:07:02,089 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-11 19:07:02,089 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-11 19:07:02,090 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-11 19:07:02,090 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-11 19:07:02,090 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-11 19:07:02,114 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 19:07:02,115 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 19:07:02,115 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 19:07:02,115 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 19:07:02,115 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-11 19:07:02,115 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-11 19:07:02,115 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-11 19:07:02,116 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-11 19:07:02,116 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-11 19:07:02,117 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-11 19:07:02,117 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-11 19:07:02,123 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-11 19:07:02,123 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-11 19:07:02,124 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-11 19:07:02,124 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-11 19:07:02,125 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-11 19:07:02,125 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-11 19:07:02,125 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-11 19:07:02,125 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-11 19:07:02,126 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-11 19:07:02,126 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-11 19:07:02,126 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-11 19:07:02,126 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-11 19:07:02,127 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-11 19:07:02,127 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-11 19:07:02,127 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-11 19:07:02,128 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-11 19:07:02,128 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-11 19:07:02,128 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-11 19:07:02,129 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-11 19:07:02,129 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-11 19:07:02,130 - DuckDbListTablesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 19:07:02,243 - DuckDbListTablesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:07:02,248 - DuckDbListTablesTool - INFO - Initialization complete: 4 views available
2025-11-11 19:07:02,248 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:07:02,248 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-11 19:07:02,248 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-11 19:07:02,249 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-11 19:07:02,249 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-11 19:07:02,249 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-11 19:07:02,249 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-11 19:07:02,250 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-11 19:07:02,250 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-11 19:07:02,251 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-11 19:07:02,251 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-11 19:07:02,252 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-11 19:07:02,252 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-11 19:07:02,253 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-11 19:07:02,253 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-11 19:07:02,254 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-11 19:07:02,254 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-11 19:07:02,254 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-11 19:07:02,255 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-11 19:07:02,255 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-11 19:07:02,255 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-11 19:07:02,256 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-11 19:07:02,256 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-11 19:07:02,256 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-11 19:07:02,256 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-11 19:07:02,257 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-11 19:07:02,257 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-11 19:07:02,258 - DuckDbAggregateTool - INFO - Found 1 data files in data/duckdb
2025-11-11 19:07:02,365 - DuckDbAggregateTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:07:02,370 - DuckDbAggregateTool - INFO - Initialization complete: 4 views available
2025-11-11 19:07:02,370 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:07:02,370 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-11 19:07:02,370 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-11 19:07:02,371 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-11 19:07:02,371 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-11 19:07:02,373 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-11 19:07:02,373 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-11 19:07:02,374 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-11 19:07:02,374 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-11 19:07:02,374 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-11 19:07:02,375 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-11 19:07:02,375 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-11 19:07:02,375 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-11 19:07:02,375 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-11 19:07:02,375 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-11 19:07:02,391 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 19:07:02,392 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 19:07:02,392 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 19:07:02,392 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 19:07:02,392 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-11 19:07:02,392 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-11 19:07:02,392 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-11 19:07:02,392 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-11 19:07:02,392 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-11 19:07:02,393 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-11 19:07:02,393 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-11 19:07:02,393 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-11 19:07:02,393 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-11 19:07:02,394 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-11 19:07:02,394 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-11 19:07:02,394 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-11 19:07:02,394 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-11 19:07:02,394 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-11 19:07:02,394 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-11 19:07:02,395 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-11 19:07:02,395 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-11 19:07:02,396 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-11 19:07:02,396 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-11 19:07:02,397 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-11 19:07:02,397 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-11 19:07:02,398 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-11 19:07:02,398 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-11 19:07:02,398 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-11 19:07:02,399 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-11 19:07:02,399 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-11 19:07:02,399 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-11 19:07:02,399 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-11 19:07:02,399 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-11 19:07:02,400 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-11 19:07:02,400 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-11 19:07:02,400 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-11 19:07:02,400 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-11 19:07:02,401 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-11 19:07:02,401 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-11 19:07:02,401 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-11 19:07:02,401 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-11 19:07:02,401 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-11 19:07:02,401 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-11 19:07:02,402 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-11 19:07:02,402 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-11 19:07:02,402 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-11 19:07:02,402 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-11 19:07:02,402 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-11 19:07:02,402 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-11 19:07:02,403 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-11 19:07:02,403 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-11 19:07:02,403 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-11 19:07:02,403 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-11 19:07:02,403 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-11 19:07:02,403 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-11 19:07:02,404 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-11 19:07:02,404 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-11 19:07:02,404 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-11 19:07:02,404 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-11 19:07:02,404 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-11 19:07:02,404 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-11 19:07:02,404 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-11 19:07:02,405 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-11 19:07:02,406 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-11 19:07:02,406 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-11 19:07:02,406 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-11 19:07:02,406 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-11 19:07:02,406 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-11 19:07:02,406 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-11 19:07:02,406 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-11 19:07:02,406 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-11 19:07:02,407 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-11 19:07:02,407 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-11 19:07:02,408 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-11 19:07:02,408 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-11 19:07:02,440 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 19:07:02,440 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 19:07:02,440 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 19:07:02,440 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 19:07:02,440 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-11 19:07:02,440 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-11 19:07:02,440 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-11 19:07:02,441 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-11 19:07:02,441 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-11 19:07:02,441 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-11 19:07:02,442 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-11 19:07:02,442 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-11 19:07:02,442 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-11 19:07:02,442 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-11 19:07:02,442 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-11 19:07:02,443 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-11 19:07:02,443 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-11 19:07:02,444 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-11 19:07:02,444 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-11 19:07:02,444 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-11 19:07:02,444 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-11 19:07:02,444 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-11 19:07:02,444 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-11 19:07:02,445 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-11 19:07:02,445 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-11 19:07:02,445 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-11 19:07:02,445 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-11 19:07:02,445 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-11 19:07:02,445 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-11 19:07:02,446 - DuckDbQueryTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 19:07:02,551 - DuckDbQueryTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:07:02,555 - DuckDbQueryTool - INFO - Initialization complete: 4 views available
2025-11-11 19:07:02,555 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:07:02,555 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-11 19:07:02,555 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-11 19:07:02,556 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-11 19:07:02,556 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-11 19:07:02,557 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-11 19:07:02,557 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-11 19:07:02,557 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-11 19:07:02,557 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-11 19:07:02,558 - DuckDbRefreshViewsTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 19:07:02,633 - DuckDbRefreshViewsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:07:02,636 - DuckDbRefreshViewsTool - INFO - Initialization complete: 4 views available
2025-11-11 19:07:02,636 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:07:02,636 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-11 19:07:02,636 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-11 19:07:02,637 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-11 19:07:02,637 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-11 19:07:02,637 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-11 19:07:02,637 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-11 19:07:02,648 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 19:07:02,648 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 19:07:02,648 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 19:07:02,648 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 19:07:02,649 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-11 19:07:02,649 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-11 19:07:02,649 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-11 19:07:02,649 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-11 19:07:02,649 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-11 19:07:02,649 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-11 19:07:02,650 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-11 19:07:02,650 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-11 19:07:02,650 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-11 19:07:02,650 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-11 19:07:02,650 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-11 19:07:02,650 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-11 19:07:02,650 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-11 19:07:02,651 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-11 19:07:02,651 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-11 19:07:02,651 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-11 19:07:02,666 - root - INFO - All routes registered successfully
2025-11-11 19:07:02,667 - werkzeug - WARNING - Werkzeug appears to be used in a production deployment. Consider switching to a production web server instead.
2025-11-11 19:07:02,673 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.68.51:8000
2025-11-11 19:07:02,673 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-11-11 19:07:05,023 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:07:05] "GET /socket.io/?EIO=4&transport=polling&t=PfrOomo HTTP/1.1" 200 -
2025-11-11 19:07:05,030 - root - INFO - WebSocket client connected: SBnJ2c49-v7unC6dAAAC
2025-11-11 19:07:05,038 - root - INFO - WebSocket client connected: DozeD16qwS5FQIkYAAAD
2025-11-11 19:07:05,040 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:07:05] "POST /socket.io/?EIO=4&transport=polling&t=PfrOon7&sid=spGT6TJY-PGAjgD0AAAB HTTP/1.1" 200 -
2025-11-11 19:07:05,043 - root - INFO - WebSocket client disconnected: SBnJ2c49-v7unC6dAAAC
2025-11-11 19:07:05,047 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:07:05] "GET /socket.io/?EIO=4&transport=polling&t=PfrOonA&sid=spGT6TJY-PGAjgD0AAAB HTTP/1.1" 200 -
2025-11-11 19:07:05,053 - root - INFO - WebSocket client disconnected: DozeD16qwS5FQIkYAAAD
2025-11-11 19:07:05,058 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:07:05] "GET /socket.io/?EIO=4&transport=websocket&sid=spGT6TJY-PGAjgD0AAAB HTTP/1.1" 200 -
2025-11-11 19:07:05,061 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:07:05] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 19:07:05,073 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 19:08:41,991 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:08:41] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 19:08:42,025 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:08:42] "GET /login?next=http://127.0.0.1:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 19:08:42,058 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:08:42] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 19:08:42,059 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:08:42] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 19:08:42,107 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:08:42] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 19:08:42,175 - root - INFO - WebSocket client connected: oc6uluX9IjJLX2VyAAAF
2025-11-11 19:08:42,178 - root - INFO - WebSocket client disconnected: oc6uluX9IjJLX2VyAAAF
2025-11-11 19:08:42,191 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:08:42] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 19:08:42,193 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 19:08:46,759 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 19:08:46,759 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 19:08:46,760 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:08:46] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 19:08:46,782 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:08:46] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 19:08:46,808 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:08:46] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 19:08:46,808 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:08:46] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 19:08:46,809 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:08:46] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 19:08:46,958 - root - INFO - WebSocket client connected: bXSqpdWA3QZ1vhB1AAAH
2025-11-11 19:08:46,961 - root - INFO - WebSocket client disconnected: bXSqpdWA3QZ1vhB1AAAH
2025-11-11 19:08:46,973 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:08:46] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 19:08:46,974 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 19:08:55,581 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:08:55] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 19:08:55,601 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:08:55] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 19:08:55,605 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:08:55] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 19:08:55,607 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:08:55] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 19:08:55,658 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:08:55] "GET /socket.io/?EIO=4&transport=polling&t=PfrPDne HTTP/1.1" 200 -
2025-11-11 19:08:55,665 - root - INFO - WebSocket client connected: 43abmIF14C0gTDFKAAAJ
2025-11-11 19:08:55,666 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:08:55] "POST /socket.io/?EIO=4&transport=polling&t=PfrPDnh&sid=r2eJWNWB8UOmhCGOAAAI HTTP/1.1" 200 -
2025-11-11 19:08:55,668 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:08:55] "GET /socket.io/?EIO=4&transport=polling&t=PfrPDni&sid=r2eJWNWB8UOmhCGOAAAI HTTP/1.1" 200 -
2025-11-11 19:08:55,672 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:08:55] "GET /socket.io/?EIO=4&transport=polling&t=PfrPDns&sid=r2eJWNWB8UOmhCGOAAAI HTTP/1.1" 200 -
2025-11-11 19:08:55,673 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:08:55] "POST /socket.io/?EIO=4&transport=polling&t=PfrPDnt&sid=r2eJWNWB8UOmhCGOAAAI HTTP/1.1" 200 -
2025-11-11 19:08:55,675 - root - INFO - Client 43abmIF14C0gTDFKAAAJ joined session room: sess-8ch652p6
2025-11-11 19:08:55,682 - root - INFO - WebSocket client connected: LRWTAVC_MY5fASwcAAAL
2025-11-11 19:09:00,874 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 19:09:00,874 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-8ch652p6
2025-11-11 19:09:00,878 - agent.state_manager - INFO - Loaded session state for sess-8ch652p6
2025-11-11 19:09:00,878 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 1 turns
2025-11-11 19:09:00,878 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 1 conversation turns
2025-11-11 19:09:00,891 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:09:00,891 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 19:09:00,892 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 19:09:00,892 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 19:09:00,892 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=1, conv_history(str)=6283
2025-11-11 19:09:00,893 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 19:09:00,893 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 19:09:00,894 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 19:09:00,897 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:09:00,898 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 19:09:04,278 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:09:04,297 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain all the detailed information about the primary limits, including full row data for each limit. Since the previous results include comprehensive columns like region_cd, industry, utilization, exposure_amt, and other key metrics, no additional database query is required to analyze or filter these existing results.
2025-11-11 19:09:04,298 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 19:09:04,298 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 19:09:04,298 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 19:09:04,301 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:09:07,763 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:09:07,765 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 19:09:07,766 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 19:09:07,766 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 19:09:07,770 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:09:07,771 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 19:09:07,771 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:09:07,771 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 19:09:07,771 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:09:07,771 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 19:09:07,771 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 19:09:07,771 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 19:09:07,771 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 19:09:07,771 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 19:09:07,771 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 19:09:07,771 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 6283 characters
2025-11-11 19:09:07,771 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 19:09:07,771 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 19:09:07,771 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 19:09:07,772 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 19:09:07,772 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 19:09:07,772 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 19:09:07,772 - tools.impl.nl_to_sql_planner - INFO -     User Query: top primary limits
2025-11-11 19:09:07,772 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 19:09:07,772 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 19:09:07,772 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 19:09:07,772 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 19:09:07,772 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-11 19:09:07,772 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_in
2025-11-11 19:09:07,772 - tools.impl.nl_to_sql_planner - INFO -     ... (5683 more characters)
2025-11-11 19:09:07,772 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:09:11,544 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:09:13,764 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:09:15,495 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:09:15,495 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 19:09:15,495 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:09:15,496 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 6283
2025-11-11 19:09:15,496 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 19:09:15,496 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 2 SQL code blocks, using LAST (most recent)
2025-11-11 19:09:15,496 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 19:09:15,496 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC...
2025-11-11 19:09:15,496 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 130 characters
2025-11-11 19:09:15,496 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 19:09:15,496 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 19:09:15,496 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 130 characters
2025-11-11 19:09:15,497 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 19:09:15,497 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 19:09:15,497 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:09:15,499 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 19:09:15,499 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 19:09:15,499 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10559 chars
2025-11-11 19:09:15,499 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 28850 chars
2025-11-11 19:09:15,499 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 19:09:15,499 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 19:09:17,791 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:09:19,963 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 404 chars
2025-11-11 19:09:19,964 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
  "explanation": "Retrieved top Primary limits at the latest date, sorted by highest utilization. Assumed 'top' means sorting by utilization in descending order, and applied 'Primary' limit class filter with most recent date.",
  "target_table": "limits_data"
}
2025-11-11 19:09:19,964 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 19:09:19,964 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 19:09:19,964 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:09:19,964 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 19:09:19,964 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 19:09:19,965 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 19:09:19,965 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 19:09:19,968 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:09:19,969 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 19:09:19,969 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 19:09:19,969 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 19:09:19,972 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:09:19,972 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:09:19,972 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 19:09:19,972 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 19:09:19,972 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:09:19,972 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:09:19,972 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 19:09:19,972 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:09:20,088 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 19:09:20,089 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 19:09:20,089 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 19:09:20,093 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:09:20,093 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 19:09:20,094 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 19:09:20,094 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 19:09:20,094 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 19:09:20,094 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 19:09:20,094 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 19:09:20,094 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 19:09:20,095 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4841 chars
2025-11-11 19:09:20,862 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:09:30,861 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1796 chars
2025-11-11 19:09:30,862 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 19:09:30,863 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 19:09:30,863 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 39892 chars
2025-11-11 19:09:37,759 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:09:37,761 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 809 chars
2025-11-11 19:09:37,761 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 19:09:37,761 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 19:09:37,761 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 19:09:37,761 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 19:09:37,762 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 19:09:37,762 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 19:09:37,763 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 19:09:37,776 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:09:37,776 - agent.streaming_agent - INFO - Agent completed for session sess-8ch652p6: 36883.679000000004ms, 8 steps
2025-11-11 19:09:37,776 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 19:10:48,388 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'what does delta mean'
2025-11-11 19:10:48,390 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-8ch652p6
2025-11-11 19:10:48,396 - agent.state_manager - INFO - Loaded session state for sess-8ch652p6
2025-11-11 19:10:48,396 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 2 turns
2025-11-11 19:10:48,396 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 2 conversation turns
2025-11-11 19:10:48,403 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:10:48,403 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 19:10:48,403 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 19:10:48,403 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 19:10:48,403 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=2, conv_history(str)=12257
2025-11-11 19:10:48,404 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 19:10:48,404 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 19:10:48,404 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 19:10:48,408 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:10:48,408 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 19:10:51,332 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:10:51,334 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain all the detailed information about the top primary limits, including full row data for each limit. Since the previous results showed the complete set of primary limits with their full details, no additional database query is needed to analyze these limits further.
2025-11-11 19:10:51,335 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 19:10:51,335 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 19:10:51,335 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 19:10:51,344 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:10:55,070 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:10:55,072 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 19:10:55,072 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 19:10:55,073 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 19:10:55,081 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:10:55,081 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=0, columns=0, rows=0, sql=N/A
2025-11-11 19:10:55,081 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: False, has 'columns' key: False
2025-11-11 19:10:55,082 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=0, columns=0, rows=0, query_length=0
2025-11-11 19:10:55,082 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 19:10:55,082 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 19:10:55,084 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 336 chars
2025-11-11 19:10:55,683 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:11:02,286 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1294 chars
2025-11-11 19:11:02,287 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 19:11:02,287 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 19:11:02,288 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 40121 chars
2025-11-11 19:11:04,495 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:11:10,765 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1147 chars
2025-11-11 19:11:10,766 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=0, columns=0, rows=0, query=MISSING
2025-11-11 19:11:10,766 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=0, columns=0, rows=0, has_query=False
2025-11-11 19:11:10,766 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=N/A...
2025-11-11 19:11:10,766 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): N/A...
2025-11-11 19:11:10,775 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:11:10,775 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for end: data keys = ['raw_table', 'response', 'prompt_monitor', 'node_output', 'node_reasoning']
2025-11-11 19:11:10,775 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for end with 5 data keys
2025-11-11 19:11:10,776 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for end
2025-11-11 19:11:10,776 - agent.streaming_agent - INFO - Agent completed for session sess-8ch652p6: 22372.947ms, 4 steps
2025-11-11 19:11:10,776 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=0, columns=0, rows=0
2025-11-11 19:11:13,804 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'what column does delta mapos to in the data set'
2025-11-11 19:11:13,805 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-8ch652p6
2025-11-11 19:11:13,806 - agent.state_manager - INFO - Loaded session state for sess-8ch652p6
2025-11-11 19:11:13,807 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 3 turns
2025-11-11 19:11:13,807 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 3 conversation turns
2025-11-11 19:11:13,815 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:11:13,816 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 19:11:13,816 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 19:11:13,816 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 19:11:13,816 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=3, conv_history(str)=14786
2025-11-11 19:11:13,816 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 19:11:13,817 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 19:11:13,817 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 19:11:13,821 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:11:13,822 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 19:11:17,711 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:11:17,713 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain detailed information about Delta limits, specifically showing two PV01 Delta limits (Canadian Options and Oil Products NGL Trading). The data includes full context about these Delta-type limits, such as their exposure amounts, utilization, and other relevant details. No additional database query is required to provide further information about Delta in this context.
2025-11-11 19:11:17,714 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 19:11:17,714 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 19:11:17,714 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 19:11:17,725 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:11:21,693 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:11:21,694 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 19:11:21,694 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 19:11:21,694 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 19:11:21,700 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:11:21,700 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 19:11:21,700 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:11:21,700 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 19:11:21,700 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:11:21,701 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 19:11:21,701 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 19:11:21,701 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 19:11:21,701 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 19:11:21,701 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 19:11:21,701 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 19:11:21,701 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 14786 characters
2025-11-11 19:11:21,701 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 19:11:21,701 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 19:11:21,701 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 19:11:21,701 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 19:11:21,701 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 19:11:21,701 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 19:11:21,701 - tools.impl.nl_to_sql_planner - INFO -     User Query: top primary limits
2025-11-11 19:11:21,701 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 19:11:21,701 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 19:11:21,701 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 19:11:21,701 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 19:11:21,701 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-11 19:11:21,701 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_in
2025-11-11 19:11:21,701 - tools.impl.nl_to_sql_planner - INFO -     ... (14186 more characters)
2025-11-11 19:11:21,701 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:11:24,998 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:11:25,790 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:11:29,272 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 19:11:29,273 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 19:11:29,273 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 19:11:29,284 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:11:29,285 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 19:11:29,285 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 19:11:29,286 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 19:11:29,293 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:11:29,294 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: -- KNOWLEDGE QUESTION...
2025-11-11 19:11:29,294 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 21 chars
2025-11-11 19:11:29,294 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: -- KNOWLEDGE QUESTION
2025-11-11 19:11:29,294 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 19:11:29,295 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 19:11:29,295 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 19:11:29,300 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:11:29,301 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=0, columns=0, rows=0, sql=-- KNOWLEDGE QUESTION
2025-11-11 19:11:29,301 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 19:11:29,301 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['columns', 'rows', 'row_count', 'query']
2025-11-11 19:11:29,301 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: -- KNOWLEDGE QUESTION
2025-11-11 19:11:29,301 - agent.graph_nodes - INFO - [END_NODE] Knowledge response detected: 'Based on the business glossary, I can help clarify the mapping for "delta" in the context of market ...'
2025-11-11 19:11:29,301 - agent.graph_nodes - INFO - [END_NODE] Returning knowledge result with response length: 797
2025-11-11 19:11:29,301 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 19:11:29,301 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 19:11:29,302 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 19:11:29,307 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:11:29,307 - agent.streaming_agent - INFO - Agent completed for session sess-8ch652p6: 15490.892ms, 8 steps
2025-11-11 19:11:29,307 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=0, columns=0, rows=0
2025-11-11 19:12:07,242 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'search for delat in the table, which columns do you find it in'
2025-11-11 19:12:07,244 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-8ch652p6
2025-11-11 19:12:07,247 - agent.state_manager - INFO - Loaded session state for sess-8ch652p6
2025-11-11 19:12:07,247 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 3 turns
2025-11-11 19:12:07,247 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 3 conversation turns
2025-11-11 19:12:07,253 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:12:07,253 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 19:12:07,253 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 19:12:07,254 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 19:12:07,254 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=3, conv_history(str)=14786
2025-11-11 19:12:07,254 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 19:12:07,254 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 19:12:07,254 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 19:12:07,259 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:12:07,259 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 19:12:11,112 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:12:11,115 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain detailed information about Delta limits, specifically showing two PV01 Delta type limits (Canadian Options and Oil Products NGL Trading). The data includes full details like limit_type, limit_desc, exposure_amt, and utilization, which can be used to analyze or explain Delta without requiring a new database query.
2025-11-11 19:12:11,115 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 19:12:11,116 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 19:12:11,116 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 19:12:11,125 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:12:15,761 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:12:15,765 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 19:12:15,766 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 19:12:15,766 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 19:12:15,779 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:12:15,780 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 19:12:15,780 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:12:15,781 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 19:12:15,781 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:12:15,781 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 19:12:15,781 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 19:12:15,781 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 19:12:15,781 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 19:12:15,781 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 19:12:15,781 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 19:12:15,781 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 14786 characters
2025-11-11 19:12:15,781 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 19:12:15,781 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 19:12:15,781 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 19:12:15,781 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 19:12:15,781 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 19:12:15,781 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 19:12:15,781 - tools.impl.nl_to_sql_planner - INFO -     User Query: top primary limits
2025-11-11 19:12:15,781 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 19:12:15,781 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 19:12:15,782 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 19:12:15,782 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 19:12:15,782 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-11 19:12:15,782 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_in
2025-11-11 19:12:15,782 - tools.impl.nl_to_sql_planner - INFO -     ... (14186 more characters)
2025-11-11 19:12:15,782 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:12:19,101 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:12:19,755 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:12:23,111 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 19:12:23,112 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 19:12:23,112 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 19:12:23,121 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:12:23,125 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 19:12:23,126 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 19:12:23,126 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 19:12:23,134 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:12:23,134 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: -- KNOWLEDGE QUESTION...
2025-11-11 19:12:23,134 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 21 chars
2025-11-11 19:12:23,135 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: -- KNOWLEDGE QUESTION
2025-11-11 19:12:23,135 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 19:12:23,135 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 19:12:23,135 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 19:12:23,142 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:12:23,142 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=0, columns=0, rows=0, sql=-- KNOWLEDGE QUESTION
2025-11-11 19:12:23,142 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 19:12:23,143 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['columns', 'rows', 'row_count', 'query']
2025-11-11 19:12:23,143 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: -- KNOWLEDGE QUESTION
2025-11-11 19:12:23,143 - agent.graph_nodes - INFO - [END_NODE] Knowledge response detected: 'Based on the business glossary, I'll help you understand where "delta" appears:

**Delta**: Price se...'
2025-11-11 19:12:23,143 - agent.graph_nodes - INFO - [END_NODE] Returning knowledge result with response length: 704
2025-11-11 19:12:23,143 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 19:12:23,143 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 19:12:23,143 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 19:12:23,148 - agent.state_manager - INFO - Saved session state for sess-8ch652p6 (user: admin)
2025-11-11 19:12:23,148 - agent.streaming_agent - INFO - Agent completed for session sess-8ch652p6: 15894.031ms, 8 steps
2025-11-11 19:12:23,148 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=0, columns=0, rows=0
2025-11-11 19:12:36,614 - root - INFO - Client 43abmIF14C0gTDFKAAAJ joined session room: sess-homf5q4o
2025-11-11 19:12:42,368 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'search for delta in the table, which columns do you find it in'
2025-11-11 19:12:42,369 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-homf5q4o
2025-11-11 19:12:42,370 - agent.state_manager - WARNING - Session sess-homf5q4o not found
2025-11-11 19:12:42,370 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 19:12:42,379 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:12:42,379 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 19:12:42,379 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 19:12:42,380 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 19:12:42,380 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 19:12:42,380 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 19:12:42,380 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 19:12:42,381 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 19:12:42,385 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:12:46,035 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:12:46,037 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 19:12:46,038 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 19:12:46,038 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 19:12:46,043 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:12:46,044 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 19:12:46,044 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:12:46,044 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 19:12:46,044 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:12:46,044 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 19:12:46,044 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 19:12:46,044 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 19:12:46,044 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 19:12:46,044 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 19:12:46,044 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 19:12:46,044 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 19:12:46,044 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 19:12:46,044 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 19:12:46,045 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 19:12:46,045 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 19:12:46,045 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:12:49,154 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:12:50,849 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:12:52,551 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 19:12:52,551 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: search for delta in the table, which columns do you find it in
2025-11-11 19:12:52,551 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-11 19:12:52,551 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 22644 chars
2025-11-11 19:12:52,551 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 19:12:52,551 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 19:12:54,776 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:12:56,401 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 341 chars
2025-11-11 19:12:56,402 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT DISTINCT column_name FROM limits_data WHERE column_name LIKE '%delta%' OR column_name LIKE '%Delta%'",
  "explanation": "Searching for 'delta' across all column names in the limits_data table. Using DISTINCT to avoid duplicate column names and case-insensitive LIKE to catch variations.",
  "target_table": "limits_data"
}
2025-11-11 19:12:56,402 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 19:12:56,402 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 19:12:56,402 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT DISTINCT column_name FROM limits_data WHERE column_name LIKE '%delta%' OR column_name LIKE '%Delta%'...
2025-11-11 19:12:56,402 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT DISTINCT column_name FROM limits_data WHERE column_name LIKE '%delta%' OR column_name LIKE '%Delta%'
2025-11-11 19:12:56,403 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 19:12:56,404 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 19:12:56,404 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 19:12:56,410 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:12:56,411 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 19:12:56,411 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 19:12:56,411 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 19:12:56,416 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:12:56,416 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT DISTINCT column_name FROM limits_data WHERE column_name LIKE '%delta%' OR column_name LIKE '%Delta%'...
2025-11-11 19:12:56,417 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 107 chars
2025-11-11 19:12:56,417 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT DISTINCT column_name FROM limits_data WHERE column_name LIKE '%delta%' OR column_name LIKE '%Delta%'
2025-11-11 19:12:56,417 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT DISTINCT column_name FROM limits_data WHERE column_name LIKE '%delta%' OR column_name LIKE '%Delta%'...
2025-11-11 19:12:56,417 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT DISTINCT column_name FROM limits_data WHERE column_name LIKE '%delta%' OR column_name LIKE '%Delta%'...
2025-11-11 19:12:56,417 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 19:12:56,417 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT DISTINCT column_name FROM limits_data WHERE column_name LIKE '%delta%' OR column_name LIKE '%Delta%'...
2025-11-11 19:12:56,517 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['node_output', 'node_reasoning']
2025-11-11 19:12:56,517 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 2 data keys
2025-11-11 19:12:56,517 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 19:12:56,520 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:12:56,522 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:12:56,522 - agent.graph_nodes - INFO - [GENERATE_SQL] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 19:12:56,522 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:12:56,522 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 19:12:56,522 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:12:56,522 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 19:12:56,522 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 19:12:56,522 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 19:12:56,522 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 19:12:56,522 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 19:12:56,522 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 19:12:56,523 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 19:12:56,523 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 19:12:56,523 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 19:12:56,523 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 19:12:56,523 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 19:12:56,523 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:12:59,079 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:13:00,816 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:13:02,638 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 19:13:02,639 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: search for delta in the table, which columns do you find it in

Previous SQL failed with error: Binder Error: Referenced column "column_name" not found in FROM clause!
Candidate bindings: "limit_concatenate", "pref_name", "limit_type", "limit_desc", "limit_class"

LINE 1: SELECT DISTINCT column_name FROM limits_data WHERE column_name LIKE '%delta%' OR column_name LIKE '%Delta%'
                                                           ^
Please generate corrected SQL.
2025-11-11 19:13:02,639 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-11 19:13:02,639 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 23054 chars
2025-11-11 19:13:02,639 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 19:13:02,639 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 19:13:04,811 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:13:08,367 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 722 chars
2025-11-11 19:13:08,368 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT DISTINCT column_name FROM (SELECT 'limit_type' AS column_name FROM limits_data WHERE limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%' UNION SELECT 'limit_desc' AS column_name FROM limits_data WHERE limit_desc LIKE '%delta%' OR limit_desc LIKE '%Delta%' UNION SELECT 'limit_group' AS column_name FROM limits_data WHERE limit_group LIKE '%delta%' OR limit_group LIKE '%Delta%') subquery",
  "explanation": "Searches for 'delta' (case-insensitive) across multiple columns: limit
2025-11-11 19:13:08,368 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 19:13:08,368 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 19:13:08,368 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT DISTINCT column_name FROM (SELECT 'limit_type' AS column_name FROM limits_data WHERE limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%' UNION SELECT 'limit_desc' AS column_name FROM limits_...
2025-11-11 19:13:08,368 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT DISTINCT column_name FROM (SELECT 'limit_type' AS column_name FROM limits_data WHERE limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%' UNION SELECT 'limit_desc' AS column_name FROM limits_data WHERE limit_desc LIKE '%delta%' OR limit_desc LIKE '%Delta%' UNION SELECT 'limit_group' AS column_name FROM limits_data WHERE limit_group LIKE '%delta%' OR limit_group LIKE '%Delta%') subquery
2025-11-11 19:13:08,368 - agent.graph_nodes - INFO - [GENERATE_SQL] Planner generated SQL: SELECT DISTINCT column_name FROM (SELECT 'limit_type' AS column_name FROM limits_data WHERE limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%' UNION SELECT 'limit_desc' AS column_name FROM limits_...
2025-11-11 19:13:08,368 - agent.graph_nodes - INFO - [GENERATE_SQL] Full SQL length: 397 chars
2025-11-11 19:13:08,368 - agent.graph_nodes - INFO - [GENERATE_SQL] Full SQL: SELECT DISTINCT column_name FROM (SELECT 'limit_type' AS column_name FROM limits_data WHERE limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%' UNION SELECT 'limit_desc' AS column_name FROM limits_data WHERE limit_desc LIKE '%delta%' OR limit_desc LIKE '%Delta%' UNION SELECT 'limit_group' AS column_name FROM limits_data WHERE limit_group LIKE '%delta%' OR limit_group LIKE '%Delta%') subquery
2025-11-11 19:13:08,368 - agent.graph_nodes - INFO - [GENERATE_SQL] Plan object keys: ['type', 'sql', 'limits', 'target_table']
2025-11-11 19:13:08,368 - agent.graph_nodes - INFO - [GENERATE_SQL] Plan object: {'type': 'sql_plan', 'sql': "SELECT DISTINCT column_name FROM (SELECT 'limit_type' AS column_name FROM limits_data WHERE limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%' UNION SELECT 'limit_desc' AS column_name FROM limits_data WHERE limit_desc LIKE '%delta%' OR limit_desc LIKE '%Delta%' UNION SELECT 'limit_group' AS column_name FROM limits_data WHERE limit_group LIKE '%delta%' OR limit_group LIKE '%Delta%') subquery", 'limits': {'preview_rows': 100}, 'target_table': 'limits_data'}
2025-11-11 19:13:08,369 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 19:13:08,369 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 19:13:08,369 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 19:13:08,371 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:13:08,371 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT DISTINCT column_name FROM (SELECT 'limit_type' AS column_name FROM limits_data WHERE limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%' UNION SELECT 'limit_desc' AS column_name FROM limits_...
2025-11-11 19:13:08,371 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 397 chars
2025-11-11 19:13:08,371 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT DISTINCT column_name FROM (SELECT 'limit_type' AS column_name FROM limits_data WHERE limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%' UNION SELECT 'limit_desc' AS column_name FROM limits_data WHERE limit_desc LIKE '%delta%' OR limit_desc LIKE '%Delta%' UNION SELECT 'limit_group' AS column_name FROM limits_data WHERE limit_group LIKE '%delta%' OR limit_group LIKE '%Delta%') subquery
2025-11-11 19:13:08,371 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT DISTINCT column_name FROM (SELECT 'limit_type' AS column_name FROM limits_data WHERE limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%' UNION SELECT 'limit_desc' AS column_name FROM limits_...
2025-11-11 19:13:08,371 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT DISTINCT column_name FROM (SELECT 'limit_type' AS column_name FROM limits_data WHERE limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%' UNION SELECT 'limit_desc' AS column_name FROM limits_...
2025-11-11 19:13:08,371 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 19:13:08,371 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT DISTINCT column_name FROM (SELECT 'limit_type' AS column_name FROM limits_data WHERE limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%' UNION SELECT 'limit_desc' AS column_name FROM limits_...
2025-11-11 19:13:08,522 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 19:13:08,522 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 19:13:08,522 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 19:13:08,526 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:13:08,526 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=1, columns=1, rows=1, sql=SELECT DISTINCT column_name FROM (SELECT 'limit_type' AS column_name FROM limits_data WHERE limit_ty
2025-11-11 19:13:08,527 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 19:13:08,527 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 19:13:08,527 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT DISTINCT column_name FROM (SELECT 'limit_type' AS column_name FROM limits_data WHERE limit_ty
2025-11-11 19:13:08,527 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=1, columns=1, rows=1, query_length=397
2025-11-11 19:13:08,528 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 19:13:08,528 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 19:13:08,529 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 861 chars
2025-11-11 19:13:09,329 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:13:14,808 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1231 chars
2025-11-11 19:13:14,808 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 19:13:14,808 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 19:13:14,809 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 37839 chars
2025-11-11 19:13:22,658 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:13:22,660 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1126 chars
2025-11-11 19:13:22,661 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=1, columns=1, rows=1, query=SELECT DISTINCT column_name FROM (SELECT 'limit_type' AS column_name FROM limits_data WHERE limit_ty
2025-11-11 19:13:22,661 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=1, columns=1, rows=1, has_query=True
2025-11-11 19:13:22,661 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT DISTINCT column_name FROM (SELECT 'limit_type' AS column_name FROM limits_data WHERE limit_ty...
2025-11-11 19:13:22,661 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT DISTINCT column_name FROM (SELECT 'limit_type' AS column_name FROM limits_data WHERE limit_ty...
2025-11-11 19:13:22,662 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 19:13:22,662 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 19:13:22,662 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 19:13:22,671 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:13:22,671 - agent.streaming_agent - INFO - Agent completed for session sess-homf5q4o: 40291.468ms, 10 steps
2025-11-11 19:13:22,672 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=1, columns=1, rows=1
2025-11-11 19:13:48,131 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'lets find the count and data analysis on limits with limit_type is like delta'
2025-11-11 19:13:48,133 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-homf5q4o
2025-11-11 19:13:48,134 - agent.state_manager - INFO - Loaded session state for sess-homf5q4o
2025-11-11 19:13:48,134 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 1 turns
2025-11-11 19:13:48,135 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 1 conversation turns
2025-11-11 19:13:48,140 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:13:48,140 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 19:13:48,140 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 19:13:48,140 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 19:13:48,140 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=1, conv_history(str)=3015
2025-11-11 19:13:48,140 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 19:13:48,140 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 19:13:48,141 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 19:13:48,143 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:13:48,143 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 19:13:50,523 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:13:50,524 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=True, reasoning=The previous query only identified which column contains 'delta', but did not return any actual delta-related data or details. To answer a follow-up query about delta entries, a new query would be needed to retrieve the specific delta limit rows, their values, or any additional context.
2025-11-11 19:13:50,525 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 19:13:50,525 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 19:13:50,525 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 19:13:50,533 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:13:55,439 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:13:55,441 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 19:13:55,441 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 19:13:55,442 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 19:13:55,450 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:13:55,450 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=True, passing to planner
2025-11-11 19:13:55,450 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: True
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü° NEW QUERY WITH CONTEXT (different data needed)
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 3015 characters
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO -     User Query: search for delta in the table, which columns do you find it in
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO -     SELECT DISTINCT column_name FROM (SELECT 'limit_type' AS column_name FROM limits_data WHERE limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%' UNION SELECT 'limit_desc' AS column_name FROM limits_data WHERE limit_desc LIKE '%delta%' OR limit_desc LIKE '%Delta%' UNION SELECT 'limit_group' AS column_name FROM limits_data WHERE limit_group LIKE '%delta%' OR limit_group LIKE '%Delta%') subquery
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO -     Result Table (1 row):
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO -     Columns: column_name
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO -     Data:
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO -       Row 1: column_name:
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO -     ... (2415 more characters)
2025-11-11 19:13:55,451 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:13:59,508 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:14:01,378 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:14:03,928 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 19:14:03,929 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: lets find the count and data analysis on limits with limit_type is like delta
2025-11-11 19:14:03,929 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10307 chars
2025-11-11 19:14:03,929 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 25641 chars
2025-11-11 19:14:03,929 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 19:14:03,929 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 19:14:06,504 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:14:09,051 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 519 chars
2025-11-11 19:14:09,052 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT COUNT(*) as delta_limit_count, AVG(utilization) as avg_utilization, SUM(exposure_amt) as total_exposure FROM limits_data WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') AND date = (SELECT MAX(date) FROM limits_data)",
    "explanation": "Performed count, average utilization, and total exposure analysis for delta-related limits. Used case-insensitive delta matching in limit_type column. Focused on most recent date to provide current snapshot.",
    "target_tabl
2025-11-11 19:14:09,052 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 19:14:09,052 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 19:14:09,052 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT COUNT(*) as delta_limit_count, AVG(utilization) as avg_utilization, SUM(exposure_amt) as total_exposure FROM limits_data WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') AND date ...
2025-11-11 19:14:09,052 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT COUNT(*) as delta_limit_count, AVG(utilization) as avg_utilization, SUM(exposure_amt) as total_exposure FROM limits_data WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') AND date = (SELECT MAX(date) FROM limits_data)
2025-11-11 19:14:09,052 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 19:14:09,052 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 19:14:09,052 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 19:14:09,055 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:14:09,055 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 19:14:09,055 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 19:14:09,055 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 19:14:09,056 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:14:09,056 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT COUNT(*) as delta_limit_count, AVG(utilization) as avg_utilization, SUM(exposure_amt) as total_exposure FROM limits_data WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') AND date ...
2025-11-11 19:14:09,057 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 237 chars
2025-11-11 19:14:09,057 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT COUNT(*) as delta_limit_count, AVG(utilization) as avg_utilization, SUM(exposure_amt) as total_exposure FROM limits_data WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') AND date = (SELECT MAX(date) FROM limits_data)
2025-11-11 19:14:09,057 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT COUNT(*) as delta_limit_count, AVG(utilization) as avg_utilization, SUM(exposure_amt) as total_exposure FROM limits_data WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') AND date ...
2025-11-11 19:14:09,057 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT COUNT(*) as delta_limit_count, AVG(utilization) as avg_utilization, SUM(exposure_amt) as total_exposure FROM limits_data WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') AND date ...
2025-11-11 19:14:09,057 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 19:14:09,057 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT COUNT(*) as delta_limit_count, AVG(utilization) as avg_utilization, SUM(exposure_amt) as total_exposure FROM limits_data WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') AND date ...
2025-11-11 19:14:09,166 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 19:14:09,166 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 19:14:09,166 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 19:14:09,170 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:14:09,170 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=1, columns=3, rows=1, sql=SELECT COUNT(*) as delta_limit_count, AVG(utilization) as avg_utilization, SUM(exposure_amt) as tota
2025-11-11 19:14:09,171 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 19:14:09,171 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 19:14:09,171 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT COUNT(*) as delta_limit_count, AVG(utilization) as avg_utilization, SUM(exposure_amt) as tota
2025-11-11 19:14:09,171 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=1, columns=3, rows=1, query_length=237
2025-11-11 19:14:09,171 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 19:14:09,171 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 19:14:09,172 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 830 chars
2025-11-11 19:14:10,085 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:14:18,005 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1678 chars
2025-11-11 19:14:18,005 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 19:14:18,006 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 19:14:18,007 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 39730 chars
2025-11-11 19:14:26,267 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:14:26,269 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1158 chars
2025-11-11 19:14:26,269 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=1, columns=3, rows=1, query=SELECT COUNT(*) as delta_limit_count, AVG(utilization) as avg_utilization, SUM(exposure_amt) as tota
2025-11-11 19:14:26,269 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=1, columns=3, rows=1, has_query=True
2025-11-11 19:14:26,269 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT COUNT(*) as delta_limit_count, AVG(utilization) as avg_utilization, SUM(exposure_amt) as tota...
2025-11-11 19:14:26,269 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT COUNT(*) as delta_limit_count, AVG(utilization) as avg_utilization, SUM(exposure_amt) as tota...
2025-11-11 19:14:26,270 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 19:14:26,271 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 19:14:26,271 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 19:14:26,279 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:14:26,280 - agent.streaming_agent - INFO - Agent completed for session sess-homf5q4o: 38139.373ms, 8 steps
2025-11-11 19:14:26,280 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=1, columns=3, rows=1
2025-11-11 19:14:36,743 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'can you list down those 4 limits below please that have delta limit type'
2025-11-11 19:14:36,744 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-homf5q4o
2025-11-11 19:14:36,745 - agent.state_manager - INFO - Loaded session state for sess-homf5q4o
2025-11-11 19:14:36,745 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 2 turns
2025-11-11 19:14:36,746 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 2 conversation turns
2025-11-11 19:14:36,751 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:14:36,752 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 19:14:36,752 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 19:14:36,752 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 19:14:36,752 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=2, conv_history(str)=6430
2025-11-11 19:14:36,752 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 19:14:36,752 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 19:14:36,752 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 19:14:36,755 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:14:36,756 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 19:14:39,679 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:14:39,681 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query already returned comprehensive aggregate data about delta limits, including count (4 limits), average utilization (0.9575), and total exposure ($10,680,950). Since the previous results provide high-level summary statistics about delta limits, no additional database query is required to analyze these delta-type limits.
2025-11-11 19:14:39,681 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 19:14:39,681 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 19:14:39,681 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 19:14:39,686 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:14:43,411 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:14:43,414 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 19:14:43,414 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 19:14:43,414 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 19:14:43,422 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:14:43,423 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 19:14:43,424 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:14:43,424 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 19:14:43,424 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:14:43,424 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 19:14:43,424 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 19:14:43,424 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 19:14:43,424 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 19:14:43,424 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 19:14:43,424 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 19:14:43,424 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 6430 characters
2025-11-11 19:14:43,424 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 19:14:43,424 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 19:14:43,424 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 19:14:43,424 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 19:14:43,424 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 19:14:43,424 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 19:14:43,424 - tools.impl.nl_to_sql_planner - INFO -     User Query: search for delta in the table, which columns do you find it in
2025-11-11 19:14:43,424 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 19:14:43,424 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 19:14:43,424 - tools.impl.nl_to_sql_planner - INFO -     SELECT DISTINCT column_name FROM (SELECT 'limit_type' AS column_name FROM limits_data WHERE limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%' UNION SELECT 'limit_desc' AS column_name FROM limits_data WHERE limit_desc LIKE '%delta%' OR limit_desc LIKE '%Delta%' UNION SELECT 'limit_group' AS column_name FROM limits_data WHERE limit_group LIKE '%delta%' OR limit_group LIKE '%Delta%') subquery
2025-11-11 19:14:43,425 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 19:14:43,425 - tools.impl.nl_to_sql_planner - INFO -     Result Table (1 row):
2025-11-11 19:14:43,425 - tools.impl.nl_to_sql_planner - INFO -     Columns: column_name
2025-11-11 19:14:43,425 - tools.impl.nl_to_sql_planner - INFO -     Data:
2025-11-11 19:14:43,425 - tools.impl.nl_to_sql_planner - INFO -       Row 1: column_name:
2025-11-11 19:14:43,425 - tools.impl.nl_to_sql_planner - INFO -     ... (5830 more characters)
2025-11-11 19:14:43,425 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:14:47,257 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:14:49,164 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:14:51,012 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:14:51,012 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 19:14:51,012 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:14:51,012 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 6430
2025-11-11 19:14:51,012 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 19:14:51,012 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 4 SQL code blocks, using LAST (most recent)
2025-11-11 19:14:51,013 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 19:14:51,013 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT COUNT(*) as delta_limit_count, 
       AVG(utilization) as avg_utilization, 
       SUM(exposure_amt) as total_exposure 
FROM limits_data 
WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') 
AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 19:14:51,013 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 256 characters
2025-11-11 19:14:51,013 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 19:14:51,013 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 19:14:51,013 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 256 characters
2025-11-11 19:14:51,013 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT COUNT(*) as delta_limit_count, 
       AVG(utilization) as avg_utilization, 
       SUM(exposure_amt) as total_exposure 
FROM limits_data 
WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') 
AND date = (SELECT MAX(date) FROM limits_data)
2025-11-11 19:14:51,013 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT COUNT(*) as delta_limit_count, 
       AVG(utilization) as avg_utilization, 
       SUM(exposure_amt) as total_exposure 
FROM limits_data 
WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') 
AND date = (SELECT MAX(date) FROM limits_data)
2025-11-11 19:14:51,013 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:14:51,015 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 19:14:51,015 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: can you list down those 4 limits below please that have delta limit type
2025-11-11 19:14:51,015 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10811 chars
2025-11-11 19:14:51,015 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 29051 chars
2025-11-11 19:14:51,015 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 19:14:51,015 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 19:14:53,401 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:14:55,795 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 420 chars
2025-11-11 19:14:55,796 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') AND date = (SELECT MAX(date) FROM limits_data) LIMIT 4",
  "explanation": "Retrieving the 4 delta-type limits from the most recent date. Used case-insensitive LIKE matching for 'delta' in limit_type, added LIMIT 4 to match the previous query's count, and filtered to the latest date.",
  "target_table": "limits_data"
}
2025-11-11 19:14:55,796 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 19:14:55,796 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 19:14:55,796 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') AND date = (SELECT MAX(date) FROM limits_data) LIMIT 4...
2025-11-11 19:14:55,796 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') AND date = (SELECT MAX(date) FROM limits_data) LIMIT 4
2025-11-11 19:14:55,797 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 19:14:55,797 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 19:14:55,798 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 19:14:55,805 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:14:55,806 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 19:14:55,807 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 19:14:55,807 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 19:14:55,811 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:14:55,811 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') AND date = (SELECT MAX(date) FROM limits_data) LIMIT 4...
2025-11-11 19:14:55,811 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 143 chars
2025-11-11 19:14:55,811 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') AND date = (SELECT MAX(date) FROM limits_data) LIMIT 4
2025-11-11 19:14:55,812 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') AND date = (SELECT MAX(date) FROM limits_data) LIMIT 4...
2025-11-11 19:14:55,812 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') AND date = (SELECT MAX(date) FROM limits_data) LIMIT 4...
2025-11-11 19:14:55,812 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 19:14:55,812 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') AND date = (SELECT MAX(date) FROM limits_data) LIMIT 4...
2025-11-11 19:14:55,936 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 19:14:55,936 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 19:14:55,937 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 19:14:55,945 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:14:55,945 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=4, columns=41, rows=4, sql=SELECT * FROM limits_data WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') AND date = 
2025-11-11 19:14:55,945 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 19:14:55,945 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 19:14:55,946 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') AND date = 
2025-11-11 19:14:55,946 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=4, columns=41, rows=4, query_length=143
2025-11-11 19:14:55,946 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 19:14:55,946 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 19:14:55,947 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 6174 chars
2025-11-11 19:14:56,987 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:15:06,206 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1685 chars
2025-11-11 19:15:06,207 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 19:15:06,207 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 19:15:06,208 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 42266 chars
2025-11-11 19:15:14,802 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:15:14,804 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1112 chars
2025-11-11 19:15:14,804 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=4, columns=41, rows=4, query=SELECT * FROM limits_data WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') AND date = 
2025-11-11 19:15:14,805 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=4, columns=41, rows=4, has_query=True
2025-11-11 19:15:14,806 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') AND date = ...
2025-11-11 19:15:14,806 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') AND date = ...
2025-11-11 19:15:14,806 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 19:15:14,806 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 19:15:14,807 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 19:15:14,823 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:15:14,823 - agent.streaming_agent - INFO - Agent completed for session sess-homf5q4o: 38070.855ms, 8 steps
2025-11-11 19:15:14,823 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=4, columns=41, rows=4
2025-11-11 19:15:59,009 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'how many extensuions do we have as active'
2025-11-11 19:15:59,010 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-homf5q4o
2025-11-11 19:15:59,016 - agent.state_manager - INFO - Loaded session state for sess-homf5q4o
2025-11-11 19:15:59,016 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 3 turns
2025-11-11 19:15:59,016 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 3 conversation turns
2025-11-11 19:15:59,027 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:15:59,027 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 19:15:59,028 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 19:15:59,028 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 19:15:59,028 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=3, conv_history(str)=13589
2025-11-11 19:15:59,029 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 19:15:59,029 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 19:15:59,030 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 19:15:59,033 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:15:59,033 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 19:16:02,317 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:16:02,320 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain the full details of the 4 delta-type limits, including all columns and comprehensive information. Since the previous query returned complete rows with all attributes, any follow-up analysis or filtering can be done using the existing result set without needing a new database query.
2025-11-11 19:16:02,320 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 19:16:02,321 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 19:16:02,321 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 19:16:02,330 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:16:07,026 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:16:07,029 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 19:16:07,029 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 19:16:07,029 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 19:16:07,038 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:16:07,039 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 19:16:07,039 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:16:07,039 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 19:16:07,039 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:16:07,039 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 19:16:07,039 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 19:16:07,039 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 19:16:07,039 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 19:16:07,039 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 19:16:07,039 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 19:16:07,039 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 13589 characters
2025-11-11 19:16:07,039 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 19:16:07,040 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 19:16:07,040 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 19:16:07,040 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 19:16:07,040 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 19:16:07,040 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 19:16:07,040 - tools.impl.nl_to_sql_planner - INFO -     User Query: search for delta in the table, which columns do you find it in
2025-11-11 19:16:07,040 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 19:16:07,040 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 19:16:07,040 - tools.impl.nl_to_sql_planner - INFO -     SELECT DISTINCT column_name FROM (SELECT 'limit_type' AS column_name FROM limits_data WHERE limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%' UNION SELECT 'limit_desc' AS column_name FROM limits_data WHERE limit_desc LIKE '%delta%' OR limit_desc LIKE '%Delta%' UNION SELECT 'limit_group' AS column_name FROM limits_data WHERE limit_group LIKE '%delta%' OR limit_group LIKE '%Delta%') subquery
2025-11-11 19:16:07,040 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 19:16:07,040 - tools.impl.nl_to_sql_planner - INFO -     Result Table (1 row):
2025-11-11 19:16:07,040 - tools.impl.nl_to_sql_planner - INFO -     Columns: column_name
2025-11-11 19:16:07,040 - tools.impl.nl_to_sql_planner - INFO -     Data:
2025-11-11 19:16:07,041 - tools.impl.nl_to_sql_planner - INFO -       Row 1: column_name:
2025-11-11 19:16:07,041 - tools.impl.nl_to_sql_planner - INFO -     ... (12989 more characters)
2025-11-11 19:16:07,041 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:16:10,928 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:16:13,274 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:16:15,513 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:16:15,513 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 19:16:15,514 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:16:15,514 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 13589
2025-11-11 19:16:15,514 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 19:16:15,514 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 6 SQL code blocks, using LAST (most recent)
2025-11-11 19:16:15,514 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 19:16:15,514 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT * FROM limits_data 
WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') 
AND date = (SELECT MAX(date) FROM limits_data) 
LIMIT 4...
2025-11-11 19:16:15,515 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 146 characters
2025-11-11 19:16:15,515 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 19:16:15,515 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 19:16:15,515 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 146 characters
2025-11-11 19:16:15,515 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT * FROM limits_data 
WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') 
AND date = (SELECT MAX(date) FROM limits_data) 
LIMIT 4
2025-11-11 19:16:15,515 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT * FROM limits_data 
WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') 
AND date = (SELECT MAX(date) FROM limits_data) 
LIMIT 4
2025-11-11 19:16:15,515 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:16:15,517 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 19:16:15,517 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: how many extensuions do we have as active
2025-11-11 19:16:15,517 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10591 chars
2025-11-11 19:16:15,518 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 36179 chars
2025-11-11 19:16:15,518 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 19:16:15,518 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 19:16:18,599 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:16:20,872 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 421 chars
2025-11-11 19:16:20,873 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT COUNT(*) as extension_count FROM limits_data WHERE extension = 1 AND state = 'Active' AND date = (SELECT MAX(date) FROM limits_data)",
    "explanation": "Counted active limit extensions for the most recent date. Assumed 'active' means current state is 'Active' and extension flag is set to 1. Used the latest date in the dataset to ensure most current snapshot.",
    "target_table": "limits_data"
}
2025-11-11 19:16:20,873 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 19:16:20,873 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 19:16:20,873 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT COUNT(*) as extension_count FROM limits_data WHERE extension = 1 AND state = 'Active' AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 19:16:20,873 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT COUNT(*) as extension_count FROM limits_data WHERE extension = 1 AND state = 'Active' AND date = (SELECT MAX(date) FROM limits_data)
2025-11-11 19:16:20,874 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 19:16:20,874 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 19:16:20,874 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 19:16:20,885 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:16:20,885 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 19:16:20,885 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 19:16:20,885 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 19:16:20,891 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:16:20,891 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT COUNT(*) as extension_count FROM limits_data WHERE extension = 1 AND state = 'Active' AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 19:16:20,891 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 139 chars
2025-11-11 19:16:20,891 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT COUNT(*) as extension_count FROM limits_data WHERE extension = 1 AND state = 'Active' AND date = (SELECT MAX(date) FROM limits_data)
2025-11-11 19:16:20,892 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT COUNT(*) as extension_count FROM limits_data WHERE extension = 1 AND state = 'Active' AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 19:16:20,892 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT COUNT(*) as extension_count FROM limits_data WHERE extension = 1 AND state = 'Active' AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 19:16:20,892 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 19:16:20,892 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT COUNT(*) as extension_count FROM limits_data WHERE extension = 1 AND state = 'Active' AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 19:16:21,010 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 19:16:21,010 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 19:16:21,011 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 19:16:21,017 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:16:21,018 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=1, columns=1, rows=1, sql=SELECT COUNT(*) as extension_count FROM limits_data WHERE extension = 1 AND state = 'Active' AND dat
2025-11-11 19:16:21,018 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 19:16:21,018 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 19:16:21,018 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT COUNT(*) as extension_count FROM limits_data WHERE extension = 1 AND state = 'Active' AND dat
2025-11-11 19:16:21,018 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=1, columns=1, rows=1, query_length=139
2025-11-11 19:16:21,018 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 19:16:21,018 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 19:16:21,019 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 580 chars
2025-11-11 19:16:21,572 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:16:26,996 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1164 chars
2025-11-11 19:16:26,997 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 19:16:26,997 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 19:16:26,998 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 43217 chars
2025-11-11 19:16:35,905 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:16:35,908 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1090 chars
2025-11-11 19:16:35,908 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=1, columns=1, rows=1, query=SELECT COUNT(*) as extension_count FROM limits_data WHERE extension = 1 AND state = 'Active' AND dat
2025-11-11 19:16:35,908 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=1, columns=1, rows=1, has_query=True
2025-11-11 19:16:35,908 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT COUNT(*) as extension_count FROM limits_data WHERE extension = 1 AND state = 'Active' AND dat...
2025-11-11 19:16:35,908 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT COUNT(*) as extension_count FROM limits_data WHERE extension = 1 AND state = 'Active' AND dat...
2025-11-11 19:16:35,909 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 19:16:35,909 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 19:16:35,909 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 19:16:35,919 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:16:35,919 - agent.streaming_agent - INFO - Agent completed for session sess-homf5q4o: 36891.210999999996ms, 8 steps
2025-11-11 19:16:35,920 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=1, columns=1, rows=1
2025-11-11 19:17:55,097 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'what are these two limits and when does the extension expire ?'
2025-11-11 19:17:55,099 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-homf5q4o
2025-11-11 19:17:55,101 - agent.state_manager - INFO - Loaded session state for sess-homf5q4o
2025-11-11 19:17:55,101 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 3 turns
2025-11-11 19:17:55,102 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 3 conversation turns
2025-11-11 19:17:55,110 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:17:55,110 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 19:17:55,111 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 19:17:55,111 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 19:17:55,111 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=3, conv_history(str)=13206
2025-11-11 19:17:55,111 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 19:17:55,111 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 19:17:55,111 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 19:17:55,121 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:17:55,122 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 19:17:57,726 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:17:57,729 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=True, reasoning=The previous query results only showed a count of 2 active extensions, but did not provide any details about those specific extensions. To get details about the extensions, a new database query would be required to retrieve the full rows/details of those active extended limits.
2025-11-11 19:17:57,730 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 19:17:57,730 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 19:17:57,730 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 19:17:57,739 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:18:02,126 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:18:02,129 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 19:18:02,130 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 19:18:02,130 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 19:18:02,138 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:18:02,138 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=True, passing to planner
2025-11-11 19:18:02,138 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:18:02,139 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 19:18:02,139 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:18:02,139 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 19:18:02,139 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 19:18:02,139 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: True
2025-11-11 19:18:02,139 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü° NEW QUERY WITH CONTEXT (different data needed)
2025-11-11 19:18:02,139 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 19:18:02,139 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 19:18:02,139 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 13206 characters
2025-11-11 19:18:02,139 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 19:18:02,139 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 19:18:02,139 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 19:18:02,139 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 19:18:02,139 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 19:18:02,139 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 19:18:02,139 - tools.impl.nl_to_sql_planner - INFO -     User Query: lets find the count and data analysis on limits with limit_type is like delta
2025-11-11 19:18:02,139 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 19:18:02,139 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 19:18:02,140 - tools.impl.nl_to_sql_planner - INFO -     SELECT COUNT(*) as delta_limit_count, AVG(utilization) as avg_utilization, SUM(exposure_amt) as total_exposure FROM limits_data WHERE (limit_type LIKE '%delta%' OR limit_type LIKE '%Delta%') AND date = (SELECT MAX(date) FROM limits_data)
2025-11-11 19:18:02,140 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 19:18:02,140 - tools.impl.nl_to_sql_planner - INFO -     Result Table (1 row):
2025-11-11 19:18:02,140 - tools.impl.nl_to_sql_planner - INFO -     Columns: delta_limit_count, avg_utilization, total_exposure
2025-11-11 19:18:02,140 - tools.impl.nl_to_sql_planner - INFO -     Data:
2025-11-11 19:18:02,140 - tools.impl.nl_to_sql_planner - INFO -       Row 1: delta_limit_count: 4 | avg_utilization: 0.9575 | total_exposure: 10680950
2025-11-11 19:18:02,140 - tools.impl.nl_to_sql_planner - INFO -     Agent Response: ```sql
2025-11-11 19:18:02,140 - tools.impl.nl_to_sql_planner - INFO -     SELECT COUNT(*) as de
2025-11-11 19:18:02,140 - tools.impl.nl_to_sql_planner - INFO -     ... (12606 more characters)
2025-11-11 19:18:02,140 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:18:05,815 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:18:06,633 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:18:11,020 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 19:18:11,021 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 19:18:11,021 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 19:18:11,030 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:18:11,031 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 19:18:11,031 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 19:18:11,031 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 19:18:11,037 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:18:11,037 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: -- KNOWLEDGE QUESTION...
2025-11-11 19:18:11,037 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 21 chars
2025-11-11 19:18:11,037 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: -- KNOWLEDGE QUESTION
2025-11-11 19:18:11,038 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 19:18:11,038 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 19:18:11,038 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 19:18:11,043 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:18:11,043 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=0, columns=0, rows=0, sql=-- KNOWLEDGE QUESTION
2025-11-11 19:18:11,043 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 19:18:11,043 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['columns', 'rows', 'row_count', 'query']
2025-11-11 19:18:11,043 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: -- KNOWLEDGE QUESTION
2025-11-11 19:18:11,044 - agent.graph_nodes - INFO - [END_NODE] Knowledge response detected: 'I apologize, but the user query is unclear and does not specify a specific term from the business gl...'
2025-11-11 19:18:11,044 - agent.graph_nodes - INFO - [END_NODE] Returning knowledge result with response length: 982
2025-11-11 19:18:11,044 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 19:18:11,044 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 19:18:11,044 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 19:18:11,050 - agent.state_manager - INFO - Saved session state for sess-homf5q4o (user: admin)
2025-11-11 19:18:11,050 - agent.streaming_agent - INFO - Agent completed for session sess-homf5q4o: 15939.574ms, 8 steps
2025-11-11 19:18:11,050 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=0, columns=0, rows=0
2025-11-11 19:19:07,554 - root - INFO - Client 43abmIF14C0gTDFKAAAJ joined session room: sess-2uovuc7o
2025-11-11 19:19:12,957 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'how many extensuions do we have as active'
2025-11-11 19:19:12,957 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-2uovuc7o
2025-11-11 19:19:12,958 - agent.state_manager - WARNING - Session sess-2uovuc7o not found
2025-11-11 19:19:12,958 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 19:19:12,965 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:19:12,965 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 19:19:12,965 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 19:19:12,965 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 19:19:12,965 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 19:19:12,966 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 19:19:12,966 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 19:19:12,967 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 19:19:12,970 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:19:17,267 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:19:17,271 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 19:19:17,272 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 19:19:17,272 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 19:19:17,277 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:19:17,277 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 19:19:17,278 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:19:17,278 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 19:19:17,278 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:19:17,278 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 19:19:17,278 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 19:19:17,278 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 19:19:17,278 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 19:19:17,278 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 19:19:17,278 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 19:19:17,278 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 19:19:17,278 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 19:19:17,278 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 19:19:17,278 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 19:19:17,278 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 19:19:17,278 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:19:19,952 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:19:21,899 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:19:25,298 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 19:19:25,298 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 19:19:25,299 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 19:19:25,305 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:19:25,307 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:19:25,307 - agent.streaming_agent - INFO - Agent paused for clarification in session sess-2uovuc7o: 12342.142000000002ms, 4 steps
2025-11-11 19:19:58,117 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'extensions, 2 number of limits with active extensions'
2025-11-11 19:19:58,118 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-2uovuc7o
2025-11-11 19:19:58,121 - agent.state_manager - INFO - Loaded session state for sess-2uovuc7o
2025-11-11 19:19:58,122 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 0 turns
2025-11-11 19:19:58,122 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 19:19:58,127 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:19:58,128 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 19:19:58,128 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 19:19:58,128 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 19:19:58,128 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 19:19:58,129 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 19:19:58,129 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 19:19:58,129 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 19:19:58,132 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:20:02,450 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:20:02,453 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 19:20:02,453 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 19:20:02,454 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 19:20:02,461 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:20:02,462 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 19:20:02,462 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:20:02,462 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 19:20:02,462 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:20:02,462 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 19:20:02,462 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 19:20:02,462 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 19:20:02,463 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 19:20:02,463 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 19:20:02,463 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 19:20:02,463 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 19:20:02,463 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 19:20:02,463 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 19:20:02,463 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 19:20:02,463 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 19:20:02,463 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:20:05,213 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:20:06,888 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:20:10,038 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 19:20:10,039 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 19:20:10,039 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 19:20:10,048 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:20:10,052 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:20:10,052 - agent.streaming_agent - INFO - Agent paused for clarification in session sess-2uovuc7o: 11923.829ms, 4 steps
2025-11-11 19:20:44,383 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'number of limits with active extensions', total count as of max date'
2025-11-11 19:20:44,385 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-2uovuc7o
2025-11-11 19:20:44,388 - agent.state_manager - INFO - Loaded session state for sess-2uovuc7o
2025-11-11 19:20:44,388 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 0 turns
2025-11-11 19:20:44,388 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 19:20:44,393 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:20:44,393 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 19:20:44,393 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 19:20:44,393 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 19:20:44,394 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 19:20:44,394 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 19:20:44,394 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 19:20:44,394 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 19:20:44,397 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:20:48,553 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:20:48,555 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 19:20:48,556 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 19:20:48,557 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 19:20:48,561 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:20:48,562 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 19:20:48,562 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:20:48,563 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 19:20:48,563 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:20:48,563 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 19:20:48,563 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 19:20:48,563 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 19:20:48,563 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 19:20:48,563 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 19:20:48,563 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 19:20:48,563 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 19:20:48,563 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 19:20:48,564 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 19:20:48,564 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 19:20:48,564 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 19:20:48,564 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:20:51,192 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:20:53,036 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:20:54,878 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 19:20:54,879 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: number of limits with active extensions', total count as of max date
2025-11-11 19:20:54,879 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-11 19:20:54,879 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 22650 chars
2025-11-11 19:20:54,879 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 19:20:54,879 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 19:20:56,721 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:20:58,690 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 386 chars
2025-11-11 19:20:58,690 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT COUNT(*) AS active_extensions_count FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data)",
  "explanation": "Counts the number of limits with active extensions as of the most recent date. Assumes 'extension' column indicates active extensions (extension = 1), and uses the latest date in the dataset.",
  "target_table": "limits_data"
}
2025-11-11 19:20:58,690 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 19:20:58,690 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 19:20:58,691 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT COUNT(*) AS active_extensions_count FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 19:20:58,691 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT COUNT(*) AS active_extensions_count FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data)
2025-11-11 19:20:58,691 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 19:20:58,691 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 19:20:58,692 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 19:20:58,698 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:20:58,698 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 19:20:58,699 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 19:20:58,700 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 19:20:58,706 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:20:58,706 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT COUNT(*) AS active_extensions_count FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 19:20:58,706 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 126 chars
2025-11-11 19:20:58,707 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT COUNT(*) AS active_extensions_count FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data)
2025-11-11 19:20:58,707 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT COUNT(*) AS active_extensions_count FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 19:20:58,707 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT COUNT(*) AS active_extensions_count FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 19:20:58,707 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 19:20:58,707 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT COUNT(*) AS active_extensions_count FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 19:20:58,838 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 19:20:58,838 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 19:20:58,839 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 19:20:58,842 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:20:58,842 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=1, columns=1, rows=1, sql=SELECT COUNT(*) AS active_extensions_count FROM limits_data WHERE extension = 1 AND date = (SELECT M
2025-11-11 19:20:58,842 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 19:20:58,842 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 19:20:58,842 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT COUNT(*) AS active_extensions_count FROM limits_data WHERE extension = 1 AND date = (SELECT M
2025-11-11 19:20:58,842 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=1, columns=1, rows=1, query_length=126
2025-11-11 19:20:58,843 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 19:20:58,843 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 19:20:58,843 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 608 chars
2025-11-11 19:20:59,486 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:21:04,768 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1159 chars
2025-11-11 19:21:04,769 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 19:21:04,769 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 19:21:04,770 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 37520 chars
2025-11-11 19:21:13,106 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:21:13,108 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1080 chars
2025-11-11 19:21:13,108 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=1, columns=1, rows=1, query=SELECT COUNT(*) AS active_extensions_count FROM limits_data WHERE extension = 1 AND date = (SELECT M
2025-11-11 19:21:13,108 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=1, columns=1, rows=1, has_query=True
2025-11-11 19:21:13,109 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT COUNT(*) AS active_extensions_count FROM limits_data WHERE extension = 1 AND date = (SELECT M...
2025-11-11 19:21:13,109 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT COUNT(*) AS active_extensions_count FROM limits_data WHERE extension = 1 AND date = (SELECT M...
2025-11-11 19:21:13,109 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 19:21:13,109 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 19:21:13,110 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 19:21:13,121 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:21:13,121 - agent.streaming_agent - INFO - Agent completed for session sess-2uovuc7o: 28727.396ms, 7 steps
2025-11-11 19:21:13,121 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=1, columns=1, rows=1
2025-11-11 19:21:39,043 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'show e those two limits from the answer above'
2025-11-11 19:21:39,045 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-2uovuc7o
2025-11-11 19:21:39,048 - agent.state_manager - INFO - Loaded session state for sess-2uovuc7o
2025-11-11 19:21:39,048 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 1 turns
2025-11-11 19:21:39,048 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 1 conversation turns
2025-11-11 19:21:39,054 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:21:39,055 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 19:21:39,055 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 19:21:39,055 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 19:21:39,055 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=1, conv_history(str)=2647
2025-11-11 19:21:39,055 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 19:21:39,055 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 19:21:39,056 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 19:21:39,059 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:21:39,060 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 19:21:41,165 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:21:41,167 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query already returned the total count of active extensions (2), so no additional data retrieval is needed. The follow-up query appears to be about the existing result, which can be directly analyzed from the previous query's output.
2025-11-11 19:21:41,167 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 19:21:41,168 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 19:21:41,168 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 19:21:41,175 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:21:44,954 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:21:44,956 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 19:21:44,956 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 19:21:44,957 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 19:21:44,965 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:21:44,965 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 19:21:44,965 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:21:44,965 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 19:21:44,966 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:21:44,966 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 19:21:44,966 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 19:21:44,966 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 19:21:44,966 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 19:21:44,966 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 19:21:44,966 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 19:21:44,966 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 2647 characters
2025-11-11 19:21:44,966 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 19:21:44,966 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 19:21:44,966 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 19:21:44,966 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 19:21:44,966 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 19:21:44,966 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 19:21:44,967 - tools.impl.nl_to_sql_planner - INFO -     User Query: number of limits with active extensions', total count as of max date
2025-11-11 19:21:44,967 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 19:21:44,967 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 19:21:44,967 - tools.impl.nl_to_sql_planner - INFO -     SELECT COUNT(*) AS active_extensions_count FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data)
2025-11-11 19:21:44,968 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 19:21:44,968 - tools.impl.nl_to_sql_planner - INFO -     Result Table (1 row):
2025-11-11 19:21:44,968 - tools.impl.nl_to_sql_planner - INFO -     Columns: active_extensions_count
2025-11-11 19:21:44,968 - tools.impl.nl_to_sql_planner - INFO -     Data:
2025-11-11 19:21:44,968 - tools.impl.nl_to_sql_planner - INFO -       Row 1: active_extensions_count: 2
2025-11-11 19:21:44,968 - tools.impl.nl_to_sql_planner - INFO -     Agent Response: ```sql
2025-11-11 19:21:44,968 - tools.impl.nl_to_sql_planner - INFO -     SELECT COUNT(*) AS active_extensions_count 
2025-11-11 19:21:44,968 - tools.impl.nl_to_sql_planner - INFO -     FROM limits_data 
2025-11-11 19:21:44,968 - tools.impl.nl_to_sql_planner - INFO -     ... (2047 more characters)
2025-11-11 19:21:44,968 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:21:48,527 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:21:50,548 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:21:52,337 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:21:52,338 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 19:21:52,338 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:21:52,338 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 2647
2025-11-11 19:21:52,339 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 19:21:52,339 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 2 SQL code blocks, using LAST (most recent)
2025-11-11 19:21:52,339 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 19:21:52,339 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT COUNT(*) AS active_extensions_count 
FROM limits_data 
WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 19:21:52,339 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 128 characters
2025-11-11 19:21:52,340 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 19:21:52,340 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 19:21:52,340 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 128 characters
2025-11-11 19:21:52,340 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT COUNT(*) AS active_extensions_count 
FROM limits_data 
WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data)
2025-11-11 19:21:52,340 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT COUNT(*) AS active_extensions_count 
FROM limits_data 
WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data)
2025-11-11 19:21:52,340 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:21:52,342 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 19:21:52,343 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: show e those two limits from the answer above
2025-11-11 19:21:52,343 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10555 chars
2025-11-11 19:21:52,343 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 25241 chars
2025-11-11 19:21:52,343 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 19:21:52,343 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 19:21:54,578 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:21:56,650 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 386 chars
2025-11-11 19:21:56,650 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT * FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data) LIMIT 2",
    "explanation": "Retrieved the 2 active extension limits from the previous query's result set, using the same date filter and extension condition. Preserved the original query's context and added LIMIT 2 to match user's request.",
    "target_table": "limits_data"
}
2025-11-11 19:21:56,651 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 19:21:56,651 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 19:21:56,651 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data) LIMIT 2...
2025-11-11 19:21:56,651 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data) LIMIT 2
2025-11-11 19:21:56,652 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 19:21:56,652 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 19:21:56,652 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 19:21:56,660 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:21:56,660 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 19:21:56,661 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 19:21:56,661 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 19:21:56,665 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:21:56,665 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data) LIMIT 2...
2025-11-11 19:21:56,666 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 100 chars
2025-11-11 19:21:56,666 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data) LIMIT 2
2025-11-11 19:21:56,666 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data) LIMIT 2...
2025-11-11 19:21:56,666 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data) LIMIT 2...
2025-11-11 19:21:56,666 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 19:21:56,666 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data) LIMIT 2...
2025-11-11 19:21:56,793 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 19:21:56,793 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 19:21:56,794 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 19:21:56,798 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:21:56,799 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=2, columns=41, rows=2, sql=SELECT * FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data) LIMIT 2
2025-11-11 19:21:56,799 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 19:21:56,799 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 19:21:56,799 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data) LIMIT 2
2025-11-11 19:21:56,799 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=2, columns=41, rows=2, query_length=100
2025-11-11 19:21:56,799 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 19:21:56,799 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 19:21:56,801 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 3663 chars
2025-11-11 19:21:57,650 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:22:05,478 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1433 chars
2025-11-11 19:22:05,480 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 19:22:05,481 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 19:22:05,482 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 39972 chars
2025-11-11 19:22:12,637 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:22:12,640 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 874 chars
2025-11-11 19:22:12,641 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=2, columns=41, rows=2, query=SELECT * FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data) LIMIT 2
2025-11-11 19:22:12,642 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=2, columns=41, rows=2, has_query=True
2025-11-11 19:22:12,642 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data) LIMIT 2...
2025-11-11 19:22:12,642 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data) LIMIT 2...
2025-11-11 19:22:12,642 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 19:22:12,642 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 19:22:12,643 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 19:22:12,655 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:22:12,656 - agent.streaming_agent - INFO - Agent completed for session sess-2uovuc7o: 33601.014ms, 8 steps
2025-11-11 19:22:12,656 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=2, columns=41, rows=2
2025-11-11 19:22:52,010 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'Review the full extension history?'
2025-11-11 19:22:52,011 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-2uovuc7o
2025-11-11 19:22:52,013 - agent.state_manager - INFO - Loaded session state for sess-2uovuc7o
2025-11-11 19:22:52,013 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 2 turns
2025-11-11 19:22:52,014 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 2 conversation turns
2025-11-11 19:22:52,024 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:22:52,024 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 19:22:52,025 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 19:22:52,025 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 19:22:52,025 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=2, conv_history(str)=7480
2025-11-11 19:22:52,026 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 19:22:52,026 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 19:22:52,026 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 19:22:52,031 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:22:52,032 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 19:22:54,996 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:22:54,999 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already returned the full details of the two active limit extensions, including all columns and comprehensive information. Since the previous result set contains complete rows with multiple attributes, any follow-up analysis or filtering can be done directly on these existing results without needing a new database query.
2025-11-11 19:22:55,000 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 19:22:55,001 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 19:22:55,001 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 19:22:55,009 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:22:58,376 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:22:58,378 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 19:22:58,379 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 19:22:58,381 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 19:22:58,388 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:22:58,389 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 19:22:58,389 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:22:58,389 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 19:22:58,389 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:22:58,389 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 19:22:58,389 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 19:22:58,389 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 19:22:58,389 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 19:22:58,389 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 19:22:58,389 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 19:22:58,389 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 7480 characters
2025-11-11 19:22:58,389 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 19:22:58,390 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 19:22:58,390 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 19:22:58,390 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 19:22:58,390 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 19:22:58,390 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 19:22:58,391 - tools.impl.nl_to_sql_planner - INFO -     User Query: number of limits with active extensions', total count as of max date
2025-11-11 19:22:58,391 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 19:22:58,391 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 19:22:58,391 - tools.impl.nl_to_sql_planner - INFO -     SELECT COUNT(*) AS active_extensions_count FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data)
2025-11-11 19:22:58,391 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 19:22:58,391 - tools.impl.nl_to_sql_planner - INFO -     Result Table (1 row):
2025-11-11 19:22:58,391 - tools.impl.nl_to_sql_planner - INFO -     Columns: active_extensions_count
2025-11-11 19:22:58,391 - tools.impl.nl_to_sql_planner - INFO -     Data:
2025-11-11 19:22:58,391 - tools.impl.nl_to_sql_planner - INFO -       Row 1: active_extensions_count: 2
2025-11-11 19:22:58,391 - tools.impl.nl_to_sql_planner - INFO -     Agent Response: ```sql
2025-11-11 19:22:58,391 - tools.impl.nl_to_sql_planner - INFO -     SELECT COUNT(*) AS active_extensions_count 
2025-11-11 19:22:58,391 - tools.impl.nl_to_sql_planner - INFO -     FROM limits_data 
2025-11-11 19:22:58,391 - tools.impl.nl_to_sql_planner - INFO -     ... (6880 more characters)
2025-11-11 19:22:58,391 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:23:01,753 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:23:03,907 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:23:06,396 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:23:06,396 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 19:23:06,396 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:23:06,396 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 7480
2025-11-11 19:23:06,397 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 19:23:06,397 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 4 SQL code blocks, using LAST (most recent)
2025-11-11 19:23:06,397 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 19:23:06,397 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT * FROM limits_data 
WHERE extension = 1 
AND date = (SELECT MAX(date) FROM limits_data) 
LIMIT 2...
2025-11-11 19:23:06,397 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 103 characters
2025-11-11 19:23:06,397 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 19:23:06,398 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 19:23:06,398 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 103 characters
2025-11-11 19:23:06,398 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT * FROM limits_data 
WHERE extension = 1 
AND date = (SELECT MAX(date) FROM limits_data) 
LIMIT 2
2025-11-11 19:23:06,398 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT * FROM limits_data 
WHERE extension = 1 
AND date = (SELECT MAX(date) FROM limits_data) 
LIMIT 2
2025-11-11 19:23:06,398 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:23:06,400 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 19:23:06,401 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: Review the full extension history?
2025-11-11 19:23:06,401 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10505 chars
2025-11-11 19:23:06,401 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 30063 chars
2025-11-11 19:23:06,401 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 19:23:06,401 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 19:23:08,717 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:23:10,716 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 363 chars
2025-11-11 19:23:10,716 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT * FROM limits_data WHERE extension = 1 ORDER BY end_dt ASC",
    "explanation": "Retrieving full history of all limits with active extensions, sorted by extension end date in ascending order to show chronological progression. No date filter applied to capture complete extension history across all dates.",
    "target_table": "limits_data"
}
2025-11-11 19:23:10,716 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 19:23:10,717 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 19:23:10,717 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE extension = 1 ORDER BY end_dt ASC...
2025-11-11 19:23:10,717 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE extension = 1 ORDER BY end_dt ASC
2025-11-11 19:23:10,718 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 19:23:10,718 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 19:23:10,719 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 19:23:10,727 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:23:10,728 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 19:23:10,728 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 19:23:10,729 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 19:23:10,735 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:23:10,735 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE extension = 1 ORDER BY end_dt ASC...
2025-11-11 19:23:10,736 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 65 chars
2025-11-11 19:23:10,736 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE extension = 1 ORDER BY end_dt ASC
2025-11-11 19:23:10,736 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE extension = 1 ORDER BY end_dt ASC...
2025-11-11 19:23:10,736 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE extension = 1 ORDER BY end_dt ASC...
2025-11-11 19:23:10,736 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 19:23:10,736 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE extension = 1 ORDER BY end_dt ASC...
2025-11-11 19:23:10,830 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 19:23:10,830 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 19:23:10,835 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 19:23:10,850 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:23:10,851 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=62, columns=41, rows=62, sql=SELECT * FROM limits_data WHERE extension = 1 ORDER BY end_dt ASC
2025-11-11 19:23:10,851 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 19:23:10,851 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 19:23:10,851 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE extension = 1 ORDER BY end_dt ASC
2025-11-11 19:23:10,851 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=62, columns=41, rows=62, query_length=65
2025-11-11 19:23:10,851 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 19:23:10,851 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 19:23:10,853 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 78062 chars
2025-11-11 19:23:16,500 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:23:27,824 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1949 chars
2025-11-11 19:23:27,824 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 19:23:27,825 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 19:23:27,826 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 41381 chars
2025-11-11 19:23:36,460 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:23:36,462 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1148 chars
2025-11-11 19:23:36,462 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=62, columns=41, rows=62, query=SELECT * FROM limits_data WHERE extension = 1 ORDER BY end_dt ASC
2025-11-11 19:23:36,462 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=62, columns=41, rows=62, has_query=True
2025-11-11 19:23:36,462 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE extension = 1 ORDER BY end_dt ASC...
2025-11-11 19:23:36,463 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE extension = 1 ORDER BY end_dt ASC...
2025-11-11 19:23:36,463 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 19:23:36,463 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 19:23:36,469 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 19:23:36,510 - agent.state_manager - INFO - Saved session state for sess-2uovuc7o (user: admin)
2025-11-11 19:23:36,510 - agent.streaming_agent - INFO - Agent completed for session sess-2uovuc7o: 44484.875ms, 8 steps
2025-11-11 19:23:36,510 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=62, columns=41, rows=62
2025-11-11 19:25:26,304 - root - INFO - Client 43abmIF14C0gTDFKAAAJ joined session room: sess-986mle58
2025-11-11 19:25:45,626 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'if i am trying to identify a lmit what are the minimum attributes i need to give you if i dont know the id ?'
2025-11-11 19:25:45,627 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-986mle58
2025-11-11 19:25:45,629 - agent.state_manager - WARNING - Session sess-986mle58 not found
2025-11-11 19:25:45,629 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 19:25:45,637 - agent.state_manager - INFO - Saved session state for sess-986mle58 (user: admin)
2025-11-11 19:25:45,637 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 19:25:45,637 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 19:25:45,637 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 19:25:45,638 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 19:25:45,638 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 19:25:45,638 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 19:25:45,638 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 19:25:45,640 - agent.state_manager - INFO - Saved session state for sess-986mle58 (user: admin)
2025-11-11 19:25:49,694 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:25:49,696 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 19:25:49,697 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 19:25:49,699 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 19:25:49,704 - agent.state_manager - INFO - Saved session state for sess-986mle58 (user: admin)
2025-11-11 19:25:49,705 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 19:25:49,705 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:25:49,705 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 19:25:49,706 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:25:49,706 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 19:25:49,706 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 19:25:49,706 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 19:25:49,706 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 19:25:49,706 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 19:25:49,706 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 19:25:49,707 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 19:25:49,707 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 19:25:49,707 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 19:25:49,707 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 19:25:49,707 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 19:25:49,707 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:25:52,155 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:25:52,764 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:25:56,746 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 19:25:56,746 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 19:25:56,747 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 19:25:56,754 - agent.state_manager - INFO - Saved session state for sess-986mle58 (user: admin)
2025-11-11 19:25:56,755 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 19:25:56,755 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 19:25:56,755 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 19:25:56,757 - agent.state_manager - INFO - Saved session state for sess-986mle58 (user: admin)
2025-11-11 19:25:56,758 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: -- KNOWLEDGE QUESTION...
2025-11-11 19:25:56,758 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 21 chars
2025-11-11 19:25:56,758 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: -- KNOWLEDGE QUESTION
2025-11-11 19:25:56,759 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 19:25:56,759 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 19:25:56,760 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 19:25:56,763 - agent.state_manager - INFO - Saved session state for sess-986mle58 (user: admin)
2025-11-11 19:25:56,764 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=0, columns=0, rows=0, sql=-- KNOWLEDGE QUESTION
2025-11-11 19:25:56,764 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 19:25:56,764 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['columns', 'rows', 'row_count', 'query']
2025-11-11 19:25:56,764 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: -- KNOWLEDGE QUESTION
2025-11-11 19:25:56,765 - agent.graph_nodes - INFO - [END_NODE] Knowledge response detected: 'Based on the user's query about identifying a limit, I'll reference the market_risk_limits_overview ...'
2025-11-11 19:25:56,765 - agent.graph_nodes - INFO - [END_NODE] Returning knowledge result with response length: 841
2025-11-11 19:25:56,765 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 19:25:56,765 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 19:25:56,766 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 19:25:56,768 - agent.state_manager - INFO - Saved session state for sess-986mle58 (user: admin)
2025-11-11 19:25:56,768 - agent.streaming_agent - INFO - Agent completed for session sess-986mle58: 11130.944ms, 7 steps
2025-11-11 19:25:56,769 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=0, columns=0, rows=0
2025-11-11 19:26:37,359 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'limit value is what i am seeking, what are the min attributes that define a limit?'
2025-11-11 19:26:37,361 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-986mle58
2025-11-11 19:26:37,364 - agent.state_manager - INFO - Loaded session state for sess-986mle58
2025-11-11 19:26:37,365 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 1 turns
2025-11-11 19:26:37,365 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 1 conversation turns
2025-11-11 19:26:37,369 - agent.state_manager - INFO - Saved session state for sess-986mle58 (user: admin)
2025-11-11 19:26:37,369 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control']
2025-11-11 19:26:37,370 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 4 data keys
2025-11-11 19:26:37,370 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 19:26:37,370 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=1, conv_history(str)=1011
2025-11-11 19:26:37,370 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 19:26:37,370 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 19:26:37,371 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 19:26:37,374 - agent.state_manager - INFO - Saved session state for sess-986mle58 (user: admin)
2025-11-11 19:26:37,374 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 19:26:39,560 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:26:39,563 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous response already outlined the key attributes needed to identify a limit, including risk metric, risk measure, threshold, trading desk, risk category, and limit type. The follow-up query is essentially asking about the minimum attributes to identify a limit, which was comprehensively answered in the previous response. No new database query is required.
2025-11-11 19:26:39,563 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 19:26:39,564 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 19:26:39,564 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 19:26:39,571 - agent.state_manager - INFO - Saved session state for sess-986mle58 (user: admin)
2025-11-11 19:26:44,171 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:26:44,173 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 19:26:44,173 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 19:26:44,174 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 19:26:44,180 - agent.state_manager - INFO - Saved session state for sess-986mle58 (user: admin)
2025-11-11 19:26:44,181 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 19:26:44,181 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:26:44,181 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 19:26:44,181 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:26:44,181 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 19:26:44,181 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 19:26:44,182 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 19:26:44,182 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 19:26:44,182 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 19:26:44,182 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 19:26:44,182 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 1011 characters
2025-11-11 19:26:44,182 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 19:26:44,182 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 19:26:44,182 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 19:26:44,182 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 19:26:44,182 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 19:26:44,182 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 19:26:44,182 - tools.impl.nl_to_sql_planner - INFO -     User Query: if i am trying to identify a lmit what are the minimum attributes i need to give you if i dont know the id ?
2025-11-11 19:26:44,182 - tools.impl.nl_to_sql_planner - INFO -     Agent Response: Based on the user's query about identifying a limit, I'll reference the market_risk_limits_overview definition.
2025-11-11 19:26:44,182 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 19:26:44,182 - tools.impl.nl_to_sql_planner - INFO -     **Limit Attributes**: To identify a limit, you would need the following minimum attributes:
2025-11-11 19:26:44,182 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 19:26:44,182 - tools.impl.nl_to_sql_planner - INFO -     1. **Risk Metric**: The type of risk being measured (e.g., PV01, Delta, Gamma, VaR)
2025-11-11 19:26:44,182 - tools.impl.nl_to_sql_planner - INFO -     2. **Risk Measure**: The dollar amount associated with the exposure
2025-11-11 19:26:44,182 - tools.impl.nl_to_sql_planner - INFO -     3. **Threshold**: The actual limit value
2025-11-11 19:26:44,182 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 19:26:44,183 - tools.impl.nl_to_sql_planner - INFO -     **Usage**: These attributes hel
2025-11-11 19:26:44,183 - tools.impl.nl_to_sql_planner - INFO -     ... (411 more characters)
2025-11-11 19:26:44,183 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:26:46,732 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:26:47,447 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:26:51,782 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 19:26:51,783 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 19:26:51,783 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 19:26:51,789 - agent.state_manager - INFO - Saved session state for sess-986mle58 (user: admin)
2025-11-11 19:26:51,791 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 19:26:51,791 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 19:26:51,791 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 19:26:51,795 - agent.state_manager - INFO - Saved session state for sess-986mle58 (user: admin)
2025-11-11 19:26:51,796 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: -- KNOWLEDGE QUESTION...
2025-11-11 19:26:51,796 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 21 chars
2025-11-11 19:26:51,796 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: -- KNOWLEDGE QUESTION
2025-11-11 19:26:51,796 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 19:26:51,796 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 19:26:51,797 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 19:26:51,801 - agent.state_manager - INFO - Saved session state for sess-986mle58 (user: admin)
2025-11-11 19:26:51,801 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=0, columns=0, rows=0, sql=-- KNOWLEDGE QUESTION
2025-11-11 19:26:51,802 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 19:26:51,802 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['columns', 'rows', 'row_count', 'query']
2025-11-11 19:26:51,802 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: -- KNOWLEDGE QUESTION
2025-11-11 19:26:51,802 - agent.graph_nodes - INFO - [END_NODE] Knowledge response detected: '**Limit Value**:
A limit value is a key threshold in market risk management that represents the maxi...'
2025-11-11 19:26:51,802 - agent.graph_nodes - INFO - [END_NODE] Returning knowledge result with response length: 889
2025-11-11 19:26:51,803 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 19:26:51,803 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 19:26:51,803 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 19:26:51,806 - agent.state_manager - INFO - Saved session state for sess-986mle58 (user: admin)
2025-11-11 19:26:51,806 - agent.streaming_agent - INFO - Agent completed for session sess-986mle58: 14436.39ms, 8 steps
2025-11-11 19:26:51,806 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=0, columns=0, rows=0
2025-11-11 19:27:07,424 - root - INFO - WebSocket client disconnected: LRWTAVC_MY5fASwcAAAL
2025-11-11 19:27:07,425 - root - INFO - WebSocket client disconnected: 43abmIF14C0gTDFKAAAJ
2025-11-11 19:27:07,426 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:27:07] "GET /socket.io/?EIO=4&transport=websocket&sid=r2eJWNWB8UOmhCGOAAAI HTTP/1.1" 200 -
2025-11-11 19:27:07,438 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:27:07] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 19:27:07,439 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:27:07] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 19:27:07,440 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 19:27:07,566 - root - INFO - WebSocket client connected: Uyl0lUAhjqITjniZAAAN
2025-11-11 19:27:07,656 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:27:07] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 19:27:09,215 - root - INFO - WebSocket client disconnected: Uyl0lUAhjqITjniZAAAN
2025-11-11 19:27:09,219 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:27:09] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 19:27:09,227 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:27:09] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 19:27:09,228 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 19:27:09,237 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:27:09] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 19:27:09,286 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:27:09] "GET /socket.io/?EIO=4&transport=polling&t=PfrTOnZ HTTP/1.1" 200 -
2025-11-11 19:27:09,289 - root - INFO - WebSocket client connected: A_JukATMxUFkOjU7AAAQ
2025-11-11 19:27:09,289 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:27:09] "POST /socket.io/?EIO=4&transport=polling&t=PfrTOnd&sid=3dtt5fPrfD0FmGWqAAAO HTTP/1.1" 200 -
2025-11-11 19:27:09,290 - root - INFO - WebSocket client connected: D4eGL0M_zfxpsBwyAAAR
2025-11-11 19:27:09,290 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:27:09] "GET /socket.io/?EIO=4&transport=polling&t=PfrTOnd.0&sid=3dtt5fPrfD0FmGWqAAAO HTTP/1.1" 200 -
2025-11-11 19:27:09,293 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:27:09] "POST /socket.io/?EIO=4&transport=polling&t=PfrTOni.0&sid=3dtt5fPrfD0FmGWqAAAO HTTP/1.1" 200 -
2025-11-11 19:27:09,294 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:27:09] "GET /socket.io/?EIO=4&transport=polling&t=PfrTOni&sid=3dtt5fPrfD0FmGWqAAAO HTTP/1.1" 200 -
2025-11-11 19:27:09,296 - root - INFO - Client A_JukATMxUFkOjU7AAAQ joined session room: sess-986mle58
2025-11-11 19:27:09,296 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:27:09] "POST /socket.io/?EIO=4&transport=polling&t=PfrTOnl&sid=3dtt5fPrfD0FmGWqAAAO HTTP/1.1" 200 -
2025-11-11 19:27:09,296 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:27:09] "GET /socket.io/?EIO=4&transport=polling&t=PfrTOnk&sid=3dtt5fPrfD0FmGWqAAAO HTTP/1.1" 200 -
2025-11-11 19:27:09,303 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:27:09] "GET /socket.io/?EIO=4&transport=polling&t=PfrTOnp&sid=3dtt5fPrfD0FmGWqAAAO HTTP/1.1" 200 -
2025-11-11 19:38:20,881 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-11 19:38:20,904 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-11 19:38:20,905 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-11 19:38:20,908 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-11 19:38:20,908 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-11 19:38:20,941 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 19:38:20,941 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 19:38:20,941 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 19:38:20,941 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 19:38:20,941 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-11 19:38:20,941 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-11 19:38:20,941 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-11 19:38:20,942 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-11 19:38:20,942 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-11 19:38:20,943 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-11 19:38:20,943 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-11 19:38:20,943 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-11 19:38:20,943 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-11 19:38:20,944 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-11 19:38:20,944 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-11 19:38:20,945 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-11 19:38:20,945 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-11 19:38:20,946 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-11 19:38:20,946 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-11 19:38:21,392 - DuckDbDescribeTableTool - INFO - Found 1 data files in data/duckdb
2025-11-11 19:38:21,458 - DuckDbDescribeTableTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:38:21,472 - DuckDbDescribeTableTool - INFO - Initialization complete: 4 views available
2025-11-11 19:38:21,472 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:38:21,472 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-11 19:38:21,472 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-11 19:38:21,473 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-11 19:38:21,473 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-11 19:38:21,762 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-11 19:38:21,762 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-11 19:38:21,763 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-11 19:38:21,763 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-11 19:38:21,764 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-11 19:38:21,764 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-11 19:38:21,764 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-11 19:38:21,764 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-11 19:38:21,765 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-11 19:38:21,765 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-11 19:38:21,769 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-11 19:38:21,769 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-11 19:38:21,769 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-11 19:38:21,769 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-11 19:38:21,770 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-11 19:38:21,770 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-11 19:38:21,770 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-11 19:38:21,771 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-11 19:38:21,771 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-11 19:38:21,771 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-11 19:38:21,771 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-11 19:38:21,771 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-11 19:38:21,772 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-11 19:38:21,772 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-11 19:38:21,773 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-11 19:38:21,773 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-11 19:38:21,774 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-11 19:38:21,774 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-11 19:38:21,774 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-11 19:38:21,774 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-11 19:38:21,774 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-11 19:38:21,775 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-11 19:38:21,776 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-11 19:38:21,776 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-11 19:38:21,776 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-11 19:38:21,776 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-11 19:38:21,776 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-11 19:38:21,776 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-11 19:38:21,780 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-11 19:38:21,780 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-11 19:38:21,780 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-11 19:38:21,780 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-11 19:38:21,780 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-11 19:38:21,781 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-11 19:38:21,781 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-11 19:38:21,781 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-11 19:38:21,790 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 19:38:21,790 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 19:38:21,790 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 19:38:21,790 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 19:38:21,790 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-11 19:38:21,790 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-11 19:38:21,790 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-11 19:38:21,791 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-11 19:38:21,791 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-11 19:38:21,791 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-11 19:38:21,791 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-11 19:38:21,792 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-11 19:38:21,792 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-11 19:38:21,792 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-11 19:38:21,792 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-11 19:38:21,793 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-11 19:38:21,793 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-11 19:38:21,793 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-11 19:38:21,793 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-11 19:38:21,794 - DuckDbListFilesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 19:38:21,852 - DuckDbListFilesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:38:21,855 - DuckDbListFilesTool - INFO - Initialization complete: 4 views available
2025-11-11 19:38:21,855 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:38:21,855 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-11 19:38:21,855 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-11 19:38:21,855 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-11 19:38:21,855 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-11 19:38:21,855 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-11 19:38:21,855 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-11 19:38:21,856 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-11 19:38:21,856 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-11 19:38:21,856 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-11 19:38:21,856 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-11 19:38:21,857 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-11 19:38:21,857 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-11 19:38:21,857 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-11 19:38:21,857 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-11 19:38:21,857 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-11 19:38:21,857 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-11 19:38:21,858 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-11 19:38:21,858 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-11 19:38:21,858 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-11 19:38:21,858 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-11 19:38:21,858 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-11 19:38:21,858 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-11 19:38:21,859 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-11 19:38:21,859 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-11 19:38:21,859 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-11 19:38:21,859 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-11 19:38:21,859 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-11 19:38:21,859 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-11 19:38:21,859 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-11 19:38:21,859 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-11 19:38:21,860 - DuckDbGetStatsTool - INFO - Found 1 data files in data/duckdb
2025-11-11 19:38:21,917 - DuckDbGetStatsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:38:21,920 - DuckDbGetStatsTool - INFO - Initialization complete: 4 views available
2025-11-11 19:38:21,920 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:38:21,920 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-11 19:38:21,920 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-11 19:38:21,920 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-11 19:38:21,920 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-11 19:38:21,921 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-11 19:38:21,921 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-11 19:38:21,921 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-11 19:38:21,921 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-11 19:38:21,921 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-11 19:38:21,921 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-11 19:38:21,931 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 19:38:21,931 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 19:38:21,931 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 19:38:21,931 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 19:38:21,931 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-11 19:38:21,931 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-11 19:38:21,931 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-11 19:38:21,931 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-11 19:38:21,931 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-11 19:38:21,931 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-11 19:38:21,931 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-11 19:38:21,948 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-11 19:38:21,948 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-11 19:38:21,949 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-11 19:38:21,949 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-11 19:38:21,949 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-11 19:38:21,949 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-11 19:38:21,949 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-11 19:38:21,949 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-11 19:38:21,949 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-11 19:38:21,949 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-11 19:38:21,949 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-11 19:38:21,949 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-11 19:38:21,950 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-11 19:38:21,950 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-11 19:38:21,950 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-11 19:38:21,950 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-11 19:38:21,950 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-11 19:38:21,951 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-11 19:38:21,951 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-11 19:38:21,951 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-11 19:38:21,952 - DuckDbListTablesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 19:38:22,010 - DuckDbListTablesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:38:22,013 - DuckDbListTablesTool - INFO - Initialization complete: 4 views available
2025-11-11 19:38:22,013 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:38:22,013 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-11 19:38:22,013 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-11 19:38:22,013 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-11 19:38:22,013 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-11 19:38:22,014 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-11 19:38:22,014 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-11 19:38:22,015 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-11 19:38:22,015 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-11 19:38:22,016 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-11 19:38:22,016 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-11 19:38:22,016 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-11 19:38:22,016 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-11 19:38:22,016 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-11 19:38:22,017 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-11 19:38:22,017 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-11 19:38:22,017 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-11 19:38:22,017 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-11 19:38:22,017 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-11 19:38:22,017 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-11 19:38:22,017 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-11 19:38:22,017 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-11 19:38:22,017 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-11 19:38:22,018 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-11 19:38:22,018 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-11 19:38:22,018 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-11 19:38:22,018 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-11 19:38:22,018 - DuckDbAggregateTool - INFO - Found 1 data files in data/duckdb
2025-11-11 19:38:22,078 - DuckDbAggregateTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:38:22,080 - DuckDbAggregateTool - INFO - Initialization complete: 4 views available
2025-11-11 19:38:22,080 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:38:22,080 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-11 19:38:22,080 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-11 19:38:22,080 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-11 19:38:22,081 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-11 19:38:22,081 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-11 19:38:22,081 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-11 19:38:22,081 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-11 19:38:22,081 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-11 19:38:22,081 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-11 19:38:22,081 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-11 19:38:22,082 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-11 19:38:22,082 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-11 19:38:22,082 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-11 19:38:22,082 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-11 19:38:22,091 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 19:38:22,091 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 19:38:22,091 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 19:38:22,091 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 19:38:22,091 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-11 19:38:22,091 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-11 19:38:22,091 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-11 19:38:22,092 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-11 19:38:22,092 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-11 19:38:22,092 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-11 19:38:22,092 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-11 19:38:22,092 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-11 19:38:22,092 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-11 19:38:22,092 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-11 19:38:22,092 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-11 19:38:22,093 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-11 19:38:22,093 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-11 19:38:22,093 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-11 19:38:22,093 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-11 19:38:22,093 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-11 19:38:22,093 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-11 19:38:22,093 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-11 19:38:22,093 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-11 19:38:22,093 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-11 19:38:22,093 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-11 19:38:22,094 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-11 19:38:22,094 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-11 19:38:22,094 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-11 19:38:22,094 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-11 19:38:22,094 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-11 19:38:22,094 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-11 19:38:22,094 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-11 19:38:22,095 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-11 19:38:22,095 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-11 19:38:22,095 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-11 19:38:22,095 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-11 19:38:22,095 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-11 19:38:22,096 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-11 19:38:22,096 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-11 19:38:22,096 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-11 19:38:22,096 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-11 19:38:22,096 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-11 19:38:22,096 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-11 19:38:22,096 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-11 19:38:22,096 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-11 19:38:22,096 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-11 19:38:22,096 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-11 19:38:22,097 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-11 19:38:22,097 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-11 19:38:22,097 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-11 19:38:22,097 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-11 19:38:22,097 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-11 19:38:22,097 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-11 19:38:22,097 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-11 19:38:22,097 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-11 19:38:22,098 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-11 19:38:22,098 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-11 19:38:22,098 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-11 19:38:22,098 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-11 19:38:22,098 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-11 19:38:22,098 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-11 19:38:22,098 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-11 19:38:22,098 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-11 19:38:22,099 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-11 19:38:22,099 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-11 19:38:22,099 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-11 19:38:22,100 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-11 19:38:22,100 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-11 19:38:22,100 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-11 19:38:22,100 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-11 19:38:22,100 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-11 19:38:22,100 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-11 19:38:22,100 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-11 19:38:22,100 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-11 19:38:22,100 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-11 19:38:22,110 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 19:38:22,110 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 19:38:22,110 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 19:38:22,110 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 19:38:22,110 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-11 19:38:22,110 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-11 19:38:22,110 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-11 19:38:22,110 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-11 19:38:22,110 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-11 19:38:22,110 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-11 19:38:22,110 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-11 19:38:22,110 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-11 19:38:22,110 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-11 19:38:22,111 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-11 19:38:22,111 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-11 19:38:22,111 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-11 19:38:22,111 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-11 19:38:22,111 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-11 19:38:22,111 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-11 19:38:22,111 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-11 19:38:22,111 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-11 19:38:22,111 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-11 19:38:22,111 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-11 19:38:22,112 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-11 19:38:22,112 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-11 19:38:22,112 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-11 19:38:22,112 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-11 19:38:22,112 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-11 19:38:22,112 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-11 19:38:22,112 - DuckDbQueryTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 19:38:22,172 - DuckDbQueryTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:38:22,175 - DuckDbQueryTool - INFO - Initialization complete: 4 views available
2025-11-11 19:38:22,175 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:38:22,175 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-11 19:38:22,175 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-11 19:38:22,175 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-11 19:38:22,175 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-11 19:38:22,175 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-11 19:38:22,176 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-11 19:38:22,176 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-11 19:38:22,176 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-11 19:38:22,176 - DuckDbRefreshViewsTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 19:38:22,236 - DuckDbRefreshViewsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:38:22,238 - DuckDbRefreshViewsTool - INFO - Initialization complete: 4 views available
2025-11-11 19:38:22,238 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:38:22,238 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-11 19:38:22,238 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-11 19:38:22,238 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-11 19:38:22,238 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-11 19:38:22,239 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-11 19:38:22,239 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-11 19:38:22,248 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 19:38:22,248 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 19:38:22,248 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 19:38:22,248 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 19:38:22,248 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-11 19:38:22,248 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-11 19:38:22,248 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-11 19:38:22,249 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-11 19:38:22,249 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-11 19:38:22,249 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-11 19:38:22,249 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-11 19:38:22,249 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-11 19:38:22,249 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-11 19:38:22,249 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-11 19:38:22,249 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-11 19:38:22,250 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-11 19:38:22,250 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-11 19:38:22,250 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-11 19:38:22,250 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-11 19:38:22,250 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-11 19:38:22,263 - root - INFO - All routes registered successfully
2025-11-11 19:38:22,263 - werkzeug - WARNING - Werkzeug appears to be used in a production deployment. Consider switching to a production web server instead.
2025-11-11 19:38:22,268 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.68.51:8000
2025-11-11 19:38:22,268 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-11-11 19:38:27,017 - root - INFO - WebSocket client connected: b0JaO4VyVkLl-a0hAAAB
2025-11-11 19:38:27,024 - root - INFO - WebSocket client disconnected: b0JaO4VyVkLl-a0hAAAB
2025-11-11 19:38:27,038 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:27] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 19:38:27,041 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 19:38:28,007 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:28] "GET /socket.io/?EIO=4&transport=polling&t=PfrV-Ub HTTP/1.1" 200 -
2025-11-11 19:38:28,013 - root - INFO - WebSocket client connected: bDLH_QpFouFAbIEWAAAD
2025-11-11 19:38:28,013 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:28] "POST /socket.io/?EIO=4&transport=polling&t=PfrV-Uf&sid=pQFjJLlmACZxZ65bAAAC HTTP/1.1" 200 -
2025-11-11 19:38:28,014 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:28] "GET /socket.io/?EIO=4&transport=polling&t=PfrV-Ug&sid=pQFjJLlmACZxZ65bAAAC HTTP/1.1" 200 -
2025-11-11 19:38:28,019 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:28] "GET /socket.io/?EIO=4&transport=polling&t=PfrV-Um&sid=pQFjJLlmACZxZ65bAAAC HTTP/1.1" 200 -
2025-11-11 19:38:28,019 - root - INFO - WebSocket client disconnected: bDLH_QpFouFAbIEWAAAD
2025-11-11 19:38:28,019 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:28] "POST /socket.io/?EIO=4&transport=polling&t=PfrV-Un&sid=pQFjJLlmACZxZ65bAAAC HTTP/1.1" 200 -
2025-11-11 19:38:28,022 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:28] "GET /socket.io/?EIO=4&transport=websocket&sid=pQFjJLlmACZxZ65bAAAC HTTP/1.1" 200 -
2025-11-11 19:38:41,396 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:41] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 19:38:41,425 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:41] "GET /login?next=http://127.0.0.1:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 19:38:41,461 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:41] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 19:38:41,474 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:41] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 19:38:41,477 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:41] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 19:38:41,626 - root - INFO - WebSocket client connected: 3zWLTBDrJ6l0pKPbAAAF
2025-11-11 19:38:41,636 - root - INFO - WebSocket client disconnected: 3zWLTBDrJ6l0pKPbAAAF
2025-11-11 19:38:41,651 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:41] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 19:38:41,653 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 19:38:46,532 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 19:38:46,532 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 19:38:46,533 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:46] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 19:38:46,550 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:46] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 19:38:46,584 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:46] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 19:38:46,587 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:46] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 19:38:46,587 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:46] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 19:38:46,733 - root - INFO - WebSocket client connected: BdqLsztue-RNAH_nAAAH
2025-11-11 19:38:46,735 - root - INFO - WebSocket client disconnected: BdqLsztue-RNAH_nAAAH
2025-11-11 19:38:46,747 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:46] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 19:38:46,748 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 19:38:51,801 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:51] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 19:38:51,833 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:51] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 19:38:51,835 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:51] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 19:38:51,837 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:51] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 19:38:51,892 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:51] "GET /socket.io/?EIO=4&transport=polling&t=PfrW4Jm HTTP/1.1" 200 -
2025-11-11 19:38:51,898 - root - INFO - WebSocket client connected: 28648427GKcZ7pU7AAAK
2025-11-11 19:38:51,899 - root - INFO - WebSocket client connected: xgQcHF6XF4gJNqe-AAAL
2025-11-11 19:38:51,899 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:51] "POST /socket.io/?EIO=4&transport=polling&t=PfrW4Jt&sid=YDqBzT1z2gvUug7ZAAAI HTTP/1.1" 200 -
2025-11-11 19:38:51,899 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:51] "GET /socket.io/?EIO=4&transport=polling&t=PfrW4Ju&sid=YDqBzT1z2gvUug7ZAAAI HTTP/1.1" 200 -
2025-11-11 19:38:51,905 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:51] "GET /socket.io/?EIO=4&transport=polling&t=PfrW4J_&sid=YDqBzT1z2gvUug7ZAAAI HTTP/1.1" 200 -
2025-11-11 19:38:51,906 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:51] "POST /socket.io/?EIO=4&transport=polling&t=PfrW4J_.0&sid=YDqBzT1z2gvUug7ZAAAI HTTP/1.1" 200 -
2025-11-11 19:38:51,909 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:51] "GET /socket.io/?EIO=4&transport=polling&t=PfrW4K3&sid=YDqBzT1z2gvUug7ZAAAI HTTP/1.1" 200 -
2025-11-11 19:38:51,911 - root - INFO - Client xgQcHF6XF4gJNqe-AAAL joined session room: sess-986mle58
2025-11-11 19:38:51,912 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:38:51] "POST /socket.io/?EIO=4&transport=polling&t=PfrW4K3.0&sid=YDqBzT1z2gvUug7ZAAAI HTTP/1.1" 200 -
2025-11-11 19:38:57,120 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 19:38:57,121 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-986mle58
2025-11-11 19:38:57,122 - agent.state_manager - INFO - Loaded session state for sess-986mle58
2025-11-11 19:38:57,122 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 1 turns
2025-11-11 19:38:57,122 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 1 conversation turns
2025-11-11 19:38:57,132 - agent.state_manager - INFO - Saved session state for sess-986mle58 (user: admin)
2025-11-11 19:38:57,132 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 19:38:57,132 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 19:38:57,132 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 19:38:57,132 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=1, conv_history(str)=1011
2025-11-11 19:38:57,132 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 19:38:57,133 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 19:38:57,133 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 19:38:57,134 - agent.state_manager - INFO - Saved session state for sess-986mle58 (user: admin)
2025-11-11 19:38:57,134 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 19:38:59,354 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:38:59,374 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous response already outlined the key attributes needed to identify a limit, including risk metric, risk measure, threshold, trading desk, risk category, and limit type. The new query is essentially asking about the minimum attributes for limit identification, which was comprehensively answered in the previous response. No additional database query is required.
2025-11-11 19:38:59,374 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 19:38:59,374 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 19:38:59,375 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 19:38:59,378 - agent.state_manager - INFO - Saved session state for sess-986mle58 (user: admin)
2025-11-11 19:39:03,307 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:39:03,311 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 19:39:03,311 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 19:39:03,311 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 19:39:03,314 - agent.state_manager - INFO - Saved session state for sess-986mle58 (user: admin)
2025-11-11 19:39:03,314 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 19:39:03,314 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:39:03,314 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 19:39:03,314 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:39:03,314 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 19:39:03,314 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 19:39:03,314 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 19:39:03,314 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 19:39:03,314 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 19:39:03,314 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 19:39:03,314 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 1011 characters
2025-11-11 19:39:03,315 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 19:39:03,315 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 19:39:03,315 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 19:39:03,315 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 19:39:03,315 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 19:39:03,315 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 19:39:03,315 - tools.impl.nl_to_sql_planner - INFO -     User Query: if i am trying to identify a lmit what are the minimum attributes i need to give you if i dont know the id ?
2025-11-11 19:39:03,315 - tools.impl.nl_to_sql_planner - INFO -     Agent Response: Based on the user's query about identifying a limit, I'll reference the market_risk_limits_overview definition.
2025-11-11 19:39:03,315 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 19:39:03,315 - tools.impl.nl_to_sql_planner - INFO -     **Limit Attributes**: To identify a limit, you would need the following minimum attributes:
2025-11-11 19:39:03,315 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 19:39:03,315 - tools.impl.nl_to_sql_planner - INFO -     1. **Risk Metric**: The type of risk being measured (e.g., PV01, Delta, Gamma, VaR)
2025-11-11 19:39:03,316 - tools.impl.nl_to_sql_planner - INFO -     2. **Risk Measure**: The dollar amount associated with the exposure
2025-11-11 19:39:03,316 - tools.impl.nl_to_sql_planner - INFO -     3. **Threshold**: The actual limit value
2025-11-11 19:39:03,316 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 19:39:03,316 - tools.impl.nl_to_sql_planner - INFO -     **Usage**: These attributes hel
2025-11-11 19:39:03,316 - tools.impl.nl_to_sql_planner - INFO -     ... (411 more characters)
2025-11-11 19:39:03,316 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:39:06,582 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:39:08,445 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:39:09,722 - root - INFO - WebSocket client disconnected: 28648427GKcZ7pU7AAAK
2025-11-11 19:39:09,722 - root - INFO - WebSocket client disconnected: xgQcHF6XF4gJNqe-AAAL
2025-11-11 19:39:09,723 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:39:09] "GET /socket.io/?EIO=4&transport=websocket&sid=YDqBzT1z2gvUug7ZAAAI HTTP/1.1" 200 -
2025-11-11 19:39:09,728 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:39:09] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 19:39:09,729 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 19:39:11,301 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:39:11,302 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 19:39:11,302 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:39:11,302 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 1011
2025-11-11 19:39:11,302 - tools.impl.nl_to_sql_planner - INFO - Attempting extraction without code blocks...
2025-11-11 19:39:11,303 - tools.impl.nl_to_sql_planner - INFO - ‚úó SELECT pattern didn't match either
2025-11-11 19:39:11,303 - tools.impl.nl_to_sql_planner - INFO - 
‚ùå FAILED TO EXTRACT PREVIOUS SQL!
2025-11-11 19:39:11,303 - tools.impl.nl_to_sql_planner - INFO -    This means FILTER-ONLY mode will NOT work correctly
2025-11-11 19:39:11,303 - tools.impl.nl_to_sql_planner - INFO -    The LLM will not have the previous query to build upon
2025-11-11 19:39:11,303 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:39:11,304 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 19:39:11,305 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 19:39:11,305 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10317 chars
2025-11-11 19:39:11,305 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 23578 chars
2025-11-11 19:39:11,305 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 19:39:11,305 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 19:39:13,648 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:39:15,559 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 402 chars
2025-11-11 19:39:15,560 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
    "explanation": "Retrieved top primary limits for the latest date, sorted by utilization in descending order. Applied 'Primary' limit class filter since query mentioned 'primary' and used most recent date as default.",
    "target_table": "limits_data"
}
2025-11-11 19:39:15,560 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 19:39:15,560 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 19:39:15,560 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:39:15,561 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 19:39:15,561 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 19:39:15,561 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 19:39:15,561 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 19:39:15,564 - agent.state_manager - INFO - Saved session state for sess-986mle58 (user: admin)
2025-11-11 19:39:15,564 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 19:39:15,564 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 19:39:15,564 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 19:39:15,566 - agent.state_manager - INFO - Saved session state for sess-986mle58 (user: admin)
2025-11-11 19:39:15,566 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:39:15,566 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 19:39:15,566 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 19:39:15,566 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:39:15,566 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:39:15,567 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 19:39:15,567 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:39:15,727 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 19:39:15,728 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 19:39:15,728 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 19:39:15,731 - agent.state_manager - INFO - Saved session state for sess-986mle58 (user: admin)
2025-11-11 19:39:15,731 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 19:39:15,731 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 19:39:15,731 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 19:39:15,731 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 19:39:15,731 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 19:39:15,731 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 19:39:15,731 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 19:39:15,733 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4840 chars
2025-11-11 19:39:16,828 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:39:19,815 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:39:19] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 19:39:19,819 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:39:19] "GET /login?next=http://localhost:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 19:39:19,892 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:39:19] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 19:39:19,892 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:39:19] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 19:39:24,969 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 19:39:24,969 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 19:39:24,970 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:39:24] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 19:39:24,983 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:39:24] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 19:39:24,993 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:39:24] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 19:39:24,994 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:39:24] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 19:39:27,431 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1797 chars
2025-11-11 19:39:27,433 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 19:39:27,433 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 19:39:27,435 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 38704 chars
2025-11-11 19:39:31,058 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:39:31] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 19:39:31,145 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:39:31] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 19:39:31,151 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:39:31] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 19:39:31,216 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:39:31] "GET /socket.io/?EIO=4&transport=polling&t=PfrWDwE HTTP/1.1" 200 -
2025-11-11 19:39:31,222 - root - INFO - WebSocket client connected: cxTez4NjnAdEU2dLAAAO
2025-11-11 19:39:31,223 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:39:31] "POST /socket.io/?EIO=4&transport=polling&t=PfrWDwK&sid=2oVsWX53i8ZP0rtZAAAM HTTP/1.1" 200 -
2025-11-11 19:39:31,224 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:39:31] "GET /socket.io/?EIO=4&transport=polling&t=PfrWDwK.0&sid=2oVsWX53i8ZP0rtZAAAM HTTP/1.1" 200 -
2025-11-11 19:39:31,224 - root - INFO - WebSocket client connected: 5ymEWzrR7wFskpr8AAAP
2025-11-11 19:39:31,228 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:39:31] "POST /socket.io/?EIO=4&transport=polling&t=PfrWDwQ&sid=2oVsWX53i8ZP0rtZAAAM HTTP/1.1" 200 -
2025-11-11 19:39:31,228 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:39:31] "GET /socket.io/?EIO=4&transport=polling&t=PfrWDwP&sid=2oVsWX53i8ZP0rtZAAAM HTTP/1.1" 200 -
2025-11-11 19:39:31,231 - root - INFO - Client cxTez4NjnAdEU2dLAAAO joined session room: sess-kfgl6x71
2025-11-11 19:39:31,231 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:39:31] "POST /socket.io/?EIO=4&transport=polling&t=PfrWDwT.0&sid=2oVsWX53i8ZP0rtZAAAM HTTP/1.1" 200 -
2025-11-11 19:39:31,231 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:39:31] "GET /socket.io/?EIO=4&transport=polling&t=PfrWDwT&sid=2oVsWX53i8ZP0rtZAAAM HTTP/1.1" 200 -
2025-11-11 19:39:31,234 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:39:31] "GET /socket.io/?EIO=4&transport=polling&t=PfrWDwX&sid=2oVsWX53i8ZP0rtZAAAM HTTP/1.1" 200 -
2025-11-11 19:39:35,675 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 19:39:35,675 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-kfgl6x71
2025-11-11 19:39:35,676 - agent.state_manager - WARNING - Session sess-kfgl6x71 not found
2025-11-11 19:39:35,676 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 19:39:35,680 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:39:35,681 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 19:39:35,681 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 19:39:35,681 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 19:39:35,681 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 19:39:35,682 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 19:39:35,682 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 19:39:35,682 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 19:39:35,684 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:39:35,696 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:39:35,698 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1137 chars
2025-11-11 19:39:35,698 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 19:39:35,698 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 19:39:35,698 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 19:39:35,698 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 19:39:35,699 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 19:39:35,699 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 19:39:35,699 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 19:39:35,706 - agent.state_manager - INFO - Saved session state for sess-986mle58 (user: admin)
2025-11-11 19:39:35,706 - agent.streaming_agent - INFO - Agent completed for session sess-986mle58: 38573.725000000006ms, 8 steps
2025-11-11 19:39:35,706 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 19:39:40,170 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:39:40,173 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 19:39:40,173 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 19:39:40,173 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 19:39:40,178 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:39:40,178 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 19:39:40,178 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:39:40,179 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 19:39:40,179 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:39:40,179 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 19:39:40,179 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 19:39:40,179 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 19:39:40,179 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 19:39:40,179 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 19:39:40,179 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 19:39:40,179 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 19:39:40,179 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 19:39:40,179 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 19:39:40,179 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 19:39:40,179 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 19:39:40,180 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:39:43,454 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:39:45,136 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:39:47,385 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 19:39:47,385 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 19:39:47,386 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-11 19:39:47,386 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 22600 chars
2025-11-11 19:39:47,386 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 19:39:47,386 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 19:39:49,319 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:39:51,231 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 364 chars
2025-11-11 19:39:51,231 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
  "explanation": "Retrieved top primary limits for the latest date, sorted by utilization in descending order. Applied 'Primary' limit class filter and used most recent date as default.",
  "target_table": "limits_data"
}
2025-11-11 19:39:51,231 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 19:39:51,231 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 19:39:51,231 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:39:51,231 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 19:39:51,232 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 19:39:51,232 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 19:39:51,232 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 19:39:51,235 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:39:51,236 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 19:39:51,236 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 19:39:51,236 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 19:39:51,239 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:39:51,239 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:39:51,239 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 19:39:51,240 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 19:39:51,241 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:39:51,241 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:39:51,241 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 19:39:51,241 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:39:51,353 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 19:39:51,353 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 19:39:51,354 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 19:39:51,355 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:39:51,356 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 19:39:51,356 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 19:39:51,356 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 19:39:51,356 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 19:39:51,356 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 19:39:51,356 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 19:39:51,356 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 19:39:51,357 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4841 chars
2025-11-11 19:39:52,253 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:40:02,230 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1812 chars
2025-11-11 19:40:02,231 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 19:40:02,231 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 19:40:02,232 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 38218 chars
2025-11-11 19:40:09,231 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:40:09,233 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 886 chars
2025-11-11 19:40:09,233 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 19:40:09,233 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 19:40:09,234 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 19:40:09,234 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 19:40:09,234 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 19:40:09,235 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 19:40:09,235 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 19:40:09,244 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:40:09,245 - agent.streaming_agent - INFO - Agent completed for session sess-kfgl6x71: 33563.91ms, 7 steps
2025-11-11 19:40:09,245 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 19:53:21,558 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-11 19:53:21,588 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-11 19:53:21,588 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-11 19:53:21,590 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-11 19:53:21,590 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-11 19:53:21,624 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 19:53:21,624 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 19:53:21,624 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 19:53:21,624 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 19:53:21,624 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-11 19:53:21,624 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-11 19:53:21,624 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-11 19:53:21,625 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-11 19:53:21,626 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-11 19:53:21,627 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-11 19:53:21,627 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-11 19:53:21,627 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-11 19:53:21,627 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-11 19:53:21,628 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-11 19:53:21,628 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-11 19:53:21,629 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-11 19:53:21,629 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-11 19:53:21,631 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-11 19:53:21,631 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-11 19:53:22,087 - DuckDbDescribeTableTool - INFO - Found 1 data files in data/duckdb
2025-11-11 19:53:22,156 - DuckDbDescribeTableTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:53:22,171 - DuckDbDescribeTableTool - INFO - Initialization complete: 4 views available
2025-11-11 19:53:22,172 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:53:22,172 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-11 19:53:22,172 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-11 19:53:22,175 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-11 19:53:22,175 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-11 19:53:22,518 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-11 19:53:22,518 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-11 19:53:22,519 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-11 19:53:22,519 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-11 19:53:22,520 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-11 19:53:22,520 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-11 19:53:22,521 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-11 19:53:22,521 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-11 19:53:22,521 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-11 19:53:22,521 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-11 19:53:22,525 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-11 19:53:22,525 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-11 19:53:22,525 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-11 19:53:22,525 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-11 19:53:22,526 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-11 19:53:22,526 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-11 19:53:22,527 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-11 19:53:22,527 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-11 19:53:22,528 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-11 19:53:22,528 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-11 19:53:22,528 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-11 19:53:22,528 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-11 19:53:22,528 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-11 19:53:22,528 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-11 19:53:22,529 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-11 19:53:22,529 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-11 19:53:22,530 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-11 19:53:22,530 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-11 19:53:22,530 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-11 19:53:22,530 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-11 19:53:22,531 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-11 19:53:22,531 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-11 19:53:22,532 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-11 19:53:22,532 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-11 19:53:22,532 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-11 19:53:22,532 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-11 19:53:22,533 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-11 19:53:22,533 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-11 19:53:22,536 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-11 19:53:22,536 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-11 19:53:22,536 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-11 19:53:22,536 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-11 19:53:22,536 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-11 19:53:22,536 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-11 19:53:22,537 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-11 19:53:22,537 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-11 19:53:22,546 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 19:53:22,546 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 19:53:22,546 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 19:53:22,546 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 19:53:22,546 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-11 19:53:22,546 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-11 19:53:22,547 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-11 19:53:22,547 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-11 19:53:22,547 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-11 19:53:22,547 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-11 19:53:22,547 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-11 19:53:22,548 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-11 19:53:22,548 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-11 19:53:22,548 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-11 19:53:22,548 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-11 19:53:22,549 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-11 19:53:22,549 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-11 19:53:22,549 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-11 19:53:22,549 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-11 19:53:22,550 - DuckDbListFilesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 19:53:22,609 - DuckDbListFilesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:53:22,612 - DuckDbListFilesTool - INFO - Initialization complete: 4 views available
2025-11-11 19:53:22,612 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:53:22,612 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-11 19:53:22,612 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-11 19:53:22,612 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-11 19:53:22,612 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-11 19:53:22,612 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-11 19:53:22,612 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-11 19:53:22,613 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-11 19:53:22,613 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-11 19:53:22,613 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-11 19:53:22,613 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-11 19:53:22,614 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-11 19:53:22,614 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-11 19:53:22,614 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-11 19:53:22,614 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-11 19:53:22,614 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-11 19:53:22,614 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-11 19:53:22,615 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-11 19:53:22,615 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-11 19:53:22,615 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-11 19:53:22,615 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-11 19:53:22,615 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-11 19:53:22,615 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-11 19:53:22,615 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-11 19:53:22,615 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-11 19:53:22,616 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-11 19:53:22,616 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-11 19:53:22,616 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-11 19:53:22,616 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-11 19:53:22,616 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-11 19:53:22,616 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-11 19:53:22,617 - DuckDbGetStatsTool - INFO - Found 1 data files in data/duckdb
2025-11-11 19:53:22,676 - DuckDbGetStatsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:53:22,678 - DuckDbGetStatsTool - INFO - Initialization complete: 4 views available
2025-11-11 19:53:22,678 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:53:22,678 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-11 19:53:22,679 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-11 19:53:22,679 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-11 19:53:22,679 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-11 19:53:22,679 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-11 19:53:22,679 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-11 19:53:22,679 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-11 19:53:22,679 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-11 19:53:22,680 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-11 19:53:22,680 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-11 19:53:22,689 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 19:53:22,689 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 19:53:22,689 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 19:53:22,689 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 19:53:22,689 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-11 19:53:22,689 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-11 19:53:22,689 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-11 19:53:22,689 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-11 19:53:22,690 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-11 19:53:22,690 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-11 19:53:22,690 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-11 19:53:22,694 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-11 19:53:22,694 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-11 19:53:22,694 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-11 19:53:22,694 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-11 19:53:22,695 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-11 19:53:22,695 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-11 19:53:22,695 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-11 19:53:22,695 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-11 19:53:22,695 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-11 19:53:22,695 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-11 19:53:22,695 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-11 19:53:22,695 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-11 19:53:22,695 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-11 19:53:22,695 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-11 19:53:22,696 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-11 19:53:22,696 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-11 19:53:22,696 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-11 19:53:22,696 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-11 19:53:22,696 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-11 19:53:22,696 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-11 19:53:22,697 - DuckDbListTablesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 19:53:22,755 - DuckDbListTablesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:53:22,757 - DuckDbListTablesTool - INFO - Initialization complete: 4 views available
2025-11-11 19:53:22,757 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:53:22,757 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-11 19:53:22,757 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-11 19:53:22,757 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-11 19:53:22,758 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-11 19:53:22,758 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-11 19:53:22,758 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-11 19:53:22,758 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-11 19:53:22,758 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-11 19:53:22,758 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-11 19:53:22,758 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-11 19:53:22,759 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-11 19:53:22,759 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-11 19:53:22,759 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-11 19:53:22,759 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-11 19:53:22,760 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-11 19:53:22,760 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-11 19:53:22,760 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-11 19:53:22,760 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-11 19:53:22,760 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-11 19:53:22,760 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-11 19:53:22,760 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-11 19:53:22,760 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-11 19:53:22,761 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-11 19:53:22,761 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-11 19:53:22,761 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-11 19:53:22,761 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-11 19:53:22,762 - DuckDbAggregateTool - INFO - Found 1 data files in data/duckdb
2025-11-11 19:53:22,820 - DuckDbAggregateTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:53:22,822 - DuckDbAggregateTool - INFO - Initialization complete: 4 views available
2025-11-11 19:53:22,822 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:53:22,822 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-11 19:53:22,823 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-11 19:53:22,823 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-11 19:53:22,823 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-11 19:53:22,823 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-11 19:53:22,823 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-11 19:53:22,823 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-11 19:53:22,823 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-11 19:53:22,824 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-11 19:53:22,824 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-11 19:53:22,824 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-11 19:53:22,824 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-11 19:53:22,824 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-11 19:53:22,824 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-11 19:53:22,834 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 19:53:22,834 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 19:53:22,834 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 19:53:22,834 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 19:53:22,834 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-11 19:53:22,834 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-11 19:53:22,834 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-11 19:53:22,834 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-11 19:53:22,834 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-11 19:53:22,835 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-11 19:53:22,835 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-11 19:53:22,835 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-11 19:53:22,835 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-11 19:53:22,835 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-11 19:53:22,835 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-11 19:53:22,835 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-11 19:53:22,835 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-11 19:53:22,836 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-11 19:53:22,836 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-11 19:53:22,836 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-11 19:53:22,836 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-11 19:53:22,836 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-11 19:53:22,836 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-11 19:53:22,836 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-11 19:53:22,836 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-11 19:53:22,836 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-11 19:53:22,836 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-11 19:53:22,837 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-11 19:53:22,837 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-11 19:53:22,837 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-11 19:53:22,837 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-11 19:53:22,838 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-11 19:53:22,838 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-11 19:53:22,838 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-11 19:53:22,838 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-11 19:53:22,838 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-11 19:53:22,838 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-11 19:53:22,838 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-11 19:53:22,838 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-11 19:53:22,839 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-11 19:53:22,839 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-11 19:53:22,839 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-11 19:53:22,839 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-11 19:53:22,839 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-11 19:53:22,839 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-11 19:53:22,839 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-11 19:53:22,839 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-11 19:53:22,840 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-11 19:53:22,840 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-11 19:53:22,840 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-11 19:53:22,840 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-11 19:53:22,840 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-11 19:53:22,840 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-11 19:53:22,840 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-11 19:53:22,840 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-11 19:53:22,841 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-11 19:53:22,841 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-11 19:53:22,841 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-11 19:53:22,841 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-11 19:53:22,841 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-11 19:53:22,841 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-11 19:53:22,841 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-11 19:53:22,841 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-11 19:53:22,842 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-11 19:53:22,842 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-11 19:53:22,843 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-11 19:53:22,843 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-11 19:53:22,843 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-11 19:53:22,843 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-11 19:53:22,843 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-11 19:53:22,843 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-11 19:53:22,843 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-11 19:53:22,843 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-11 19:53:22,843 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-11 19:53:22,843 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-11 19:53:22,852 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 19:53:22,853 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 19:53:22,853 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 19:53:22,853 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 19:53:22,853 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-11 19:53:22,853 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-11 19:53:22,853 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-11 19:53:22,853 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-11 19:53:22,853 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-11 19:53:22,853 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-11 19:53:22,853 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-11 19:53:22,853 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-11 19:53:22,853 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-11 19:53:22,854 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-11 19:53:22,854 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-11 19:53:22,854 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-11 19:53:22,854 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-11 19:53:22,854 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-11 19:53:22,854 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-11 19:53:22,854 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-11 19:53:22,854 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-11 19:53:22,855 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-11 19:53:22,855 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-11 19:53:22,855 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-11 19:53:22,855 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-11 19:53:22,855 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-11 19:53:22,855 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-11 19:53:22,855 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-11 19:53:22,855 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-11 19:53:22,856 - DuckDbQueryTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 19:53:22,915 - DuckDbQueryTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:53:22,917 - DuckDbQueryTool - INFO - Initialization complete: 4 views available
2025-11-11 19:53:22,917 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:53:22,917 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-11 19:53:22,917 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-11 19:53:22,918 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-11 19:53:22,918 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-11 19:53:22,918 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-11 19:53:22,918 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-11 19:53:22,918 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-11 19:53:22,918 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-11 19:53:22,919 - DuckDbRefreshViewsTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 19:53:22,978 - DuckDbRefreshViewsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 19:53:22,980 - DuckDbRefreshViewsTool - INFO - Initialization complete: 4 views available
2025-11-11 19:53:22,980 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 19:53:22,980 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-11 19:53:22,980 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-11 19:53:22,980 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-11 19:53:22,980 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-11 19:53:22,981 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-11 19:53:22,981 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-11 19:53:22,990 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 19:53:22,990 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 19:53:22,990 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 19:53:22,990 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 19:53:22,990 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-11 19:53:22,990 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-11 19:53:22,990 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-11 19:53:22,991 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-11 19:53:22,991 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-11 19:53:22,991 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-11 19:53:22,991 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-11 19:53:22,991 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-11 19:53:22,991 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-11 19:53:22,991 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-11 19:53:22,991 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-11 19:53:22,992 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-11 19:53:22,992 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-11 19:53:22,992 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-11 19:53:22,992 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-11 19:53:22,992 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-11 19:53:23,005 - root - INFO - All routes registered successfully
2025-11-11 19:53:23,005 - werkzeug - WARNING - Werkzeug appears to be used in a production deployment. Consider switching to a production web server instead.
2025-11-11 19:53:23,011 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.68.51:8000
2025-11-11 19:53:23,011 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-11-11 19:53:23,018 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:53:23] "GET /socket.io/?EIO=4&transport=polling&t=PfrZO_1 HTTP/1.1" 200 -
2025-11-11 19:53:23,024 - root - INFO - WebSocket client connected: FEcwhDOy_PHobNTcAAAB
2025-11-11 19:53:23,024 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:53:23] "POST /socket.io/?EIO=4&transport=polling&t=PfrZO_D&sid=BsvjgJ15Oezn4C0xAAAA HTTP/1.1" 200 -
2025-11-11 19:53:23,025 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:53:23] "GET /socket.io/?EIO=4&transport=polling&t=PfrZO_D.0&sid=BsvjgJ15Oezn4C0xAAAA HTTP/1.1" 200 -
2025-11-11 19:53:23,028 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:53:23] "GET /socket.io/?EIO=4&transport=polling&t=PfrZO_I&sid=BsvjgJ15Oezn4C0xAAAA HTTP/1.1" 200 -
2025-11-11 19:53:23,028 - root - INFO - WebSocket client disconnected: FEcwhDOy_PHobNTcAAAB
2025-11-11 19:53:23,029 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:53:23] "POST /socket.io/?EIO=4&transport=polling&t=PfrZO_J&sid=BsvjgJ15Oezn4C0xAAAA HTTP/1.1" 200 -
2025-11-11 19:53:23,030 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:53:23] "GET /socket.io/?EIO=4&transport=websocket&sid=BsvjgJ15Oezn4C0xAAAA HTTP/1.1" 200 -
2025-11-11 19:53:24,021 - root - INFO - WebSocket client connected: e9EbC5OcO91KreDnAAAD
2025-11-11 19:53:24,024 - root - INFO - WebSocket client disconnected: e9EbC5OcO91KreDnAAAD
2025-11-11 19:53:24,040 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:53:24] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 19:53:24,044 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 19:54:10,719 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:54:10] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 19:54:10,766 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:54:10] "GET /login?next=http://localhost:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 19:54:10,810 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:54:10] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 19:54:10,817 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:54:10] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 19:54:11,089 - root - INFO - WebSocket client connected: 35EUQiUTOZ1Uh2WbAAAF
2025-11-11 19:54:11,100 - root - INFO - WebSocket client disconnected: 35EUQiUTOZ1Uh2WbAAAF
2025-11-11 19:54:11,116 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:54:11] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 19:54:11,121 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 19:54:17,591 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 19:54:17,591 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 19:54:17,592 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:54:17] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 19:54:17,615 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:54:17] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 19:54:17,631 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:54:17] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 19:54:17,632 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:54:17] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 19:54:17,736 - root - INFO - WebSocket client connected: hFLy0nmnLfIZ-kVrAAAH
2025-11-11 19:54:17,738 - root - INFO - WebSocket client disconnected: hFLy0nmnLfIZ-kVrAAAH
2025-11-11 19:54:17,750 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:54:17] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 19:54:17,752 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 19:54:21,911 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:54:21] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 19:54:21,967 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:54:21] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 19:54:22,089 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:54:22] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 19:54:22,145 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:54:22] "GET /socket.io/?EIO=4&transport=polling&t=PfrZdQ- HTTP/1.1" 200 -
2025-11-11 19:54:22,171 - root - INFO - WebSocket client connected: 16riOpdMbbpE9Q4bAAAJ
2025-11-11 19:54:22,171 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:54:22] "POST /socket.io/?EIO=4&transport=polling&t=PfrZdRM&sid=OPyjKEDeeyqeMC9eAAAI HTTP/1.1" 200 -
2025-11-11 19:54:22,171 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:54:22] "GET /socket.io/?EIO=4&transport=polling&t=PfrZdRN&sid=OPyjKEDeeyqeMC9eAAAI HTTP/1.1" 200 -
2025-11-11 19:54:22,176 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:54:22] "POST /socket.io/?EIO=4&transport=polling&t=PfrZdRU&sid=OPyjKEDeeyqeMC9eAAAI HTTP/1.1" 200 -
2025-11-11 19:54:22,177 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:54:22] "GET /socket.io/?EIO=4&transport=polling&t=PfrZdRT&sid=OPyjKEDeeyqeMC9eAAAI HTTP/1.1" 200 -
2025-11-11 19:54:22,180 - root - INFO - Client 16riOpdMbbpE9Q4bAAAJ joined session room: sess-kfgl6x71
2025-11-11 19:54:22,180 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:54:22] "POST /socket.io/?EIO=4&transport=polling&t=PfrZdRY.0&sid=OPyjKEDeeyqeMC9eAAAI HTTP/1.1" 200 -
2025-11-11 19:54:22,180 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:54:22] "GET /socket.io/?EIO=4&transport=polling&t=PfrZdRY&sid=OPyjKEDeeyqeMC9eAAAI HTTP/1.1" 200 -
2025-11-11 19:54:23,199 - root - INFO - WebSocket client connected: 76iY2AQBVyt5jMVgAAAL
2025-11-11 19:54:23,210 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:54:23] "GET /socket.io/?EIO=4&transport=polling&t=PfrZdRb&sid=OPyjKEDeeyqeMC9eAAAI HTTP/1.1" 200 -
2025-11-11 19:54:28,579 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primry limits'
2025-11-11 19:54:28,579 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-kfgl6x71
2025-11-11 19:54:28,582 - agent.state_manager - INFO - Loaded session state for sess-kfgl6x71
2025-11-11 19:54:28,582 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 1 turns
2025-11-11 19:54:28,582 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 1 conversation turns
2025-11-11 19:54:28,590 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:54:28,591 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 19:54:28,591 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 19:54:28,591 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 19:54:28,591 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=1, conv_history(str)=6090
2025-11-11 19:54:28,591 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 19:54:28,591 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 19:54:28,591 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 19:54:28,593 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:54:28,594 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 19:54:31,579 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:54:31,596 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain all the detailed information about the primary limits, including full row data for each limit. Since the previous results include comprehensive columns like region_cd, industry, utilization, exposure_amt, etc., any follow-up analysis or filtering can be done directly on these existing results without needing a new database query.
2025-11-11 19:54:31,596 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 19:54:31,596 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 19:54:31,596 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 19:54:31,599 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:54:36,084 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:54:36,086 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 19:54:36,087 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 19:54:36,087 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 19:54:36,092 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:54:36,093 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 19:54:36,093 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:54:36,093 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 19:54:36,093 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:54:36,094 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 19:54:36,094 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 19:54:36,094 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 19:54:36,094 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 19:54:36,094 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 19:54:36,094 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 19:54:36,094 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 6090 characters
2025-11-11 19:54:36,094 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 19:54:36,094 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 19:54:36,094 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 19:54:36,094 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 19:54:36,094 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 19:54:36,094 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 19:54:36,094 - tools.impl.nl_to_sql_planner - INFO -     User Query: top primary limits
2025-11-11 19:54:36,094 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 19:54:36,094 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 19:54:36,094 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 19:54:36,095 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 19:54:36,095 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-11 19:54:36,095 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_in
2025-11-11 19:54:36,095 - tools.impl.nl_to_sql_planner - INFO -     ... (5490 more characters)
2025-11-11 19:54:36,095 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:54:39,667 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:54:41,920 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:54:44,165 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:54:44,165 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 19:54:44,165 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:54:44,165 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 6090
2025-11-11 19:54:44,165 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 19:54:44,165 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 2 SQL code blocks, using LAST (most recent)
2025-11-11 19:54:44,165 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 19:54:44,165 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC...
2025-11-11 19:54:44,166 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 130 characters
2025-11-11 19:54:44,166 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 19:54:44,166 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 19:54:44,166 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 130 characters
2025-11-11 19:54:44,166 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 19:54:44,166 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 19:54:44,166 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:54:44,167 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 19:54:44,167 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primry limits
2025-11-11 19:54:44,167 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10559 chars
2025-11-11 19:54:44,167 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 28656 chars
2025-11-11 19:54:44,167 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 19:54:44,167 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 19:54:46,733 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:54:48,753 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 362 chars
2025-11-11 19:54:48,754 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
  "explanation": "Retrieved top Primary limits for the most recent date, sorted by highest utilization. Assumed 'primary' means Primary limit class and used most recent date snapshot.",
  "target_table": "limits_data"
}
2025-11-11 19:54:48,754 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 19:54:48,754 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 19:54:48,754 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:54:48,755 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 19:54:48,755 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 19:54:48,755 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 19:54:48,756 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 19:54:48,761 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:54:48,761 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 19:54:48,761 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 19:54:48,761 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 19:54:48,765 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:54:48,765 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:54:48,765 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-11 19:54:48,766 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 19:54:48,766 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:54:48,766 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:54:48,766 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 19:54:48,766 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 19:54:48,877 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 19:54:48,877 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 19:54:48,877 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 19:54:48,881 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:54:48,881 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 19:54:48,881 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 19:54:48,881 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 19:54:48,881 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 19:54:48,881 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-11 19:54:48,881 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 19:54:48,881 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 19:54:48,882 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4840 chars
2025-11-11 19:54:50,188 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:55:00,308 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1898 chars
2025-11-11 19:55:00,308 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 19:55:00,309 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 19:55:00,310 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 39676 chars
2025-11-11 19:55:07,749 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:55:07,750 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 890 chars
2025-11-11 19:55:07,750 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 19:55:07,751 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 19:55:07,751 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 19:55:07,751 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 19:55:07,751 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 19:55:07,751 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 19:55:07,752 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 19:55:07,763 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:55:07,763 - agent.streaming_agent - INFO - Agent completed for session sess-kfgl6x71: 39171.869999999995ms, 8 steps
2025-11-11 19:55:07,763 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 19:56:48,716 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:56:48] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 19:56:48,740 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 19:56:48] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 19:58:02,245 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'analkyse the table holisticaly'
2025-11-11 19:58:02,247 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-kfgl6x71
2025-11-11 19:58:02,250 - agent.state_manager - INFO - Loaded session state for sess-kfgl6x71
2025-11-11 19:58:02,251 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 2 turns
2025-11-11 19:58:02,252 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 2 conversation turns
2025-11-11 19:58:02,263 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:58:02,263 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 19:58:02,264 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 19:58:02,264 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 19:58:02,264 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=2, conv_history(str)=12246
2025-11-11 19:58:02,265 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 19:58:02,265 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 19:58:02,266 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 19:58:02,269 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:58:02,270 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 19:58:05,161 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:58:05,164 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain the full details of the top primary limits, including all columns and metadata. Since the previous results show the complete set of primary limits with their full details, no additional database query is needed to analyze or filter these existing results.
2025-11-11 19:58:05,165 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 19:58:05,165 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 19:58:05,165 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 19:58:05,172 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:58:09,161 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:58:09,164 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 19:58:09,164 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 19:58:09,164 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 19:58:09,169 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:58:09,169 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 19:58:09,169 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:58:09,169 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 19:58:09,169 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:58:09,169 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 19:58:09,169 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 19:58:09,169 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 19:58:09,169 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 19:58:09,170 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 19:58:09,170 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 19:58:09,170 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 12246 characters
2025-11-11 19:58:09,170 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 19:58:09,170 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 19:58:09,170 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 19:58:09,170 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 19:58:09,170 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 19:58:09,170 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 19:58:09,170 - tools.impl.nl_to_sql_planner - INFO -     User Query: top primary limits
2025-11-11 19:58:09,170 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 19:58:09,170 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 19:58:09,170 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 19:58:09,170 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 19:58:09,170 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-11 19:58:09,170 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_in
2025-11-11 19:58:09,170 - tools.impl.nl_to_sql_planner - INFO -     ... (11646 more characters)
2025-11-11 19:58:09,170 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:58:12,867 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:58:15,325 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:58:18,902 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 19:58:18,903 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 19:58:18,903 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 19:58:18,916 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:58:18,921 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:58:18,921 - agent.streaming_agent - INFO - Agent paused for clarification in session sess-kfgl6x71: 16656.958ms, 5 steps
2025-11-11 19:58:54,029 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'analyze the table holistically, overall statistics'
2025-11-11 19:58:54,030 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-kfgl6x71
2025-11-11 19:58:54,031 - agent.state_manager - INFO - Loaded session state for sess-kfgl6x71
2025-11-11 19:58:54,032 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 2 turns
2025-11-11 19:58:54,032 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 2 conversation turns
2025-11-11 19:58:54,039 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:58:54,039 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 19:58:54,039 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 19:58:54,040 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 19:58:54,040 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=2, conv_history(str)=12246
2025-11-11 19:58:54,040 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 19:58:54,040 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 19:58:54,041 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 19:58:54,045 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:58:54,045 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 19:58:56,993 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:58:56,996 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain all the detailed information about the top primary limits, including full row data for each limit. Since the previous results returned the complete dataset of primary limits sorted by utilization, no additional database query is needed to analyze these limits further.
2025-11-11 19:58:56,996 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 19:58:56,996 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 19:58:56,996 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 19:58:57,006 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:59:01,406 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:59:01,408 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 19:59:01,409 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 19:59:01,409 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 19:59:01,419 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:59:01,420 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 19:59:01,420 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:59:01,420 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 19:59:01,420 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:59:01,420 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 19:59:01,420 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 19:59:01,420 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 19:59:01,420 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 19:59:01,420 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 19:59:01,420 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 19:59:01,420 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 12246 characters
2025-11-11 19:59:01,420 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 19:59:01,421 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 19:59:01,421 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 19:59:01,421 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 19:59:01,421 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 19:59:01,421 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 19:59:01,421 - tools.impl.nl_to_sql_planner - INFO -     User Query: top primary limits
2025-11-11 19:59:01,421 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 19:59:01,421 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 19:59:01,421 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 19:59:01,421 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 19:59:01,421 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-11 19:59:01,421 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_in
2025-11-11 19:59:01,421 - tools.impl.nl_to_sql_planner - INFO -     ... (11646 more characters)
2025-11-11 19:59:01,421 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:59:05,195 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:59:07,653 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:59:10,382 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:59:10,383 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 19:59:10,383 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:59:10,383 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 12246
2025-11-11 19:59:10,383 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 19:59:10,384 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 4 SQL code blocks, using LAST (most recent)
2025-11-11 19:59:10,384 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 19:59:10,385 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC...
2025-11-11 19:59:10,385 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 130 characters
2025-11-11 19:59:10,385 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 19:59:10,385 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 19:59:10,385 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 130 characters
2025-11-11 19:59:10,386 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 19:59:10,386 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 19:59:10,386 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:59:10,388 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 19:59:10,388 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: analyze the table holistically, overall statistics
2025-11-11 19:59:10,388 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10559 chars
2025-11-11 19:59:10,388 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 34845 chars
2025-11-11 19:59:10,388 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 19:59:10,388 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 19:59:13,591 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:59:17,590 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 1051 chars
2025-11-11 19:59:17,591 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT 'Overall Limits Statistics' AS analysis_type,
    COUNT(*) AS total_limits,
    COUNT(DISTINCT letter_nm) AS unique_desks,
    COUNT(DISTINCT region_cd) AS unique_regions,
    COUNT(DISTINCT industry) AS unique_industries,
    AVG(utilization) AS avg_utilization,
    MAX(utilization) AS max_utilization,
    MIN(utilization) AS min_utilization,
    SUM(exposure_amt) AS total_exposure,
    SUM(effective_limit) AS total_limit_capacity,
    COUNT(CASE WHEN utilization >= 0.9 THE
2025-11-11 19:59:17,591 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 19:59:17,591 - tools.impl.nl_to_sql_planner - ERROR - [SQL_GENERATOR] ‚ùå JSON parsing failed: Invalid control character at: line 2 column 65 (char 66)
2025-11-11 19:59:17,592 - tools.impl.nl_to_sql_planner - ERROR - [SQL_GENERATOR] Full response that failed to parse: {
    "sql": "SELECT 'Overall Limits Statistics' AS analysis_type,
    COUNT(*) AS total_limits,
    COUNT(DISTINCT letter_nm) AS unique_desks,
    COUNT(DISTINCT region_cd) AS unique_regions,
    COUNT(DISTINCT industry) AS unique_industries,
    AVG(utilization) AS avg_utilization,
    MAX(utilization) AS max_utilization,
    MIN(utilization) AS min_utilization,
    SUM(exposure_amt) AS total_exposure,
    SUM(effective_limit) AS total_limit_capacity,
    COUNT(CASE WHEN utilization >= 0.9 THEN 1 END) AS high_utilization_limits,
    COUNT(CASE WHEN utilization >= 1.0 THEN 1 END) AS breached_limits,
    COUNT(DISTINCT meas_unit) AS unique_currencies
FROM limits_data 
WHERE date = (SELECT MAX(date) FROM limits_data)",
    "explanation": "Comprehensive holistic analysis of limits data for the most recent date. Provides overall statistics including total limits, unique desks/regions/industries, utilization metrics, exposure, and limit capacity. Includes counts of high utilization and breached limits.",
    "target_table": "limits_data"
}
2025-11-11 19:59:17,592 - tools.impl.nl_to_sql_planner - ERROR - [SQL_GENERATOR] Response length: 1051 chars
2025-11-11 19:59:17,592 - tools.impl.nl_to_sql_planner - ERROR - [SQL_GENERATOR] Response type: <class 'str'>
2025-11-11 19:59:17,592 - tools.impl.nl_to_sql_planner - ERROR - [SQL_GENERATOR] ‚ùå Failed to parse LLM response as JSON for query 'analyze the table holistically, overall statistics': Invalid control character at: line 2 column 65 (char 66)
2025-11-11 19:59:17,592 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 19:59:17,593 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 19:59:17,593 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 19:59:17,603 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:59:17,604 - agent.graph_nodes - INFO - [GENERATE_SQL] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 19:59:17,604 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:59:17,604 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 19:59:17,604 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:59:17,604 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 19:59:17,604 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 19:59:17,604 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 19:59:17,604 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 19:59:17,605 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 19:59:17,605 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 19:59:17,605 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 12246 characters
2025-11-11 19:59:17,605 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 19:59:17,605 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 19:59:17,605 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 19:59:17,605 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 19:59:17,605 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 19:59:17,605 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 19:59:17,605 - tools.impl.nl_to_sql_planner - INFO -     User Query: top primary limits
2025-11-11 19:59:17,605 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 19:59:17,605 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 19:59:17,605 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 19:59:17,605 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 19:59:17,605 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-11 19:59:17,605 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_in
2025-11-11 19:59:17,605 - tools.impl.nl_to_sql_planner - INFO -     ... (11646 more characters)
2025-11-11 19:59:17,605 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:59:21,580 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:59:24,242 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:59:26,447 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:59:26,448 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 19:59:26,448 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:59:26,448 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 12246
2025-11-11 19:59:26,448 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 19:59:26,449 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 4 SQL code blocks, using LAST (most recent)
2025-11-11 19:59:26,449 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 19:59:26,449 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC...
2025-11-11 19:59:26,449 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 130 characters
2025-11-11 19:59:26,449 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 19:59:26,449 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 19:59:26,450 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 130 characters
2025-11-11 19:59:26,450 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 19:59:26,450 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 19:59:26,450 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:59:26,452 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 19:59:26,453 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: analyze the table holistically, overall statistics
2025-11-11 19:59:26,453 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10559 chars
2025-11-11 19:59:26,453 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 34845 chars
2025-11-11 19:59:26,453 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 19:59:26,453 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 19:59:29,054 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:59:30,669 - root - INFO - Client 16riOpdMbbpE9Q4bAAAJ joined session room: sess-9mnu9s4w
2025-11-11 19:59:32,973 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 998 chars
2025-11-11 19:59:32,974 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT 'Overall Limits Statistics' AS analysis_type,
    COUNT(*) AS total_limits,
    COUNT(DISTINCT letter_nm) AS unique_desks,
    COUNT(DISTINCT region_cd) AS unique_regions,
    COUNT(DISTINCT industry) AS unique_industries,
    AVG(utilization) AS avg_utilization,
    MAX(utilization) AS max_utilization,
    MIN(utilization) AS min_utilization,
    SUM(exposure_amt) AS total_exposure,
    SUM(effective_limit) AS total_limit_capacity,
    COUNT(CASE WHEN utilization >= 0.9 THE
2025-11-11 19:59:32,974 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 19:59:32,974 - tools.impl.nl_to_sql_planner - ERROR - [SQL_GENERATOR] ‚ùå JSON parsing failed: Invalid control character at: line 2 column 65 (char 66)
2025-11-11 19:59:32,974 - tools.impl.nl_to_sql_planner - ERROR - [SQL_GENERATOR] Full response that failed to parse: {
    "sql": "SELECT 'Overall Limits Statistics' AS analysis_type,
    COUNT(*) AS total_limits,
    COUNT(DISTINCT letter_nm) AS unique_desks,
    COUNT(DISTINCT region_cd) AS unique_regions,
    COUNT(DISTINCT industry) AS unique_industries,
    AVG(utilization) AS avg_utilization,
    MAX(utilization) AS max_utilization,
    MIN(utilization) AS min_utilization,
    SUM(exposure_amt) AS total_exposure,
    SUM(effective_limit) AS total_limit_capacity,
    COUNT(CASE WHEN utilization >= 0.9 THEN 1 END) AS high_utilization_limits,
    COUNT(CASE WHEN utilization >= 1.0 THEN 1 END) AS breached_limits
FROM limits_data
WHERE date = (SELECT MAX(date) FROM limits_data)",
    "explanation": "Comprehensive holistic analysis of limits data for the most recent date. Provides overall statistics including total limits, unique desks/regions/industries, utilization metrics, exposure, and limit capacity. Includes counts of high utilization and breached limits.",
    "target_table": "limits_data"
}
2025-11-11 19:59:32,975 - tools.impl.nl_to_sql_planner - ERROR - [SQL_GENERATOR] Response length: 998 chars
2025-11-11 19:59:32,975 - tools.impl.nl_to_sql_planner - ERROR - [SQL_GENERATOR] Response type: <class 'str'>
2025-11-11 19:59:32,975 - tools.impl.nl_to_sql_planner - ERROR - [SQL_GENERATOR] ‚ùå Failed to parse LLM response as JSON for query 'analyze the table holistically, overall statistics': Invalid control character at: line 2 column 65 (char 66)
2025-11-11 19:59:32,975 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['node_output', 'node_reasoning']
2025-11-11 19:59:32,976 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 2 data keys
2025-11-11 19:59:32,976 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 19:59:32,988 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:59:32,989 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=0, columns=0, rows=0, sql=N/A
2025-11-11 19:59:32,989 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: False, has 'columns' key: False
2025-11-11 19:59:32,989 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=0, columns=0, rows=0, query_length=0
2025-11-11 19:59:32,989 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 19:59:32,989 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 19:59:32,990 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 366 chars
2025-11-11 19:59:33,661 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:59:39,759 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1182 chars
2025-11-11 19:59:39,759 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 19:59:39,760 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 19:59:39,761 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 40224 chars
2025-11-11 19:59:42,265 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:59:43,742 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'how many extensions do we have'
2025-11-11 19:59:43,743 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-9mnu9s4w
2025-11-11 19:59:43,744 - agent.state_manager - WARNING - Session sess-9mnu9s4w not found
2025-11-11 19:59:43,745 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 19:59:43,749 - agent.state_manager - INFO - Saved session state for sess-9mnu9s4w (user: admin)
2025-11-11 19:59:43,749 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 19:59:43,749 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 19:59:43,750 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 19:59:43,750 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 19:59:43,750 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 19:59:43,750 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 19:59:43,750 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 19:59:43,752 - agent.state_manager - INFO - Saved session state for sess-9mnu9s4w (user: admin)
2025-11-11 19:59:47,318 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1022 chars
2025-11-11 19:59:47,319 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=0, columns=0, rows=0, query=MISSING
2025-11-11 19:59:47,320 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=0, columns=0, rows=0, has_query=False
2025-11-11 19:59:47,320 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=N/A...
2025-11-11 19:59:47,320 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): N/A...
2025-11-11 19:59:47,330 - agent.state_manager - INFO - Saved session state for sess-kfgl6x71 (user: admin)
2025-11-11 19:59:47,330 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for end: data keys = ['raw_table', 'response', 'prompt_monitor', 'node_output', 'node_reasoning']
2025-11-11 19:59:47,330 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for end with 5 data keys
2025-11-11 19:59:47,331 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for end
2025-11-11 19:59:47,331 - agent.streaming_agent - INFO - Agent completed for session sess-kfgl6x71: 53291.044ms, 6 steps
2025-11-11 19:59:47,331 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=0, columns=0, rows=0
2025-11-11 19:59:48,102 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:59:48,104 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 19:59:48,104 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 19:59:48,104 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 19:59:48,109 - agent.state_manager - INFO - Saved session state for sess-9mnu9s4w (user: admin)
2025-11-11 19:59:48,109 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 19:59:48,110 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 19:59:48,118 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 19:59:48,119 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 19:59:48,119 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 19:59:48,119 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 19:59:48,119 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 19:59:48,119 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 19:59:48,119 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 19:59:48,119 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 19:59:48,119 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 19:59:48,119 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 19:59:48,119 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 19:59:48,119 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 19:59:48,119 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 19:59:48,119 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 19:59:51,481 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:59:53,323 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:59:55,585 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 19:59:55,586 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: how many extensions do we have
2025-11-11 19:59:55,586 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-11 19:59:55,586 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 22612 chars
2025-11-11 19:59:55,586 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 19:59:55,586 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 19:59:57,594 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 19:59:59,640 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 387 chars
2025-11-11 19:59:59,640 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT COUNT(*) AS extension_count FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data)",
  "explanation": "Counted the number of active extensions on the most recent date. Assumed 'extension' means limits with an active extension flag (extension = 1). Used latest date to get current snapshot of extensions.",
  "target_table": "limits_data"
}
2025-11-11 19:59:59,640 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 19:59:59,641 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 19:59:59,641 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT COUNT(*) AS extension_count FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 19:59:59,641 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT COUNT(*) AS extension_count FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data)
2025-11-11 19:59:59,642 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 19:59:59,642 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 19:59:59,642 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 19:59:59,646 - agent.state_manager - INFO - Saved session state for sess-9mnu9s4w (user: admin)
2025-11-11 19:59:59,646 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 19:59:59,646 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 19:59:59,646 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 19:59:59,649 - agent.state_manager - INFO - Saved session state for sess-9mnu9s4w (user: admin)
2025-11-11 19:59:59,649 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT COUNT(*) AS extension_count FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 19:59:59,649 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 118 chars
2025-11-11 19:59:59,650 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT COUNT(*) AS extension_count FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data)
2025-11-11 19:59:59,650 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT COUNT(*) AS extension_count FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 19:59:59,650 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT COUNT(*) AS extension_count FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 19:59:59,651 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 19:59:59,651 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT COUNT(*) AS extension_count FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 19:59:59,760 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 19:59:59,760 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 19:59:59,760 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 19:59:59,762 - agent.state_manager - INFO - Saved session state for sess-9mnu9s4w (user: admin)
2025-11-11 19:59:59,762 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=1, columns=1, rows=1, sql=SELECT COUNT(*) AS extension_count FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date)
2025-11-11 19:59:59,762 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 19:59:59,762 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 19:59:59,762 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT COUNT(*) AS extension_count FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date)
2025-11-11 19:59:59,762 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=1, columns=1, rows=1, query_length=118
2025-11-11 19:59:59,763 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 19:59:59,763 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 19:59:59,763 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 548 chars
2025-11-11 20:00:00,259 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:00:05,991 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1318 chars
2025-11-11 20:00:05,991 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 20:00:05,991 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 20:00:05,993 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 37477 chars
2025-11-11 20:00:13,395 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:00:13,397 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 969 chars
2025-11-11 20:00:13,398 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=1, columns=1, rows=1, query=SELECT COUNT(*) AS extension_count FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date)
2025-11-11 20:00:13,398 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=1, columns=1, rows=1, has_query=True
2025-11-11 20:00:13,398 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT COUNT(*) AS extension_count FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date)...
2025-11-11 20:00:13,398 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT COUNT(*) AS extension_count FROM limits_data WHERE extension = 1 AND date = (SELECT MAX(date)...
2025-11-11 20:00:13,399 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 20:00:13,399 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 20:00:13,399 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 20:00:13,404 - agent.state_manager - INFO - Saved session state for sess-9mnu9s4w (user: admin)
2025-11-11 20:00:13,405 - agent.streaming_agent - INFO - Agent completed for session sess-9mnu9s4w: 29654.639ms, 7 steps
2025-11-11 20:00:13,405 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=1, columns=1, rows=1
2025-11-11 20:00:18,829 - root - INFO - WebSocket client disconnected: 76iY2AQBVyt5jMVgAAAL
2025-11-11 20:00:18,833 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:00:18] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 20:00:18,855 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 20:00:18,856 - root - INFO - WebSocket client disconnected: 16riOpdMbbpE9Q4bAAAJ
2025-11-11 20:00:18,857 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:00:18] "GET /socket.io/?EIO=4&transport=websocket&sid=OPyjKEDeeyqeMC9eAAAI HTTP/1.1" 200 -
2025-11-11 20:00:19,403 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:00:19] "GET /socket.io/?EIO=4&transport=polling&t=Pfra-f5 HTTP/1.1" 200 -
2025-11-11 20:00:19,417 - root - INFO - WebSocket client connected: OFNytIoKnltj3S_zAAAN
2025-11-11 20:00:19,417 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:00:19] "POST /socket.io/?EIO=4&transport=polling&t=Pfra-fE&sid=FQoMreu6k1P0XCKSAAAM HTTP/1.1" 200 -
2025-11-11 20:00:19,419 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:00:19] "GET /socket.io/?EIO=4&transport=polling&t=Pfra-fG&sid=FQoMreu6k1P0XCKSAAAM HTTP/1.1" 200 -
2025-11-11 20:00:19,423 - root - INFO - Client OFNytIoKnltj3S_zAAAN joined session room: sess-9mnu9s4w
2025-11-11 20:00:19,526 - root - INFO - WebSocket client connected: TueAl5gVb241NUtqAAAP
2025-11-11 20:11:54,367 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-11 20:11:54,385 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-11 20:11:54,385 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-11 20:11:54,394 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-11 20:11:54,394 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-11 20:11:54,820 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 20:11:54,820 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 20:11:54,820 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 20:11:54,820 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 20:11:54,820 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-11 20:11:54,820 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-11 20:11:54,820 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-11 20:11:54,825 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-11 20:11:54,825 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-11 20:11:54,830 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-11 20:11:54,830 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-11 20:11:54,830 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-11 20:11:54,830 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-11 20:11:54,833 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-11 20:11:54,833 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-11 20:11:54,836 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-11 20:11:54,836 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-11 20:11:54,845 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-11 20:11:54,845 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-11 20:11:55,129 - DuckDbDescribeTableTool - INFO - Found 1 data files in data/duckdb
2025-11-11 20:11:55,166 - DuckDbDescribeTableTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 20:11:55,172 - DuckDbDescribeTableTool - INFO - Initialization complete: 4 views available
2025-11-11 20:11:55,172 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 20:11:55,172 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-11 20:11:55,172 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-11 20:11:55,176 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-11 20:11:55,176 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-11 20:11:55,459 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-11 20:11:55,459 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-11 20:11:55,461 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-11 20:11:55,461 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-11 20:11:55,465 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-11 20:11:55,465 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-11 20:11:55,465 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-11 20:11:55,465 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-11 20:11:55,465 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-11 20:11:55,465 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-11 20:11:55,474 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-11 20:11:55,474 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-11 20:11:55,474 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-11 20:11:55,474 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-11 20:11:55,479 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-11 20:11:55,479 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-11 20:11:55,480 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-11 20:11:55,480 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-11 20:11:55,482 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-11 20:11:55,482 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-11 20:11:55,482 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-11 20:11:55,482 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-11 20:11:55,484 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-11 20:11:55,484 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-11 20:11:55,486 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-11 20:11:55,486 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-11 20:11:55,489 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-11 20:11:55,489 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-11 20:11:55,490 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-11 20:11:55,490 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-11 20:11:55,492 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-11 20:11:55,492 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-11 20:11:55,495 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-11 20:11:55,495 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-11 20:11:55,495 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-11 20:11:55,495 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-11 20:11:55,495 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-11 20:11:55,495 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-11 20:11:55,504 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-11 20:11:55,504 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-11 20:11:55,504 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-11 20:11:55,504 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-11 20:11:55,504 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-11 20:11:55,504 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-11 20:11:55,505 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-11 20:11:55,505 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-11 20:11:55,511 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 20:11:55,511 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 20:11:55,511 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 20:11:55,511 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 20:11:55,511 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-11 20:11:55,511 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-11 20:11:55,511 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-11 20:11:55,511 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-11 20:11:55,511 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-11 20:11:55,511 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-11 20:11:55,511 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-11 20:11:55,514 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-11 20:11:55,514 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-11 20:11:55,514 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-11 20:11:55,515 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-11 20:11:55,515 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-11 20:11:55,515 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-11 20:11:55,516 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-11 20:11:55,516 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-11 20:11:55,516 - DuckDbListFilesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 20:11:55,551 - DuckDbListFilesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 20:11:55,552 - DuckDbListFilesTool - INFO - Initialization complete: 4 views available
2025-11-11 20:11:55,552 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 20:11:55,552 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-11 20:11:55,552 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-11 20:11:55,552 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-11 20:11:55,552 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-11 20:11:55,553 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-11 20:11:55,553 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-11 20:11:55,553 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-11 20:11:55,553 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-11 20:11:55,553 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-11 20:11:55,553 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-11 20:11:55,553 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-11 20:11:55,553 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-11 20:11:55,553 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-11 20:11:55,553 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-11 20:11:55,554 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-11 20:11:55,554 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-11 20:11:55,554 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-11 20:11:55,554 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-11 20:11:55,554 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-11 20:11:55,554 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-11 20:11:55,554 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-11 20:11:55,554 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-11 20:11:55,555 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-11 20:11:55,555 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-11 20:11:55,555 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-11 20:11:55,555 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-11 20:11:55,555 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-11 20:11:55,555 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-11 20:11:55,555 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-11 20:11:55,555 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-11 20:11:55,556 - DuckDbGetStatsTool - INFO - Found 1 data files in data/duckdb
2025-11-11 20:11:55,591 - DuckDbGetStatsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 20:11:55,593 - DuckDbGetStatsTool - INFO - Initialization complete: 4 views available
2025-11-11 20:11:55,593 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 20:11:55,593 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-11 20:11:55,593 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-11 20:11:55,593 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-11 20:11:55,594 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-11 20:11:55,594 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-11 20:11:55,594 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-11 20:11:55,594 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-11 20:11:55,594 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-11 20:11:55,595 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-11 20:11:55,595 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-11 20:11:55,600 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 20:11:55,600 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 20:11:55,600 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 20:11:55,600 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 20:11:55,601 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-11 20:11:55,601 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-11 20:11:55,601 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-11 20:11:55,601 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-11 20:11:55,601 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-11 20:11:55,601 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-11 20:11:55,601 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-11 20:11:55,615 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-11 20:11:55,615 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-11 20:11:55,616 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-11 20:11:55,616 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-11 20:11:55,616 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-11 20:11:55,616 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-11 20:11:55,616 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-11 20:11:55,616 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-11 20:11:55,616 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-11 20:11:55,616 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-11 20:11:55,616 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-11 20:11:55,616 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-11 20:11:55,617 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-11 20:11:55,617 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-11 20:11:55,617 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-11 20:11:55,617 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-11 20:11:55,617 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-11 20:11:55,617 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-11 20:11:55,617 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-11 20:11:55,617 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-11 20:11:55,618 - DuckDbListTablesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 20:11:55,652 - DuckDbListTablesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 20:11:55,653 - DuckDbListTablesTool - INFO - Initialization complete: 4 views available
2025-11-11 20:11:55,654 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 20:11:55,654 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-11 20:11:55,654 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-11 20:11:55,654 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-11 20:11:55,654 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-11 20:11:55,654 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-11 20:11:55,654 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-11 20:11:55,654 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-11 20:11:55,654 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-11 20:11:55,654 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-11 20:11:55,654 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-11 20:11:55,655 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-11 20:11:55,655 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-11 20:11:55,655 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-11 20:11:55,655 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-11 20:11:55,655 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-11 20:11:55,655 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-11 20:11:55,655 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-11 20:11:55,655 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-11 20:11:55,655 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-11 20:11:55,655 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-11 20:11:55,655 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-11 20:11:55,655 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-11 20:11:55,656 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-11 20:11:55,656 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-11 20:11:55,656 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-11 20:11:55,656 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-11 20:11:55,656 - DuckDbAggregateTool - INFO - Found 1 data files in data/duckdb
2025-11-11 20:11:55,691 - DuckDbAggregateTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 20:11:55,692 - DuckDbAggregateTool - INFO - Initialization complete: 4 views available
2025-11-11 20:11:55,692 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 20:11:55,693 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-11 20:11:55,693 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-11 20:11:55,693 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-11 20:11:55,693 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-11 20:11:55,693 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-11 20:11:55,693 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-11 20:11:55,693 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-11 20:11:55,693 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-11 20:11:55,694 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-11 20:11:55,694 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-11 20:11:55,694 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-11 20:11:55,694 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-11 20:11:55,694 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-11 20:11:55,694 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-11 20:11:55,699 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 20:11:55,700 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 20:11:55,700 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 20:11:55,700 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 20:11:55,700 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-11 20:11:55,700 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-11 20:11:55,700 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-11 20:11:55,700 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-11 20:11:55,700 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-11 20:11:55,700 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-11 20:11:55,700 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-11 20:11:55,700 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-11 20:11:55,700 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-11 20:11:55,701 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-11 20:11:55,701 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-11 20:11:55,701 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-11 20:11:55,701 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-11 20:11:55,701 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-11 20:11:55,701 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-11 20:11:55,701 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-11 20:11:55,701 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-11 20:11:55,701 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-11 20:11:55,701 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-11 20:11:55,701 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-11 20:11:55,701 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-11 20:11:55,702 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-11 20:11:55,702 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-11 20:11:55,702 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-11 20:11:55,702 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-11 20:11:55,702 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-11 20:11:55,702 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-11 20:11:55,703 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-11 20:11:55,703 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-11 20:11:55,703 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-11 20:11:55,703 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-11 20:11:55,703 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-11 20:11:55,703 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-11 20:11:55,703 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-11 20:11:55,703 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-11 20:11:55,703 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-11 20:11:55,704 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-11 20:11:55,704 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-11 20:11:55,704 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-11 20:11:55,704 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-11 20:11:55,704 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-11 20:11:55,704 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-11 20:11:55,704 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-11 20:11:55,704 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-11 20:11:55,704 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-11 20:11:55,704 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-11 20:11:55,704 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-11 20:11:55,704 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-11 20:11:55,704 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-11 20:11:55,705 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-11 20:11:55,705 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-11 20:11:55,705 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-11 20:11:55,705 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-11 20:11:55,705 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-11 20:11:55,705 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-11 20:11:55,705 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-11 20:11:55,705 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-11 20:11:55,706 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-11 20:11:55,706 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-11 20:11:55,708 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-11 20:11:55,708 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-11 20:11:55,708 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-11 20:11:55,708 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-11 20:11:55,708 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-11 20:11:55,708 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-11 20:11:55,708 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-11 20:11:55,708 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-11 20:11:55,708 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-11 20:11:55,708 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-11 20:11:55,708 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-11 20:11:55,708 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-11 20:11:55,714 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 20:11:55,714 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 20:11:55,714 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 20:11:55,714 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 20:11:55,714 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-11 20:11:55,714 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-11 20:11:55,714 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-11 20:11:55,714 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-11 20:11:55,714 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-11 20:11:55,715 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-11 20:11:55,715 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-11 20:11:55,715 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-11 20:11:55,715 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-11 20:11:55,715 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-11 20:11:55,715 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-11 20:11:55,715 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-11 20:11:55,715 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-11 20:11:55,715 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-11 20:11:55,715 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-11 20:11:55,715 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-11 20:11:55,715 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-11 20:11:55,716 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-11 20:11:55,716 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-11 20:11:55,716 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-11 20:11:55,716 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-11 20:11:55,716 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-11 20:11:55,716 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-11 20:11:55,716 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-11 20:11:55,716 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-11 20:11:55,717 - DuckDbQueryTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 20:11:55,751 - DuckDbQueryTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 20:11:55,752 - DuckDbQueryTool - INFO - Initialization complete: 4 views available
2025-11-11 20:11:55,752 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 20:11:55,752 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-11 20:11:55,752 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-11 20:11:55,753 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-11 20:11:55,753 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-11 20:11:55,753 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-11 20:11:55,753 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-11 20:11:55,753 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-11 20:11:55,753 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-11 20:11:55,754 - DuckDbRefreshViewsTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 20:11:55,788 - DuckDbRefreshViewsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 20:11:55,789 - DuckDbRefreshViewsTool - INFO - Initialization complete: 4 views available
2025-11-11 20:11:55,790 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 20:11:55,790 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-11 20:11:55,790 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-11 20:11:55,790 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-11 20:11:55,790 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-11 20:11:55,790 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-11 20:11:55,790 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-11 20:11:55,796 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 20:11:55,796 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 20:11:55,796 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 20:11:55,796 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 20:11:55,796 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-11 20:11:55,796 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-11 20:11:55,796 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-11 20:11:55,797 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-11 20:11:55,797 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-11 20:11:55,797 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-11 20:11:55,797 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-11 20:11:55,797 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-11 20:11:55,797 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-11 20:11:55,797 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-11 20:11:55,797 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-11 20:11:55,798 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-11 20:11:55,798 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-11 20:11:55,798 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-11 20:11:55,798 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-11 20:11:55,798 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-11 20:11:55,805 - root - INFO - All routes registered successfully
2025-11-11 20:11:55,810 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.68.51:8000
2025-11-11 20:11:55,810 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-11-11 20:12:02,087 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:12:02] "[32mGET / HTTP/1.1[0m" 302 -
2025-11-11 20:12:42,552 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:12:42] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 20:12:42,570 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:12:42] "GET /login?next=http://localhost:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 20:12:42,594 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:12:42] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 20:12:42,618 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:12:42] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 20:12:42,663 - root - INFO - WebSocket client connected: gq9n3nerCynLcaalAAAB
2025-11-11 20:12:42,665 - root - INFO - WebSocket client disconnected: gq9n3nerCynLcaalAAAB
2025-11-11 20:12:42,677 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:12:42] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 20:12:42,680 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/Library/Python/3.9/lib/python/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
  File "/Users/saadahmed/Library/Python/3.9/lib/python/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
  File "/Users/saadahmed/Library/Python/3.9/lib/python/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
AssertionError: write() before start_response
2025-11-11 20:12:42,729 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:12:42] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-11-11 20:17:07,665 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 20:17:07,665 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 20:17:07,666 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:17:07] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 20:17:07,691 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:17:07] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 20:17:07,713 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:17:07] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 20:17:07,714 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:17:07] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 20:17:07,780 - root - INFO - WebSocket client connected: Jlap5-eguhyk6TQmAAAD
2025-11-11 20:17:07,783 - root - INFO - WebSocket client disconnected: Jlap5-eguhyk6TQmAAAD
2025-11-11 20:17:07,795 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:17:07] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 20:17:07,796 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/Library/Python/3.9/lib/python/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
  File "/Users/saadahmed/Library/Python/3.9/lib/python/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
  File "/Users/saadahmed/Library/Python/3.9/lib/python/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
AssertionError: write() before start_response
2025-11-11 20:17:12,944 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:17:12] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 20:17:12,963 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:17:12] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 20:17:12,964 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:17:12] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 20:17:13,016 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:17:13] "GET /socket.io/?EIO=4&transport=polling&t=Pfres6s HTTP/1.1" 200 -
2025-11-11 20:17:13,021 - root - INFO - WebSocket client connected: YSJj6sJKiJxmKtNSAAAG
2025-11-11 20:17:13,021 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:17:13] "POST /socket.io/?EIO=4&transport=polling&t=Pfres6w&sid=PLefFKTgNfWYB0fxAAAE HTTP/1.1" 200 -
2025-11-11 20:17:13,021 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:17:13] "GET /socket.io/?EIO=4&transport=polling&t=Pfres6w.0&sid=PLefFKTgNfWYB0fxAAAE HTTP/1.1" 200 -
2025-11-11 20:17:13,022 - root - INFO - WebSocket client connected: -tWflwPh0ehUY2eaAAAH
2025-11-11 20:17:13,026 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:17:13] "GET /socket.io/?EIO=4&transport=polling&t=Pfres6_&sid=PLefFKTgNfWYB0fxAAAE HTTP/1.1" 200 -
2025-11-11 20:17:13,026 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:17:13] "POST /socket.io/?EIO=4&transport=polling&t=Pfres70&sid=PLefFKTgNfWYB0fxAAAE HTTP/1.1" 200 -
2025-11-11 20:17:13,029 - root - INFO - Client YSJj6sJKiJxmKtNSAAAG joined session room: sess-zktlpn3r
2025-11-11 20:17:13,029 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:17:13] "POST /socket.io/?EIO=4&transport=polling&t=Pfres73.0&sid=PLefFKTgNfWYB0fxAAAE HTTP/1.1" 200 -
2025-11-11 20:17:13,030 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 20:17:13] "GET /socket.io/?EIO=4&transport=polling&t=Pfres73&sid=PLefFKTgNfWYB0fxAAAE HTTP/1.1" 200 -
2025-11-11 20:17:22,696 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limit'
2025-11-11 20:17:22,696 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-zktlpn3r
2025-11-11 20:17:22,700 - agent.state_manager - INFO - Loaded session state for sess-zktlpn3r
2025-11-11 20:17:22,700 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 2 turns
2025-11-11 20:17:22,701 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 2 conversation turns
2025-11-11 20:17:22,711 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:17:22,711 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 20:17:22,711 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 20:17:22,711 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 20:17:22,712 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=2, conv_history(str)=23677
2025-11-11 20:17:22,712 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 20:17:22,712 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 20:17:22,712 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 20:17:22,717 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:17:22,717 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 20:17:26,314 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:17:26,341 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain all the data needed to count AMERICAS limits. The region_cd column is present in the existing result set, and the agent can simply filter and count the rows with 'AMERICAS' as the region_cd without needing a new database query.
2025-11-11 20:17:26,341 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 20:17:26,341 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 20:17:26,342 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 20:17:26,346 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:17:30,000 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:17:30,003 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 20:17:30,003 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 20:17:30,004 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 20:17:30,012 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:17:30,013 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 20:17:30,013 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:17:30,013 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 20:17:30,013 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:17:30,013 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 20:17:30,013 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 20:17:30,013 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 20:17:30,013 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 20:17:30,013 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 20:17:30,013 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 20:17:30,013 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 23677 characters
2025-11-11 20:17:30,014 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 20:17:30,014 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 20:17:30,014 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 20:17:30,014 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 20:17:30,014 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 20:17:30,014 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 20:17:30,014 - tools.impl.nl_to_sql_planner - INFO -     User Query: "top primary limits"
2025-11-11 20:17:30,014 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 20:17:30,014 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 20:17:30,014 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data LIMIT 10
2025-11-11 20:17:30,014 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 20:17:30,014 - tools.impl.nl_to_sql_planner - INFO -     Result Table (10 rows):
2025-11-11 20:17:30,014 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_instance_id, state, extension, st_dt, end_dt, limit_concatenate, pref_name, LM_Column1, LM_Co
2025-11-11 20:17:30,014 - tools.impl.nl_to_sql_planner - INFO -     ... (23077 more characters)
2025-11-11 20:17:30,014 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:17:34,608 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:17:37,781 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:17:39,679 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:17:39,679 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 20:17:39,679 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:17:39,679 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 23677
2025-11-11 20:17:39,679 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 20:17:39,680 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 4 SQL code blocks, using LAST (most recent)
2025-11-11 20:17:39,680 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 20:17:39,680 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT COUNT(*) as americas_count 
FROM limits_data 
WHERE region_cd = 'AMERICAS'...
2025-11-11 20:17:39,680 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 81 characters
2025-11-11 20:17:39,680 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 20:17:39,680 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 20:17:39,680 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 81 characters
2025-11-11 20:17:39,680 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT COUNT(*) as americas_count 
FROM limits_data 
WHERE region_cd = 'AMERICAS'
2025-11-11 20:17:39,680 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT COUNT(*) as americas_count 
FROM limits_data 
WHERE region_cd = 'AMERICAS'
2025-11-11 20:17:39,680 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:17:39,681 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 20:17:39,681 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limit
2025-11-11 20:17:39,682 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10461 chars
2025-11-11 20:17:39,682 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 46243 chars
2025-11-11 20:17:39,682 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 20:17:39,682 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 20:17:43,424 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:17:45,408 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 333 chars
2025-11-11 20:17:45,409 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' ORDER BY utilization DESC",
    "explanation": "Retrieved all primary limits, sorted by utilization in descending order. Used 'PRIMARY' in id2 to capture primary limits, with no date or additional filters to maximize result set.",
    "target_table": "limits_data"
}
2025-11-11 20:17:45,409 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 20:17:45,409 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 20:17:45,409 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' ORDER BY utilization DESC...
2025-11-11 20:17:45,410 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' ORDER BY utilization DESC
2025-11-11 20:17:45,411 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 20:17:45,411 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 20:17:45,412 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 20:17:45,420 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:17:45,420 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 20:17:45,421 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 20:17:45,421 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 20:17:45,428 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:17:45,428 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' ORDER BY utilization DESC...
2025-11-11 20:17:45,428 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 78 chars
2025-11-11 20:17:45,428 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' ORDER BY utilization DESC
2025-11-11 20:17:45,428 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' ORDER BY utilization DESC...
2025-11-11 20:17:45,429 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' ORDER BY utilization DESC...
2025-11-11 20:17:45,429 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 20:17:45,429 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' ORDER BY utilization DESC...
2025-11-11 20:17:45,495 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 20:17:45,496 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 20:17:45,500 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 20:17:45,511 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:17:45,511 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=126, columns=41, rows=126, sql=SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' ORDER BY utilization DESC
2025-11-11 20:17:45,511 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 20:17:45,511 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 20:17:45,511 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' ORDER BY utilization DESC
2025-11-11 20:17:45,511 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=126, columns=41, rows=126, query_length=78
2025-11-11 20:17:45,511 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 20:17:45,511 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 20:17:45,517 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 156191 chars
2025-11-11 20:17:55,591 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:18:06,333 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1619 chars
2025-11-11 20:18:06,335 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 20:18:06,335 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 20:18:06,337 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 40887 chars
2025-11-11 20:18:13,508 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:18:13,511 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 902 chars
2025-11-11 20:18:13,511 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=126, columns=41, rows=126, query=SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' ORDER BY utilization DESC
2025-11-11 20:18:13,511 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=126, columns=41, rows=126, has_query=True
2025-11-11 20:18:13,511 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' ORDER BY utilization DESC...
2025-11-11 20:18:13,512 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' ORDER BY utilization DESC...
2025-11-11 20:18:13,512 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 20:18:13,513 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 20:18:13,526 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 20:18:13,579 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:18:13,580 - agent.streaming_agent - INFO - Agent completed for session sess-zktlpn3r: 50868.17ms, 8 steps
2025-11-11 20:18:13,580 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=126, columns=41, rows=126
2025-11-11 20:18:41,190 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'give me the count of limits by group of limits class, limit group and limit type'
2025-11-11 20:18:41,192 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-zktlpn3r
2025-11-11 20:18:41,207 - agent.state_manager - INFO - Loaded session state for sess-zktlpn3r
2025-11-11 20:18:41,208 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 3 turns
2025-11-11 20:18:41,210 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 3 conversation turns
2025-11-11 20:18:41,235 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:18:41,236 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 20:18:41,236 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 20:18:41,236 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 20:18:41,236 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=3, conv_history(str)=139182
2025-11-11 20:18:41,236 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 20:18:41,236 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 20:18:41,236 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 20:18:41,249 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:18:41,249 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 20:18:52,019 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:18:52,022 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query returned the full dataset of 126 primary limits with comprehensive details, including utilization, region, limit type, and other key attributes. Any follow-up query about analyzing these primary limits can be directly answered using the existing result set without needing to fetch additional data from the database.
2025-11-11 20:18:52,022 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 20:18:52,023 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 20:18:52,023 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 20:18:52,046 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:18:56,948 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:18:56,951 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 20:18:56,951 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 20:18:56,952 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 20:18:56,977 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:18:56,978 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 20:18:56,978 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:18:56,978 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 20:18:56,978 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:18:56,978 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 20:18:56,978 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 20:18:56,978 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 20:18:56,978 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 20:18:56,978 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 20:18:56,978 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 20:18:56,978 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 139182 characters
2025-11-11 20:18:56,978 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 20:18:56,979 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 20:18:56,979 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 20:18:56,979 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 20:18:56,979 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 20:18:56,979 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 20:18:56,979 - tools.impl.nl_to_sql_planner - INFO -     User Query: "top primary limits"
2025-11-11 20:18:56,979 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 20:18:56,979 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 20:18:56,980 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data LIMIT 10
2025-11-11 20:18:56,980 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 20:18:56,980 - tools.impl.nl_to_sql_planner - INFO -     Result Table (10 rows):
2025-11-11 20:18:56,980 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_instance_id, state, extension, st_dt, end_dt, limit_concatenate, pref_name, LM_Column1, LM_Co
2025-11-11 20:18:56,980 - tools.impl.nl_to_sql_planner - INFO -     ... (138582 more characters)
2025-11-11 20:18:56,980 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:19:09,281 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:19:21,003 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:19:23,230 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:19:23,231 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 20:19:23,231 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:19:23,232 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 139182
2025-11-11 20:19:23,232 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 20:19:23,232 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 6 SQL code blocks, using LAST (most recent)
2025-11-11 20:19:23,232 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 20:19:23,232 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT * FROM limits_data 
WHERE id2 LIKE '%PRIMARY%' 
ORDER BY utilization DESC...
2025-11-11 20:19:23,232 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 80 characters
2025-11-11 20:19:23,232 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 20:19:23,232 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 20:19:23,232 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 80 characters
2025-11-11 20:19:23,232 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT * FROM limits_data 
WHERE id2 LIKE '%PRIMARY%' 
ORDER BY utilization DESC
2025-11-11 20:19:23,233 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT * FROM limits_data 
WHERE id2 LIKE '%PRIMARY%' 
ORDER BY utilization DESC
2025-11-11 20:19:23,233 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:19:23,234 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 20:19:23,234 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: give me the count of limits by group of limits class, limit group and limit type
2025-11-11 20:19:23,234 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10459 chars
2025-11-11 20:19:23,234 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 161811 chars
2025-11-11 20:19:23,235 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 20:19:23,235 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 20:19:34,314 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:19:36,305 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 451 chars
2025-11-11 20:19:36,306 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT limit_class, limit_group, limit_type, COUNT(*) as limit_count FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY limit_class, limit_group, limit_type ORDER BY limit_count DESC",
    "explanation": "Counted limits grouped by limit class, group, and type for the latest date snapshot. Sorted by total number of limits descending to show most common limit configurations.",
    "target_table": "limits_data"
}
2025-11-11 20:19:36,306 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 20:19:36,306 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 20:19:36,306 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT limit_class, limit_group, limit_type, COUNT(*) as limit_count FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY limit_class, limit_group, limit_type ORDER BY limit_coun...
2025-11-11 20:19:36,307 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT limit_class, limit_group, limit_type, COUNT(*) as limit_count FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY limit_class, limit_group, limit_type ORDER BY limit_count DESC
2025-11-11 20:19:36,307 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 20:19:36,308 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 20:19:36,308 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 20:19:36,333 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:19:36,334 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 20:19:36,334 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 20:19:36,334 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 20:19:36,351 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:19:36,351 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT limit_class, limit_group, limit_type, COUNT(*) as limit_count FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY limit_class, limit_group, limit_type ORDER BY limit_coun...
2025-11-11 20:19:36,352 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 206 chars
2025-11-11 20:19:36,352 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT limit_class, limit_group, limit_type, COUNT(*) as limit_count FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY limit_class, limit_group, limit_type ORDER BY limit_count DESC
2025-11-11 20:19:36,352 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT limit_class, limit_group, limit_type, COUNT(*) as limit_count FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY limit_class, limit_group, limit_type ORDER BY limit_coun...
2025-11-11 20:19:36,352 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT limit_class, limit_group, limit_type, COUNT(*) as limit_count FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY limit_class, limit_group, limit_type ORDER BY limit_coun...
2025-11-11 20:19:36,352 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 20:19:36,352 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT limit_class, limit_group, limit_type, COUNT(*) as limit_count FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY limit_class, limit_group, limit_type ORDER BY limit_coun...
2025-11-11 20:19:36,421 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 20:19:36,422 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 20:19:36,422 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 20:19:36,432 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:19:36,432 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=9, columns=4, rows=9, sql=SELECT limit_class, limit_group, limit_type, COUNT(*) as limit_count FROM limits_data WHERE date = (
2025-11-11 20:19:36,432 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 20:19:36,432 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 20:19:36,432 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT limit_class, limit_group, limit_type, COUNT(*) as limit_count FROM limits_data WHERE date = (
2025-11-11 20:19:36,432 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=9, columns=4, rows=9, query_length=206
2025-11-11 20:19:36,432 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 20:19:36,432 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 20:19:36,433 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 1933 chars
2025-11-11 20:19:37,287 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:19:45,373 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1647 chars
2025-11-11 20:19:45,374 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 20:19:45,374 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 20:19:45,378 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 41776 chars
2025-11-11 20:19:52,338 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:19:52,341 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 919 chars
2025-11-11 20:19:52,342 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=9, columns=4, rows=9, query=SELECT limit_class, limit_group, limit_type, COUNT(*) as limit_count FROM limits_data WHERE date = (
2025-11-11 20:19:52,342 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=9, columns=4, rows=9, has_query=True
2025-11-11 20:19:52,342 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT limit_class, limit_group, limit_type, COUNT(*) as limit_count FROM limits_data WHERE date = (...
2025-11-11 20:19:52,342 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT limit_class, limit_group, limit_type, COUNT(*) as limit_count FROM limits_data WHERE date = (...
2025-11-11 20:19:52,343 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 20:19:52,343 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 20:19:52,343 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 20:19:52,377 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:19:52,377 - agent.streaming_agent - INFO - Agent completed for session sess-zktlpn3r: 71140.757ms, 8 steps
2025-11-11 20:19:52,377 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=9, columns=4, rows=9
2025-11-11 20:20:24,383 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'for limit id 300185, show me past 7 days of data'
2025-11-11 20:20:24,384 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-zktlpn3r
2025-11-11 20:20:24,417 - agent.state_manager - INFO - Loaded session state for sess-zktlpn3r
2025-11-11 20:20:24,417 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 3 turns
2025-11-11 20:20:24,419 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 3 conversation turns
2025-11-11 20:20:24,434 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:20:24,435 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 20:20:24,435 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 20:20:24,435 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 20:20:24,435 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=3, conv_history(str)=131104
2025-11-11 20:20:24,435 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 20:20:24,435 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 20:20:24,435 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 20:20:24,447 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:20:24,447 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 20:20:35,551 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:20:35,554 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain the full breakdown of limits by class, group, and type. Any follow-up analysis or filtering can be done using the existing 9-row result set without requiring a new database query.
2025-11-11 20:20:35,555 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 20:20:35,555 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 20:20:35,556 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 20:20:35,580 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:20:38,931 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:20:38,933 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 20:20:38,934 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 20:20:38,934 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 20:20:38,957 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:20:38,957 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 20:20:38,957 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:20:38,957 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 20:20:38,958 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:20:38,958 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 20:20:38,958 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 20:20:38,958 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 20:20:38,958 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 20:20:38,958 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 20:20:38,958 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 20:20:38,958 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 131104 characters
2025-11-11 20:20:38,958 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 20:20:38,959 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 20:20:38,959 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 20:20:38,959 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 20:20:38,959 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 20:20:38,959 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 20:20:38,959 - tools.impl.nl_to_sql_planner - INFO -     User Query: count of americas from above
2025-11-11 20:20:38,959 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 20:20:38,959 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 20:20:38,959 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data LIMIT 10
2025-11-11 20:20:38,959 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 20:20:38,959 - tools.impl.nl_to_sql_planner - INFO -     Result Table (10 rows):
2025-11-11 20:20:38,959 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_instance_id, state, extension, st_dt, end_dt, limit_concatenate, pref_name, LM_Column
2025-11-11 20:20:38,959 - tools.impl.nl_to_sql_planner - INFO -     ... (130504 more characters)
2025-11-11 20:20:38,959 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:20:49,887 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:20:59,819 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:21:01,546 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:21:01,547 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 20:21:01,547 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:21:01,547 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 131104
2025-11-11 20:21:01,547 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 20:21:01,547 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 6 SQL code blocks, using LAST (most recent)
2025-11-11 20:21:01,548 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 20:21:01,548 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT limit_class, limit_group, limit_type, COUNT(*) as limit_count 
FROM limits_data 
WHERE date = (SELECT MAX(date) FROM limits_data) 
GROUP BY limit_class, limit_group, limit_type 
ORDER BY limit_count DESC...
2025-11-11 20:21:01,548 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 210 characters
2025-11-11 20:21:01,548 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 20:21:01,548 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 20:21:01,548 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 210 characters
2025-11-11 20:21:01,548 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT limit_class, limit_group, limit_type, COUNT(*) as limit_count 
FROM limits_data 
WHERE date = (SELECT MAX(date) FROM limits_data) 
GROUP BY limit_class, limit_group, limit_type 
ORDER BY limit_count DESC
2025-11-11 20:21:01,548 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT limit_class, limit_group, limit_type, COUNT(*) as limit_count 
FROM limits_data 
WHERE date = (SELECT MAX(date) FROM limits_data) 
GROUP BY limit_class, limit_group, limit_type 
ORDER BY limit_count DESC
2025-11-11 20:21:01,548 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:21:01,550 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 20:21:01,550 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: for limit id 300185, show me past 7 days of data
2025-11-11 20:21:01,550 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10719 chars
2025-11-11 20:21:01,550 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 153701 chars
2025-11-11 20:21:01,550 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 20:21:01,551 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 20:21:13,544 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:21:15,795 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 401 chars
2025-11-11 20:21:15,795 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' FROM limits_data) ORDER BY date ASC",
    "explanation": "Retrieved past 7 days of data for limit ID 300185, sorted chronologically. Used latest date minus 7 days to capture historical progression. Returned all columns to provide comprehensive view.",
    "target_table": "limits_data"
}
2025-11-11 20:21:15,796 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 20:21:15,796 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 20:21:15,796 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' FROM limits_data) ORDER BY date ASC...
2025-11-11 20:21:15,796 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' FROM limits_data) ORDER BY date ASC
2025-11-11 20:21:15,797 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 20:21:15,797 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 20:21:15,797 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 20:21:15,820 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:21:15,821 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 20:21:15,821 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 20:21:15,821 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 20:21:15,841 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:21:15,842 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' FROM limits_data) ORDER BY date ASC...
2025-11-11 20:21:15,842 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 135 chars
2025-11-11 20:21:15,842 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' FROM limits_data) ORDER BY date ASC
2025-11-11 20:21:15,842 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' FROM limits_data) ORDER BY date ASC...
2025-11-11 20:21:15,842 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' FROM limits_data) ORDER BY date ASC...
2025-11-11 20:21:15,842 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 20:21:15,842 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' FROM limits_data) ORDER BY date ASC...
2025-11-11 20:21:15,911 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 20:21:15,911 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 20:21:15,911 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 20:21:15,920 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:21:15,921 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=1, columns=41, rows=1, sql=SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' 
2025-11-11 20:21:15,921 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 20:21:15,921 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 20:21:15,921 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' 
2025-11-11 20:21:15,921 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=1, columns=41, rows=1, query_length=135
2025-11-11 20:21:15,921 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 20:21:15,921 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 20:21:15,922 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 2484 chars
2025-11-11 20:21:16,615 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:21:24,931 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1538 chars
2025-11-11 20:21:24,932 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 20:21:24,932 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 20:21:24,935 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 42657 chars
2025-11-11 20:21:31,874 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:21:31,876 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 833 chars
2025-11-11 20:21:31,876 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=1, columns=41, rows=1, query=SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' 
2025-11-11 20:21:31,876 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=1, columns=41, rows=1, has_query=True
2025-11-11 20:21:31,877 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' ...
2025-11-11 20:21:31,877 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' ...
2025-11-11 20:21:31,877 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 20:21:31,878 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 20:21:31,878 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 20:21:31,922 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:21:31,922 - agent.streaming_agent - INFO - Agent completed for session sess-zktlpn3r: 67487.36700000001ms, 8 steps
2025-11-11 20:21:31,922 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=1, columns=41, rows=1
2025-11-11 20:21:45,378 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'which limit ids exists for atleast 5 days'
2025-11-11 20:21:45,379 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-zktlpn3r
2025-11-11 20:21:45,387 - agent.state_manager - INFO - Loaded session state for sess-zktlpn3r
2025-11-11 20:21:45,387 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 3 turns
2025-11-11 20:21:45,390 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 3 conversation turns
2025-11-11 20:21:45,409 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:21:45,409 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 20:21:45,409 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 20:21:45,410 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 20:21:45,410 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=3, conv_history(str)=123510
2025-11-11 20:21:45,410 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 20:21:45,410 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 20:21:45,410 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 20:21:45,429 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:21:45,429 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 20:21:56,142 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:21:56,145 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain the full details for limit ID 300185, including all columns and attributes. Any follow-up query about this specific limit can be directly answered using the existing data without needing an additional database query.
2025-11-11 20:21:56,145 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 20:21:56,146 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 20:21:56,146 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 20:21:56,169 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:22:00,750 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:22:00,753 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 20:22:00,754 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 20:22:00,754 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 20:22:00,778 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:22:00,779 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 20:22:00,779 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:22:00,779 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 20:22:00,779 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:22:00,779 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 20:22:00,780 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 20:22:00,780 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 20:22:00,780 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 20:22:00,780 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 20:22:00,780 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 20:22:00,780 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 123510 characters
2025-11-11 20:22:00,780 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 20:22:00,780 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 20:22:00,780 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 20:22:00,781 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 20:22:00,781 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 20:22:00,781 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 20:22:00,781 - tools.impl.nl_to_sql_planner - INFO -     User Query: top primary limit
2025-11-11 20:22:00,781 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 20:22:00,781 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 20:22:00,781 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' ORDER BY utilization DESC
2025-11-11 20:22:00,781 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 20:22:00,781 - tools.impl.nl_to_sql_planner - INFO -     Result Table (126 rows):
2025-11-11 20:22:00,781 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_instance_id, state, extension, st_dt, end_dt, limit
2025-11-11 20:22:00,781 - tools.impl.nl_to_sql_planner - INFO -     ... (122910 more characters)
2025-11-11 20:22:00,781 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:22:12,834 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:22:23,175 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:22:29,269 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:22:29,270 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 20:22:29,270 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:22:29,270 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 123510
2025-11-11 20:22:29,271 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 20:22:29,271 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 6 SQL code blocks, using LAST (most recent)
2025-11-11 20:22:29,271 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 20:22:29,271 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT * FROM limits_data 
WHERE limit_id = 300185 
AND date >= (SELECT MAX(date) - INTERVAL '7 days' FROM limits_data) 
ORDER BY date ASC...
2025-11-11 20:22:29,272 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 138 characters
2025-11-11 20:22:29,272 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 20:22:29,272 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 20:22:29,272 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 138 characters
2025-11-11 20:22:29,272 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT * FROM limits_data 
WHERE limit_id = 300185 
AND date >= (SELECT MAX(date) - INTERVAL '7 days' FROM limits_data) 
ORDER BY date ASC
2025-11-11 20:22:29,272 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT * FROM limits_data 
WHERE limit_id = 300185 
AND date >= (SELECT MAX(date) - INTERVAL '7 days' FROM limits_data) 
ORDER BY date ASC
2025-11-11 20:22:29,272 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:22:29,274 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 20:22:29,274 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: which limit ids exists for atleast 5 days
2025-11-11 20:22:29,274 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10575 chars
2025-11-11 20:22:29,274 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 146100 chars
2025-11-11 20:22:29,274 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 20:22:29,274 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 20:22:38,739 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:22:41,009 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 405 chars
2025-11-11 20:22:41,009 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' FROM limits_data) ORDER BY date ASC",
  "explanation": "Retrieved all data for Limit ID 300185 for the past 7 days from the most recent date, sorted chronologically. Single row indicates a snapshot of the Collateral Optimization limit with full utilization.",
  "target_table": "limits_data"
}
2025-11-11 20:22:41,010 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 20:22:41,010 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 20:22:41,010 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' FROM limits_data) ORDER BY date ASC...
2025-11-11 20:22:41,010 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' FROM limits_data) ORDER BY date ASC
2025-11-11 20:22:41,011 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 20:22:41,012 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 20:22:41,013 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 20:22:41,036 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:22:41,037 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 20:22:41,037 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 20:22:41,037 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 20:22:41,053 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:22:41,054 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' FROM limits_data) ORDER BY date ASC...
2025-11-11 20:22:41,054 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 135 chars
2025-11-11 20:22:41,054 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' FROM limits_data) ORDER BY date ASC
2025-11-11 20:22:41,054 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' FROM limits_data) ORDER BY date ASC...
2025-11-11 20:22:41,054 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' FROM limits_data) ORDER BY date ASC...
2025-11-11 20:22:41,054 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 20:22:41,054 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' FROM limits_data) ORDER BY date ASC...
2025-11-11 20:22:41,131 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 20:22:41,131 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 20:22:41,131 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 20:22:41,140 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:22:41,140 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=1, columns=41, rows=1, sql=SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' 
2025-11-11 20:22:41,140 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 20:22:41,140 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 20:22:41,140 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' 
2025-11-11 20:22:41,140 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=1, columns=41, rows=1, query_length=135
2025-11-11 20:22:41,140 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 20:22:41,140 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 20:22:41,141 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 2477 chars
2025-11-11 20:22:41,916 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:22:49,668 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1427 chars
2025-11-11 20:22:49,669 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 20:22:49,669 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 20:22:49,673 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 42779 chars
2025-11-11 20:22:58,226 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:22:58,229 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1072 chars
2025-11-11 20:22:58,229 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=1, columns=41, rows=1, query=SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' 
2025-11-11 20:22:58,229 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=1, columns=41, rows=1, has_query=True
2025-11-11 20:22:58,229 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' ...
2025-11-11 20:22:58,229 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' ...
2025-11-11 20:22:58,230 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 20:22:58,230 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 20:22:58,231 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 20:22:58,264 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:22:58,264 - agent.streaming_agent - INFO - Agent completed for session sess-zktlpn3r: 72854.28899999999ms, 8 steps
2025-11-11 20:22:58,264 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=1, columns=41, rows=1
2025-11-11 20:27:43,011 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'new query find limits ids that exists on more than 3 dates'
2025-11-11 20:27:43,012 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-zktlpn3r
2025-11-11 20:27:43,017 - agent.state_manager - INFO - Loaded session state for sess-zktlpn3r
2025-11-11 20:27:43,018 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 3 turns
2025-11-11 20:27:43,018 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 3 conversation turns
2025-11-11 20:27:43,028 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:27:43,028 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 20:27:43,029 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 20:27:43,029 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 20:27:43,029 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=3, conv_history(str)=12189
2025-11-11 20:27:43,029 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 20:27:43,029 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 20:27:43,029 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 20:27:43,033 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:27:43,033 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 20:27:47,064 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:27:47,066 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=True, reasoning=The previous query results only showed data for limit ID 300185 for a single date, and the follow-up query seems to be asking about limit IDs existing for at least 5 days. This requires a broader analysis across multiple dates and limit IDs, which is not present in the previous results. A new database query would be needed to comprehensively identify limit IDs that exist for 5 or more distinct days.
2025-11-11 20:27:47,067 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 20:27:47,068 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 20:27:47,068 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 20:27:47,075 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:27:51,469 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:27:51,472 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 20:27:51,472 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 20:27:51,472 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 20:27:51,479 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:27:51,480 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=True, passing to planner
2025-11-11 20:27:51,480 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:27:51,480 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 20:27:51,480 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:27:51,480 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 20:27:51,480 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 20:27:51,481 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: True
2025-11-11 20:27:51,481 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü° NEW QUERY WITH CONTEXT (different data needed)
2025-11-11 20:27:51,481 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 20:27:51,481 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 20:27:51,481 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 12189 characters
2025-11-11 20:27:51,481 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 20:27:51,481 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 20:27:51,481 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 20:27:51,481 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 20:27:51,481 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 20:27:51,481 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 20:27:51,481 - tools.impl.nl_to_sql_planner - INFO -     User Query: give me the count of limits by group of limits class, limit group and limit type
2025-11-11 20:27:51,481 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 20:27:51,481 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 20:27:51,482 - tools.impl.nl_to_sql_planner - INFO -     SELECT limit_class, limit_group, limit_type, COUNT(*) as limit_count FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY limit_class, limit_group, limit_type ORDER BY limit_count DESC
2025-11-11 20:27:51,482 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 20:27:51,482 - tools.impl.nl_to_sql_planner - INFO -     Result Table (9 rows):
2025-11-11 20:27:51,482 - tools.impl.nl_to_sql_planner - INFO -     Columns: limit_class, limit_group, limit_type, limit_count
2025-11-11 20:27:51,482 - tools.impl.nl_to_sql_planner - INFO -     Data:
2025-11-11 20:27:51,482 - tools.impl.nl_to_sql_planner - INFO -       Row 1: limit_class: Primary | limit_group: PV01 | limit_type: PV01 Delta | limit_count: 2
2025-11-11 20:27:51,482 - tools.impl.nl_to_sql_planner - INFO -       Row 2: limit_class: Reporting | limit_group: Asset | limit_ty
2025-11-11 20:27:51,482 - tools.impl.nl_to_sql_planner - INFO -     ... (11589 more characters)
2025-11-11 20:27:51,482 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:27:55,439 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:27:57,554 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:27:59,323 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 20:27:59,323 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: new query find limits ids that exists on more than 3 dates
2025-11-11 20:27:59,323 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10307 chars
2025-11-11 20:27:59,323 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 34796 chars
2025-11-11 20:27:59,323 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 20:27:59,323 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 20:28:01,912 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:28:04,580 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 473 chars
2025-11-11 20:28:04,581 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(DISTINCT date) >= 5 ORDER BY days_count DESC",
    "explanation": "Query finds limit IDs that exist on at least 5 distinct dates. Uses COUNT(DISTINCT date) to ensure unique date tracking, groups by limit_id, and filters for those with 5+ unique dates. Sorted by descending days count to show most persistent limits first.",
    "target_table": "limits_data"
}
2025-11-11 20:28:04,581 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 20:28:04,581 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 20:28:04,581 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(DISTINCT date) >= 5 ORDER BY days_count DESC...
2025-11-11 20:28:04,581 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(DISTINCT date) >= 5 ORDER BY days_count DESC
2025-11-11 20:28:04,581 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 20:28:04,581 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 20:28:04,581 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 20:28:04,585 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:28:04,585 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 20:28:04,585 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 20:28:04,585 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 20:28:04,588 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:28:04,588 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(DISTINCT date) >= 5 ORDER BY days_count DESC...
2025-11-11 20:28:04,588 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 144 chars
2025-11-11 20:28:04,588 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(DISTINCT date) >= 5 ORDER BY days_count DESC
2025-11-11 20:28:04,588 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(DISTINCT date) >= 5 ORDER BY days_count DESC...
2025-11-11 20:28:04,588 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(DISTINCT date) >= 5 ORDER BY days_count DESC...
2025-11-11 20:28:04,588 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 20:28:04,588 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(DISTINCT date) >= 5 ORDER BY days_count DESC...
2025-11-11 20:28:04,641 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 20:28:04,641 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 20:28:04,641 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 20:28:04,643 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:28:04,643 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=2, columns=2, rows=2, sql=SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(
2025-11-11 20:28:04,643 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 20:28:04,643 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 20:28:04,643 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(
2025-11-11 20:28:04,643 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=2, columns=2, rows=2, query_length=144
2025-11-11 20:28:04,643 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 20:28:04,643 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 20:28:04,644 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 694 chars
2025-11-11 20:28:05,321 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:28:13,203 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1716 chars
2025-11-11 20:28:13,204 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 20:28:13,204 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 20:28:13,207 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 42351 chars
2025-11-11 20:28:20,854 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:28:20,857 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 935 chars
2025-11-11 20:28:20,857 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=2, columns=2, rows=2, query=SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(
2025-11-11 20:28:20,858 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=2, columns=2, rows=2, has_query=True
2025-11-11 20:28:20,858 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(...
2025-11-11 20:28:20,858 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(...
2025-11-11 20:28:20,859 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 20:28:20,859 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 20:28:20,859 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 20:28:20,868 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:28:20,868 - agent.streaming_agent - INFO - Agent completed for session sess-zktlpn3r: 37838.831ms, 8 steps
2025-11-11 20:28:20,868 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=2, columns=2, rows=2
2025-11-11 20:29:12,595 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-11 20:29:12,611 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-11 20:29:12,611 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-11 20:29:12,612 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-11 20:29:12,612 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-11 20:29:12,635 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 20:29:12,635 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 20:29:12,635 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 20:29:12,635 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 20:29:12,635 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-11 20:29:12,635 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-11 20:29:12,635 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-11 20:29:12,636 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-11 20:29:12,636 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-11 20:29:12,636 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-11 20:29:12,636 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-11 20:29:12,636 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-11 20:29:12,636 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-11 20:29:12,637 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-11 20:29:12,637 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-11 20:29:12,637 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-11 20:29:12,637 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-11 20:29:12,638 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-11 20:29:12,638 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-11 20:29:12,643 - DuckDbDescribeTableTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/Resources/Python.app/Contents/MacOS/Python (PID 12402) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 20:29:12,643 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 20:29:12,643 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-11 20:29:12,643 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-11 20:29:12,644 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-11 20:29:12,644 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-11 20:29:12,861 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-11 20:29:12,861 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-11 20:29:12,862 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-11 20:29:12,862 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-11 20:29:12,862 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-11 20:29:12,862 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-11 20:29:12,863 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-11 20:29:12,863 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-11 20:29:12,863 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-11 20:29:12,863 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-11 20:29:12,865 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-11 20:29:12,865 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-11 20:29:12,865 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-11 20:29:12,865 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-11 20:29:12,866 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-11 20:29:12,866 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-11 20:29:12,866 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-11 20:29:12,866 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-11 20:29:12,866 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-11 20:29:12,866 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-11 20:29:12,866 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-11 20:29:12,866 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-11 20:29:12,867 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-11 20:29:12,867 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-11 20:29:12,867 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-11 20:29:12,867 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-11 20:29:12,868 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-11 20:29:12,868 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-11 20:29:12,868 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-11 20:29:12,868 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-11 20:29:12,868 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-11 20:29:12,868 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-11 20:29:12,869 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-11 20:29:12,869 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-11 20:29:12,869 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-11 20:29:12,869 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-11 20:29:12,869 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-11 20:29:12,869 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-11 20:29:12,872 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-11 20:29:12,872 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-11 20:29:12,872 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-11 20:29:12,872 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-11 20:29:12,872 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-11 20:29:12,872 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-11 20:29:12,872 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-11 20:29:12,872 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-11 20:29:12,878 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 20:29:12,878 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 20:29:12,878 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 20:29:12,878 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 20:29:12,878 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-11 20:29:12,878 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-11 20:29:12,878 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-11 20:29:12,878 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-11 20:29:12,878 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-11 20:29:12,878 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-11 20:29:12,878 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-11 20:29:12,879 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-11 20:29:12,879 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-11 20:29:12,879 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-11 20:29:12,879 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-11 20:29:12,879 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-11 20:29:12,879 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-11 20:29:12,879 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-11 20:29:12,879 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-11 20:29:12,882 - DuckDbListFilesTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/Resources/Python.app/Contents/MacOS/Python (PID 12402) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 20:29:12,882 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 20:29:12,882 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-11 20:29:12,882 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-11 20:29:12,882 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-11 20:29:12,882 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-11 20:29:12,883 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-11 20:29:12,883 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-11 20:29:12,883 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-11 20:29:12,883 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-11 20:29:12,883 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-11 20:29:12,883 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-11 20:29:12,883 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-11 20:29:12,883 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-11 20:29:12,883 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-11 20:29:12,883 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-11 20:29:12,883 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-11 20:29:12,883 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-11 20:29:12,883 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-11 20:29:12,883 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-11 20:29:12,883 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-11 20:29:12,883 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-11 20:29:12,883 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-11 20:29:12,883 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-11 20:29:12,883 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-11 20:29:12,883 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-11 20:29:12,884 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-11 20:29:12,884 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-11 20:29:12,884 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-11 20:29:12,884 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-11 20:29:12,884 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-11 20:29:12,884 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-11 20:29:12,886 - DuckDbGetStatsTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/Resources/Python.app/Contents/MacOS/Python (PID 12402) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 20:29:12,886 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 20:29:12,886 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-11 20:29:12,886 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-11 20:29:12,886 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-11 20:29:12,886 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-11 20:29:12,886 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-11 20:29:12,886 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-11 20:29:12,887 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-11 20:29:12,887 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-11 20:29:12,887 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-11 20:29:12,887 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-11 20:29:12,892 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 20:29:12,892 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 20:29:12,892 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 20:29:12,892 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 20:29:12,892 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-11 20:29:12,892 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-11 20:29:12,892 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-11 20:29:12,892 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-11 20:29:12,892 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-11 20:29:12,892 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-11 20:29:12,892 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-11 20:29:12,897 - tools.tools_registry - ERROR - Error loading custom tool parquet_agent: invalid syntax (graph_nodes.py, line 732)
2025-11-11 20:29:12,897 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-11 20:29:12,897 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-11 20:29:12,897 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-11 20:29:12,897 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-11 20:29:12,897 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-11 20:29:12,897 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-11 20:29:12,897 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-11 20:29:12,897 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-11 20:29:12,897 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-11 20:29:12,897 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-11 20:29:12,898 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-11 20:29:12,898 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-11 20:29:12,898 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-11 20:29:12,898 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-11 20:29:12,898 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-11 20:29:12,898 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-11 20:29:12,898 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-11 20:29:12,898 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-11 20:29:12,900 - DuckDbListTablesTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/Resources/Python.app/Contents/MacOS/Python (PID 12402) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 20:29:12,900 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 20:29:12,900 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-11 20:29:12,900 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-11 20:29:12,900 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-11 20:29:12,900 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-11 20:29:12,900 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-11 20:29:12,900 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-11 20:29:12,901 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-11 20:29:12,901 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-11 20:29:12,901 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-11 20:29:12,901 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-11 20:29:12,901 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-11 20:29:12,901 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-11 20:29:12,901 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-11 20:29:12,901 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-11 20:29:12,901 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-11 20:29:12,901 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-11 20:29:12,901 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-11 20:29:12,901 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-11 20:29:12,901 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-11 20:29:12,901 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-11 20:29:12,901 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-11 20:29:12,901 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-11 20:29:12,901 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-11 20:29:12,901 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-11 20:29:12,901 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-11 20:29:12,901 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-11 20:29:12,904 - DuckDbAggregateTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/Resources/Python.app/Contents/MacOS/Python (PID 12402) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 20:29:12,904 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 20:29:12,904 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-11 20:29:12,904 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-11 20:29:12,904 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-11 20:29:12,904 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-11 20:29:12,904 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-11 20:29:12,904 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-11 20:29:12,904 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-11 20:29:12,904 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-11 20:29:12,904 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-11 20:29:12,904 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-11 20:29:12,904 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-11 20:29:12,904 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-11 20:29:12,904 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-11 20:29:12,905 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-11 20:29:12,910 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 20:29:12,910 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 20:29:12,910 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 20:29:12,910 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 20:29:12,910 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-11 20:29:12,910 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-11 20:29:12,910 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-11 20:29:12,910 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-11 20:29:12,910 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-11 20:29:12,910 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-11 20:29:12,910 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-11 20:29:12,910 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-11 20:29:12,910 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-11 20:29:12,910 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-11 20:29:12,910 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-11 20:29:12,910 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-11 20:29:12,910 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-11 20:29:12,911 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-11 20:29:12,911 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-11 20:29:12,911 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-11 20:29:12,911 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-11 20:29:12,911 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-11 20:29:12,911 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-11 20:29:12,911 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-11 20:29:12,911 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-11 20:29:12,911 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-11 20:29:12,911 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-11 20:29:12,911 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-11 20:29:12,911 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-11 20:29:12,911 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-11 20:29:12,911 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-11 20:29:12,911 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-11 20:29:12,911 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-11 20:29:12,911 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-11 20:29:12,911 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-11 20:29:12,911 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-11 20:29:12,911 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-11 20:29:12,912 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-11 20:29:12,912 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-11 20:29:12,912 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-11 20:29:12,912 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-11 20:29:12,912 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-11 20:29:12,912 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-11 20:29:12,912 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-11 20:29:12,912 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-11 20:29:12,912 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-11 20:29:12,912 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-11 20:29:12,912 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-11 20:29:12,912 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-11 20:29:12,912 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-11 20:29:12,912 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-11 20:29:12,912 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-11 20:29:12,912 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-11 20:29:12,912 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-11 20:29:12,912 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-11 20:29:12,912 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-11 20:29:12,912 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-11 20:29:12,912 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-11 20:29:12,912 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-11 20:29:12,913 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-11 20:29:12,913 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-11 20:29:12,913 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-11 20:29:12,913 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-11 20:29:12,913 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-11 20:29:12,913 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-11 20:29:12,913 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-11 20:29:12,913 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-11 20:29:12,913 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-11 20:29:12,913 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-11 20:29:12,913 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-11 20:29:12,913 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-11 20:29:12,913 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-11 20:29:12,913 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-11 20:29:12,914 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-11 20:29:12,914 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-11 20:29:12,919 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 20:29:12,919 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 20:29:12,919 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 20:29:12,919 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 20:29:12,919 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-11 20:29:12,919 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-11 20:29:12,919 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-11 20:29:12,919 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-11 20:29:12,919 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-11 20:29:12,919 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-11 20:29:12,919 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-11 20:29:12,919 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-11 20:29:12,919 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-11 20:29:12,919 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-11 20:29:12,919 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-11 20:29:12,920 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-11 20:29:12,920 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-11 20:29:12,920 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-11 20:29:12,920 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-11 20:29:12,920 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-11 20:29:12,920 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-11 20:29:12,920 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-11 20:29:12,920 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-11 20:29:12,920 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-11 20:29:12,920 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-11 20:29:12,920 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-11 20:29:12,920 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-11 20:29:12,920 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-11 20:29:12,920 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-11 20:29:12,922 - DuckDbQueryTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/Resources/Python.app/Contents/MacOS/Python (PID 12402) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 20:29:12,923 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 20:29:12,923 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-11 20:29:12,923 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-11 20:29:12,923 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-11 20:29:12,923 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-11 20:29:12,923 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-11 20:29:12,923 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-11 20:29:12,923 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-11 20:29:12,923 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-11 20:29:12,925 - DuckDbRefreshViewsTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /Applications/Xcode.app/Contents/Developer/Library/Frameworks/Python3.framework/Versions/3.9/Resources/Python.app/Contents/MacOS/Python (PID 12402) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 20:29:12,925 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 20:29:12,925 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-11 20:29:12,925 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-11 20:29:12,925 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-11 20:29:12,925 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-11 20:29:12,926 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-11 20:29:12,926 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-11 20:29:12,931 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 20:29:12,931 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 20:29:12,931 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 20:29:12,931 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 20:29:12,931 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-11 20:29:12,931 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-11 20:29:12,931 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-11 20:29:12,931 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-11 20:29:12,931 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-11 20:29:12,931 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-11 20:29:12,931 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-11 20:29:12,931 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-11 20:29:12,931 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-11 20:29:12,932 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-11 20:29:12,932 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-11 20:29:12,932 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-11 20:29:12,932 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-11 20:29:12,932 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-11 20:29:12,932 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-11 20:29:12,932 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-11 20:29:12,938 - root - INFO - All routes registered successfully
2025-11-11 20:29:13,931 - DuckDbRefreshViewsTool - INFO - Auto-refresh stopped
2025-11-11 20:29:14,933 - DuckDbQueryTool - INFO - Auto-refresh stopped
2025-11-11 20:29:15,915 - DuckDbAggregateTool - INFO - Auto-refresh stopped
2025-11-11 20:29:16,919 - DuckDbListTablesTool - INFO - Auto-refresh stopped
2025-11-11 20:29:17,901 - DuckDbGetStatsTool - INFO - Auto-refresh stopped
2025-11-11 20:29:18,904 - DuckDbListFilesTool - INFO - Auto-refresh stopped
2025-11-11 20:29:19,675 - DuckDbDescribeTableTool - INFO - Auto-refresh stopped
2025-11-11 20:29:34,780 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(DISTINCT date) >= 5 ORDER BY days_count DESC, change this to 8 dates'
2025-11-11 20:29:34,781 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-zktlpn3r
2025-11-11 20:29:34,783 - agent.state_manager - INFO - Loaded session state for sess-zktlpn3r
2025-11-11 20:29:34,783 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 3 turns
2025-11-11 20:29:34,784 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 3 conversation turns
2025-11-11 20:29:34,793 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:29:34,793 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 20:29:34,793 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 20:29:34,794 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 20:29:34,794 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=3, conv_history(str)=11360
2025-11-11 20:29:34,794 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 20:29:34,794 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 20:29:34,794 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 20:29:34,797 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:29:34,797 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 20:29:37,556 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:29:37,559 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=True, reasoning=The previous query only returned limit_id and days_count columns, which does not provide enough context to answer a potential follow-up query. Without knowing the specific follow-up query, the safest assumption is that additional data retrieval would be needed to provide comprehensive information about these limit IDs.
2025-11-11 20:29:37,560 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 20:29:37,560 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 20:29:37,560 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 20:29:37,568 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:29:41,228 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:29:41,230 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 20:29:41,230 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 20:29:41,231 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 20:29:41,237 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:29:41,238 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=True, passing to planner
2025-11-11 20:29:41,238 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:29:41,238 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 20:29:41,238 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:29:41,238 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 20:29:41,238 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 20:29:41,239 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: True
2025-11-11 20:29:41,239 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü° NEW QUERY WITH CONTEXT (different data needed)
2025-11-11 20:29:41,239 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 20:29:41,239 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 20:29:41,239 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 11360 characters
2025-11-11 20:29:41,239 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 20:29:41,239 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 20:29:41,239 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 20:29:41,239 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 20:29:41,239 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 20:29:41,240 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 20:29:41,240 - tools.impl.nl_to_sql_planner - INFO -     User Query: for limit id 300185, show me past 7 days of data
2025-11-11 20:29:41,240 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 20:29:41,240 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 20:29:41,240 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_id = 300185 AND date >= (SELECT MAX(date) - INTERVAL '7 days' FROM limits_data) ORDER BY date ASC
2025-11-11 20:29:41,240 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 20:29:41,240 - tools.impl.nl_to_sql_planner - INFO -     Result Table (1 row):
2025-11-11 20:29:41,240 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, i
2025-11-11 20:29:41,240 - tools.impl.nl_to_sql_planner - INFO -     ... (10760 more characters)
2025-11-11 20:29:41,240 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:29:44,999 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:29:47,180 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:29:49,341 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 20:29:49,342 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(DISTINCT date) >= 5 ORDER BY days_count DESC, change this to 8 dates
2025-11-11 20:29:49,342 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10307 chars
2025-11-11 20:29:49,342 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 34077 chars
2025-11-11 20:29:49,342 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 20:29:49,342 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 20:29:52,198 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:29:54,578 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 453 chars
2025-11-11 20:29:54,578 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(DISTINCT date) >= 8 ORDER BY days_count DESC",
    "explanation": "Modified previous query to find limit IDs that exist on exactly 8 distinct dates, maintaining the same grouping and aggregation logic. Assumes user wants to refine the previous query by increasing the date count threshold from 5 to 8.",
    "target_table": "limits_data"
}
2025-11-11 20:29:54,578 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 20:29:54,579 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 20:29:54,579 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(DISTINCT date) >= 8 ORDER BY days_count DESC...
2025-11-11 20:29:54,579 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(DISTINCT date) >= 8 ORDER BY days_count DESC
2025-11-11 20:29:54,579 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 20:29:54,579 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 20:29:54,580 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 20:29:54,586 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:29:54,587 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 20:29:54,587 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 20:29:54,588 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 20:29:54,593 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:29:54,593 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(DISTINCT date) >= 8 ORDER BY days_count DESC...
2025-11-11 20:29:54,593 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 144 chars
2025-11-11 20:29:54,593 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(DISTINCT date) >= 8 ORDER BY days_count DESC
2025-11-11 20:29:54,593 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(DISTINCT date) >= 8 ORDER BY days_count DESC...
2025-11-11 20:29:54,594 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(DISTINCT date) >= 8 ORDER BY days_count DESC...
2025-11-11 20:29:54,594 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 20:29:54,594 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(DISTINCT date) >= 8 ORDER BY days_count DESC...
2025-11-11 20:29:54,662 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 20:29:54,662 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 20:29:54,662 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 20:29:54,664 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:29:54,664 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=1, columns=2, rows=1, sql=SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(
2025-11-11 20:29:54,664 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 20:29:54,664 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 20:29:54,664 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(
2025-11-11 20:29:54,664 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=1, columns=2, rows=1, query_length=144
2025-11-11 20:29:54,664 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 20:29:54,664 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 20:29:54,665 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 743 chars
2025-11-11 20:29:55,164 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:30:01,235 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1248 chars
2025-11-11 20:30:01,236 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 20:30:01,236 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 20:30:01,239 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 42381 chars
2025-11-11 20:30:09,710 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:30:09,712 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1061 chars
2025-11-11 20:30:09,713 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=1, columns=2, rows=1, query=SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(
2025-11-11 20:30:09,713 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=1, columns=2, rows=1, has_query=True
2025-11-11 20:30:09,713 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(...
2025-11-11 20:30:09,713 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT limit_id, COUNT(DISTINCT date) as days_count FROM limits_data GROUP BY limit_id HAVING COUNT(...
2025-11-11 20:30:09,714 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 20:30:09,714 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 20:30:09,714 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 20:30:09,725 - agent.state_manager - INFO - Saved session state for sess-zktlpn3r (user: admin)
2025-11-11 20:30:09,725 - agent.streaming_agent - INFO - Agent completed for session sess-zktlpn3r: 34931.266ms, 8 steps
2025-11-11 20:30:09,725 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=1, columns=2, rows=1
2025-11-11 20:33:57,909 - root - INFO - Client YSJj6sJKiJxmKtNSAAAG joined session room: sess-3i93prgr
2025-11-11 20:34:05,036 - agent.streaming_agent - INFO - [StreamingAgent] Query: '123456'
2025-11-11 20:34:05,043 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-3i93prgr
2025-11-11 20:34:05,044 - agent.state_manager - WARNING - Session sess-3i93prgr not found
2025-11-11 20:34:05,044 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 20:34:05,048 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:34:05,049 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 20:34:05,049 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 20:34:05,049 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 20:34:05,049 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 20:34:05,049 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 20:34:05,050 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 20:34:05,050 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 20:34:05,052 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:34:08,816 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:34:08,817 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 20:34:08,818 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 20:34:08,818 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 20:34:08,820 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:34:08,821 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 20:34:08,821 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:34:08,821 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 20:34:08,821 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:34:08,821 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 20:34:08,821 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 20:34:08,822 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 20:34:08,822 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 20:34:08,822 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 20:34:08,822 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 20:34:08,822 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 20:34:08,822 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 20:34:08,822 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 20:34:08,822 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 20:34:08,822 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 20:34:08,822 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:34:11,582 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:34:13,427 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:34:15,732 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 20:34:15,733 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 20:34:15,733 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 20:34:15,737 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:34:15,741 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:34:15,741 - agent.streaming_agent - INFO - Agent paused for clarification in session sess-3i93prgr: 10691.97ms, 4 steps
2025-11-11 20:34:42,540 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'explain me the count and average of limit value and utlisation by region type and metrics'
2025-11-11 20:34:42,540 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-3i93prgr
2025-11-11 20:34:42,542 - agent.state_manager - INFO - Loaded session state for sess-3i93prgr
2025-11-11 20:34:42,542 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 0 turns
2025-11-11 20:34:42,542 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 20:34:42,547 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:34:42,548 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 20:34:42,548 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 20:34:42,548 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 20:34:42,548 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 20:34:42,548 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 20:34:42,549 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 20:34:42,549 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 20:34:42,551 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:34:47,124 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:34:47,127 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 20:34:47,127 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 20:34:47,128 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 20:34:47,131 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:34:47,132 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 20:34:47,132 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:34:47,132 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 20:34:47,132 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:34:47,132 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 20:34:47,133 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 20:34:47,133 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 20:34:47,133 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 20:34:47,133 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 20:34:47,133 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 20:34:47,133 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 20:34:47,133 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 20:34:47,133 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 20:34:47,133 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 20:34:47,133 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 20:34:47,133 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:34:50,596 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:34:52,233 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:34:56,460 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 20:34:56,460 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: explain me the count and average of limit value and utlisation by region type and metrics
2025-11-11 20:34:56,461 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-11 20:34:56,461 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 22671 chars
2025-11-11 20:34:56,461 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 20:34:56,461 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 20:34:58,686 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:35:01,122 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 536 chars
2025-11-11 20:35:01,122 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT region_cd, COUNT(*) as limit_count, AVG(exposure_amt) as avg_exposure, AVG(utilization) as avg_utilization FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY region_cd ORDER BY limit_count DESC",
  "explanation": "Aggregated count and average of limit values and utilization grouped by region type. Assumptions: using latest date snapshot, grouping by region_cd, calculating count of limits, average exposure amount, and average utilization for each region.
2025-11-11 20:35:01,123 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 20:35:01,123 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 20:35:01,123 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT region_cd, COUNT(*) as limit_count, AVG(exposure_amt) as avg_exposure, AVG(utilization) as avg_utilization FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY region_cd O...
2025-11-11 20:35:01,123 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT region_cd, COUNT(*) as limit_count, AVG(exposure_amt) as avg_exposure, AVG(utilization) as avg_utilization FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY region_cd ORDER BY limit_count DESC
2025-11-11 20:35:01,124 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 20:35:01,124 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 20:35:01,124 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 20:35:01,127 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:35:01,128 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 20:35:01,128 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 20:35:01,128 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 20:35:01,131 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:35:01,131 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT region_cd, COUNT(*) as limit_count, AVG(exposure_amt) as avg_exposure, AVG(utilization) as avg_utilization FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY region_cd O...
2025-11-11 20:35:01,131 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 224 chars
2025-11-11 20:35:01,131 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT region_cd, COUNT(*) as limit_count, AVG(exposure_amt) as avg_exposure, AVG(utilization) as avg_utilization FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY region_cd ORDER BY limit_count DESC
2025-11-11 20:35:01,132 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT region_cd, COUNT(*) as limit_count, AVG(exposure_amt) as avg_exposure, AVG(utilization) as avg_utilization FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY region_cd O...
2025-11-11 20:35:01,132 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT region_cd, COUNT(*) as limit_count, AVG(exposure_amt) as avg_exposure, AVG(utilization) as avg_utilization FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY region_cd O...
2025-11-11 20:35:01,132 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 20:35:01,132 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT region_cd, COUNT(*) as limit_count, AVG(exposure_amt) as avg_exposure, AVG(utilization) as avg_utilization FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY region_cd O...
2025-11-11 20:35:01,216 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 20:35:01,216 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 20:35:01,217 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 20:35:01,218 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:35:01,218 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=4, columns=4, rows=4, sql=SELECT region_cd, COUNT(*) as limit_count, AVG(exposure_amt) as avg_exposure, AVG(utilization) as av
2025-11-11 20:35:01,218 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 20:35:01,218 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 20:35:01,218 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT region_cd, COUNT(*) as limit_count, AVG(exposure_amt) as avg_exposure, AVG(utilization) as av
2025-11-11 20:35:01,218 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=4, columns=4, rows=4, query_length=224
2025-11-11 20:35:01,218 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 20:35:01,218 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 20:35:01,219 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 1278 chars
2025-11-11 20:35:01,859 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:35:10,582 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1845 chars
2025-11-11 20:35:10,582 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 20:35:10,582 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 20:35:10,585 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 37746 chars
2025-11-11 20:35:18,858 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:35:18,861 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1170 chars
2025-11-11 20:35:18,862 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=4, columns=4, rows=4, query=SELECT region_cd, COUNT(*) as limit_count, AVG(exposure_amt) as avg_exposure, AVG(utilization) as av
2025-11-11 20:35:18,862 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=4, columns=4, rows=4, has_query=True
2025-11-11 20:35:18,862 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT region_cd, COUNT(*) as limit_count, AVG(exposure_amt) as avg_exposure, AVG(utilization) as av...
2025-11-11 20:35:18,862 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT region_cd, COUNT(*) as limit_count, AVG(exposure_amt) as avg_exposure, AVG(utilization) as av...
2025-11-11 20:35:18,863 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 20:35:18,863 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 20:35:18,864 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 20:35:18,870 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:35:18,870 - agent.streaming_agent - INFO - Agent completed for session sess-3i93prgr: 36321.533ms, 7 steps
2025-11-11 20:35:18,870 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=4, columns=4, rows=4
2025-11-11 20:36:00,473 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'how many breaches that is utlisation above 100% are with active extensions and when do those extensions expire. be precise'
2025-11-11 20:36:00,474 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-3i93prgr
2025-11-11 20:36:00,475 - agent.state_manager - INFO - Loaded session state for sess-3i93prgr
2025-11-11 20:36:00,475 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 1 turns
2025-11-11 20:36:00,475 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 1 conversation turns
2025-11-11 20:36:00,480 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:36:00,480 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 20:36:00,480 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 20:36:00,480 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 20:36:00,480 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=1, conv_history(str)=3947
2025-11-11 20:36:00,481 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 20:36:00,481 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 20:36:00,481 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 20:36:00,484 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:36:00,484 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 20:36:03,095 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:36:03,099 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query already provided a comprehensive breakdown of limits by region, including count, average exposure, and average utilization. Since no specific new information is requested beyond the existing aggregated results, the current data is sufficient to continue analyzing or discussing the regional limit metrics.
2025-11-11 20:36:03,099 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 20:36:03,100 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 20:36:03,100 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 20:36:03,104 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:36:07,325 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:36:07,329 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 20:36:07,329 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 20:36:07,329 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 20:36:07,335 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:36:07,335 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 20:36:07,335 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:36:07,335 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 20:36:07,336 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:36:07,336 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 20:36:07,336 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 20:36:07,336 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 20:36:07,336 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 20:36:07,336 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 20:36:07,336 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 20:36:07,336 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 3947 characters
2025-11-11 20:36:07,336 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 20:36:07,336 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 20:36:07,336 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 20:36:07,336 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 20:36:07,336 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 20:36:07,337 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 20:36:07,337 - tools.impl.nl_to_sql_planner - INFO -     User Query: explain me the count and average of limit value and utlisation by region type and metrics
2025-11-11 20:36:07,337 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 20:36:07,337 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 20:36:07,337 - tools.impl.nl_to_sql_planner - INFO -     SELECT region_cd, COUNT(*) as limit_count, AVG(exposure_amt) as avg_exposure, AVG(utilization) as avg_utilization FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY region_cd ORDER BY limit_count DESC
2025-11-11 20:36:07,337 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 20:36:07,337 - tools.impl.nl_to_sql_planner - INFO -     Result Table (4 rows):
2025-11-11 20:36:07,337 - tools.impl.nl_to_sql_planner - INFO -     Columns: region_cd, limit_count, avg_exposure, avg_utilization
2025-11-11 20:36:07,337 - tools.impl.nl_to_sql_planner - INFO -     Data:
2025-11-11 20:36:07,337 - tools.impl.nl_to_sql_planner - INFO -       Row 1: region_cd: AMERICAS | limit_count: 5 | avg_exposure: 3270190.0 | avg_utilization: 0.9440000000000002
2025-11-11 20:36:07,337 - tools.impl.nl_to_sql_planner - INFO -       Row 2: regio
2025-11-11 20:36:07,337 - tools.impl.nl_to_sql_planner - INFO -     ... (3347 more characters)
2025-11-11 20:36:07,337 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:36:10,574 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:36:12,414 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:36:14,473 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:36:14,473 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 20:36:14,474 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:36:14,474 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 3947
2025-11-11 20:36:14,474 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 20:36:14,474 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 2 SQL code blocks, using LAST (most recent)
2025-11-11 20:36:14,474 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 20:36:14,474 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT region_cd, 
       COUNT(*) as limit_count, 
       AVG(exposure_amt) as avg_exposure, 
       AVG(utilization) as avg_utilization 
FROM limits_data 
WHERE date = (SELECT MAX(date) FROM limits_data) 
GROUP BY region_cd 
ORDER BY limit_count DESC...
2025-11-11 20:36:14,474 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 252 characters
2025-11-11 20:36:14,474 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 20:36:14,474 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 20:36:14,474 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 252 characters
2025-11-11 20:36:14,475 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT region_cd, 
       COUNT(*) as limit_count, 
       AVG(exposure_amt) as avg_exposure, 
       AVG(utilization) as avg_utilization 
FROM limits_data 
WHERE date = (SELECT MAX(date) FROM limits_data) 
GROUP BY region_cd 
ORDER BY limit_count DESC
2025-11-11 20:36:14,475 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT region_cd, 
       COUNT(*) as limit_count, 
       AVG(exposure_amt) as avg_exposure, 
       AVG(utilization) as avg_utilization 
FROM limits_data 
WHERE date = (SELECT MAX(date) FROM limits_data) 
GROUP BY region_cd 
ORDER BY limit_count DESC
2025-11-11 20:36:14,475 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:36:14,477 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 20:36:14,477 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: how many breaches that is utlisation above 100% are with active extensions and when do those extensions expire. be precise
2025-11-11 20:36:14,477 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10803 chars
2025-11-11 20:36:14,477 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 26618 chars
2025-11-11 20:36:14,477 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 20:36:14,477 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 20:36:17,124 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:36:20,050 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 560 chars
2025-11-11 20:36:20,051 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT COUNT(*) as breach_count, 
            MAX(end_dt) as latest_extension_expiry 
     FROM limits_data 
     WHERE date = (SELECT MAX(date) FROM limits_data) 
       AND utilization > 1.0 
       AND extension = 1 
       AND state = 'Active'",
    "explanation": "Counted breached limits with active extensions, showing total count and latest extension expiry date. Assumptions: 'utilization above 100%' means > 1.0, 'active extensions' means extension=1 and state='Active', using
2025-11-11 20:36:20,051 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 20:36:20,051 - tools.impl.nl_to_sql_planner - ERROR - [SQL_GENERATOR] ‚ùå JSON parsing failed: Invalid control character at: line 2 column 46 (char 47)
2025-11-11 20:36:20,051 - tools.impl.nl_to_sql_planner - ERROR - [SQL_GENERATOR] Full response that failed to parse: {
    "sql": "SELECT COUNT(*) as breach_count, 
            MAX(end_dt) as latest_extension_expiry 
     FROM limits_data 
     WHERE date = (SELECT MAX(date) FROM limits_data) 
       AND utilization > 1.0 
       AND extension = 1 
       AND state = 'Active'",
    "explanation": "Counted breached limits with active extensions, showing total count and latest extension expiry date. Assumptions: 'utilization above 100%' means > 1.0, 'active extensions' means extension=1 and state='Active', using latest date snapshot.",
    "target_table": "limits_data"
}
2025-11-11 20:36:20,051 - tools.impl.nl_to_sql_planner - ERROR - [SQL_GENERATOR] Response length: 560 chars
2025-11-11 20:36:20,052 - tools.impl.nl_to_sql_planner - ERROR - [SQL_GENERATOR] Response type: <class 'str'>
2025-11-11 20:36:20,052 - tools.impl.nl_to_sql_planner - ERROR - [SQL_GENERATOR] ‚ùå Failed to parse LLM response as JSON for query 'how many breaches that is utlisation above 100% are with active extensions and when do those extensions expire. be precise': Invalid control character at: line 2 column 46 (char 47)
2025-11-11 20:36:20,053 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 20:36:20,053 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 20:36:20,053 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 20:36:20,057 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:36:20,058 - agent.graph_nodes - INFO - [GENERATE_SQL] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 20:36:20,058 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:36:20,058 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 20:36:20,058 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:36:20,058 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 20:36:20,058 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 20:36:20,058 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 20:36:20,059 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 20:36:20,059 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 20:36:20,059 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 20:36:20,059 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 3947 characters
2025-11-11 20:36:20,059 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 20:36:20,059 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 20:36:20,059 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 20:36:20,059 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 20:36:20,059 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 20:36:20,059 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 20:36:20,059 - tools.impl.nl_to_sql_planner - INFO -     User Query: explain me the count and average of limit value and utlisation by region type and metrics
2025-11-11 20:36:20,059 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 20:36:20,059 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 20:36:20,059 - tools.impl.nl_to_sql_planner - INFO -     SELECT region_cd, COUNT(*) as limit_count, AVG(exposure_amt) as avg_exposure, AVG(utilization) as avg_utilization FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY region_cd ORDER BY limit_count DESC
2025-11-11 20:36:20,059 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 20:36:20,060 - tools.impl.nl_to_sql_planner - INFO -     Result Table (4 rows):
2025-11-11 20:36:20,060 - tools.impl.nl_to_sql_planner - INFO -     Columns: region_cd, limit_count, avg_exposure, avg_utilization
2025-11-11 20:36:20,060 - tools.impl.nl_to_sql_planner - INFO -     Data:
2025-11-11 20:36:20,060 - tools.impl.nl_to_sql_planner - INFO -       Row 1: region_cd: AMERICAS | limit_count: 5 | avg_exposure: 3270190.0 | avg_utilization: 0.9440000000000002
2025-11-11 20:36:20,060 - tools.impl.nl_to_sql_planner - INFO -       Row 2: regio
2025-11-11 20:36:20,060 - tools.impl.nl_to_sql_planner - INFO -     ... (3347 more characters)
2025-11-11 20:36:20,060 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:36:23,576 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:36:25,417 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:36:27,704 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:36:27,705 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 20:36:27,705 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:36:27,706 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 3947
2025-11-11 20:36:27,706 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 20:36:27,706 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 2 SQL code blocks, using LAST (most recent)
2025-11-11 20:36:27,707 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 20:36:27,707 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT region_cd, 
       COUNT(*) as limit_count, 
       AVG(exposure_amt) as avg_exposure, 
       AVG(utilization) as avg_utilization 
FROM limits_data 
WHERE date = (SELECT MAX(date) FROM limits_data) 
GROUP BY region_cd 
ORDER BY limit_count DESC...
2025-11-11 20:36:27,707 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 252 characters
2025-11-11 20:36:27,707 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 20:36:27,707 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 20:36:27,707 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 252 characters
2025-11-11 20:36:27,707 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT region_cd, 
       COUNT(*) as limit_count, 
       AVG(exposure_amt) as avg_exposure, 
       AVG(utilization) as avg_utilization 
FROM limits_data 
WHERE date = (SELECT MAX(date) FROM limits_data) 
GROUP BY region_cd 
ORDER BY limit_count DESC
2025-11-11 20:36:27,707 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT region_cd, 
       COUNT(*) as limit_count, 
       AVG(exposure_amt) as avg_exposure, 
       AVG(utilization) as avg_utilization 
FROM limits_data 
WHERE date = (SELECT MAX(date) FROM limits_data) 
GROUP BY region_cd 
ORDER BY limit_count DESC
2025-11-11 20:36:27,707 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:36:27,709 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 20:36:27,709 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: how many breaches that is utlisation above 100% are with active extensions and when do those extensions expire. be precise
2025-11-11 20:36:27,710 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10803 chars
2025-11-11 20:36:27,710 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 26618 chars
2025-11-11 20:36:27,710 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 20:36:27,710 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 20:36:30,002 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:36:32,717 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 497 chars
2025-11-11 20:36:32,718 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT COUNT(*) as breach_count, 
            MAX(end_dt) as latest_extension_expiry 
     FROM limits_data 
     WHERE date = (SELECT MAX(date) FROM limits_data) 
       AND utilization > 1.0 
       AND extension = 1 
       AND state = 'Active'",
    "explanation": "Counted breaches with active extensions, where utilization exceeds 100%. Used latest date snapshot, focused on active extensions, and tracked the latest extension expiry date.",
    "target_table": "limits_data"
}
2025-11-11 20:36:32,718 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 20:36:32,718 - tools.impl.nl_to_sql_planner - ERROR - [SQL_GENERATOR] ‚ùå JSON parsing failed: Invalid control character at: line 2 column 46 (char 47)
2025-11-11 20:36:32,718 - tools.impl.nl_to_sql_planner - ERROR - [SQL_GENERATOR] Full response that failed to parse: {
    "sql": "SELECT COUNT(*) as breach_count, 
            MAX(end_dt) as latest_extension_expiry 
     FROM limits_data 
     WHERE date = (SELECT MAX(date) FROM limits_data) 
       AND utilization > 1.0 
       AND extension = 1 
       AND state = 'Active'",
    "explanation": "Counted breaches with active extensions, where utilization exceeds 100%. Used latest date snapshot, focused on active extensions, and tracked the latest extension expiry date.",
    "target_table": "limits_data"
}
2025-11-11 20:36:32,719 - tools.impl.nl_to_sql_planner - ERROR - [SQL_GENERATOR] Response length: 497 chars
2025-11-11 20:36:32,719 - tools.impl.nl_to_sql_planner - ERROR - [SQL_GENERATOR] Response type: <class 'str'>
2025-11-11 20:36:32,719 - tools.impl.nl_to_sql_planner - ERROR - [SQL_GENERATOR] ‚ùå Failed to parse LLM response as JSON for query 'how many breaches that is utlisation above 100% are with active extensions and when do those extensions expire. be precise': Invalid control character at: line 2 column 46 (char 47)
2025-11-11 20:36:32,719 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['node_output', 'node_reasoning']
2025-11-11 20:36:32,720 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 2 data keys
2025-11-11 20:36:32,720 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 20:36:32,723 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:36:32,724 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=0, columns=0, rows=0, sql=N/A
2025-11-11 20:36:32,724 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: False, has 'columns' key: False
2025-11-11 20:36:32,724 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=0, columns=0, rows=0, query_length=0
2025-11-11 20:36:32,724 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 20:36:32,724 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 20:36:32,727 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 438 chars
2025-11-11 20:36:33,303 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:36:39,778 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1298 chars
2025-11-11 20:36:39,779 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 20:36:39,779 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 20:36:39,782 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 39375 chars
2025-11-11 20:36:41,999 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:36:47,388 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 977 chars
2025-11-11 20:36:47,389 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=0, columns=0, rows=0, query=MISSING
2025-11-11 20:36:47,389 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=0, columns=0, rows=0, has_query=False
2025-11-11 20:36:47,389 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=N/A...
2025-11-11 20:36:47,389 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): N/A...
2025-11-11 20:36:47,396 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:36:47,397 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for end: data keys = ['raw_table', 'response', 'prompt_monitor', 'node_output', 'node_reasoning']
2025-11-11 20:36:47,397 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for end with 5 data keys
2025-11-11 20:36:47,398 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for end
2025-11-11 20:36:47,398 - agent.streaming_agent - INFO - Agent completed for session sess-3i93prgr: 46917.405ms, 6 steps
2025-11-11 20:36:47,398 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=0, columns=0, rows=0
2025-11-11 20:37:18,636 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'show me the count of  extension_expiry_date by date for the past 30 days'
2025-11-11 20:37:18,636 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-3i93prgr
2025-11-11 20:37:18,637 - agent.state_manager - INFO - Loaded session state for sess-3i93prgr
2025-11-11 20:37:18,638 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 2 turns
2025-11-11 20:37:18,638 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 2 conversation turns
2025-11-11 20:37:18,643 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:37:18,643 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 20:37:18,644 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 20:37:18,644 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 20:37:18,644 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=2, conv_history(str)=6412
2025-11-11 20:37:18,644 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 20:37:18,644 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 20:37:18,644 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 20:37:18,648 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:37:18,648 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 20:37:21,638 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:37:21,641 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=True, reasoning=The previous query results only showed aggregated regional limit statistics (count, average exposure, average utilization) and did not return any specific details about breaches, extensions, or expiry dates. The follow-up query requires precise information about limit breaches, active extensions, and their expiration dates, which was not present in the previous results. A new database query will be needed to retrieve these specific details.
2025-11-11 20:37:21,642 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 20:37:21,642 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 20:37:21,643 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 20:37:21,648 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:37:26,235 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:37:26,238 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 20:37:26,238 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 20:37:26,238 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 20:37:26,242 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:37:26,242 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=True, passing to planner
2025-11-11 20:37:26,242 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:37:26,242 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 20:37:26,242 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:37:26,243 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 20:37:26,243 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 20:37:26,243 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: True
2025-11-11 20:37:26,243 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü° NEW QUERY WITH CONTEXT (different data needed)
2025-11-11 20:37:26,243 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 20:37:26,243 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 20:37:26,243 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 6412 characters
2025-11-11 20:37:26,243 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 20:37:26,243 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 20:37:26,243 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 20:37:26,243 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 20:37:26,243 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 20:37:26,243 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 20:37:26,243 - tools.impl.nl_to_sql_planner - INFO -     User Query: explain me the count and average of limit value and utlisation by region type and metrics
2025-11-11 20:37:26,243 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 20:37:26,244 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 20:37:26,244 - tools.impl.nl_to_sql_planner - INFO -     SELECT region_cd, COUNT(*) as limit_count, AVG(exposure_amt) as avg_exposure, AVG(utilization) as avg_utilization FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY region_cd ORDER BY limit_count DESC
2025-11-11 20:37:26,244 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 20:37:26,244 - tools.impl.nl_to_sql_planner - INFO -     Result Table (4 rows):
2025-11-11 20:37:26,244 - tools.impl.nl_to_sql_planner - INFO -     Columns: region_cd, limit_count, avg_exposure, avg_utilization
2025-11-11 20:37:26,244 - tools.impl.nl_to_sql_planner - INFO -     Data:
2025-11-11 20:37:26,244 - tools.impl.nl_to_sql_planner - INFO -       Row 1: region_cd: AMERICAS | limit_count: 5 | avg_exposure: 3270190.0 | avg_utilization: 0.9440000000000002
2025-11-11 20:37:26,244 - tools.impl.nl_to_sql_planner - INFO -       Row 2: regio
2025-11-11 20:37:26,244 - tools.impl.nl_to_sql_planner - INFO -     ... (5812 more characters)
2025-11-11 20:37:26,244 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:37:29,933 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:37:32,495 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:37:34,632 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 20:37:34,632 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: show me the count of  extension_expiry_date by date for the past 30 days
2025-11-11 20:37:34,633 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10307 chars
2025-11-11 20:37:34,633 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 29033 chars
2025-11-11 20:37:34,633 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 20:37:34,633 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 20:37:37,205 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:37:39,645 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 465 chars
2025-11-11 20:37:39,646 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT date, COUNT(DISTINCT extension_expiry_date) as unique_expiry_count FROM limits_data WHERE extension_expiry_date IS NOT NULL AND date >= (SELECT MAX(date) FROM limits_data) - INTERVAL '30 days' GROUP BY date ORDER BY date",
    "explanation": "Counted unique extension expiry dates for the past 30 days from the latest date in the dataset. Grouped results by date to show daily count of unique expiry dates.",
    "target_table": "limits_data"
}
2025-11-11 20:37:39,646 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 20:37:39,646 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 20:37:39,646 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT date, COUNT(DISTINCT extension_expiry_date) as unique_expiry_count FROM limits_data WHERE extension_expiry_date IS NOT NULL AND date >= (SELECT MAX(date) FROM limits_data) - INTERVAL '30 days' ...
2025-11-11 20:37:39,647 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT date, COUNT(DISTINCT extension_expiry_date) as unique_expiry_count FROM limits_data WHERE extension_expiry_date IS NOT NULL AND date >= (SELECT MAX(date) FROM limits_data) - INTERVAL '30 days' GROUP BY date ORDER BY date
2025-11-11 20:37:39,647 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 20:37:39,648 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 20:37:39,648 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 20:37:39,653 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:37:39,653 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 20:37:39,653 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 20:37:39,654 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 20:37:39,657 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:37:39,658 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT date, COUNT(DISTINCT extension_expiry_date) as unique_expiry_count FROM limits_data WHERE extension_expiry_date IS NOT NULL AND date >= (SELECT MAX(date) FROM limits_data) - INTERVAL '30 days' ...
2025-11-11 20:37:39,658 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 227 chars
2025-11-11 20:37:39,658 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT date, COUNT(DISTINCT extension_expiry_date) as unique_expiry_count FROM limits_data WHERE extension_expiry_date IS NOT NULL AND date >= (SELECT MAX(date) FROM limits_data) - INTERVAL '30 days' GROUP BY date ORDER BY date
2025-11-11 20:37:39,658 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT date, COUNT(DISTINCT extension_expiry_date) as unique_expiry_count FROM limits_data WHERE extension_expiry_date IS NOT NULL AND date >= (SELECT MAX(date) FROM limits_data) - INTERVAL '30 days' ...
2025-11-11 20:37:39,658 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT date, COUNT(DISTINCT extension_expiry_date) as unique_expiry_count FROM limits_data WHERE extension_expiry_date IS NOT NULL AND date >= (SELECT MAX(date) FROM limits_data) - INTERVAL '30 days' ...
2025-11-11 20:37:39,658 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 20:37:39,658 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT date, COUNT(DISTINCT extension_expiry_date) as unique_expiry_count FROM limits_data WHERE extension_expiry_date IS NOT NULL AND date >= (SELECT MAX(date) FROM limits_data) - INTERVAL '30 days' ...
2025-11-11 20:37:39,740 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['node_output', 'node_reasoning']
2025-11-11 20:37:39,740 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 2 data keys
2025-11-11 20:37:39,740 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 20:37:39,741 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:37:39,742 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:37:39,743 - agent.graph_nodes - INFO - [GENERATE_SQL] is_followup=True, more_data_needed=True, passing to planner
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: True
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü° NEW QUERY WITH CONTEXT (different data needed)
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 6412 characters
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO -     User Query: explain me the count and average of limit value and utlisation by region type and metrics
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO -     SELECT region_cd, COUNT(*) as limit_count, AVG(exposure_amt) as avg_exposure, AVG(utilization) as avg_utilization FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY region_cd ORDER BY limit_count DESC
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO -     Result Table (4 rows):
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO -     Columns: region_cd, limit_count, avg_exposure, avg_utilization
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO -     Data:
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO -       Row 1: region_cd: AMERICAS | limit_count: 5 | avg_exposure: 3270190.0 | avg_utilization: 0.9440000000000002
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO -       Row 2: regio
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO -     ... (5812 more characters)
2025-11-11 20:37:39,743 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:37:43,149 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:37:45,191 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:37:48,639 - agent.graph_nodes - INFO - [GENERATE_SQL] Planner generated SQL: EMPTY...
2025-11-11 20:37:48,639 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['node_output', 'node_reasoning']
2025-11-11 20:37:48,640 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 2 data keys
2025-11-11 20:37:48,640 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 20:37:48,645 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:37:48,645 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=0, columns=0, rows=0, sql=N/A
2025-11-11 20:37:48,646 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: False, has 'columns' key: False
2025-11-11 20:37:48,646 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=0, columns=0, rows=0, query_length=0
2025-11-11 20:37:48,646 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 20:37:48,646 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 20:37:48,648 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 781 chars
2025-11-11 20:37:49,285 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:37:55,228 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1211 chars
2025-11-11 20:37:55,229 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 20:37:55,229 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 20:37:55,231 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 41054 chars
2025-11-11 20:37:57,342 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:38:03,601 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1117 chars
2025-11-11 20:38:03,602 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=0, columns=0, rows=0, query=MISSING
2025-11-11 20:38:03,602 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=0, columns=0, rows=0, has_query=False
2025-11-11 20:38:03,602 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=N/A...
2025-11-11 20:38:03,602 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): N/A...
2025-11-11 20:38:03,612 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:38:03,612 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for end: data keys = ['raw_table', 'response', 'prompt_monitor', 'node_output', 'node_reasoning']
2025-11-11 20:38:03,613 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for end with 5 data keys
2025-11-11 20:38:03,613 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for end
2025-11-11 20:38:03,614 - agent.streaming_agent - INFO - Agent completed for session sess-3i93prgr: 44969.769ms, 9 steps
2025-11-11 20:38:03,614 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=0, columns=0, rows=0
2025-11-11 20:38:09,385 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'what columsn exist in database'
2025-11-11 20:38:09,386 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-3i93prgr
2025-11-11 20:38:09,387 - agent.state_manager - INFO - Loaded session state for sess-3i93prgr
2025-11-11 20:38:09,388 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 3 turns
2025-11-11 20:38:09,388 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 3 conversation turns
2025-11-11 20:38:09,394 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:38:09,395 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 20:38:09,395 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 20:38:09,395 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 20:38:09,395 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=3, conv_history(str)=8880
2025-11-11 20:38:09,396 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 20:38:09,396 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 20:38:09,396 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 20:38:09,400 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:38:09,400 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 20:38:12,839 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:38:12,842 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=True, reasoning=The previous query results only showed aggregated regional limit statistics (count, average exposure, average utilization) and did not contain specific details about extension dates or expiry information. To answer a query about extension date counts, we would need to run a new database query to retrieve the specific extension date details.
2025-11-11 20:38:12,842 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 20:38:12,843 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 20:38:12,843 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 20:38:12,849 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:38:16,832 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:38:16,836 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 20:38:16,836 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 20:38:16,836 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 20:38:16,841 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:38:16,841 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=True, passing to planner
2025-11-11 20:38:16,841 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:38:16,841 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 20:38:16,841 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:38:16,842 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 20:38:16,842 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 20:38:16,842 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: True
2025-11-11 20:38:16,842 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü° NEW QUERY WITH CONTEXT (different data needed)
2025-11-11 20:38:16,842 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 20:38:16,842 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 20:38:16,842 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 8880 characters
2025-11-11 20:38:16,842 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 20:38:16,842 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 20:38:16,842 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 20:38:16,842 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 20:38:16,842 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 20:38:16,842 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 20:38:16,842 - tools.impl.nl_to_sql_planner - INFO -     User Query: explain me the count and average of limit value and utlisation by region type and metrics
2025-11-11 20:38:16,842 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 20:38:16,843 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 20:38:16,843 - tools.impl.nl_to_sql_planner - INFO -     SELECT region_cd, COUNT(*) as limit_count, AVG(exposure_amt) as avg_exposure, AVG(utilization) as avg_utilization FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY region_cd ORDER BY limit_count DESC
2025-11-11 20:38:16,843 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 20:38:16,843 - tools.impl.nl_to_sql_planner - INFO -     Result Table (4 rows):
2025-11-11 20:38:16,843 - tools.impl.nl_to_sql_planner - INFO -     Columns: region_cd, limit_count, avg_exposure, avg_utilization
2025-11-11 20:38:16,843 - tools.impl.nl_to_sql_planner - INFO -     Data:
2025-11-11 20:38:16,843 - tools.impl.nl_to_sql_planner - INFO -       Row 1: region_cd: AMERICAS | limit_count: 5 | avg_exposure: 3270190.0 | avg_utilization: 0.9440000000000002
2025-11-11 20:38:16,843 - tools.impl.nl_to_sql_planner - INFO -       Row 2: regio
2025-11-11 20:38:16,843 - tools.impl.nl_to_sql_planner - INFO -     ... (8280 more characters)
2025-11-11 20:38:16,843 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:38:20,623 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:38:23,082 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:38:27,274 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 20:38:27,274 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 20:38:27,275 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 20:38:27,280 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:38:27,285 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:38:27,285 - agent.streaming_agent - INFO - Agent paused for clarification in session sess-3i93prgr: 17890.111999999997ms, 5 steps
2025-11-11 20:38:54,477 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'i want to knwo the name of all columns the table'
2025-11-11 20:38:54,477 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-3i93prgr
2025-11-11 20:38:54,479 - agent.state_manager - INFO - Loaded session state for sess-3i93prgr
2025-11-11 20:38:54,479 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 3 turns
2025-11-11 20:38:54,479 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 3 conversation turns
2025-11-11 20:38:54,485 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:38:54,485 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 20:38:54,486 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 20:38:54,486 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 20:38:54,486 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=3, conv_history(str)=8880
2025-11-11 20:38:54,486 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 20:38:54,486 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 20:38:54,486 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 20:38:54,490 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:38:54,490 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 20:38:57,384 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:38:57,387 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=True, reasoning=The new query about extension_expiry_date cannot be answered using the previous query results. The previous queries only provided aggregated metrics by region (limit count, average exposure, average utilization) and did not include any specific details about extension dates. To answer this query, a new database query would be required to retrieve the count of extension expiry dates over the past 30 days.
2025-11-11 20:38:57,388 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 20:38:57,388 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 20:38:57,388 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 20:38:57,395 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:39:00,763 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:39:00,766 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 20:39:00,767 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 20:39:00,767 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 20:39:00,773 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:39:00,774 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=True, passing to planner
2025-11-11 20:39:00,774 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:39:00,774 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 20:39:00,774 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:39:00,774 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 20:39:00,774 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 20:39:00,775 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: True
2025-11-11 20:39:00,775 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü° NEW QUERY WITH CONTEXT (different data needed)
2025-11-11 20:39:00,775 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 20:39:00,775 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 20:39:00,775 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 8880 characters
2025-11-11 20:39:00,775 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 20:39:00,775 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 20:39:00,775 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 20:39:00,775 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 20:39:00,775 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 20:39:00,775 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 20:39:00,775 - tools.impl.nl_to_sql_planner - INFO -     User Query: explain me the count and average of limit value and utlisation by region type and metrics
2025-11-11 20:39:00,775 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 20:39:00,775 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 20:39:00,775 - tools.impl.nl_to_sql_planner - INFO -     SELECT region_cd, COUNT(*) as limit_count, AVG(exposure_amt) as avg_exposure, AVG(utilization) as avg_utilization FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY region_cd ORDER BY limit_count DESC
2025-11-11 20:39:00,776 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 20:39:00,776 - tools.impl.nl_to_sql_planner - INFO -     Result Table (4 rows):
2025-11-11 20:39:00,776 - tools.impl.nl_to_sql_planner - INFO -     Columns: region_cd, limit_count, avg_exposure, avg_utilization
2025-11-11 20:39:00,776 - tools.impl.nl_to_sql_planner - INFO -     Data:
2025-11-11 20:39:00,776 - tools.impl.nl_to_sql_planner - INFO -       Row 1: region_cd: AMERICAS | limit_count: 5 | avg_exposure: 3270190.0 | avg_utilization: 0.9440000000000002
2025-11-11 20:39:00,776 - tools.impl.nl_to_sql_planner - INFO -       Row 2: regio
2025-11-11 20:39:00,776 - tools.impl.nl_to_sql_planner - INFO -     ... (8280 more characters)
2025-11-11 20:39:00,776 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:39:04,062 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:39:06,087 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:39:10,803 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 20:39:10,804 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 20:39:10,804 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 20:39:10,811 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:39:10,816 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:39:10,817 - agent.streaming_agent - INFO - Agent paused for clarification in session sess-3i93prgr: 16330.822999999999ms, 5 steps
2025-11-11 20:39:30,838 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'i want to knwo the name of all columns for the 'limits_data' table'
2025-11-11 20:39:30,839 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-3i93prgr
2025-11-11 20:39:30,840 - agent.state_manager - INFO - Loaded session state for sess-3i93prgr
2025-11-11 20:39:30,840 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 3 turns
2025-11-11 20:39:30,840 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 3 conversation turns
2025-11-11 20:39:30,846 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:39:30,847 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 20:39:30,847 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 20:39:30,847 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 20:39:30,847 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=3, conv_history(str)=8880
2025-11-11 20:39:30,847 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 20:39:30,848 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 20:39:30,848 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 20:39:30,852 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:39:30,852 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 20:39:33,706 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:39:33,709 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=True, reasoning=The previous query results only showed aggregated regional limit statistics (count, average exposure, average utilization) and did not contain specific details about extension dates or expiry information. To answer a query about extension date counts, we would need to run a new database query to retrieve the specific extension date details.
2025-11-11 20:39:33,710 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 20:39:33,710 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 20:39:33,711 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 20:39:33,716 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:39:36,808 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:39:36,812 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 20:39:36,812 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 20:39:36,812 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 20:39:36,817 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:39:36,817 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=True, passing to planner
2025-11-11 20:39:36,817 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:39:36,818 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 20:39:36,818 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:39:36,818 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 20:39:36,818 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 20:39:36,818 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: True
2025-11-11 20:39:36,818 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü° NEW QUERY WITH CONTEXT (different data needed)
2025-11-11 20:39:36,818 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 20:39:36,818 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 20:39:36,818 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 8880 characters
2025-11-11 20:39:36,818 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 20:39:36,818 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 20:39:36,818 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 20:39:36,819 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 20:39:36,819 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 20:39:36,819 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 20:39:36,819 - tools.impl.nl_to_sql_planner - INFO -     User Query: explain me the count and average of limit value and utlisation by region type and metrics
2025-11-11 20:39:36,819 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 20:39:36,819 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 20:39:36,819 - tools.impl.nl_to_sql_planner - INFO -     SELECT region_cd, COUNT(*) as limit_count, AVG(exposure_amt) as avg_exposure, AVG(utilization) as avg_utilization FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY region_cd ORDER BY limit_count DESC
2025-11-11 20:39:36,819 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 20:39:36,819 - tools.impl.nl_to_sql_planner - INFO -     Result Table (4 rows):
2025-11-11 20:39:36,819 - tools.impl.nl_to_sql_planner - INFO -     Columns: region_cd, limit_count, avg_exposure, avg_utilization
2025-11-11 20:39:36,819 - tools.impl.nl_to_sql_planner - INFO -     Data:
2025-11-11 20:39:36,819 - tools.impl.nl_to_sql_planner - INFO -       Row 1: region_cd: AMERICAS | limit_count: 5 | avg_exposure: 3270190.0 | avg_utilization: 0.9440000000000002
2025-11-11 20:39:36,819 - tools.impl.nl_to_sql_planner - INFO -       Row 2: regio
2025-11-11 20:39:36,819 - tools.impl.nl_to_sql_planner - INFO -     ... (8280 more characters)
2025-11-11 20:39:36,819 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:39:40,597 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:39:42,645 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:39:43,915 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 20:39:43,916 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: i want to knwo the name of all columns for the 'limits_data' table
2025-11-11 20:39:43,916 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10307 chars
2025-11-11 20:39:43,916 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 31495 chars
2025-11-11 20:39:43,916 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 20:39:43,916 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 20:39:46,432 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:39:48,240 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 368 chars
2025-11-11 20:39:48,241 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT column_name FROM information_schema.columns WHERE table_name = 'limits_data' ORDER BY ordinal_position",
    "explanation": "Query retrieves all column names for the 'limits_data' table using standard information schema. This will return a list of columns in their original order of definition.",
    "target_table": "information_schema.columns"
}
2025-11-11 20:39:48,241 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 20:39:48,241 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 20:39:48,241 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT column_name FROM information_schema.columns WHERE table_name = 'limits_data' ORDER BY ordinal_position...
2025-11-11 20:39:48,241 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT column_name FROM information_schema.columns WHERE table_name = 'limits_data' ORDER BY ordinal_position
2025-11-11 20:39:48,242 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 20:39:48,243 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 20:39:48,243 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 20:39:48,248 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:39:48,249 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 20:39:48,249 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 20:39:48,249 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 20:39:48,253 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:39:48,254 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT column_name FROM information_schema.columns WHERE table_name = 'limits_data' ORDER BY ordinal_position...
2025-11-11 20:39:48,254 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 109 chars
2025-11-11 20:39:48,254 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT column_name FROM information_schema.columns WHERE table_name = 'limits_data' ORDER BY ordinal_position
2025-11-11 20:39:48,254 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT column_name FROM information_schema.columns WHERE table_name = 'limits_data' ORDER BY ordinal_position...
2025-11-11 20:39:48,254 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT column_name FROM information_schema.columns WHERE table_name = 'limits_data' ORDER BY ordinal_position...
2025-11-11 20:39:48,254 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 20:39:48,254 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT column_name FROM information_schema.columns WHERE table_name = 'limits_data' ORDER BY ordinal_position...
2025-11-11 20:39:48,304 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 20:39:48,304 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 20:39:48,304 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 20:39:48,307 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:39:48,307 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=41, columns=1, rows=41, sql=SELECT column_name FROM information_schema.columns WHERE table_name = 'limits_data' ORDER BY ordinal
2025-11-11 20:39:48,307 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 20:39:48,307 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 20:39:48,307 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT column_name FROM information_schema.columns WHERE table_name = 'limits_data' ORDER BY ordinal
2025-11-11 20:39:48,307 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=41, columns=1, rows=41, query_length=109
2025-11-11 20:39:48,307 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 20:39:48,307 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 20:39:48,308 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 2440 chars
2025-11-11 20:39:49,095 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:39:56,851 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1485 chars
2025-11-11 20:39:56,852 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 20:39:56,852 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 20:39:56,855 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 42579 chars
2025-11-11 20:40:05,279 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:40:05,282 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1147 chars
2025-11-11 20:40:05,282 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=41, columns=1, rows=41, query=SELECT column_name FROM information_schema.columns WHERE table_name = 'limits_data' ORDER BY ordinal
2025-11-11 20:40:05,283 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=41, columns=1, rows=41, has_query=True
2025-11-11 20:40:05,283 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT column_name FROM information_schema.columns WHERE table_name = 'limits_data' ORDER BY ordinal...
2025-11-11 20:40:05,283 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT column_name FROM information_schema.columns WHERE table_name = 'limits_data' ORDER BY ordinal...
2025-11-11 20:40:05,284 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 20:40:05,284 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 20:40:05,285 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 20:40:05,295 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:40:05,296 - agent.streaming_agent - INFO - Agent completed for session sess-3i93prgr: 34448.352999999996ms, 8 steps
2025-11-11 20:40:05,296 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=41, columns=1, rows=41
2025-11-11 20:40:31,939 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'what does extension dolumn has as values'
2025-11-11 20:40:31,940 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-3i93prgr
2025-11-11 20:40:31,942 - agent.state_manager - INFO - Loaded session state for sess-3i93prgr
2025-11-11 20:40:31,942 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 3 turns
2025-11-11 20:40:31,943 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 3 conversation turns
2025-11-11 20:40:31,949 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:40:31,949 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 20:40:31,950 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 20:40:31,950 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 20:40:31,950 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=3, conv_history(str)=9274
2025-11-11 20:40:31,950 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 20:40:31,950 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 20:40:31,951 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 20:40:31,953 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:40:31,954 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 20:40:34,768 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:40:34,771 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query already retrieved the full list of column names for the 'limits_data' table. Since the query was specifically to list all columns, any follow-up query about column names or table structure can be directly answered using the existing results from the information_schema query.
2025-11-11 20:40:34,772 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 20:40:34,772 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 20:40:34,772 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 20:40:34,779 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:40:38,328 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:40:38,332 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 20:40:38,332 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 20:40:38,332 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 20:40:38,339 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:40:38,340 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 20:40:38,340 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:40:38,340 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 20:40:38,340 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:40:38,340 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 20:40:38,340 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 20:40:38,340 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 20:40:38,340 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 20:40:38,340 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 20:40:38,340 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 20:40:38,341 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 9274 characters
2025-11-11 20:40:38,341 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 20:40:38,341 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 20:40:38,341 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 20:40:38,341 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 20:40:38,341 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 20:40:38,341 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 20:40:38,341 - tools.impl.nl_to_sql_planner - INFO -     User Query: how many breaches that is utlisation above 100% are with active extensions and when do those extensions expire. be precise
2025-11-11 20:40:38,341 - tools.impl.nl_to_sql_planner - INFO -     Agent Response: I noticed that the query returned zero results, which suggests we might need to adjust our query strategy. I'll help diagnose and provide a comprehensive response.
2025-11-11 20:40:38,341 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 20:40:38,341 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 20:40:38,341 - tools.impl.nl_to_sql_planner - INFO -     SELECT 
2025-11-11 20:40:38,341 - tools.impl.nl_to_sql_planner - INFO -         COUNT(*) as breach_count,
2025-11-11 20:40:38,341 - tools.impl.nl_to_sql_planner - INFO -         COUNT(DISTINCT CASE WHEN extension_expiry_date IS NOT NULL THEN limit_id END) as extended_breaches,
2025-11-11 20:40:38,341 - tools.impl.nl_to_sql_planner - INFO -         MIN(extension_expiry_date) as earliest_extension_expiry,
2025-11-11 20:40:38,342 - tools.impl.nl_to_sql_planner - INFO -         MAX(extension_expiry_date) as latest_e
2025-11-11 20:40:38,342 - tools.impl.nl_to_sql_planner - INFO -     ... (8674 more characters)
2025-11-11 20:40:38,342 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:40:42,138 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:40:42,855 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:40:44,621 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 20:40:44,622 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 20:40:44,622 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 20:40:44,629 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:40:44,630 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 20:40:44,630 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 20:40:44,630 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 20:40:44,635 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:40:44,635 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: -- KNOWLEDGE QUESTION...
2025-11-11 20:40:44,635 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 21 chars
2025-11-11 20:40:44,635 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: -- KNOWLEDGE QUESTION
2025-11-11 20:40:44,636 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 20:40:44,636 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 20:40:44,636 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 20:40:44,641 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:40:44,641 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=0, columns=0, rows=0, sql=-- KNOWLEDGE QUESTION
2025-11-11 20:40:44,641 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 20:40:44,641 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['columns', 'rows', 'row_count', 'query']
2025-11-11 20:40:44,641 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: -- KNOWLEDGE QUESTION
2025-11-11 20:40:44,641 - agent.graph_nodes - INFO - [END_NODE] Knowledge response detected: 'I apologize, but I cannot find a clear definition for "extension dolumn" in the provided business gl...'
2025-11-11 20:40:44,641 - agent.graph_nodes - INFO - [END_NODE] Returning knowledge result with response length: 409
2025-11-11 20:40:44,641 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 20:40:44,641 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 20:40:44,642 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 20:40:44,647 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:40:44,648 - agent.streaming_agent - INFO - Agent completed for session sess-3i93prgr: 12697.97ms, 8 steps
2025-11-11 20:40:44,648 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=0, columns=0, rows=0
2025-11-11 20:42:00,218 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'what are the possible unique values of extension column in limits table'
2025-11-11 20:42:00,218 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-3i93prgr
2025-11-11 20:42:00,220 - agent.state_manager - INFO - Loaded session state for sess-3i93prgr
2025-11-11 20:42:00,220 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 3 turns
2025-11-11 20:42:00,220 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 3 conversation turns
2025-11-11 20:42:00,226 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:42:00,227 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 20:42:00,227 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 20:42:00,227 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 20:42:00,227 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=3, conv_history(str)=9274
2025-11-11 20:42:00,228 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 20:42:00,228 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 20:42:00,228 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 20:42:00,231 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:42:00,232 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 20:42:02,828 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:42:02,868 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query already retrieved the full list of column names for the 'limits_data' table. Since the query was specifically to list out all column names, and the result showed 41 columns in detail, no additional database query is needed to understand the table's structure.
2025-11-11 20:42:02,868 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 20:42:02,868 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 20:42:02,868 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 20:42:02,870 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:42:07,236 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:42:07,239 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 20:42:07,239 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 20:42:07,239 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 20:42:07,245 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:42:07,246 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 20:42:07,246 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:42:07,246 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 20:42:07,246 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:42:07,246 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 20:42:07,246 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 20:42:07,246 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 20:42:07,246 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 20:42:07,246 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 20:42:07,246 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 20:42:07,247 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 9274 characters
2025-11-11 20:42:07,247 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 20:42:07,247 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 20:42:07,247 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 20:42:07,247 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 20:42:07,247 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 20:42:07,247 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 20:42:07,247 - tools.impl.nl_to_sql_planner - INFO -     User Query: how many breaches that is utlisation above 100% are with active extensions and when do those extensions expire. be precise
2025-11-11 20:42:07,247 - tools.impl.nl_to_sql_planner - INFO -     Agent Response: I noticed that the query returned zero results, which suggests we might need to adjust our query strategy. I'll help diagnose and provide a comprehensive response.
2025-11-11 20:42:07,247 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 20:42:07,247 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 20:42:07,247 - tools.impl.nl_to_sql_planner - INFO -     SELECT 
2025-11-11 20:42:07,247 - tools.impl.nl_to_sql_planner - INFO -         COUNT(*) as breach_count,
2025-11-11 20:42:07,247 - tools.impl.nl_to_sql_planner - INFO -         COUNT(DISTINCT CASE WHEN extension_expiry_date IS NOT NULL THEN limit_id END) as extended_breaches,
2025-11-11 20:42:07,247 - tools.impl.nl_to_sql_planner - INFO -         MIN(extension_expiry_date) as earliest_extension_expiry,
2025-11-11 20:42:07,248 - tools.impl.nl_to_sql_planner - INFO -         MAX(extension_expiry_date) as latest_e
2025-11-11 20:42:07,248 - tools.impl.nl_to_sql_planner - INFO -     ... (8674 more characters)
2025-11-11 20:42:07,248 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:42:10,641 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:42:12,869 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:42:14,231 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:42:14,232 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 20:42:14,232 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:42:14,232 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 9274
2025-11-11 20:42:14,232 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 20:42:14,232 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 4 SQL code blocks, using LAST (most recent)
2025-11-11 20:42:14,232 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 20:42:14,232 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT column_name 
FROM information_schema.columns 
WHERE table_name = 'limits_data' 
ORDER BY ordinal_position...
2025-11-11 20:42:14,232 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 112 characters
2025-11-11 20:42:14,232 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 20:42:14,232 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 20:42:14,232 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 112 characters
2025-11-11 20:42:14,232 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT column_name 
FROM information_schema.columns 
WHERE table_name = 'limits_data' 
ORDER BY ordinal_position
2025-11-11 20:42:14,232 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT column_name 
FROM information_schema.columns 
WHERE table_name = 'limits_data' 
ORDER BY ordinal_position
2025-11-11 20:42:14,232 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:42:14,233 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 20:42:14,233 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: what are the possible unique values of extension column in limits table
2025-11-11 20:42:14,233 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10523 chars
2025-11-11 20:42:14,233 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 31894 chars
2025-11-11 20:42:14,233 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 20:42:14,233 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 20:42:16,860 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:42:18,601 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 340 chars
2025-11-11 20:42:18,601 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT DISTINCT extension FROM limits_data ORDER BY extension",
    "explanation": "Retrieving unique values of the 'extension' column. Used DISTINCT to eliminate duplicates and ORDER BY to present values systematically. No additional filters applied since query is specific about column.",
    "target_table": "limits_data"
}
2025-11-11 20:42:18,601 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 20:42:18,602 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 20:42:18,602 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT DISTINCT extension FROM limits_data ORDER BY extension...
2025-11-11 20:42:18,602 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT DISTINCT extension FROM limits_data ORDER BY extension
2025-11-11 20:42:18,603 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 20:42:18,603 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 20:42:18,603 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 20:42:18,610 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:42:18,611 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 20:42:18,611 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 20:42:18,611 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 20:42:18,616 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:42:18,616 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT DISTINCT extension FROM limits_data ORDER BY extension...
2025-11-11 20:42:18,617 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 61 chars
2025-11-11 20:42:18,617 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT DISTINCT extension FROM limits_data ORDER BY extension
2025-11-11 20:42:18,617 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT DISTINCT extension FROM limits_data ORDER BY extension...
2025-11-11 20:42:18,617 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT DISTINCT extension FROM limits_data ORDER BY extension...
2025-11-11 20:42:18,617 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 20:42:18,617 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT DISTINCT extension FROM limits_data ORDER BY extension...
2025-11-11 20:42:18,681 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 20:42:18,681 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 20:42:18,681 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 20:42:18,683 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:42:18,683 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=2, columns=1, rows=2, sql=SELECT DISTINCT extension FROM limits_data ORDER BY extension
2025-11-11 20:42:18,683 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 20:42:18,684 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 20:42:18,684 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT DISTINCT extension FROM limits_data ORDER BY extension
2025-11-11 20:42:18,684 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=2, columns=1, rows=2, query_length=61
2025-11-11 20:42:18,684 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 20:42:18,684 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 20:42:18,684 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 553 chars
2025-11-11 20:42:19,222 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:42:24,803 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1169 chars
2025-11-11 20:42:24,805 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 20:42:24,805 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 20:42:24,808 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 42418 chars
2025-11-11 20:42:32,635 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:42:32,638 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1091 chars
2025-11-11 20:42:32,638 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=2, columns=1, rows=2, query=SELECT DISTINCT extension FROM limits_data ORDER BY extension
2025-11-11 20:42:32,638 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=2, columns=1, rows=2, has_query=True
2025-11-11 20:42:32,638 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT DISTINCT extension FROM limits_data ORDER BY extension...
2025-11-11 20:42:32,638 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT DISTINCT extension FROM limits_data ORDER BY extension...
2025-11-11 20:42:32,639 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 20:42:32,639 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 20:42:32,639 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 20:42:32,647 - agent.state_manager - INFO - Saved session state for sess-3i93prgr (user: admin)
2025-11-11 20:42:32,647 - agent.streaming_agent - INFO - Agent completed for session sess-3i93prgr: 32419.689ms, 8 steps
2025-11-11 20:42:32,647 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=2, columns=1, rows=2
2025-11-11 20:43:16,139 - root - INFO - Client YSJj6sJKiJxmKtNSAAAG joined session room: sess-8fknlmfn
2025-11-11 20:44:18,838 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'run sql to find the possible unique values of the column extension'
2025-11-11 20:44:18,838 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-8fknlmfn
2025-11-11 20:44:18,838 - agent.state_manager - WARNING - Session sess-8fknlmfn not found
2025-11-11 20:44:18,838 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 20:44:18,840 - agent.state_manager - INFO - Saved session state for sess-8fknlmfn (user: admin)
2025-11-11 20:44:18,840 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 20:44:18,840 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 20:44:18,841 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 20:44:18,841 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 20:44:18,841 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 20:44:18,841 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 20:44:18,841 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 20:44:18,843 - agent.state_manager - INFO - Saved session state for sess-8fknlmfn (user: admin)
2025-11-11 20:44:22,463 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:44:22,467 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 20:44:22,467 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 20:44:22,468 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 20:44:22,471 - agent.state_manager - INFO - Saved session state for sess-8fknlmfn (user: admin)
2025-11-11 20:44:22,471 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 20:44:22,472 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:44:22,472 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 20:44:22,472 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:44:22,472 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 20:44:22,472 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 20:44:22,472 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 20:44:22,472 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 20:44:22,472 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 20:44:22,472 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 20:44:22,472 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 20:44:22,472 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 20:44:22,472 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 20:44:22,472 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 20:44:22,473 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 20:44:22,473 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:44:25,067 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:44:26,910 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:44:28,829 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 20:44:28,829 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: run sql to find the possible unique values of the column extension
2025-11-11 20:44:28,829 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-11 20:44:28,829 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 22648 chars
2025-11-11 20:44:28,829 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 20:44:28,830 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 20:44:31,007 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:44:32,920 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 324 chars
2025-11-11 20:44:32,921 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT DISTINCT extension FROM limits_data ORDER BY extension",
  "explanation": "Query to find unique values of the 'extension' column. Used DISTINCT to get unique values and ordered the results for clarity. No additional filters applied since query is specific about column.",
  "target_table": "limits_data"
}
2025-11-11 20:44:32,921 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 20:44:32,921 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 20:44:32,922 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT DISTINCT extension FROM limits_data ORDER BY extension...
2025-11-11 20:44:32,922 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT DISTINCT extension FROM limits_data ORDER BY extension
2025-11-11 20:44:32,922 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 20:44:32,923 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 20:44:32,923 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 20:44:32,927 - agent.state_manager - INFO - Saved session state for sess-8fknlmfn (user: admin)
2025-11-11 20:44:32,927 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 20:44:32,927 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 20:44:32,928 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 20:44:32,931 - agent.state_manager - INFO - Saved session state for sess-8fknlmfn (user: admin)
2025-11-11 20:44:32,931 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT DISTINCT extension FROM limits_data ORDER BY extension...
2025-11-11 20:44:32,931 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 61 chars
2025-11-11 20:44:32,931 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT DISTINCT extension FROM limits_data ORDER BY extension
2025-11-11 20:44:32,932 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT DISTINCT extension FROM limits_data ORDER BY extension...
2025-11-11 20:44:32,932 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT DISTINCT extension FROM limits_data ORDER BY extension...
2025-11-11 20:44:32,932 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 20:44:32,932 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT DISTINCT extension FROM limits_data ORDER BY extension...
2025-11-11 20:44:32,996 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 20:44:32,996 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 20:44:32,996 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 20:44:32,997 - agent.state_manager - INFO - Saved session state for sess-8fknlmfn (user: admin)
2025-11-11 20:44:32,997 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=2, columns=1, rows=2, sql=SELECT DISTINCT extension FROM limits_data ORDER BY extension
2025-11-11 20:44:32,997 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 20:44:32,997 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 20:44:32,997 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT DISTINCT extension FROM limits_data ORDER BY extension
2025-11-11 20:44:32,997 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=2, columns=1, rows=2, query_length=61
2025-11-11 20:44:32,998 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 20:44:32,998 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 20:44:32,998 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 548 chars
2025-11-11 20:44:33,514 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:44:39,212 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1188 chars
2025-11-11 20:44:39,212 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 20:44:39,212 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 20:44:39,215 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 37443 chars
2025-11-11 20:44:46,777 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:44:46,780 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 928 chars
2025-11-11 20:44:46,780 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=2, columns=1, rows=2, query=SELECT DISTINCT extension FROM limits_data ORDER BY extension
2025-11-11 20:44:46,780 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=2, columns=1, rows=2, has_query=True
2025-11-11 20:44:46,781 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT DISTINCT extension FROM limits_data ORDER BY extension...
2025-11-11 20:44:46,781 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT DISTINCT extension FROM limits_data ORDER BY extension...
2025-11-11 20:44:46,781 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 20:44:46,782 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 20:44:46,782 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 20:44:46,786 - agent.state_manager - INFO - Saved session state for sess-8fknlmfn (user: admin)
2025-11-11 20:44:46,786 - agent.streaming_agent - INFO - Agent completed for session sess-8fknlmfn: 27945.767ms, 7 steps
2025-11-11 20:44:46,787 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=2, columns=1, rows=2
2025-11-11 20:45:00,317 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'run suggested queries'
2025-11-11 20:45:00,318 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-8fknlmfn
2025-11-11 20:45:00,319 - agent.state_manager - INFO - Loaded session state for sess-8fknlmfn
2025-11-11 20:45:00,319 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 1 turns
2025-11-11 20:45:00,319 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 1 conversation turns
2025-11-11 20:45:00,325 - agent.state_manager - INFO - Saved session state for sess-8fknlmfn (user: admin)
2025-11-11 20:45:00,326 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 20:45:00,326 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 20:45:00,326 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 20:45:00,326 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=1, conv_history(str)=2452
2025-11-11 20:45:00,327 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 20:45:00,327 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 20:45:00,327 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 20:45:00,330 - agent.state_manager - INFO - Saved session state for sess-8fknlmfn (user: admin)
2025-11-11 20:45:00,330 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 20:45:02,801 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:45:02,804 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query already returned the complete set of unique extension values (0 and 1). Since the follow-up query is about the existing extension values, no additional database query is required. The previous result set contains all the necessary information to understand the extension column's possible values.
2025-11-11 20:45:02,805 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 20:45:02,805 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 20:45:02,806 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 20:45:02,810 - agent.state_manager - INFO - Saved session state for sess-8fknlmfn (user: admin)
2025-11-11 20:45:06,643 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:45:06,646 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 20:45:06,646 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 20:45:06,647 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 20:45:06,652 - agent.state_manager - INFO - Saved session state for sess-8fknlmfn (user: admin)
2025-11-11 20:45:06,653 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 20:45:06,653 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:45:06,654 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 20:45:06,654 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:45:06,654 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 20:45:06,654 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 20:45:06,654 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 20:45:06,654 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 20:45:06,654 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 20:45:06,654 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 20:45:06,654 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 2452 characters
2025-11-11 20:45:06,654 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 20:45:06,654 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 20:45:06,654 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 20:45:06,654 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 20:45:06,654 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 20:45:06,654 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 20:45:06,655 - tools.impl.nl_to_sql_planner - INFO -     User Query: run sql to find the possible unique values of the column extension
2025-11-11 20:45:06,655 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 20:45:06,655 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 20:45:06,655 - tools.impl.nl_to_sql_planner - INFO -     SELECT DISTINCT extension FROM limits_data ORDER BY extension
2025-11-11 20:45:06,655 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 20:45:06,655 - tools.impl.nl_to_sql_planner - INFO -     Result Table (2 rows):
2025-11-11 20:45:06,655 - tools.impl.nl_to_sql_planner - INFO -     Columns: extension
2025-11-11 20:45:06,655 - tools.impl.nl_to_sql_planner - INFO -     Data:
2025-11-11 20:45:06,655 - tools.impl.nl_to_sql_planner - INFO -       Row 1: extension: 0
2025-11-11 20:45:06,655 - tools.impl.nl_to_sql_planner - INFO -       Row 2: extension: 1
2025-11-11 20:45:06,655 - tools.impl.nl_to_sql_planner - INFO -     Agent Response: ```sql
2025-11-11 20:45:06,655 - tools.impl.nl_to_sql_planner - INFO -     SELECT DISTINCT extension FROM limits_data ORDER BY extension
2025-11-11 20:45:06,655 - tools.impl.nl_to_sql_planner - INFO -     ... (1852 more characters)
2025-11-11 20:45:06,656 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:45:10,021 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:45:11,967 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:45:15,349 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 20:45:15,350 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 20:45:15,350 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 20:45:15,350 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 2452
2025-11-11 20:45:15,350 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 20:45:15,351 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 3 SQL code blocks, using LAST (most recent)
2025-11-11 20:45:15,351 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 20:45:15,351 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): -- Suggested follow-up queries
SELECT extension, COUNT(*) as count FROM limits_data GROUP BY extension
SELECT region, extension, COUNT(*) as count FROM limits_data GROUP BY region, extension...
2025-11-11 20:45:15,351 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 190 characters
2025-11-11 20:45:15,351 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 20:45:15,351 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 20:45:15,352 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 190 characters
2025-11-11 20:45:15,352 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): -- Suggested follow-up queries
SELECT extension, COUNT(*) as count FROM limits_data GROUP BY extension
SELECT region, extension, COUNT(*) as count FROM limits_data GROUP BY region, extension
2025-11-11 20:45:15,352 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): -- Suggested follow-up queries
SELECT extension, COUNT(*) as count FROM limits_data GROUP BY extension
SELECT region, extension, COUNT(*) as count FROM limits_data GROUP BY region, extension
2025-11-11 20:45:15,352 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 20:45:15,354 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 20:45:15,354 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: run suggested queries
2025-11-11 20:45:15,354 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10679 chars
2025-11-11 20:45:15,354 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 25022 chars
2025-11-11 20:45:15,354 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 20:45:15,354 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 20:45:17,497 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:45:18,963 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 309 chars
2025-11-11 20:45:18,964 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT extension, COUNT(*) as count FROM limits_data GROUP BY extension",
    "explanation": "Counting the number of limits for each extension status (0 and 1). This follows the suggested follow-up query from the previous analysis of the 'extension' column.",
    "target_table": "limits_data"
}
2025-11-11 20:45:18,964 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 20:45:18,964 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 20:45:18,965 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT extension, COUNT(*) as count FROM limits_data GROUP BY extension...
2025-11-11 20:45:18,965 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT extension, COUNT(*) as count FROM limits_data GROUP BY extension
2025-11-11 20:45:18,966 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 20:45:18,966 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 20:45:18,966 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 20:45:18,970 - agent.state_manager - INFO - Saved session state for sess-8fknlmfn (user: admin)
2025-11-11 20:45:18,971 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 20:45:18,971 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 20:45:18,971 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 20:45:18,975 - agent.state_manager - INFO - Saved session state for sess-8fknlmfn (user: admin)
2025-11-11 20:45:18,975 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT extension, COUNT(*) as count FROM limits_data GROUP BY extension...
2025-11-11 20:45:18,975 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 71 chars
2025-11-11 20:45:18,976 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT extension, COUNT(*) as count FROM limits_data GROUP BY extension
2025-11-11 20:45:18,976 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT extension, COUNT(*) as count FROM limits_data GROUP BY extension...
2025-11-11 20:45:18,976 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT extension, COUNT(*) as count FROM limits_data GROUP BY extension...
2025-11-11 20:45:18,976 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 20:45:18,976 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT extension, COUNT(*) as count FROM limits_data GROUP BY extension...
2025-11-11 20:45:19,040 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 20:45:19,040 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 20:45:19,040 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 20:45:19,042 - agent.state_manager - INFO - Saved session state for sess-8fknlmfn (user: admin)
2025-11-11 20:45:19,042 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=2, columns=2, rows=2, sql=SELECT extension, COUNT(*) as count FROM limits_data GROUP BY extension
2025-11-11 20:45:19,042 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 20:45:19,042 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 20:45:19,042 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT extension, COUNT(*) as count FROM limits_data GROUP BY extension
2025-11-11 20:45:19,042 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=2, columns=2, rows=2, query_length=71
2025-11-11 20:45:19,042 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 20:45:19,042 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 20:45:19,043 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 566 chars
2025-11-11 20:45:19,668 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:45:25,430 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1230 chars
2025-11-11 20:45:25,431 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 20:45:25,431 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 20:45:25,434 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 38887 chars
2025-11-11 20:45:33,370 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 20:45:33,372 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 943 chars
2025-11-11 20:45:33,373 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=2, columns=2, rows=2, query=SELECT extension, COUNT(*) as count FROM limits_data GROUP BY extension
2025-11-11 20:45:33,373 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=2, columns=2, rows=2, has_query=True
2025-11-11 20:45:33,373 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT extension, COUNT(*) as count FROM limits_data GROUP BY extension...
2025-11-11 20:45:33,373 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT extension, COUNT(*) as count FROM limits_data GROUP BY extension...
2025-11-11 20:45:33,374 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 20:45:33,374 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 20:45:33,374 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 20:45:33,380 - agent.state_manager - INFO - Saved session state for sess-8fknlmfn (user: admin)
2025-11-11 20:45:33,380 - agent.streaming_agent - INFO - Agent completed for session sess-8fknlmfn: 33054.079ms, 8 steps
2025-11-11 20:45:33,380 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=2, columns=2, rows=2
2025-11-11 21:00:26,330 - root - INFO - Client YSJj6sJKiJxmKtNSAAAG joined session room: sess-g3eut2m9
2025-11-11 21:08:38,087 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-11 21:08:38,104 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-11 21:08:38,104 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-11 21:08:38,105 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-11 21:08:38,105 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-11 21:08:38,212 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:08:38,212 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:08:38,212 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:08:38,212 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:08:38,212 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-11 21:08:38,213 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-11 21:08:38,213 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-11 21:08:38,213 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-11 21:08:38,213 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-11 21:08:38,214 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-11 21:08:38,214 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-11 21:08:38,214 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-11 21:08:38,214 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-11 21:08:38,215 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-11 21:08:38,215 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-11 21:08:38,215 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-11 21:08:38,215 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-11 21:08:38,216 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-11 21:08:38,216 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-11 21:08:38,656 - DuckDbDescribeTableTool - INFO - Found 1 data files in data/duckdb
2025-11-11 21:08:38,706 - DuckDbDescribeTableTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:08:38,714 - DuckDbDescribeTableTool - INFO - Initialization complete: 4 views available
2025-11-11 21:08:38,714 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:08:38,714 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-11 21:08:38,715 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-11 21:08:38,715 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-11 21:08:38,715 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-11 21:08:38,943 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-11 21:08:38,943 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-11 21:08:38,944 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-11 21:08:38,944 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-11 21:08:38,945 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-11 21:08:38,945 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-11 21:08:38,945 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-11 21:08:38,945 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-11 21:08:38,945 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-11 21:08:38,945 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-11 21:08:38,948 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-11 21:08:38,948 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-11 21:08:38,949 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-11 21:08:38,949 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-11 21:08:38,949 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-11 21:08:38,950 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-11 21:08:38,950 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-11 21:08:38,950 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-11 21:08:38,950 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-11 21:08:38,951 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-11 21:08:38,951 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-11 21:08:38,951 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-11 21:08:38,951 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-11 21:08:38,951 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-11 21:08:38,952 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-11 21:08:38,952 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-11 21:08:38,952 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-11 21:08:38,952 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-11 21:08:38,953 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-11 21:08:38,953 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-11 21:08:38,953 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-11 21:08:38,953 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-11 21:08:38,954 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-11 21:08:38,955 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-11 21:08:38,955 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-11 21:08:38,955 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-11 21:08:38,955 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-11 21:08:38,955 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-11 21:08:38,958 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-11 21:08:38,958 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-11 21:08:38,958 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-11 21:08:38,958 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-11 21:08:38,958 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-11 21:08:38,958 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-11 21:08:38,959 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-11 21:08:38,959 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-11 21:08:38,965 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:08:38,965 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:08:38,965 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:08:38,965 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:08:38,965 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-11 21:08:38,965 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-11 21:08:38,965 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-11 21:08:38,965 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-11 21:08:38,965 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-11 21:08:38,965 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-11 21:08:38,965 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-11 21:08:38,966 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-11 21:08:38,966 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-11 21:08:38,966 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-11 21:08:38,966 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-11 21:08:38,967 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-11 21:08:38,967 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-11 21:08:38,967 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-11 21:08:38,967 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-11 21:08:38,967 - DuckDbListFilesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 21:08:39,004 - DuckDbListFilesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:08:39,006 - DuckDbListFilesTool - INFO - Initialization complete: 4 views available
2025-11-11 21:08:39,006 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:08:39,006 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-11 21:08:39,006 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-11 21:08:39,006 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-11 21:08:39,006 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-11 21:08:39,007 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-11 21:08:39,007 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-11 21:08:39,007 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-11 21:08:39,007 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-11 21:08:39,007 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-11 21:08:39,007 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-11 21:08:39,008 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-11 21:08:39,008 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-11 21:08:39,008 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-11 21:08:39,008 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-11 21:08:39,008 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-11 21:08:39,008 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-11 21:08:39,009 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-11 21:08:39,009 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-11 21:08:39,009 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-11 21:08:39,009 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-11 21:08:39,009 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-11 21:08:39,009 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-11 21:08:39,009 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-11 21:08:39,009 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-11 21:08:39,010 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-11 21:08:39,010 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-11 21:08:39,010 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-11 21:08:39,010 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-11 21:08:39,010 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-11 21:08:39,010 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-11 21:08:39,011 - DuckDbGetStatsTool - INFO - Found 1 data files in data/duckdb
2025-11-11 21:08:39,049 - DuckDbGetStatsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:08:39,051 - DuckDbGetStatsTool - INFO - Initialization complete: 4 views available
2025-11-11 21:08:39,051 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:08:39,051 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-11 21:08:39,051 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-11 21:08:39,051 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-11 21:08:39,051 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-11 21:08:39,051 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-11 21:08:39,051 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-11 21:08:39,052 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-11 21:08:39,052 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-11 21:08:39,052 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-11 21:08:39,052 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-11 21:08:39,058 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:08:39,058 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:08:39,058 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:08:39,058 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:08:39,058 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-11 21:08:39,058 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-11 21:08:39,058 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-11 21:08:39,058 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-11 21:08:39,058 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-11 21:08:39,058 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-11 21:08:39,058 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-11 21:08:39,065 - tools.tools_registry - ERROR - Error loading custom tool parquet_agent: invalid syntax (graph_nodes.py, line 732)
2025-11-11 21:08:39,065 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-11 21:08:39,065 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-11 21:08:39,065 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-11 21:08:39,065 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-11 21:08:39,066 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-11 21:08:39,066 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-11 21:08:39,066 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-11 21:08:39,066 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-11 21:08:39,066 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-11 21:08:39,066 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-11 21:08:39,066 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-11 21:08:39,066 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-11 21:08:39,066 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-11 21:08:39,066 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-11 21:08:39,066 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-11 21:08:39,066 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-11 21:08:39,067 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-11 21:08:39,067 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-11 21:08:39,067 - DuckDbListTablesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 21:08:39,104 - DuckDbListTablesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:08:39,105 - DuckDbListTablesTool - INFO - Initialization complete: 4 views available
2025-11-11 21:08:39,105 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:08:39,105 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-11 21:08:39,105 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-11 21:08:39,106 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-11 21:08:39,106 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-11 21:08:39,106 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-11 21:08:39,106 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-11 21:08:39,106 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-11 21:08:39,106 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-11 21:08:39,107 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-11 21:08:39,107 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-11 21:08:39,107 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-11 21:08:39,107 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-11 21:08:39,108 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-11 21:08:39,108 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-11 21:08:39,108 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-11 21:08:39,108 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-11 21:08:39,108 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-11 21:08:39,108 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-11 21:08:39,108 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-11 21:08:39,108 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-11 21:08:39,109 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-11 21:08:39,109 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-11 21:08:39,109 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-11 21:08:39,109 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-11 21:08:39,109 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-11 21:08:39,109 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-11 21:08:39,110 - DuckDbAggregateTool - INFO - Found 1 data files in data/duckdb
2025-11-11 21:08:39,146 - DuckDbAggregateTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:08:39,147 - DuckDbAggregateTool - INFO - Initialization complete: 4 views available
2025-11-11 21:08:39,147 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:08:39,147 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-11 21:08:39,147 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-11 21:08:39,148 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-11 21:08:39,148 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-11 21:08:39,148 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-11 21:08:39,148 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-11 21:08:39,148 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-11 21:08:39,148 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-11 21:08:39,148 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-11 21:08:39,148 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-11 21:08:39,149 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-11 21:08:39,149 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-11 21:08:39,149 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-11 21:08:39,149 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-11 21:08:39,155 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:08:39,155 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:08:39,155 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:08:39,155 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:08:39,155 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-11 21:08:39,155 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-11 21:08:39,155 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-11 21:08:39,156 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-11 21:08:39,156 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-11 21:08:39,156 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-11 21:08:39,156 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-11 21:08:39,156 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-11 21:08:39,156 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-11 21:08:39,156 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-11 21:08:39,156 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-11 21:08:39,157 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-11 21:08:39,157 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-11 21:08:39,157 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-11 21:08:39,157 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-11 21:08:39,157 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-11 21:08:39,157 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-11 21:08:39,157 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-11 21:08:39,157 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-11 21:08:39,157 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-11 21:08:39,157 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-11 21:08:39,157 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-11 21:08:39,157 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-11 21:08:39,157 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-11 21:08:39,157 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-11 21:08:39,158 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-11 21:08:39,158 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-11 21:08:39,158 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-11 21:08:39,158 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-11 21:08:39,159 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-11 21:08:39,159 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-11 21:08:39,159 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-11 21:08:39,159 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-11 21:08:39,159 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-11 21:08:39,159 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-11 21:08:39,159 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-11 21:08:39,159 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-11 21:08:39,159 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-11 21:08:39,159 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-11 21:08:39,160 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-11 21:08:39,160 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-11 21:08:39,160 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-11 21:08:39,160 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-11 21:08:39,160 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-11 21:08:39,160 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-11 21:08:39,160 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-11 21:08:39,160 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-11 21:08:39,160 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-11 21:08:39,160 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-11 21:08:39,160 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-11 21:08:39,160 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-11 21:08:39,161 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-11 21:08:39,161 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-11 21:08:39,161 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-11 21:08:39,161 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-11 21:08:39,161 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-11 21:08:39,161 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-11 21:08:39,162 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-11 21:08:39,162 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-11 21:08:39,163 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-11 21:08:39,163 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-11 21:08:39,163 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-11 21:08:39,163 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-11 21:08:39,163 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-11 21:08:39,163 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-11 21:08:39,163 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-11 21:08:39,163 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-11 21:08:39,163 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-11 21:08:39,163 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-11 21:08:39,163 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-11 21:08:39,163 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-11 21:08:39,170 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:08:39,170 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:08:39,170 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:08:39,170 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:08:39,170 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-11 21:08:39,170 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-11 21:08:39,170 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-11 21:08:39,170 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-11 21:08:39,170 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-11 21:08:39,170 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-11 21:08:39,170 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-11 21:08:39,171 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-11 21:08:39,171 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-11 21:08:39,171 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-11 21:08:39,171 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-11 21:08:39,171 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-11 21:08:39,171 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-11 21:08:39,171 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-11 21:08:39,171 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-11 21:08:39,171 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-11 21:08:39,171 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-11 21:08:39,171 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-11 21:08:39,172 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-11 21:08:39,172 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-11 21:08:39,172 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-11 21:08:39,172 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-11 21:08:39,172 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-11 21:08:39,172 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-11 21:08:39,172 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-11 21:08:39,172 - DuckDbQueryTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 21:08:39,210 - DuckDbQueryTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:08:39,211 - DuckDbQueryTool - INFO - Initialization complete: 4 views available
2025-11-11 21:08:39,212 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:08:39,212 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-11 21:08:39,212 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-11 21:08:39,212 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-11 21:08:39,212 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-11 21:08:39,212 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-11 21:08:39,212 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-11 21:08:39,212 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-11 21:08:39,212 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-11 21:08:39,213 - DuckDbRefreshViewsTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 21:08:39,248 - DuckDbRefreshViewsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:08:39,250 - DuckDbRefreshViewsTool - INFO - Initialization complete: 4 views available
2025-11-11 21:08:39,250 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:08:39,250 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-11 21:08:39,250 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-11 21:08:39,250 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-11 21:08:39,250 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-11 21:08:39,250 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-11 21:08:39,250 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-11 21:08:39,256 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:08:39,256 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:08:39,256 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:08:39,256 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:08:39,256 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-11 21:08:39,256 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-11 21:08:39,256 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-11 21:08:39,257 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-11 21:08:39,257 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-11 21:08:39,257 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-11 21:08:39,257 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-11 21:08:39,258 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-11 21:08:39,258 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-11 21:08:39,258 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-11 21:08:39,258 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-11 21:08:39,258 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-11 21:08:39,258 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-11 21:08:39,258 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-11 21:08:39,258 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-11 21:08:39,258 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-11 21:08:39,267 - root - INFO - All routes registered successfully
2025-11-11 21:08:39,275 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.68.51:8000
2025-11-11 21:08:39,275 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-11-11 21:08:40,239 - root - INFO - WebSocket client connected: UAsDpgR_U6xjPSZkAAAB
2025-11-11 21:08:40,242 - root - INFO - WebSocket client disconnected: UAsDpgR_U6xjPSZkAAAB
2025-11-11 21:08:40,256 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:08:40] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:08:40,259 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:08:41,238 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:08:41] "GET /socket.io/?EIO=4&transport=polling&t=Pfrqe4H HTTP/1.1" 200 -
2025-11-11 21:08:41,248 - root - INFO - WebSocket client connected: 1qBBfAJlw1ojyQWRAAAD
2025-11-11 21:08:41,250 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:08:41] "POST /socket.io/?EIO=4&transport=polling&t=Pfrqe4P&sid=JRYxW1evVumx2oZXAAAC HTTP/1.1" 200 -
2025-11-11 21:08:41,250 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:08:41] "GET /socket.io/?EIO=4&transport=polling&t=Pfrqe4Q&sid=JRYxW1evVumx2oZXAAAC HTTP/1.1" 200 -
2025-11-11 21:08:41,257 - root - INFO - WebSocket client disconnected: 1qBBfAJlw1ojyQWRAAAD
2025-11-11 21:08:41,258 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:08:41] "GET /socket.io/?EIO=4&transport=websocket&sid=JRYxW1evVumx2oZXAAAC HTTP/1.1" 200 -
2025-11-11 21:08:52,221 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:08:52] "GET /health HTTP/1.1" 200 -
2025-11-11 21:09:07,587 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:09:07] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 21:09:07,605 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:09:07] "GET /login?next=http://localhost:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 21:09:07,631 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:09:07] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:09:07,631 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:09:07] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:09:07,659 - root - INFO - WebSocket client connected: FqT7gn27lsnWXYhVAAAF
2025-11-11 21:09:07,661 - root - INFO - WebSocket client disconnected: FqT7gn27lsnWXYhVAAAF
2025-11-11 21:09:07,673 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:09:07] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:09:07,674 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:09:12,303 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 21:09:12,303 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 21:09:12,304 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:09:12] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 21:09:12,322 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:09:12] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 21:09:12,342 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:09:12] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:09:12,343 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:09:12] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:09:12,407 - root - INFO - WebSocket client connected: gv8B3saq_V0AKgbmAAAH
2025-11-11 21:09:12,408 - root - INFO - WebSocket client disconnected: gv8B3saq_V0AKgbmAAAH
2025-11-11 21:09:12,420 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:09:12] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:09:12,421 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:09:22,803 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:09:22] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 21:09:22,819 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:09:22] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:09:22,821 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:09:22] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:09:22,833 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:09:22] "GET /socket.io/?EIO=4&transport=polling&t=PfrqoEG HTTP/1.1" 200 -
2025-11-11 21:09:22,836 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:09:22] "GET /api/agent/welcome-message HTTP/1.1" 200 -
2025-11-11 21:09:22,842 - root - INFO - WebSocket client connected: NSf887nsPLW87XjDAAAJ
2025-11-11 21:09:22,842 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:09:22] "POST /socket.io/?EIO=4&transport=polling&t=PfrqoEN&sid=ERqZgPgXe78GiBPHAAAI HTTP/1.1" 200 -
2025-11-11 21:09:22,843 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:09:22] "GET /socket.io/?EIO=4&transport=polling&t=PfrqoEN.0&sid=ERqZgPgXe78GiBPHAAAI HTTP/1.1" 200 -
2025-11-11 21:09:22,854 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:09:22] "POST /socket.io/?EIO=4&transport=polling&t=PfrqoEZ&sid=ERqZgPgXe78GiBPHAAAI HTTP/1.1" 200 -
2025-11-11 21:09:22,854 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:09:22] "GET /socket.io/?EIO=4&transport=polling&t=PfrqoEY&sid=ERqZgPgXe78GiBPHAAAI HTTP/1.1" 200 -
2025-11-11 21:09:22,857 - root - INFO - WebSocket client connected: FZFu3W9VT1bIK90CAAAL
2025-11-11 21:09:22,857 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:09:22] "GET /socket.io/?EIO=4&transport=polling&t=PfrqoEe&sid=ERqZgPgXe78GiBPHAAAI HTTP/1.1" 200 -
2025-11-11 21:09:22,858 - root - INFO - Client NSf887nsPLW87XjDAAAJ joined session room: sess-g3eut2m9
2025-11-11 21:09:22,858 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:09:22] "POST /socket.io/?EIO=4&transport=polling&t=PfrqoEe.0&sid=ERqZgPgXe78GiBPHAAAI HTTP/1.1" 200 -
2025-11-11 21:11:15,150 - root - INFO - WebSocket client disconnected: NSf887nsPLW87XjDAAAJ
2025-11-11 21:11:15,151 - root - INFO - WebSocket client disconnected: FZFu3W9VT1bIK90CAAAL
2025-11-11 21:11:15,152 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:11:15] "GET /socket.io/?EIO=4&transport=websocket&sid=ERqZgPgXe78GiBPHAAAI HTTP/1.1" 200 -
2025-11-11 21:11:15,155 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:11:15] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:11:15,157 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:11:25,267 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:11:25] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 21:11:25,290 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:11:25] "GET /socket.io/?EIO=4&transport=polling&t=PfrrG7e HTTP/1.1" 200 -
2025-11-11 21:11:25,300 - root - INFO - WebSocket client connected: QIwV9lkVMc9kQ7HUAAAO
2025-11-11 21:11:25,300 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:11:25] "POST /socket.io/?EIO=4&transport=polling&t=PfrrG7m&sid=Gk6DUhoKnyTay8JTAAAM HTTP/1.1" 200 -
2025-11-11 21:11:25,301 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:11:25] "GET /socket.io/?EIO=4&transport=polling&t=PfrrG7m.0&sid=Gk6DUhoKnyTay8JTAAAM HTTP/1.1" 200 -
2025-11-11 21:11:25,303 - root - INFO - WebSocket client connected: rbgGj2-T5HM5SPwRAAAP
2025-11-11 21:11:25,305 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:11:25] "POST /socket.io/?EIO=4&transport=polling&t=PfrrG7t.0&sid=Gk6DUhoKnyTay8JTAAAM HTTP/1.1" 200 -
2025-11-11 21:11:25,305 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:11:25] "GET /socket.io/?EIO=4&transport=polling&t=PfrrG7t&sid=Gk6DUhoKnyTay8JTAAAM HTTP/1.1" 200 -
2025-11-11 21:11:25,308 - root - INFO - Client QIwV9lkVMc9kQ7HUAAAO joined session room: sess-g3eut2m9
2025-11-11 21:11:25,308 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:11:25] "POST /socket.io/?EIO=4&transport=polling&t=PfrrG7x&sid=Gk6DUhoKnyTay8JTAAAM HTTP/1.1" 200 -
2025-11-11 21:11:25,308 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:11:25] "GET /socket.io/?EIO=4&transport=polling&t=PfrrG7w&sid=Gk6DUhoKnyTay8JTAAAM HTTP/1.1" 200 -
2025-11-11 21:11:25,311 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:11:25] "GET /socket.io/?EIO=4&transport=polling&t=PfrrG7z&sid=Gk6DUhoKnyTay8JTAAAM HTTP/1.1" 200 -
2025-11-11 21:11:27,659 - root - INFO - WebSocket client disconnected: QIwV9lkVMc9kQ7HUAAAO
2025-11-11 21:11:27,659 - root - INFO - WebSocket client disconnected: rbgGj2-T5HM5SPwRAAAP
2025-11-11 21:11:27,660 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:11:27] "GET /socket.io/?EIO=4&transport=websocket&sid=Gk6DUhoKnyTay8JTAAAM HTTP/1.1" 200 -
2025-11-11 21:11:27,662 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:11:27] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 21:11:27,667 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:11:27] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:11:27,668 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:11:27,682 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:11:27] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:11:27,683 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:11:27] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:11:27,696 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:11:27] "GET /socket.io/?EIO=4&transport=polling&t=PfrrGjE HTTP/1.1" 200 -
2025-11-11 21:11:27,699 - root - INFO - WebSocket client connected: gNC7X1nEdNZ1JZHNAAAS
2025-11-11 21:11:27,699 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:11:27] "POST /socket.io/?EIO=4&transport=polling&t=PfrrGjH&sid=bdkAPvYKyaeNMpC_AAAQ HTTP/1.1" 200 -
2025-11-11 21:11:27,700 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:11:27] "GET /socket.io/?EIO=4&transport=polling&t=PfrrGjH.0&sid=bdkAPvYKyaeNMpC_AAAQ HTTP/1.1" 200 -
2025-11-11 21:11:27,701 - root - INFO - WebSocket client connected: CPk1Vk3wQzOjFsEtAAAT
2025-11-11 21:11:27,704 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:11:27] "POST /socket.io/?EIO=4&transport=polling&t=PfrrGjM&sid=bdkAPvYKyaeNMpC_AAAQ HTTP/1.1" 200 -
2025-11-11 21:11:27,704 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:11:27] "GET /socket.io/?EIO=4&transport=polling&t=PfrrGjL&sid=bdkAPvYKyaeNMpC_AAAQ HTTP/1.1" 200 -
2025-11-11 21:11:27,706 - root - INFO - Client gNC7X1nEdNZ1JZHNAAAS joined session room: sess-g3eut2m9
2025-11-11 21:11:27,706 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:11:27] "POST /socket.io/?EIO=4&transport=polling&t=PfrrGjP&sid=bdkAPvYKyaeNMpC_AAAQ HTTP/1.1" 200 -
2025-11-11 21:11:27,706 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:11:27] "GET /socket.io/?EIO=4&transport=polling&t=PfrrGjO&sid=bdkAPvYKyaeNMpC_AAAQ HTTP/1.1" 200 -
2025-11-11 21:11:27,710 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:11:27] "GET /socket.io/?EIO=4&transport=polling&t=PfrrGjR&sid=bdkAPvYKyaeNMpC_AAAQ HTTP/1.1" 200 -
2025-11-11 21:11:38,730 - root - INFO - Client gNC7X1nEdNZ1JZHNAAAS joined session room: sess-xerfzxi1
2025-11-11 21:12:09,637 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-11 21:12:09,654 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-11 21:12:09,654 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-11 21:12:09,655 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-11 21:12:09,655 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-11 21:12:09,675 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:12:09,676 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:12:09,676 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:12:09,676 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:12:09,676 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-11 21:12:09,676 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-11 21:12:09,676 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-11 21:12:09,677 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-11 21:12:09,677 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-11 21:12:09,677 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-11 21:12:09,677 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-11 21:12:09,678 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-11 21:12:09,678 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-11 21:12:09,678 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-11 21:12:09,678 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-11 21:12:09,679 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-11 21:12:09,679 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-11 21:12:09,680 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-11 21:12:09,680 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-11 21:12:09,992 - DuckDbDescribeTableTool - INFO - Found 1 data files in data/duckdb
2025-11-11 21:12:10,032 - DuckDbDescribeTableTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:12:10,039 - DuckDbDescribeTableTool - INFO - Initialization complete: 4 views available
2025-11-11 21:12:10,039 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:12:10,039 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-11 21:12:10,039 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-11 21:12:10,040 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-11 21:12:10,040 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-11 21:12:10,181 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-11 21:12:10,181 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-11 21:12:10,182 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-11 21:12:10,182 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-11 21:12:10,183 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-11 21:12:10,183 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-11 21:12:10,183 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-11 21:12:10,183 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-11 21:12:10,183 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-11 21:12:10,183 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-11 21:12:10,186 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-11 21:12:10,186 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-11 21:12:10,187 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-11 21:12:10,187 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-11 21:12:10,187 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-11 21:12:10,187 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-11 21:12:10,188 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-11 21:12:10,188 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-11 21:12:10,188 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-11 21:12:10,188 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-11 21:12:10,188 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-11 21:12:10,188 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-11 21:12:10,189 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-11 21:12:10,189 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-11 21:12:10,189 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-11 21:12:10,189 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-11 21:12:10,190 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-11 21:12:10,190 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-11 21:12:10,190 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-11 21:12:10,190 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-11 21:12:10,191 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-11 21:12:10,191 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-11 21:12:10,192 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-11 21:12:10,192 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-11 21:12:10,192 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-11 21:12:10,192 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-11 21:12:10,192 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-11 21:12:10,192 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-11 21:12:10,195 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-11 21:12:10,195 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-11 21:12:10,195 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-11 21:12:10,195 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-11 21:12:10,195 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-11 21:12:10,195 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-11 21:12:10,195 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-11 21:12:10,196 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-11 21:12:10,201 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:12:10,202 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:12:10,202 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:12:10,202 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:12:10,202 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-11 21:12:10,202 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-11 21:12:10,202 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-11 21:12:10,202 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-11 21:12:10,202 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-11 21:12:10,202 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-11 21:12:10,202 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-11 21:12:10,202 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-11 21:12:10,203 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-11 21:12:10,203 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-11 21:12:10,203 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-11 21:12:10,203 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-11 21:12:10,203 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-11 21:12:10,204 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-11 21:12:10,204 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-11 21:12:10,204 - DuckDbListFilesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 21:12:10,240 - DuckDbListFilesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:12:10,242 - DuckDbListFilesTool - INFO - Initialization complete: 4 views available
2025-11-11 21:12:10,242 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:12:10,243 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-11 21:12:10,243 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-11 21:12:10,243 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-11 21:12:10,243 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-11 21:12:10,243 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-11 21:12:10,243 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-11 21:12:10,243 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-11 21:12:10,243 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-11 21:12:10,243 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-11 21:12:10,243 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-11 21:12:10,244 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-11 21:12:10,244 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-11 21:12:10,245 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-11 21:12:10,245 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-11 21:12:10,245 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-11 21:12:10,245 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-11 21:12:10,245 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-11 21:12:10,245 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-11 21:12:10,245 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-11 21:12:10,245 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-11 21:12:10,246 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-11 21:12:10,246 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-11 21:12:10,246 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-11 21:12:10,246 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-11 21:12:10,246 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-11 21:12:10,246 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-11 21:12:10,246 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-11 21:12:10,246 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-11 21:12:10,247 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-11 21:12:10,247 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-11 21:12:10,247 - DuckDbGetStatsTool - INFO - Found 1 data files in data/duckdb
2025-11-11 21:12:10,283 - DuckDbGetStatsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:12:10,284 - DuckDbGetStatsTool - INFO - Initialization complete: 4 views available
2025-11-11 21:12:10,284 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:12:10,284 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-11 21:12:10,284 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-11 21:12:10,285 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-11 21:12:10,285 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-11 21:12:10,285 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-11 21:12:10,285 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-11 21:12:10,285 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-11 21:12:10,285 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-11 21:12:10,285 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-11 21:12:10,285 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-11 21:12:10,291 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:12:10,291 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:12:10,291 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:12:10,291 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:12:10,291 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-11 21:12:10,291 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-11 21:12:10,291 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-11 21:12:10,291 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-11 21:12:10,291 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-11 21:12:10,292 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-11 21:12:10,292 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-11 21:12:10,294 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-11 21:12:10,294 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-11 21:12:10,294 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-11 21:12:10,294 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-11 21:12:10,294 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-11 21:12:10,294 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-11 21:12:10,294 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-11 21:12:10,294 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-11 21:12:10,294 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-11 21:12:10,294 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-11 21:12:10,295 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-11 21:12:10,295 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-11 21:12:10,295 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-11 21:12:10,295 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-11 21:12:10,295 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-11 21:12:10,295 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-11 21:12:10,295 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-11 21:12:10,295 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-11 21:12:10,295 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-11 21:12:10,295 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-11 21:12:10,296 - DuckDbListTablesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 21:12:10,331 - DuckDbListTablesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:12:10,333 - DuckDbListTablesTool - INFO - Initialization complete: 4 views available
2025-11-11 21:12:10,333 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:12:10,333 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-11 21:12:10,333 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-11 21:12:10,334 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-11 21:12:10,334 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-11 21:12:10,334 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-11 21:12:10,334 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-11 21:12:10,334 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-11 21:12:10,334 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-11 21:12:10,334 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-11 21:12:10,334 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-11 21:12:10,335 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-11 21:12:10,335 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-11 21:12:10,335 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-11 21:12:10,335 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-11 21:12:10,336 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-11 21:12:10,336 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-11 21:12:10,336 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-11 21:12:10,336 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-11 21:12:10,336 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-11 21:12:10,336 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-11 21:12:10,336 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-11 21:12:10,336 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-11 21:12:10,336 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-11 21:12:10,336 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-11 21:12:10,337 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-11 21:12:10,337 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-11 21:12:10,337 - DuckDbAggregateTool - INFO - Found 1 data files in data/duckdb
2025-11-11 21:12:10,373 - DuckDbAggregateTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:12:10,374 - DuckDbAggregateTool - INFO - Initialization complete: 4 views available
2025-11-11 21:12:10,374 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:12:10,374 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-11 21:12:10,374 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-11 21:12:10,375 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-11 21:12:10,375 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-11 21:12:10,375 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-11 21:12:10,375 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-11 21:12:10,375 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-11 21:12:10,375 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-11 21:12:10,375 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-11 21:12:10,375 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-11 21:12:10,376 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-11 21:12:10,376 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-11 21:12:10,376 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-11 21:12:10,376 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-11 21:12:10,381 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:12:10,382 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:12:10,382 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:12:10,382 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:12:10,382 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-11 21:12:10,382 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-11 21:12:10,382 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-11 21:12:10,382 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-11 21:12:10,382 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-11 21:12:10,382 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-11 21:12:10,382 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-11 21:12:10,382 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-11 21:12:10,382 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-11 21:12:10,382 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-11 21:12:10,382 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-11 21:12:10,383 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-11 21:12:10,383 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-11 21:12:10,383 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-11 21:12:10,383 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-11 21:12:10,383 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-11 21:12:10,383 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-11 21:12:10,383 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-11 21:12:10,383 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-11 21:12:10,383 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-11 21:12:10,383 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-11 21:12:10,383 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-11 21:12:10,383 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-11 21:12:10,383 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-11 21:12:10,383 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-11 21:12:10,384 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-11 21:12:10,384 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-11 21:12:10,384 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-11 21:12:10,384 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-11 21:12:10,385 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-11 21:12:10,385 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-11 21:12:10,385 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-11 21:12:10,385 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-11 21:12:10,385 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-11 21:12:10,385 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-11 21:12:10,385 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-11 21:12:10,385 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-11 21:12:10,385 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-11 21:12:10,385 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-11 21:12:10,386 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-11 21:12:10,386 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-11 21:12:10,386 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-11 21:12:10,386 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-11 21:12:10,386 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-11 21:12:10,386 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-11 21:12:10,386 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-11 21:12:10,386 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-11 21:12:10,387 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-11 21:12:10,387 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-11 21:12:10,387 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-11 21:12:10,387 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-11 21:12:10,387 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-11 21:12:10,387 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-11 21:12:10,388 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-11 21:12:10,388 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-11 21:12:10,388 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-11 21:12:10,388 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-11 21:12:10,388 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-11 21:12:10,388 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-11 21:12:10,389 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-11 21:12:10,389 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-11 21:12:10,389 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-11 21:12:10,389 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-11 21:12:10,389 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-11 21:12:10,389 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-11 21:12:10,390 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-11 21:12:10,390 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-11 21:12:10,390 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-11 21:12:10,390 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-11 21:12:10,390 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-11 21:12:10,390 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-11 21:12:10,396 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:12:10,396 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:12:10,396 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:12:10,396 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:12:10,396 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-11 21:12:10,396 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-11 21:12:10,396 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-11 21:12:10,396 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-11 21:12:10,396 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-11 21:12:10,396 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-11 21:12:10,396 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-11 21:12:10,396 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-11 21:12:10,396 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-11 21:12:10,396 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-11 21:12:10,396 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-11 21:12:10,397 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-11 21:12:10,397 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-11 21:12:10,397 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-11 21:12:10,397 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-11 21:12:10,397 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-11 21:12:10,397 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-11 21:12:10,397 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-11 21:12:10,397 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-11 21:12:10,397 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-11 21:12:10,397 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-11 21:12:10,397 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-11 21:12:10,397 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-11 21:12:10,398 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-11 21:12:10,398 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-11 21:12:10,398 - DuckDbQueryTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 21:12:10,434 - DuckDbQueryTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:12:10,435 - DuckDbQueryTool - INFO - Initialization complete: 4 views available
2025-11-11 21:12:10,435 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:12:10,435 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-11 21:12:10,435 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-11 21:12:10,436 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-11 21:12:10,436 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-11 21:12:10,436 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-11 21:12:10,436 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-11 21:12:10,436 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-11 21:12:10,436 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-11 21:12:10,436 - DuckDbRefreshViewsTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 21:12:10,472 - DuckDbRefreshViewsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:12:10,473 - DuckDbRefreshViewsTool - INFO - Initialization complete: 4 views available
2025-11-11 21:12:10,473 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:12:10,473 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-11 21:12:10,474 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-11 21:12:10,474 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-11 21:12:10,474 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-11 21:12:10,474 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-11 21:12:10,474 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-11 21:12:10,481 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:12:10,481 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:12:10,481 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:12:10,481 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:12:10,481 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-11 21:12:10,481 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-11 21:12:10,481 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-11 21:12:10,482 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-11 21:12:10,482 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-11 21:12:10,482 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-11 21:12:10,482 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-11 21:12:10,482 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-11 21:12:10,482 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-11 21:12:10,482 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-11 21:12:10,482 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-11 21:12:10,483 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-11 21:12:10,483 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-11 21:12:10,483 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-11 21:12:10,483 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-11 21:12:10,483 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-11 21:12:10,496 - root - INFO - All routes registered successfully
2025-11-11 21:12:10,501 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.68.51:8000
2025-11-11 21:12:10,501 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-11-11 21:12:11,239 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:11] "GET /socket.io/?EIO=4&transport=polling&t=PfrrRLY HTTP/1.1" 200 -
2025-11-11 21:12:11,250 - root - INFO - WebSocket client connected: rVw0ZRTrglv4T6JkAAAB
2025-11-11 21:12:11,251 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:11] "POST /socket.io/?EIO=4&transport=polling&t=PfrrRLg&sid=O1_huy1uFRcTVSW4AAAA HTTP/1.1" 200 -
2025-11-11 21:12:11,251 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:11] "GET /socket.io/?EIO=4&transport=polling&t=PfrrRLh&sid=O1_huy1uFRcTVSW4AAAA HTTP/1.1" 200 -
2025-11-11 21:12:11,257 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:11] "GET /socket.io/?EIO=4&transport=polling&t=PfrrRLt&sid=O1_huy1uFRcTVSW4AAAA HTTP/1.1" 200 -
2025-11-11 21:12:11,260 - root - INFO - WebSocket client disconnected: rVw0ZRTrglv4T6JkAAAB
2025-11-11 21:12:11,260 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:11] "POST /socket.io/?EIO=4&transport=polling&t=PfrrRLt.0&sid=O1_huy1uFRcTVSW4AAAA HTTP/1.1" 200 -
2025-11-11 21:12:11,263 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:11] "GET /socket.io/?EIO=4&transport=websocket&sid=O1_huy1uFRcTVSW4AAAA HTTP/1.1" 200 -
2025-11-11 21:12:12,242 - root - INFO - WebSocket client connected: 2xtnrqcDYSgbFyYYAAAD
2025-11-11 21:12:12,245 - root - INFO - WebSocket client disconnected: 2xtnrqcDYSgbFyYYAAAD
2025-11-11 21:12:12,259 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:12] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:12:12,262 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:12:17,827 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:17] "GET /health HTTP/1.1" 200 -
2025-11-11 21:12:38,574 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:38] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 21:12:38,593 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:38] "GET /login?next=http://localhost:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 21:12:38,620 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:38] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:12:38,620 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:38] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:12:38,645 - root - INFO - WebSocket client connected: 24H0GGHwz4V_MkahAAAF
2025-11-11 21:12:38,646 - root - INFO - WebSocket client disconnected: 24H0GGHwz4V_MkahAAAF
2025-11-11 21:12:38,658 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:38] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:12:38,659 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:12:42,263 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 21:12:42,263 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 21:12:42,264 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:42] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 21:12:42,289 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:42] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 21:12:42,311 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:42] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:12:42,311 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:42] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:12:42,374 - root - INFO - WebSocket client connected: pczfTZq2SFtRoHhsAAAH
2025-11-11 21:12:42,376 - root - INFO - WebSocket client disconnected: pczfTZq2SFtRoHhsAAAH
2025-11-11 21:12:42,388 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:42] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:12:42,389 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:12:47,465 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:47] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 21:12:47,484 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:47] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:12:47,485 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:47] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:12:47,494 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:47] "GET /socket.io/?EIO=4&transport=polling&t=PfrraC4 HTTP/1.1" 200 -
2025-11-11 21:12:47,500 - root - INFO - WebSocket client connected: XuBLKZE9eOkkZg9VAAAK
2025-11-11 21:12:47,500 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:47] "POST /socket.io/?EIO=4&transport=polling&t=PfrraC8&sid=VSrCcWT_iV158BhEAAAI HTTP/1.1" 200 -
2025-11-11 21:12:47,502 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:47] "GET /socket.io/?EIO=4&transport=polling&t=PfrraC8.0&sid=VSrCcWT_iV158BhEAAAI HTTP/1.1" 200 -
2025-11-11 21:12:47,503 - root - INFO - WebSocket client connected: H5NjXbe6wlkQwuh0AAAL
2025-11-11 21:12:47,507 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:47] "POST /socket.io/?EIO=4&transport=polling&t=PfrraCG.0&sid=VSrCcWT_iV158BhEAAAI HTTP/1.1" 200 -
2025-11-11 21:12:47,507 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:47] "GET /socket.io/?EIO=4&transport=polling&t=PfrraCG&sid=VSrCcWT_iV158BhEAAAI HTTP/1.1" 200 -
2025-11-11 21:12:47,509 - root - INFO - Client XuBLKZE9eOkkZg9VAAAK joined session room: sess-xerfzxi1
2025-11-11 21:12:47,509 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:47] "POST /socket.io/?EIO=4&transport=polling&t=PfrraCK.0&sid=VSrCcWT_iV158BhEAAAI HTTP/1.1" 200 -
2025-11-11 21:12:47,510 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:47] "GET /socket.io/?EIO=4&transport=polling&t=PfrraCK&sid=VSrCcWT_iV158BhEAAAI HTTP/1.1" 200 -
2025-11-11 21:12:47,511 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:12:47] "GET /socket.io/?EIO=4&transport=polling&t=PfrraCN&sid=VSrCcWT_iV158BhEAAAI HTTP/1.1" 200 -
2025-11-11 21:12:53,722 - root - INFO - Client XuBLKZE9eOkkZg9VAAAK joined session room: sess-qk3va6vm
2025-11-11 21:14:11,052 - core.auth_manager - WARNING - Login attempt for invalid/disabled user: None
2025-11-11 21:14:11,052 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:14:11] "POST /login HTTP/1.1" 200 -
2025-11-11 21:14:11,059 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:14:11] "[32mGET /api/agent/welcome-message HTTP/1.1[0m" 302 -
2025-11-11 21:15:19,405 - root - INFO - WebSocket client disconnected: XuBLKZE9eOkkZg9VAAAK
2025-11-11 21:15:19,406 - root - INFO - WebSocket client disconnected: H5NjXbe6wlkQwuh0AAAL
2025-11-11 21:15:19,406 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:15:19] "GET /socket.io/?EIO=4&transport=websocket&sid=VSrCcWT_iV158BhEAAAI HTTP/1.1" 200 -
2025-11-11 21:15:19,415 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:15:19] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 21:15:19,418 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:15:19] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:15:19,419 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:15:19,436 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:15:19] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:15:19,437 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:15:19] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:15:19,453 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:15:19] "GET /socket.io/?EIO=4&transport=polling&t=Pfrs9IR HTTP/1.1" 200 -
2025-11-11 21:15:19,457 - root - INFO - WebSocket client connected: gOlN5MuOtGJ6kzWcAAAO
2025-11-11 21:15:19,457 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:15:19] "POST /socket.io/?EIO=4&transport=polling&t=Pfrs9IV&sid=VtfSiDSsGCx9OZeBAAAM HTTP/1.1" 200 -
2025-11-11 21:15:19,458 - root - INFO - WebSocket client connected: 83id6J-CFGbvT37cAAAP
2025-11-11 21:15:19,459 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:15:19] "GET /socket.io/?EIO=4&transport=polling&t=Pfrs9IV.0&sid=VtfSiDSsGCx9OZeBAAAM HTTP/1.1" 200 -
2025-11-11 21:15:19,462 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:15:19] "POST /socket.io/?EIO=4&transport=polling&t=Pfrs9Ia.0&sid=VtfSiDSsGCx9OZeBAAAM HTTP/1.1" 200 -
2025-11-11 21:15:19,462 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:15:19] "GET /socket.io/?EIO=4&transport=polling&t=Pfrs9Ia&sid=VtfSiDSsGCx9OZeBAAAM HTTP/1.1" 200 -
2025-11-11 21:15:19,464 - root - INFO - Client gOlN5MuOtGJ6kzWcAAAO joined session room: sess-qk3va6vm
2025-11-11 21:15:19,464 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:15:19] "POST /socket.io/?EIO=4&transport=polling&t=Pfrs9Id.0&sid=VtfSiDSsGCx9OZeBAAAM HTTP/1.1" 200 -
2025-11-11 21:15:19,465 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:15:19] "GET /socket.io/?EIO=4&transport=polling&t=Pfrs9Id&sid=VtfSiDSsGCx9OZeBAAAM HTTP/1.1" 200 -
2025-11-11 21:15:19,468 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:15:19] "GET /socket.io/?EIO=4&transport=polling&t=Pfrs9If&sid=VtfSiDSsGCx9OZeBAAAM HTTP/1.1" 200 -
2025-11-11 21:15:22,865 - root - INFO - Client gOlN5MuOtGJ6kzWcAAAO joined session room: sess-w3auyqh2
2025-11-11 21:15:37,933 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-11 21:15:37,949 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-11 21:15:37,949 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-11 21:15:37,950 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-11 21:15:37,950 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-11 21:15:37,973 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:15:37,973 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:15:37,973 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:15:37,973 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:15:37,973 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-11 21:15:37,973 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-11 21:15:37,973 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-11 21:15:37,974 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-11 21:15:37,974 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-11 21:15:37,974 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-11 21:15:37,974 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-11 21:15:37,975 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-11 21:15:37,975 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-11 21:15:37,975 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-11 21:15:37,975 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-11 21:15:37,976 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-11 21:15:37,976 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-11 21:15:37,977 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-11 21:15:37,977 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-11 21:15:38,264 - DuckDbDescribeTableTool - INFO - Found 1 data files in data/duckdb
2025-11-11 21:15:38,305 - DuckDbDescribeTableTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:15:38,313 - DuckDbDescribeTableTool - INFO - Initialization complete: 4 views available
2025-11-11 21:15:38,313 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:15:38,313 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-11 21:15:38,313 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-11 21:15:38,314 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-11 21:15:38,314 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-11 21:15:38,519 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-11 21:15:38,519 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-11 21:15:38,520 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-11 21:15:38,520 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-11 21:15:38,521 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-11 21:15:38,521 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-11 21:15:38,521 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-11 21:15:38,521 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-11 21:15:38,521 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-11 21:15:38,521 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-11 21:15:38,525 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-11 21:15:38,525 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-11 21:15:38,525 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-11 21:15:38,525 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-11 21:15:38,526 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-11 21:15:38,526 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-11 21:15:38,526 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-11 21:15:38,526 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-11 21:15:38,527 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-11 21:15:38,527 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-11 21:15:38,527 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-11 21:15:38,527 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-11 21:15:38,528 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-11 21:15:38,528 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-11 21:15:38,528 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-11 21:15:38,528 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-11 21:15:38,529 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-11 21:15:38,529 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-11 21:15:38,529 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-11 21:15:38,529 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-11 21:15:38,530 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-11 21:15:38,530 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-11 21:15:38,530 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-11 21:15:38,530 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-11 21:15:38,531 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-11 21:15:38,531 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-11 21:15:38,531 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-11 21:15:38,531 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-11 21:15:38,534 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-11 21:15:38,534 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-11 21:15:38,534 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-11 21:15:38,534 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-11 21:15:38,534 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-11 21:15:38,534 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-11 21:15:38,535 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-11 21:15:38,535 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-11 21:15:38,541 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:15:38,541 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:15:38,541 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:15:38,541 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:15:38,541 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-11 21:15:38,541 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-11 21:15:38,541 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-11 21:15:38,541 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-11 21:15:38,541 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-11 21:15:38,541 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-11 21:15:38,541 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-11 21:15:38,542 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-11 21:15:38,542 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-11 21:15:38,542 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-11 21:15:38,542 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-11 21:15:38,542 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-11 21:15:38,542 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-11 21:15:38,543 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-11 21:15:38,543 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-11 21:15:38,543 - DuckDbListFilesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 21:15:38,580 - DuckDbListFilesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:15:38,582 - DuckDbListFilesTool - INFO - Initialization complete: 4 views available
2025-11-11 21:15:38,582 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:15:38,582 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-11 21:15:38,582 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-11 21:15:38,582 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-11 21:15:38,582 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-11 21:15:38,582 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-11 21:15:38,582 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-11 21:15:38,583 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-11 21:15:38,583 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-11 21:15:38,583 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-11 21:15:38,583 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-11 21:15:38,584 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-11 21:15:38,584 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-11 21:15:38,584 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-11 21:15:38,584 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-11 21:15:38,584 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-11 21:15:38,584 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-11 21:15:38,584 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-11 21:15:38,584 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-11 21:15:38,585 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-11 21:15:38,585 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-11 21:15:38,585 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-11 21:15:38,585 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-11 21:15:38,585 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-11 21:15:38,585 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-11 21:15:38,586 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-11 21:15:38,586 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-11 21:15:38,586 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-11 21:15:38,586 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-11 21:15:38,586 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-11 21:15:38,586 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-11 21:15:38,586 - DuckDbGetStatsTool - INFO - Found 1 data files in data/duckdb
2025-11-11 21:15:38,627 - DuckDbGetStatsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:15:38,629 - DuckDbGetStatsTool - INFO - Initialization complete: 4 views available
2025-11-11 21:15:38,629 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:15:38,629 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-11 21:15:38,629 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-11 21:15:38,630 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-11 21:15:38,630 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-11 21:15:38,630 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-11 21:15:38,630 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-11 21:15:38,630 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-11 21:15:38,630 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-11 21:15:38,630 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-11 21:15:38,630 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-11 21:15:38,637 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:15:38,637 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:15:38,637 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:15:38,637 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:15:38,637 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-11 21:15:38,637 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-11 21:15:38,637 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-11 21:15:38,638 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-11 21:15:38,638 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-11 21:15:38,638 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-11 21:15:38,638 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-11 21:15:38,648 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-11 21:15:38,648 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-11 21:15:38,648 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-11 21:15:38,648 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-11 21:15:38,649 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-11 21:15:38,649 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-11 21:15:38,649 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-11 21:15:38,649 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-11 21:15:38,649 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-11 21:15:38,649 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-11 21:15:38,649 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-11 21:15:38,649 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-11 21:15:38,649 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-11 21:15:38,649 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-11 21:15:38,649 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-11 21:15:38,649 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-11 21:15:38,650 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-11 21:15:38,650 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-11 21:15:38,650 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-11 21:15:38,650 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-11 21:15:38,650 - DuckDbListTablesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 21:15:38,689 - DuckDbListTablesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:15:38,691 - DuckDbListTablesTool - INFO - Initialization complete: 4 views available
2025-11-11 21:15:38,691 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:15:38,691 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-11 21:15:38,691 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-11 21:15:38,691 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-11 21:15:38,691 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-11 21:15:38,691 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-11 21:15:38,692 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-11 21:15:38,692 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-11 21:15:38,692 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-11 21:15:38,692 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-11 21:15:38,692 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-11 21:15:38,693 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-11 21:15:38,693 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-11 21:15:38,693 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-11 21:15:38,693 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-11 21:15:38,694 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-11 21:15:38,694 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-11 21:15:38,694 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-11 21:15:38,694 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-11 21:15:38,694 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-11 21:15:38,694 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-11 21:15:38,694 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-11 21:15:38,694 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-11 21:15:38,695 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-11 21:15:38,695 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-11 21:15:38,695 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-11 21:15:38,695 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-11 21:15:38,696 - DuckDbAggregateTool - INFO - Found 1 data files in data/duckdb
2025-11-11 21:15:38,732 - DuckDbAggregateTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:15:38,733 - DuckDbAggregateTool - INFO - Initialization complete: 4 views available
2025-11-11 21:15:38,734 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:15:38,734 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-11 21:15:38,734 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-11 21:15:38,734 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-11 21:15:38,734 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-11 21:15:38,734 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-11 21:15:38,734 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-11 21:15:38,734 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-11 21:15:38,734 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-11 21:15:38,735 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-11 21:15:38,735 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-11 21:15:38,735 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-11 21:15:38,735 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-11 21:15:38,735 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-11 21:15:38,735 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-11 21:15:38,741 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:15:38,741 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:15:38,741 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:15:38,741 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:15:38,741 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-11 21:15:38,741 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-11 21:15:38,741 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-11 21:15:38,742 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-11 21:15:38,742 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-11 21:15:38,742 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-11 21:15:38,742 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-11 21:15:38,742 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-11 21:15:38,742 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-11 21:15:38,742 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-11 21:15:38,742 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-11 21:15:38,743 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-11 21:15:38,743 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-11 21:15:38,743 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-11 21:15:38,743 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-11 21:15:38,743 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-11 21:15:38,743 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-11 21:15:38,743 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-11 21:15:38,743 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-11 21:15:38,743 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-11 21:15:38,743 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-11 21:15:38,743 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-11 21:15:38,743 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-11 21:15:38,743 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-11 21:15:38,743 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-11 21:15:38,744 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-11 21:15:38,744 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-11 21:15:38,744 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-11 21:15:38,744 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-11 21:15:38,745 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-11 21:15:38,745 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-11 21:15:38,745 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-11 21:15:38,745 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-11 21:15:38,745 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-11 21:15:38,745 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-11 21:15:38,745 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-11 21:15:38,745 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-11 21:15:38,745 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-11 21:15:38,745 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-11 21:15:38,745 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-11 21:15:38,745 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-11 21:15:38,746 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-11 21:15:38,746 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-11 21:15:38,746 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-11 21:15:38,746 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-11 21:15:38,746 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-11 21:15:38,746 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-11 21:15:38,746 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-11 21:15:38,746 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-11 21:15:38,746 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-11 21:15:38,746 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-11 21:15:38,747 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-11 21:15:38,747 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-11 21:15:38,747 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-11 21:15:38,747 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-11 21:15:38,747 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-11 21:15:38,747 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-11 21:15:38,747 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-11 21:15:38,747 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-11 21:15:38,748 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-11 21:15:38,748 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-11 21:15:38,748 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-11 21:15:38,748 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-11 21:15:38,748 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-11 21:15:38,748 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-11 21:15:38,749 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-11 21:15:38,749 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-11 21:15:38,749 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-11 21:15:38,749 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-11 21:15:38,749 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-11 21:15:38,749 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-11 21:15:38,755 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:15:38,755 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:15:38,755 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:15:38,755 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:15:38,755 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-11 21:15:38,755 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-11 21:15:38,755 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-11 21:15:38,755 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-11 21:15:38,755 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-11 21:15:38,756 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-11 21:15:38,756 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-11 21:15:38,756 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-11 21:15:38,756 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-11 21:15:38,756 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-11 21:15:38,756 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-11 21:15:38,757 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-11 21:15:38,757 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-11 21:15:38,757 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-11 21:15:38,757 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-11 21:15:38,757 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-11 21:15:38,757 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-11 21:15:38,757 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-11 21:15:38,757 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-11 21:15:38,757 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-11 21:15:38,757 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-11 21:15:38,757 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-11 21:15:38,757 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-11 21:15:38,757 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-11 21:15:38,757 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-11 21:15:38,758 - DuckDbQueryTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 21:15:38,795 - DuckDbQueryTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:15:38,796 - DuckDbQueryTool - INFO - Initialization complete: 4 views available
2025-11-11 21:15:38,796 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:15:38,796 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-11 21:15:38,796 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-11 21:15:38,797 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-11 21:15:38,797 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-11 21:15:38,797 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-11 21:15:38,797 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-11 21:15:38,797 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-11 21:15:38,797 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-11 21:15:38,798 - DuckDbRefreshViewsTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 21:15:38,833 - DuckDbRefreshViewsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:15:38,835 - DuckDbRefreshViewsTool - INFO - Initialization complete: 4 views available
2025-11-11 21:15:38,835 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:15:38,835 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-11 21:15:38,835 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-11 21:15:38,835 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-11 21:15:38,835 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-11 21:15:38,836 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-11 21:15:38,836 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-11 21:15:38,842 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:15:38,842 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:15:38,842 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:15:38,842 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:15:38,842 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-11 21:15:38,842 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-11 21:15:38,842 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-11 21:15:38,842 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-11 21:15:38,842 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-11 21:15:38,842 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-11 21:15:38,842 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-11 21:15:38,843 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-11 21:15:38,843 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-11 21:15:38,843 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-11 21:15:38,843 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-11 21:15:38,843 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-11 21:15:38,843 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-11 21:15:38,843 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-11 21:15:38,843 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-11 21:15:38,843 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-11 21:15:38,852 - root - INFO - All routes registered successfully
2025-11-11 21:15:38,855 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.68.51:8000
2025-11-11 21:15:38,855 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-11-11 21:15:39,239 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:15:39] "GET /socket.io/?EIO=4&transport=polling&t=PfrsE7Z HTTP/1.1" 200 -
2025-11-11 21:15:39,241 - root - INFO - WebSocket client connected: p7pybJ3SXxf0VPg7AAAC
2025-11-11 21:15:39,244 - root - INFO - WebSocket client disconnected: p7pybJ3SXxf0VPg7AAAC
2025-11-11 21:15:39,244 - root - INFO - WebSocket client connected: 2R_zEflaTsDdwmpaAAAD
2025-11-11 21:15:39,244 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:15:39] "POST /socket.io/?EIO=4&transport=polling&t=PfrsE7f&sid=yEV_SC3_9OjAVCOfAAAB HTTP/1.1" 200 -
2025-11-11 21:15:39,244 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:15:39] "GET /socket.io/?EIO=4&transport=polling&t=PfrsE7f.0&sid=yEV_SC3_9OjAVCOfAAAB HTTP/1.1" 200 -
2025-11-11 21:15:39,249 - root - INFO - WebSocket client disconnected: 2R_zEflaTsDdwmpaAAAD
2025-11-11 21:15:39,249 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:15:39] "GET /socket.io/?EIO=4&transport=polling&t=PfrsE7k&sid=yEV_SC3_9OjAVCOfAAAB HTTP/1.1" 200 -
2025-11-11 21:15:39,249 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:15:39] "POST /socket.io/?EIO=4&transport=polling&t=PfrsE7l&sid=yEV_SC3_9OjAVCOfAAAB HTTP/1.1" 200 -
2025-11-11 21:15:39,252 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:15:39] "GET /socket.io/?EIO=4&transport=websocket&sid=yEV_SC3_9OjAVCOfAAAB HTTP/1.1" 200 -
2025-11-11 21:15:39,252 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:15:39] "POST /socket.io/?EIO=4&transport=polling&t=PfrsE7p&sid=yEV_SC3_9OjAVCOfAAAB HTTP/1.1" 200 -
2025-11-11 21:15:39,253 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:15:39] "GET /socket.io/?EIO=4&transport=polling&t=PfrsE7o&sid=yEV_SC3_9OjAVCOfAAAB HTTP/1.1" 200 -
2025-11-11 21:15:39,257 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:15:39] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:15:39,258 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:15:45,778 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:15:45] "GET /health HTTP/1.1" 200 -
2025-11-11 21:16:23,409 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:16:23] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 21:16:23,432 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:16:23] "GET /login?next=http://localhost:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 21:16:23,460 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:16:23] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:16:23,460 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:16:23] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:16:23,488 - root - INFO - WebSocket client connected: 9MNjbJdvczDITrxpAAAF
2025-11-11 21:16:23,489 - root - INFO - WebSocket client disconnected: 9MNjbJdvczDITrxpAAAF
2025-11-11 21:16:23,501 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:16:23] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:16:23,502 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:16:27,676 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 21:16:27,676 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 21:16:27,678 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:16:27] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 21:16:27,701 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:16:27] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 21:16:27,724 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:16:27] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:16:27,724 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:16:27] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:16:27,785 - root - INFO - WebSocket client connected: escEeaBi4HXdK0mXAAAH
2025-11-11 21:16:27,788 - root - INFO - WebSocket client disconnected: escEeaBi4HXdK0mXAAAH
2025-11-11 21:16:27,800 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:16:27] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:16:27,801 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:16:32,753 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:16:32] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 21:16:32,771 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:16:32] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:16:32,772 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:16:32] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:16:32,781 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:16:32] "GET /socket.io/?EIO=4&transport=polling&t=PfrsRCB HTTP/1.1" 200 -
2025-11-11 21:16:32,788 - root - INFO - WebSocket client connected: zsj97PGAr2hd3_p3AAAK
2025-11-11 21:16:32,790 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:16:32] "POST /socket.io/?EIO=4&transport=polling&t=PfrsRCF&sid=CsG7dEFeUC5HSHVWAAAI HTTP/1.1" 200 -
2025-11-11 21:16:32,790 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:16:32] "GET /socket.io/?EIO=4&transport=polling&t=PfrsRCF.0&sid=CsG7dEFeUC5HSHVWAAAI HTTP/1.1" 200 -
2025-11-11 21:16:32,790 - root - INFO - WebSocket client connected: v55CYYopVu54TX_oAAAL
2025-11-11 21:16:32,793 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:16:32] "POST /socket.io/?EIO=4&transport=polling&t=PfrsRCN.0&sid=CsG7dEFeUC5HSHVWAAAI HTTP/1.1" 200 -
2025-11-11 21:16:32,793 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:16:32] "GET /socket.io/?EIO=4&transport=polling&t=PfrsRCN&sid=CsG7dEFeUC5HSHVWAAAI HTTP/1.1" 200 -
2025-11-11 21:16:32,795 - root - INFO - Client zsj97PGAr2hd3_p3AAAK joined session room: sess-w3auyqh2
2025-11-11 21:16:32,795 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:16:32] "POST /socket.io/?EIO=4&transport=polling&t=PfrsRCQ.0&sid=CsG7dEFeUC5HSHVWAAAI HTTP/1.1" 200 -
2025-11-11 21:16:32,795 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:16:32] "GET /socket.io/?EIO=4&transport=polling&t=PfrsRCQ&sid=CsG7dEFeUC5HSHVWAAAI HTTP/1.1" 200 -
2025-11-11 21:16:32,800 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:16:32] "GET /socket.io/?EIO=4&transport=polling&t=PfrsRCS&sid=CsG7dEFeUC5HSHVWAAAI HTTP/1.1" 200 -
2025-11-11 21:16:41,754 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:16:41] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:16:41,758 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:16:41] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 21:18:39,632 - root - INFO - WebSocket client disconnected: zsj97PGAr2hd3_p3AAAK
2025-11-11 21:18:39,634 - root - INFO - WebSocket client disconnected: v55CYYopVu54TX_oAAAL
2025-11-11 21:18:39,635 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:18:39] "GET /socket.io/?EIO=4&transport=websocket&sid=CsG7dEFeUC5HSHVWAAAI HTTP/1.1" 200 -
2025-11-11 21:18:39,637 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:18:39] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 21:18:39,644 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:18:39] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:18:39,647 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:18:39,660 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:18:39] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 21:18:39,662 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:18:39] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:18:39,664 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:18:39] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:18:39,725 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:18:39] "GET /socket.io/?EIO=4&transport=polling&t=PfrswBY HTTP/1.1" 200 -
2025-11-11 21:18:39,732 - root - INFO - WebSocket client connected: -VJlNd0YRi_flR48AAAO
2025-11-11 21:18:39,734 - root - INFO - WebSocket client connected: JpLpz3B2qgufcqhfAAAP
2025-11-11 21:18:39,734 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:18:39] "POST /socket.io/?EIO=4&transport=polling&t=PfrswBp&sid=OSuB0rpalOJlcGZuAAAM HTTP/1.1" 200 -
2025-11-11 21:18:39,736 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:18:39] "GET /socket.io/?EIO=4&transport=polling&t=PfrswBq&sid=OSuB0rpalOJlcGZuAAAM HTTP/1.1" 200 -
2025-11-11 21:18:39,742 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:18:39] "POST /socket.io/?EIO=4&transport=polling&t=PfrswBx.0&sid=OSuB0rpalOJlcGZuAAAM HTTP/1.1" 200 -
2025-11-11 21:18:39,742 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:18:39] "GET /socket.io/?EIO=4&transport=polling&t=PfrswBx&sid=OSuB0rpalOJlcGZuAAAM HTTP/1.1" 200 -
2025-11-11 21:18:39,749 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:18:39] "GET /socket.io/?EIO=4&transport=polling&t=PfrswC4&sid=OSuB0rpalOJlcGZuAAAM HTTP/1.1" 200 -
2025-11-11 21:18:39,750 - root - INFO - Client JpLpz3B2qgufcqhfAAAP joined session room: sess-w3auyqh2
2025-11-11 21:18:39,750 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:18:39] "POST /socket.io/?EIO=4&transport=polling&t=PfrswC4.0&sid=OSuB0rpalOJlcGZuAAAM HTTP/1.1" 200 -
2025-11-11 21:18:42,859 - root - INFO - Client JpLpz3B2qgufcqhfAAAP joined session room: sess-ndepe32p
2025-11-11 21:18:43,368 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:18:43] "GET /api/agent/welcome-message HTTP/1.1" 200 -
2025-11-11 21:23:02,115 - root - INFO - WebSocket client disconnected: -VJlNd0YRi_flR48AAAO
2025-11-11 21:23:02,117 - root - INFO - WebSocket client disconnected: JpLpz3B2qgufcqhfAAAP
2025-11-11 21:23:02,117 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:23:02] "GET /socket.io/?EIO=4&transport=websocket&sid=OSuB0rpalOJlcGZuAAAM HTTP/1.1" 200 -
2025-11-11 21:23:02,120 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:23:02] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 21:23:02,125 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:23:02] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:23:02,126 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:23:02,141 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:23:02] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:23:02,142 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:23:02] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:23:02,158 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:23:02] "GET /socket.io/?EIO=4&transport=polling&t=PfrtwGD HTTP/1.1" 200 -
2025-11-11 21:23:02,163 - root - INFO - WebSocket client connected: GpPZg-K6111MmQa1AAAS
2025-11-11 21:23:02,163 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:23:02] "POST /socket.io/?EIO=4&transport=polling&t=PfrtwGG&sid=raJW38OxdxgYpfl9AAAQ HTTP/1.1" 200 -
2025-11-11 21:23:02,163 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:23:02] "GET /socket.io/?EIO=4&transport=polling&t=PfrtwGG.0&sid=raJW38OxdxgYpfl9AAAQ HTTP/1.1" 200 -
2025-11-11 21:23:02,164 - root - INFO - WebSocket client connected: DDDyUbHX3vyz4_LtAAAT
2025-11-11 21:23:02,166 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:23:02] "POST /socket.io/?EIO=4&transport=polling&t=PfrtwGK.0&sid=raJW38OxdxgYpfl9AAAQ HTTP/1.1" 200 -
2025-11-11 21:23:02,166 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:23:02] "GET /socket.io/?EIO=4&transport=polling&t=PfrtwGK&sid=raJW38OxdxgYpfl9AAAQ HTTP/1.1" 200 -
2025-11-11 21:23:02,167 - root - INFO - Client GpPZg-K6111MmQa1AAAS joined session room: sess-ndepe32p
2025-11-11 21:23:02,168 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:23:02] "POST /socket.io/?EIO=4&transport=polling&t=PfrtwGM.0&sid=raJW38OxdxgYpfl9AAAQ HTTP/1.1" 200 -
2025-11-11 21:23:02,168 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:23:02] "GET /socket.io/?EIO=4&transport=polling&t=PfrtwGM&sid=raJW38OxdxgYpfl9AAAQ HTTP/1.1" 200 -
2025-11-11 21:23:02,173 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:23:02] "GET /socket.io/?EIO=4&transport=polling&t=PfrtwGO&sid=raJW38OxdxgYpfl9AAAQ HTTP/1.1" 200 -
2025-11-11 21:23:05,346 - root - INFO - Client GpPZg-K6111MmQa1AAAS joined session room: sess-j7emlfjj
2025-11-11 21:23:05,855 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:23:05] "GET /api/agent/welcome-message HTTP/1.1" 200 -
2025-11-11 21:26:28,522 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'Show me limits near breach (utilization >= 0.5)'
2025-11-11 21:26:28,522 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-j7emlfjj
2025-11-11 21:26:28,523 - agent.state_manager - WARNING - Session sess-j7emlfjj not found
2025-11-11 21:26:28,523 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 21:26:28,526 - agent.state_manager - INFO - Saved session state for sess-j7emlfjj (user: admin)
2025-11-11 21:26:28,526 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 21:26:28,526 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 21:26:28,527 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 21:26:28,527 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 21:26:28,527 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 21:26:28,527 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 21:26:28,527 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 21:26:28,530 - agent.state_manager - INFO - Saved session state for sess-j7emlfjj (user: admin)
2025-11-11 21:26:32,587 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:26:32,606 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 21:26:32,607 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 21:26:32,607 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 21:26:32,608 - agent.state_manager - INFO - Saved session state for sess-j7emlfjj (user: admin)
2025-11-11 21:26:32,608 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 21:26:32,608 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 21:26:32,609 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 21:26:32,609 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 21:26:32,609 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 21:26:32,609 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 21:26:32,609 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 21:26:32,609 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 21:26:32,609 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 21:26:32,609 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 21:26:32,609 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 21:26:32,609 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 21:26:32,609 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 21:26:32,609 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 21:26:32,609 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 21:26:32,609 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 21:26:35,649 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:26:37,499 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:26:39,189 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 21:26:39,189 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: Show me limits near breach (utilization >= 0.5)
2025-11-11 21:26:39,189 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-11 21:26:39,189 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 22629 chars
2025-11-11 21:26:39,189 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 21:26:39,189 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 21:26:41,083 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:26:42,979 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 386 chars
2025-11-11 21:26:42,979 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE utilization >= 0.5 AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
  "explanation": "Queried limits with utilization >= 0.5 (near breach threshold) for the latest date, sorted by utilization in descending order. Used business terminology mapping for 'near breach' interpretation.",
  "target_table": "limits_data"
}
2025-11-11 21:26:42,979 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 21:26:42,979 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 21:26:42,979 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE utilization >= 0.5 AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 21:26:42,979 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE utilization >= 0.5 AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 21:26:42,979 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 21:26:42,979 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 21:26:42,979 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 21:26:42,980 - agent.state_manager - INFO - Saved session state for sess-j7emlfjj (user: admin)
2025-11-11 21:26:42,980 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 21:26:42,980 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 21:26:42,980 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 21:26:42,981 - agent.state_manager - INFO - Saved session state for sess-j7emlfjj (user: admin)
2025-11-11 21:26:42,981 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE utilization >= 0.5 AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 21:26:42,981 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 123 chars
2025-11-11 21:26:42,981 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE utilization >= 0.5 AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 21:26:42,981 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE utilization >= 0.5 AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 21:26:42,981 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE utilization >= 0.5 AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 21:26:42,981 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 21:26:42,981 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE utilization >= 0.5 AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 21:26:43,053 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 21:26:43,053 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 21:26:43,053 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 21:26:43,055 - agent.state_manager - INFO - Saved session state for sess-j7emlfjj (user: admin)
2025-11-11 21:26:43,055 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=10, columns=41, rows=10, sql=SELECT * FROM limits_data WHERE utilization >= 0.5 AND date = (SELECT MAX(date) FROM limits_data) OR
2025-11-11 21:26:43,055 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 21:26:43,056 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 21:26:43,056 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE utilization >= 0.5 AND date = (SELECT MAX(date) FROM limits_data) OR
2025-11-11 21:26:43,056 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=10, columns=41, rows=10, query_length=123
2025-11-11 21:26:43,056 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 21:26:43,056 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 21:26:43,056 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 13504 chars
2025-11-11 21:26:44,404 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:26:55,890 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1863 chars
2025-11-11 21:26:55,891 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 21:26:55,891 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 21:26:55,892 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 38269 chars
2025-11-11 21:27:02,963 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:27:02,964 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 921 chars
2025-11-11 21:27:02,965 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=10, columns=41, rows=10, query=SELECT * FROM limits_data WHERE utilization >= 0.5 AND date = (SELECT MAX(date) FROM limits_data) OR
2025-11-11 21:27:02,965 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=10, columns=41, rows=10, has_query=True
2025-11-11 21:27:02,965 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE utilization >= 0.5 AND date = (SELECT MAX(date) FROM limits_data) OR...
2025-11-11 21:27:02,965 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE utilization >= 0.5 AND date = (SELECT MAX(date) FROM limits_data) OR...
2025-11-11 21:27:02,966 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 21:27:02,966 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 21:27:02,967 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 21:27:02,980 - agent.state_manager - INFO - Saved session state for sess-j7emlfjj (user: admin)
2025-11-11 21:27:02,980 - agent.streaming_agent - INFO - Agent completed for session sess-j7emlfjj: 34453.168ms, 7 steps
2025-11-11 21:27:02,980 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=10, columns=41, rows=10
2025-11-11 21:28:49,513 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'show me breakdown of above 50% ultisation by aggregation type'
2025-11-11 21:28:49,514 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-j7emlfjj
2025-11-11 21:28:49,516 - agent.state_manager - INFO - Loaded session state for sess-j7emlfjj
2025-11-11 21:28:49,516 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 1 turns
2025-11-11 21:28:49,517 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 1 conversation turns
2025-11-11 21:28:49,526 - agent.state_manager - INFO - Saved session state for sess-j7emlfjj (user: admin)
2025-11-11 21:28:49,527 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 21:28:49,527 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 21:28:49,527 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 21:28:49,527 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=1, conv_history(str)=12456
2025-11-11 21:28:49,527 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 21:28:49,528 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 21:28:49,528 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 21:28:49,531 - agent.state_manager - INFO - Saved session state for sess-j7emlfjj (user: admin)
2025-11-11 21:28:49,532 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 21:28:52,776 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:28:52,778 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain the full details of limits near breach, including all columns like region_cd, utilization, limit_id, etc. Any follow-up analysis or filtering can be done directly on these existing results without needing a new database query.
2025-11-11 21:28:52,779 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 21:28:52,779 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 21:28:52,779 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 21:28:52,785 - agent.state_manager - INFO - Saved session state for sess-j7emlfjj (user: admin)
2025-11-11 21:28:56,973 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:28:56,975 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 21:28:56,976 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 21:28:56,976 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 21:28:56,981 - agent.state_manager - INFO - Saved session state for sess-j7emlfjj (user: admin)
2025-11-11 21:28:56,982 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 21:28:56,982 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 21:28:56,983 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 21:28:56,983 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 21:28:56,983 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 21:28:56,983 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 21:28:56,983 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 21:28:56,983 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 21:28:56,983 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 21:28:56,983 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 21:28:56,983 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 12456 characters
2025-11-11 21:28:56,983 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 21:28:56,983 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 21:28:56,983 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 21:28:56,983 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 21:28:56,984 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 21:28:56,984 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 21:28:56,984 - tools.impl.nl_to_sql_planner - INFO -     User Query: Show me limits near breach (utilization >= 0.5)
2025-11-11 21:28:56,984 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 21:28:56,984 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 21:28:56,984 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE utilization >= 0.5 AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 21:28:56,984 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 21:28:56,984 - tools.impl.nl_to_sql_planner - INFO -     Result Table (10 rows):
2025-11-11 21:28:56,984 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, re
2025-11-11 21:28:56,984 - tools.impl.nl_to_sql_planner - INFO -     ... (11856 more characters)
2025-11-11 21:28:56,984 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 21:29:01,470 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:29:04,242 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:29:06,347 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 21:29:06,348 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 21:29:06,348 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 21:29:06,348 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 12456
2025-11-11 21:29:06,348 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 21:29:06,349 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 2 SQL code blocks, using LAST (most recent)
2025-11-11 21:29:06,349 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 21:29:06,349 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT * FROM limits_data 
WHERE utilization >= 0.5 AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC...
2025-11-11 21:29:06,349 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 125 characters
2025-11-11 21:29:06,349 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 21:29:06,349 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 21:29:06,349 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 125 characters
2025-11-11 21:29:06,349 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT * FROM limits_data 
WHERE utilization >= 0.5 AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 21:29:06,349 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT * FROM limits_data 
WHERE utilization >= 0.5 AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 21:29:06,350 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 21:29:06,351 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 21:29:06,351 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: show me breakdown of above 50% ultisation by aggregation type
2025-11-11 21:29:06,352 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10549 chars
2025-11-11 21:29:06,352 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 35066 chars
2025-11-11 21:29:06,352 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 21:29:06,352 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 21:29:09,025 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:29:11,480 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 574 chars
2025-11-11 21:29:11,480 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT aggr_func_cd, COUNT(*) as limit_count, SUM(exposure_amt) as total_exposure, AVG(utilization) as avg_utilization FROM limits_data WHERE utilization >= 0.5 AND date = (SELECT MAX(date) FROM limits_data) GROUP BY aggr_func_cd ORDER BY limit_count DESC",
    "explanation": "Breakdown of limits above 50% utilization grouped by aggregation type. Counts limits, calculates total exposure and average utilization for each aggregation function. Assumes latest date and preserves previou
2025-11-11 21:29:11,480 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 21:29:11,480 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 21:29:11,481 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT aggr_func_cd, COUNT(*) as limit_count, SUM(exposure_amt) as total_exposure, AVG(utilization) as avg_utilization FROM limits_data WHERE utilization >= 0.5 AND date = (SELECT MAX(date) FROM limit...
2025-11-11 21:29:11,481 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT aggr_func_cd, COUNT(*) as limit_count, SUM(exposure_amt) as total_exposure, AVG(utilization) as avg_utilization FROM limits_data WHERE utilization >= 0.5 AND date = (SELECT MAX(date) FROM limits_data) GROUP BY aggr_func_cd ORDER BY limit_count DESC
2025-11-11 21:29:11,482 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 21:29:11,482 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 21:29:11,482 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 21:29:11,488 - agent.state_manager - INFO - Saved session state for sess-j7emlfjj (user: admin)
2025-11-11 21:29:11,488 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 21:29:11,488 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 21:29:11,489 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 21:29:11,493 - agent.state_manager - INFO - Saved session state for sess-j7emlfjj (user: admin)
2025-11-11 21:29:11,493 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT aggr_func_cd, COUNT(*) as limit_count, SUM(exposure_amt) as total_exposure, AVG(utilization) as avg_utilization FROM limits_data WHERE utilization >= 0.5 AND date = (SELECT MAX(date) FROM limit...
2025-11-11 21:29:11,494 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 255 chars
2025-11-11 21:29:11,494 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT aggr_func_cd, COUNT(*) as limit_count, SUM(exposure_amt) as total_exposure, AVG(utilization) as avg_utilization FROM limits_data WHERE utilization >= 0.5 AND date = (SELECT MAX(date) FROM limits_data) GROUP BY aggr_func_cd ORDER BY limit_count DESC
2025-11-11 21:29:11,494 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT aggr_func_cd, COUNT(*) as limit_count, SUM(exposure_amt) as total_exposure, AVG(utilization) as avg_utilization FROM limits_data WHERE utilization >= 0.5 AND date = (SELECT MAX(date) FROM limit...
2025-11-11 21:29:11,494 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT aggr_func_cd, COUNT(*) as limit_count, SUM(exposure_amt) as total_exposure, AVG(utilization) as avg_utilization FROM limits_data WHERE utilization >= 0.5 AND date = (SELECT MAX(date) FROM limit...
2025-11-11 21:29:11,494 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 21:29:11,494 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT aggr_func_cd, COUNT(*) as limit_count, SUM(exposure_amt) as total_exposure, AVG(utilization) as avg_utilization FROM limits_data WHERE utilization >= 0.5 AND date = (SELECT MAX(date) FROM limit...
2025-11-11 21:29:11,581 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 21:29:11,581 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 21:29:11,581 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 21:29:11,582 - agent.state_manager - INFO - Saved session state for sess-j7emlfjj (user: admin)
2025-11-11 21:29:11,583 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=6, columns=4, rows=6, sql=SELECT aggr_func_cd, COUNT(*) as limit_count, SUM(exposure_amt) as total_exposure, AVG(utilization) 
2025-11-11 21:29:11,583 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 21:29:11,583 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 21:29:11,583 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT aggr_func_cd, COUNT(*) as limit_count, SUM(exposure_amt) as total_exposure, AVG(utilization) 
2025-11-11 21:29:11,583 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=6, columns=4, rows=6, query_length=255
2025-11-11 21:29:11,583 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 21:29:11,583 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 21:29:11,583 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 1543 chars
2025-11-11 21:29:12,172 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:29:21,139 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1752 chars
2025-11-11 21:29:21,141 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 21:29:21,141 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 21:29:21,142 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 39271 chars
2025-11-11 21:29:30,560 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:29:30,561 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1269 chars
2025-11-11 21:29:30,562 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=6, columns=4, rows=6, query=SELECT aggr_func_cd, COUNT(*) as limit_count, SUM(exposure_amt) as total_exposure, AVG(utilization) 
2025-11-11 21:29:30,562 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=6, columns=4, rows=6, has_query=True
2025-11-11 21:29:30,562 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT aggr_func_cd, COUNT(*) as limit_count, SUM(exposure_amt) as total_exposure, AVG(utilization) ...
2025-11-11 21:29:30,562 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT aggr_func_cd, COUNT(*) as limit_count, SUM(exposure_amt) as total_exposure, AVG(utilization) ...
2025-11-11 21:29:30,562 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 21:29:30,562 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 21:29:30,563 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 21:29:30,570 - agent.state_manager - INFO - Saved session state for sess-j7emlfjj (user: admin)
2025-11-11 21:29:30,570 - agent.streaming_agent - INFO - Agent completed for session sess-j7emlfjj: 41042.893ms, 8 steps
2025-11-11 21:29:30,570 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=6, columns=4, rows=6
2025-11-11 21:30:40,382 - root - INFO - WebSocket client disconnected: DDDyUbHX3vyz4_LtAAAT
2025-11-11 21:30:40,382 - root - INFO - WebSocket client disconnected: GpPZg-K6111MmQa1AAAS
2025-11-11 21:30:40,383 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:30:40] "GET /socket.io/?EIO=4&transport=websocket&sid=raJW38OxdxgYpfl9AAAQ HTTP/1.1" 200 -
2025-11-11 21:30:40,400 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:30:40] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:30:40,400 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:30:40] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 21:30:40,402 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:30:40,494 - root - INFO - WebSocket client connected: 93BByYCP14mxaPPZAAAV
2025-11-11 21:30:42,244 - root - INFO - WebSocket client disconnected: 93BByYCP14mxaPPZAAAV
2025-11-11 21:30:42,248 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:30:42] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 21:30:42,256 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:30:42] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:30:42,257 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:30:42,273 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:30:42] "GET /socket.io/?EIO=4&transport=polling&t=PfrvgbV HTTP/1.1" 200 -
2025-11-11 21:30:42,284 - root - INFO - WebSocket client connected: ZX9PGkSScR4ZN5OIAAAY
2025-11-11 21:30:42,284 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:30:42] "POST /socket.io/?EIO=4&transport=polling&t=Pfrvgbd&sid=P-ghn3pm_3yu1IuTAAAW HTTP/1.1" 200 -
2025-11-11 21:30:42,284 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:30:42] "GET /socket.io/?EIO=4&transport=polling&t=Pfrvgbe&sid=P-ghn3pm_3yu1IuTAAAW HTTP/1.1" 200 -
2025-11-11 21:30:42,286 - root - INFO - WebSocket client connected: dq2ZbVsJ9T78gTPiAAAZ
2025-11-11 21:30:42,287 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:30:42] "GET /socket.io/?EIO=4&transport=polling&t=Pfrvgbj&sid=P-ghn3pm_3yu1IuTAAAW HTTP/1.1" 200 -
2025-11-11 21:30:42,287 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:30:42] "POST /socket.io/?EIO=4&transport=polling&t=Pfrvgbj.0&sid=P-ghn3pm_3yu1IuTAAAW HTTP/1.1" 200 -
2025-11-11 21:30:42,289 - root - INFO - Client ZX9PGkSScR4ZN5OIAAAY joined session room: sess-j7emlfjj
2025-11-11 21:30:42,289 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:30:42] "POST /socket.io/?EIO=4&transport=polling&t=Pfrvgbm.0&sid=P-ghn3pm_3yu1IuTAAAW HTTP/1.1" 200 -
2025-11-11 21:30:42,289 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:30:42] "GET /socket.io/?EIO=4&transport=polling&t=Pfrvgbm&sid=P-ghn3pm_3yu1IuTAAAW HTTP/1.1" 200 -
2025-11-11 21:30:42,295 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:30:42] "GET /socket.io/?EIO=4&transport=polling&t=Pfrvgbo&sid=P-ghn3pm_3yu1IuTAAAW HTTP/1.1" 200 -
2025-11-11 21:30:46,710 - root - INFO - Client ZX9PGkSScR4ZN5OIAAAY joined session room: sess-gj0prkm8
2025-11-11 21:30:47,213 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:30:47] "GET /api/agent/welcome-message HTTP/1.1" 200 -
2025-11-11 21:31:01,441 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'Show me limits that breached in the last 10 days'
2025-11-11 21:31:01,442 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-gj0prkm8
2025-11-11 21:31:01,442 - agent.state_manager - WARNING - Session sess-gj0prkm8 not found
2025-11-11 21:31:01,442 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 21:31:01,447 - agent.state_manager - INFO - Saved session state for sess-gj0prkm8 (user: admin)
2025-11-11 21:31:01,448 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 21:31:01,448 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 21:31:01,448 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 21:31:01,448 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 21:31:01,448 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 21:31:01,448 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 21:31:01,449 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 21:31:01,451 - agent.state_manager - INFO - Saved session state for sess-gj0prkm8 (user: admin)
2025-11-11 21:31:05,662 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:31:05,663 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 21:31:05,663 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 21:31:05,663 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 21:31:05,664 - agent.state_manager - INFO - Saved session state for sess-gj0prkm8 (user: admin)
2025-11-11 21:31:05,664 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 21:31:05,664 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 21:31:05,664 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 21:31:05,664 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 21:31:05,664 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 21:31:05,664 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 21:31:05,664 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 21:31:05,664 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 21:31:05,664 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 21:31:05,664 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 21:31:05,664 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 21:31:05,664 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 21:31:05,664 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 21:31:05,664 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 21:31:05,664 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 21:31:05,664 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 21:31:08,866 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:31:10,621 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:31:12,076 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 21:31:12,076 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: Show me limits that breached in the last 10 days
2025-11-11 21:31:12,076 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-11 21:31:12,076 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 22630 chars
2025-11-11 21:31:12,076 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 21:31:12,076 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 21:31:13,986 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:31:16,358 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 533 chars
2025-11-11 21:31:16,358 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE utilization >= 1.0 AND date >= (SELECT MAX(date) FROM limits_data) - INTERVAL '9 days' AND date <= (SELECT MAX(date) FROM limits_data) ORDER BY date DESC, utilization DESC",
  "explanation": "Query for limits that breached (utilization >= 1.0) in the last 10 days. Used business terminology mapping for 'breached' (utilization >= 1.0). Sorted by most recent date and highest utilization. Includes all columns to provide comprehensive breach information.",

2025-11-11 21:31:16,358 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 21:31:16,358 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 21:31:16,358 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE utilization >= 1.0 AND date >= (SELECT MAX(date) FROM limits_data) - INTERVAL '9 days' AND date <= (SELECT MAX(date) FROM limits_data) ORDER BY date DESC, utilization D...
2025-11-11 21:31:16,358 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE utilization >= 1.0 AND date >= (SELECT MAX(date) FROM limits_data) - INTERVAL '9 days' AND date <= (SELECT MAX(date) FROM limits_data) ORDER BY date DESC, utilization DESC
2025-11-11 21:31:16,358 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 21:31:16,358 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 21:31:16,358 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 21:31:16,359 - agent.state_manager - INFO - Saved session state for sess-gj0prkm8 (user: admin)
2025-11-11 21:31:16,359 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 21:31:16,359 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 21:31:16,359 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 21:31:16,360 - agent.state_manager - INFO - Saved session state for sess-gj0prkm8 (user: admin)
2025-11-11 21:31:16,360 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE utilization >= 1.0 AND date >= (SELECT MAX(date) FROM limits_data) - INTERVAL '9 days' AND date <= (SELECT MAX(date) FROM limits_data) ORDER BY date DESC, utilization D...
2025-11-11 21:31:16,360 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 203 chars
2025-11-11 21:31:16,360 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE utilization >= 1.0 AND date >= (SELECT MAX(date) FROM limits_data) - INTERVAL '9 days' AND date <= (SELECT MAX(date) FROM limits_data) ORDER BY date DESC, utilization DESC
2025-11-11 21:31:16,360 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE utilization >= 1.0 AND date >= (SELECT MAX(date) FROM limits_data) - INTERVAL '9 days' AND date <= (SELECT MAX(date) FROM limits_data) ORDER BY date DESC, utilization D...
2025-11-11 21:31:16,360 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE utilization >= 1.0 AND date >= (SELECT MAX(date) FROM limits_data) - INTERVAL '9 days' AND date <= (SELECT MAX(date) FROM limits_data) ORDER BY date DESC, utilization D...
2025-11-11 21:31:16,360 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 21:31:16,361 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE utilization >= 1.0 AND date >= (SELECT MAX(date) FROM limits_data) - INTERVAL '9 days' AND date <= (SELECT MAX(date) FROM limits_data) ORDER BY date DESC, utilization D...
2025-11-11 21:31:16,445 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 21:31:16,445 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 21:31:16,446 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 21:31:16,447 - agent.state_manager - INFO - Saved session state for sess-gj0prkm8 (user: admin)
2025-11-11 21:31:16,448 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=16, columns=41, rows=16, sql=SELECT * FROM limits_data WHERE utilization >= 1.0 AND date >= (SELECT MAX(date) FROM limits_data) -
2025-11-11 21:31:16,448 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 21:31:16,448 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 21:31:16,448 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE utilization >= 1.0 AND date >= (SELECT MAX(date) FROM limits_data) -
2025-11-11 21:31:16,448 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=16, columns=41, rows=16, query_length=203
2025-11-11 21:31:16,448 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 21:31:16,448 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 21:31:16,448 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 21067 chars
2025-11-11 21:31:18,478 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:31:27,935 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1496 chars
2025-11-11 21:31:27,936 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 21:31:27,936 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 21:31:27,938 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 38417 chars
2025-11-11 21:31:36,004 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:31:36,006 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1017 chars
2025-11-11 21:31:36,006 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=16, columns=41, rows=16, query=SELECT * FROM limits_data WHERE utilization >= 1.0 AND date >= (SELECT MAX(date) FROM limits_data) -
2025-11-11 21:31:36,007 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=16, columns=41, rows=16, has_query=True
2025-11-11 21:31:36,007 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE utilization >= 1.0 AND date >= (SELECT MAX(date) FROM limits_data) -...
2025-11-11 21:31:36,007 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE utilization >= 1.0 AND date >= (SELECT MAX(date) FROM limits_data) -...
2025-11-11 21:31:36,007 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 21:31:36,008 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 21:31:36,009 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 21:31:36,020 - agent.state_manager - INFO - Saved session state for sess-gj0prkm8 (user: admin)
2025-11-11 21:31:36,020 - agent.streaming_agent - INFO - Agent completed for session sess-gj0prkm8: 34572.221999999994ms, 7 steps
2025-11-11 21:31:36,020 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=16, columns=41, rows=16
2025-11-11 21:35:40,153 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-11 21:35:40,168 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-11 21:35:40,168 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-11 21:35:40,170 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-11 21:35:40,170 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-11 21:35:40,193 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:35:40,193 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:35:40,193 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:35:40,193 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:35:40,193 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-11 21:35:40,193 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-11 21:35:40,193 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-11 21:35:40,194 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-11 21:35:40,194 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-11 21:35:40,195 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-11 21:35:40,195 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-11 21:35:40,195 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-11 21:35:40,195 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-11 21:35:40,196 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-11 21:35:40,196 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-11 21:35:40,196 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-11 21:35:40,196 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-11 21:35:40,198 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-11 21:35:40,198 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-11 21:35:40,494 - DuckDbDescribeTableTool - INFO - Found 1 data files in data/duckdb
2025-11-11 21:35:40,531 - DuckDbDescribeTableTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:35:40,538 - DuckDbDescribeTableTool - INFO - Initialization complete: 4 views available
2025-11-11 21:35:40,538 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:35:40,538 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-11 21:35:40,538 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-11 21:35:40,539 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-11 21:35:40,540 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-11 21:35:40,758 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-11 21:35:40,758 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-11 21:35:40,759 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-11 21:35:40,759 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-11 21:35:40,760 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-11 21:35:40,760 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-11 21:35:40,760 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-11 21:35:40,760 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-11 21:35:40,760 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-11 21:35:40,761 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-11 21:35:40,764 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-11 21:35:40,764 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-11 21:35:40,764 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-11 21:35:40,764 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-11 21:35:40,765 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-11 21:35:40,765 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-11 21:35:40,765 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-11 21:35:40,765 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-11 21:35:40,766 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-11 21:35:40,766 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-11 21:35:40,766 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-11 21:35:40,766 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-11 21:35:40,766 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-11 21:35:40,766 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-11 21:35:40,767 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-11 21:35:40,767 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-11 21:35:40,768 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-11 21:35:40,768 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-11 21:35:40,768 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-11 21:35:40,768 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-11 21:35:40,769 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-11 21:35:40,769 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-11 21:35:40,769 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-11 21:35:40,769 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-11 21:35:40,770 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-11 21:35:40,770 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-11 21:35:40,770 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-11 21:35:40,770 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-11 21:35:40,773 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-11 21:35:40,773 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-11 21:35:40,774 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-11 21:35:40,774 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-11 21:35:40,774 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-11 21:35:40,774 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-11 21:35:40,774 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-11 21:35:40,774 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-11 21:35:40,780 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:35:40,780 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:35:40,780 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:35:40,780 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:35:40,780 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-11 21:35:40,780 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-11 21:35:40,780 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-11 21:35:40,780 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-11 21:35:40,780 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-11 21:35:40,780 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-11 21:35:40,781 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-11 21:35:40,781 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-11 21:35:40,781 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-11 21:35:40,781 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-11 21:35:40,781 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-11 21:35:40,782 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-11 21:35:40,782 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-11 21:35:40,782 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-11 21:35:40,782 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-11 21:35:40,783 - DuckDbListFilesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 21:35:40,818 - DuckDbListFilesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:35:40,820 - DuckDbListFilesTool - INFO - Initialization complete: 4 views available
2025-11-11 21:35:40,820 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:35:40,820 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-11 21:35:40,820 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-11 21:35:40,820 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-11 21:35:40,820 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-11 21:35:40,820 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-11 21:35:40,820 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-11 21:35:40,821 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-11 21:35:40,821 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-11 21:35:40,821 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-11 21:35:40,821 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-11 21:35:40,822 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-11 21:35:40,822 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-11 21:35:40,822 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-11 21:35:40,822 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-11 21:35:40,822 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-11 21:35:40,822 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-11 21:35:40,822 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-11 21:35:40,822 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-11 21:35:40,822 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-11 21:35:40,822 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-11 21:35:40,823 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-11 21:35:40,823 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-11 21:35:40,823 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-11 21:35:40,823 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-11 21:35:40,823 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-11 21:35:40,823 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-11 21:35:40,824 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-11 21:35:40,824 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-11 21:35:40,824 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-11 21:35:40,824 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-11 21:35:40,824 - DuckDbGetStatsTool - INFO - Found 1 data files in data/duckdb
2025-11-11 21:35:40,859 - DuckDbGetStatsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:35:40,860 - DuckDbGetStatsTool - INFO - Initialization complete: 4 views available
2025-11-11 21:35:40,860 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:35:40,860 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-11 21:35:40,860 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-11 21:35:40,861 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-11 21:35:40,861 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-11 21:35:40,861 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-11 21:35:40,861 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-11 21:35:40,861 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-11 21:35:40,861 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-11 21:35:40,861 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-11 21:35:40,861 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-11 21:35:40,867 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:35:40,867 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:35:40,867 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:35:40,867 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:35:40,867 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-11 21:35:40,867 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-11 21:35:40,867 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-11 21:35:40,868 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-11 21:35:40,868 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-11 21:35:40,868 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-11 21:35:40,868 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-11 21:35:40,878 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-11 21:35:40,879 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-11 21:35:40,879 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-11 21:35:40,879 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-11 21:35:40,879 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-11 21:35:40,879 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-11 21:35:40,879 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-11 21:35:40,879 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-11 21:35:40,879 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-11 21:35:40,880 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-11 21:35:40,880 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-11 21:35:40,880 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-11 21:35:40,880 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-11 21:35:40,880 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-11 21:35:40,880 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-11 21:35:40,880 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-11 21:35:40,880 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-11 21:35:40,880 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-11 21:35:40,880 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-11 21:35:40,880 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-11 21:35:40,881 - DuckDbListTablesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 21:35:40,916 - DuckDbListTablesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:35:40,918 - DuckDbListTablesTool - INFO - Initialization complete: 4 views available
2025-11-11 21:35:40,918 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:35:40,918 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-11 21:35:40,918 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-11 21:35:40,918 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-11 21:35:40,918 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-11 21:35:40,918 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-11 21:35:40,919 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-11 21:35:40,919 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-11 21:35:40,919 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-11 21:35:40,919 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-11 21:35:40,919 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-11 21:35:40,920 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-11 21:35:40,920 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-11 21:35:40,920 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-11 21:35:40,920 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-11 21:35:40,920 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-11 21:35:40,920 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-11 21:35:40,920 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-11 21:35:40,920 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-11 21:35:40,920 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-11 21:35:40,921 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-11 21:35:40,921 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-11 21:35:40,921 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-11 21:35:40,921 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-11 21:35:40,921 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-11 21:35:40,921 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-11 21:35:40,921 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-11 21:35:40,922 - DuckDbAggregateTool - INFO - Found 1 data files in data/duckdb
2025-11-11 21:35:40,958 - DuckDbAggregateTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:35:40,959 - DuckDbAggregateTool - INFO - Initialization complete: 4 views available
2025-11-11 21:35:40,959 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:35:40,959 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-11 21:35:40,959 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-11 21:35:40,960 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-11 21:35:40,960 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-11 21:35:40,960 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-11 21:35:40,960 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-11 21:35:40,960 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-11 21:35:40,960 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-11 21:35:40,960 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-11 21:35:40,960 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-11 21:35:40,961 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-11 21:35:40,961 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-11 21:35:40,961 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-11 21:35:40,961 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-11 21:35:40,967 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:35:40,967 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:35:40,967 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:35:40,967 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:35:40,967 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-11 21:35:40,967 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-11 21:35:40,967 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-11 21:35:40,967 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-11 21:35:40,967 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-11 21:35:40,968 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-11 21:35:40,968 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-11 21:35:40,968 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-11 21:35:40,968 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-11 21:35:40,968 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-11 21:35:40,968 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-11 21:35:40,968 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-11 21:35:40,968 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-11 21:35:40,968 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-11 21:35:40,968 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-11 21:35:40,969 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-11 21:35:40,969 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-11 21:35:40,969 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-11 21:35:40,969 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-11 21:35:40,969 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-11 21:35:40,969 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-11 21:35:40,969 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-11 21:35:40,969 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-11 21:35:40,969 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-11 21:35:40,969 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-11 21:35:40,970 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-11 21:35:40,970 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-11 21:35:40,970 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-11 21:35:40,970 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-11 21:35:40,970 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-11 21:35:40,970 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-11 21:35:40,970 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-11 21:35:40,970 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-11 21:35:40,971 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-11 21:35:40,971 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-11 21:35:40,971 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-11 21:35:40,971 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-11 21:35:40,971 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-11 21:35:40,971 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-11 21:35:40,972 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-11 21:35:40,972 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-11 21:35:40,972 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-11 21:35:40,972 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-11 21:35:40,973 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-11 21:35:40,973 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-11 21:35:40,973 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-11 21:35:40,973 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-11 21:35:40,973 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-11 21:35:40,973 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-11 21:35:40,974 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-11 21:35:40,974 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-11 21:35:40,974 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-11 21:35:40,974 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-11 21:35:40,974 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-11 21:35:40,974 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-11 21:35:40,975 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-11 21:35:40,975 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-11 21:35:40,975 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-11 21:35:40,975 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-11 21:35:40,976 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-11 21:35:40,976 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-11 21:35:40,976 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-11 21:35:40,976 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-11 21:35:40,976 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-11 21:35:40,976 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-11 21:35:40,976 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-11 21:35:40,976 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-11 21:35:40,976 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-11 21:35:40,976 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-11 21:35:40,976 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-11 21:35:40,977 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-11 21:35:40,982 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:35:40,982 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:35:40,982 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:35:40,982 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:35:40,982 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-11 21:35:40,982 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-11 21:35:40,982 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-11 21:35:40,983 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-11 21:35:40,983 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-11 21:35:40,983 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-11 21:35:40,983 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-11 21:35:40,983 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-11 21:35:40,983 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-11 21:35:40,983 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-11 21:35:40,983 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-11 21:35:40,983 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-11 21:35:40,983 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-11 21:35:40,984 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-11 21:35:40,984 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-11 21:35:40,984 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-11 21:35:40,984 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-11 21:35:40,984 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-11 21:35:40,984 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-11 21:35:40,984 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-11 21:35:40,984 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-11 21:35:40,984 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-11 21:35:40,984 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-11 21:35:40,984 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-11 21:35:40,984 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-11 21:35:40,985 - DuckDbQueryTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 21:35:41,021 - DuckDbQueryTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:35:41,022 - DuckDbQueryTool - INFO - Initialization complete: 4 views available
2025-11-11 21:35:41,022 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:35:41,022 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-11 21:35:41,022 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-11 21:35:41,023 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-11 21:35:41,023 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-11 21:35:41,023 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-11 21:35:41,023 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-11 21:35:41,023 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-11 21:35:41,023 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-11 21:35:41,024 - DuckDbRefreshViewsTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 21:35:41,059 - DuckDbRefreshViewsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:35:41,061 - DuckDbRefreshViewsTool - INFO - Initialization complete: 4 views available
2025-11-11 21:35:41,061 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:35:41,061 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-11 21:35:41,061 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-11 21:35:41,061 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-11 21:35:41,061 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-11 21:35:41,061 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-11 21:35:41,062 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-11 21:35:41,067 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:35:41,067 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:35:41,067 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:35:41,067 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:35:41,067 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-11 21:35:41,067 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-11 21:35:41,067 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-11 21:35:41,068 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-11 21:35:41,068 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-11 21:35:41,068 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-11 21:35:41,068 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-11 21:35:41,068 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-11 21:35:41,068 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-11 21:35:41,068 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-11 21:35:41,068 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-11 21:35:41,069 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-11 21:35:41,069 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-11 21:35:41,069 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-11 21:35:41,069 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-11 21:35:41,069 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-11 21:35:41,078 - root - INFO - All routes registered successfully
2025-11-11 21:35:41,082 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.68.51:8000
2025-11-11 21:35:41,082 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-11-11 21:35:41,274 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:35:41] "GET /socket.io/?EIO=4&transport=polling&t=PfrwpbM HTTP/1.1" 200 -
2025-11-11 21:35:41,280 - root - INFO - WebSocket client connected: J6r8k77VrKddhzP8AAAB
2025-11-11 21:35:41,281 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:35:41] "POST /socket.io/?EIO=4&transport=polling&t=PfrwpbS&sid=qVYMKQ8T79pAp-d3AAAA HTTP/1.1" 200 -
2025-11-11 21:35:41,283 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:35:41] "GET /socket.io/?EIO=4&transport=polling&t=PfrwpbT&sid=qVYMKQ8T79pAp-d3AAAA HTTP/1.1" 200 -
2025-11-11 21:35:41,294 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:35:41] "GET /socket.io/?EIO=4&transport=polling&t=Pfrwpbi&sid=qVYMKQ8T79pAp-d3AAAA HTTP/1.1" 200 -
2025-11-11 21:35:41,297 - root - INFO - WebSocket client disconnected: J6r8k77VrKddhzP8AAAB
2025-11-11 21:35:41,298 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:35:41] "GET /socket.io/?EIO=4&transport=websocket&sid=qVYMKQ8T79pAp-d3AAAA HTTP/1.1" 200 -
2025-11-11 21:35:42,273 - root - INFO - WebSocket client connected: Kd7NNuS0fBmB7KgjAAAD
2025-11-11 21:35:42,275 - root - INFO - WebSocket client disconnected: Kd7NNuS0fBmB7KgjAAAD
2025-11-11 21:35:42,287 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:35:42] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:35:42,290 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:35:46,439 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:35:46] "GET /health HTTP/1.1" 200 -
2025-11-11 21:35:53,937 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:35:53] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 21:35:53,957 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:35:53] "GET /login?next=http://localhost:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 21:35:53,995 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:35:53] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:35:53,996 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:35:53] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:35:54,023 - root - INFO - WebSocket client connected: 3Mrrgge144iiWecvAAAF
2025-11-11 21:35:54,025 - root - INFO - WebSocket client disconnected: 3Mrrgge144iiWecvAAAF
2025-11-11 21:35:54,037 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:35:54] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:35:54,037 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:35:57,554 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 21:35:57,554 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 21:35:57,556 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:35:57] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 21:35:57,579 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:35:57] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 21:35:57,601 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:35:57] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:35:57,602 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:35:57] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:35:57,666 - root - INFO - WebSocket client connected: lAXpB0iv6C7IWWhGAAAH
2025-11-11 21:35:57,668 - root - INFO - WebSocket client disconnected: lAXpB0iv6C7IWWhGAAAH
2025-11-11 21:35:57,682 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:35:57] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:35:57,683 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:36:02,775 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:36:02] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 21:36:02,794 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:36:02] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:36:02,794 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:36:02] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:36:02,812 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:36:02] "GET /socket.io/?EIO=4&transport=polling&t=Pfrwurw HTTP/1.1" 200 -
2025-11-11 21:36:02,816 - root - INFO - WebSocket client connected: l2UxT_zEEFEa1IyRAAAK
2025-11-11 21:36:02,816 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:36:02] "POST /socket.io/?EIO=4&transport=polling&t=Pfrwur-&sid=pHMK0hzBlGN83g1pAAAI HTTP/1.1" 200 -
2025-11-11 21:36:02,816 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:36:02] "GET /socket.io/?EIO=4&transport=polling&t=Pfrwur-.0&sid=pHMK0hzBlGN83g1pAAAI HTTP/1.1" 200 -
2025-11-11 21:36:02,817 - root - INFO - WebSocket client connected: PgdqoSa7E7QAcPtEAAAL
2025-11-11 21:36:02,821 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:36:02] "POST /socket.io/?EIO=4&transport=polling&t=Pfrwus3.0&sid=pHMK0hzBlGN83g1pAAAI HTTP/1.1" 200 -
2025-11-11 21:36:02,821 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:36:02] "GET /socket.io/?EIO=4&transport=polling&t=Pfrwus3&sid=pHMK0hzBlGN83g1pAAAI HTTP/1.1" 200 -
2025-11-11 21:36:02,823 - root - INFO - Client l2UxT_zEEFEa1IyRAAAK joined session room: sess-gj0prkm8
2025-11-11 21:36:02,823 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:36:02] "POST /socket.io/?EIO=4&transport=polling&t=Pfrwus6.0&sid=pHMK0hzBlGN83g1pAAAI HTTP/1.1" 200 -
2025-11-11 21:36:02,824 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:36:02] "GET /socket.io/?EIO=4&transport=polling&t=Pfrwus6&sid=pHMK0hzBlGN83g1pAAAI HTTP/1.1" 200 -
2025-11-11 21:36:02,828 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:36:02] "GET /socket.io/?EIO=4&transport=polling&t=Pfrwus9&sid=pHMK0hzBlGN83g1pAAAI HTTP/1.1" 200 -
2025-11-11 21:36:03,019 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:36:03] "GET /api/agent/welcome-message HTTP/1.1" 200 -
2025-11-11 21:36:14,193 - agent.session_manager - INFO - [SessionManager] Registered session sess-gj0prkm8
2025-11-11 21:36:14,193 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top breached limits'
2025-11-11 21:36:14,193 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-gj0prkm8
2025-11-11 21:36:14,195 - agent.state_manager - INFO - Loaded session state for sess-gj0prkm8
2025-11-11 21:36:14,195 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 1 turns
2025-11-11 21:36:14,195 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 1 conversation turns
2025-11-11 21:36:14,201 - agent.state_manager - INFO - Saved session state for sess-gj0prkm8 (user: admin)
2025-11-11 21:36:14,201 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 21:36:14,201 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 21:36:14,201 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 21:36:14,201 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=1, conv_history(str)=17694
2025-11-11 21:36:14,202 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 21:36:14,202 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 21:36:14,202 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 21:36:14,204 - agent.state_manager - INFO - Saved session state for sess-gj0prkm8 (user: admin)
2025-11-11 21:36:14,205 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 21:36:16,542 - agent.session_manager - INFO - [SessionManager] Cancelled session sess-gj0prkm8
2025-11-11 21:36:16,543 - root - INFO - Kill request received for session sess-gj0prkm8
2025-11-11 21:36:17,919 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:36:17,936 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain all the columns and data needed to analyze the limits. Since the previous results include full details for all 16 breached limits, including region_cd, limit_type, utilization, and other attributes, no additional database query is required to further analyze or filter these results.
2025-11-11 21:36:17,937 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 21:36:17,937 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 21:36:17,937 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 21:36:17,942 - agent.state_manager - INFO - Saved session state for sess-gj0prkm8 (user: admin)
2025-11-11 21:36:17,942 - agent.streaming_agent - INFO - [StreamingAgent] Query cancelled for session sess-gj0prkm8
2025-11-11 21:36:17,942 - agent.streaming_agent - INFO - [StreamingAgent] Query cancelled, skipping end_node and conversation history save
2025-11-11 21:36:17,943 - agent.session_manager - INFO - [SessionManager] Unregistered session sess-gj0prkm8
2025-11-11 21:36:22,865 - agent.session_manager - INFO - [SessionManager] Registered session sess-gj0prkm8
2025-11-11 21:36:22,866 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'hi'
2025-11-11 21:36:22,866 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-gj0prkm8
2025-11-11 21:36:22,867 - agent.state_manager - INFO - Loaded session state for sess-gj0prkm8
2025-11-11 21:36:22,867 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 1 turns
2025-11-11 21:36:22,868 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 1 conversation turns
2025-11-11 21:36:22,873 - agent.state_manager - INFO - Saved session state for sess-gj0prkm8 (user: admin)
2025-11-11 21:36:22,874 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 21:36:22,874 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 21:36:22,874 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 21:36:22,874 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=1, conv_history(str)=17694
2025-11-11 21:36:22,875 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 21:36:22,875 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 21:36:22,875 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 21:36:22,879 - agent.state_manager - INFO - Saved session state for sess-gj0prkm8 (user: admin)
2025-11-11 21:36:22,879 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 21:36:24,214 - agent.session_manager - INFO - [SessionManager] Cancelled session sess-gj0prkm8
2025-11-11 21:36:24,214 - root - INFO - Kill request received for session sess-gj0prkm8
2025-11-11 21:36:26,286 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:36:26,289 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain all the columns and data needed to analyze the breached limits. Since the previous results include full details for each limit, including region, limit type, utilization, and other attributes, no additional database query is required to further analyze or filter the existing data.
2025-11-11 21:36:26,289 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 21:36:26,290 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 21:36:26,290 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 21:36:26,296 - agent.state_manager - INFO - Saved session state for sess-gj0prkm8 (user: admin)
2025-11-11 21:36:26,296 - agent.streaming_agent - INFO - [StreamingAgent] Query cancelled for session sess-gj0prkm8
2025-11-11 21:36:26,297 - agent.streaming_agent - INFO - [StreamingAgent] Query cancelled, skipping end_node and conversation history save
2025-11-11 21:36:26,297 - agent.session_manager - INFO - [SessionManager] Unregistered session sess-gj0prkm8
2025-11-11 21:36:29,604 - root - INFO - Client l2UxT_zEEFEa1IyRAAAK joined session room: sess-f6nmwjba
2025-11-11 21:36:30,107 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:36:30] "GET /api/agent/welcome-message HTTP/1.1" 200 -
2025-11-11 21:36:40,022 - agent.session_manager - INFO - [SessionManager] Registered session sess-f6nmwjba
2025-11-11 21:36:40,023 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'Show me breached limits (utilization >= 1.0)'
2025-11-11 21:36:40,023 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-f6nmwjba
2025-11-11 21:36:40,023 - agent.state_manager - WARNING - Session sess-f6nmwjba not found
2025-11-11 21:36:40,023 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 21:36:40,027 - agent.state_manager - INFO - Saved session state for sess-f6nmwjba (user: admin)
2025-11-11 21:36:40,027 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 21:36:40,027 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 21:36:40,028 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 21:36:40,028 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 21:36:40,028 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 21:36:40,028 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 21:36:40,028 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 21:36:40,030 - agent.state_manager - INFO - Saved session state for sess-f6nmwjba (user: admin)
2025-11-11 21:36:43,621 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:36:43,623 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 21:36:43,623 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 21:36:43,624 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 21:36:43,627 - agent.state_manager - INFO - Saved session state for sess-f6nmwjba (user: admin)
2025-11-11 21:36:43,628 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 21:36:43,629 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 21:36:43,629 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 21:36:43,629 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 21:36:43,629 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 21:36:43,629 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 21:36:43,629 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 21:36:43,629 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 21:36:43,629 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 21:36:43,629 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 21:36:43,629 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 21:36:43,629 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 21:36:43,630 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 21:36:43,630 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 21:36:43,630 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 21:36:43,630 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 21:36:46,900 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:36:48,409 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:36:50,056 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 21:36:50,057 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: Show me breached limits (utilization >= 1.0)
2025-11-11 21:36:50,057 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-11 21:36:50,057 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 22626 chars
2025-11-11 21:36:50,057 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 21:36:50,057 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 21:36:52,223 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:36:54,221 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 428 chars
2025-11-11 21:36:54,222 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE utilization >= 1.0 AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
  "explanation": "Retrieve all limits that are breached (utilization >= 1.0) for the most recent date, sorted by utilization in descending order. This follows the business terminology mapping for 'breached' limits, which is defined as utilization >= 1.0.",
  "target_table": "limits_data"
}
2025-11-11 21:36:54,222 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 21:36:54,222 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 21:36:54,222 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE utilization >= 1.0 AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 21:36:54,223 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE utilization >= 1.0 AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 21:36:54,223 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 21:36:54,224 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 21:36:54,224 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 21:36:54,227 - agent.state_manager - INFO - Saved session state for sess-f6nmwjba (user: admin)
2025-11-11 21:36:54,228 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 21:36:54,228 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 21:36:54,228 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 21:36:54,231 - agent.state_manager - INFO - Saved session state for sess-f6nmwjba (user: admin)
2025-11-11 21:36:54,232 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE utilization >= 1.0 AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 21:36:54,232 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 123 chars
2025-11-11 21:36:54,232 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE utilization >= 1.0 AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 21:36:54,232 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE utilization >= 1.0 AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 21:36:54,232 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE utilization >= 1.0 AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 21:36:54,233 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 21:36:54,233 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE utilization >= 1.0 AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-11 21:36:54,321 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 21:36:54,321 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 21:36:54,321 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 21:36:54,322 - agent.state_manager - INFO - Saved session state for sess-f6nmwjba (user: admin)
2025-11-11 21:36:54,322 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=2, columns=41, rows=2, sql=SELECT * FROM limits_data WHERE utilization >= 1.0 AND date = (SELECT MAX(date) FROM limits_data) OR
2025-11-11 21:36:54,322 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 21:36:54,322 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 21:36:54,322 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE utilization >= 1.0 AND date = (SELECT MAX(date) FROM limits_data) OR
2025-11-11 21:36:54,322 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=2, columns=41, rows=2, query_length=123
2025-11-11 21:36:54,322 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 21:36:54,322 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 21:36:54,323 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 3673 chars
2025-11-11 21:36:55,400 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:37:04,407 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1663 chars
2025-11-11 21:37:04,407 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 21:37:04,408 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 21:37:04,409 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 38307 chars
2025-11-11 21:37:13,010 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:37:13,012 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1192 chars
2025-11-11 21:37:13,013 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=2, columns=41, rows=2, query=SELECT * FROM limits_data WHERE utilization >= 1.0 AND date = (SELECT MAX(date) FROM limits_data) OR
2025-11-11 21:37:13,013 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=2, columns=41, rows=2, has_query=True
2025-11-11 21:37:13,013 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE utilization >= 1.0 AND date = (SELECT MAX(date) FROM limits_data) OR...
2025-11-11 21:37:13,013 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE utilization >= 1.0 AND date = (SELECT MAX(date) FROM limits_data) OR...
2025-11-11 21:37:13,014 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 21:37:13,014 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 21:37:13,014 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 21:37:13,021 - agent.state_manager - INFO - Saved session state for sess-f6nmwjba (user: admin)
2025-11-11 21:37:13,022 - agent.streaming_agent - INFO - Agent completed for session sess-f6nmwjba: 32993.763999999996ms, 7 steps
2025-11-11 21:37:13,022 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=2, columns=41, rows=2
2025-11-11 21:37:13,022 - agent.session_manager - INFO - [SessionManager] Unregistered session sess-f6nmwjba
2025-11-11 21:37:53,230 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:37:53] "[32mGET / HTTP/1.1[0m" 302 -
2025-11-11 21:37:53,247 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:37:53] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 21:37:53,266 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:37:53] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:37:53,266 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:37:53] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:37:53,373 - root - INFO - WebSocket client connected: C4Vfe3UKvfBCYrTmAAAN
2025-11-11 21:41:37,919 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-11 21:41:37,936 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-11 21:41:37,936 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-11 21:41:37,937 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-11 21:41:37,937 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-11 21:41:37,960 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:41:37,960 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:41:37,960 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:41:37,960 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:41:37,960 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-11 21:41:37,960 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-11 21:41:37,960 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-11 21:41:37,962 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-11 21:41:37,962 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-11 21:41:37,962 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-11 21:41:37,962 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-11 21:41:37,963 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-11 21:41:37,963 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-11 21:41:37,963 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-11 21:41:37,963 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-11 21:41:37,964 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-11 21:41:37,964 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-11 21:41:37,965 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-11 21:41:37,965 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-11 21:41:38,260 - DuckDbDescribeTableTool - INFO - Found 1 data files in data/duckdb
2025-11-11 21:41:38,300 - DuckDbDescribeTableTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:41:38,307 - DuckDbDescribeTableTool - INFO - Initialization complete: 4 views available
2025-11-11 21:41:38,308 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:41:38,308 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-11 21:41:38,308 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-11 21:41:38,309 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-11 21:41:38,309 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-11 21:41:38,520 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-11 21:41:38,520 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-11 21:41:38,520 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-11 21:41:38,520 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-11 21:41:38,521 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-11 21:41:38,521 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-11 21:41:38,522 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-11 21:41:38,522 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-11 21:41:38,522 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-11 21:41:38,522 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-11 21:41:38,525 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-11 21:41:38,525 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-11 21:41:38,525 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-11 21:41:38,525 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-11 21:41:38,526 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-11 21:41:38,526 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-11 21:41:38,526 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-11 21:41:38,526 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-11 21:41:38,527 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-11 21:41:38,527 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-11 21:41:38,527 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-11 21:41:38,527 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-11 21:41:38,528 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-11 21:41:38,528 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-11 21:41:38,528 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-11 21:41:38,528 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-11 21:41:38,529 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-11 21:41:38,529 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-11 21:41:38,529 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-11 21:41:38,529 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-11 21:41:38,530 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-11 21:41:38,530 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-11 21:41:38,531 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-11 21:41:38,531 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-11 21:41:38,531 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-11 21:41:38,531 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-11 21:41:38,531 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-11 21:41:38,531 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-11 21:41:38,534 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-11 21:41:38,534 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-11 21:41:38,534 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-11 21:41:38,534 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-11 21:41:38,535 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-11 21:41:38,535 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-11 21:41:38,535 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-11 21:41:38,535 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-11 21:41:38,543 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:41:38,544 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:41:38,544 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:41:38,544 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:41:38,544 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-11 21:41:38,544 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-11 21:41:38,544 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-11 21:41:38,544 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-11 21:41:38,544 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-11 21:41:38,544 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-11 21:41:38,544 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-11 21:41:38,545 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-11 21:41:38,545 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-11 21:41:38,545 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-11 21:41:38,545 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-11 21:41:38,545 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-11 21:41:38,545 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-11 21:41:38,546 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-11 21:41:38,546 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-11 21:41:38,546 - DuckDbListFilesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 21:41:38,585 - DuckDbListFilesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:41:38,587 - DuckDbListFilesTool - INFO - Initialization complete: 4 views available
2025-11-11 21:41:38,587 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:41:38,587 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-11 21:41:38,587 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-11 21:41:38,588 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-11 21:41:38,588 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-11 21:41:38,588 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-11 21:41:38,588 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-11 21:41:38,588 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-11 21:41:38,588 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-11 21:41:38,588 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-11 21:41:38,588 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-11 21:41:38,589 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-11 21:41:38,589 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-11 21:41:38,589 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-11 21:41:38,589 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-11 21:41:38,590 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-11 21:41:38,590 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-11 21:41:38,590 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-11 21:41:38,590 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-11 21:41:38,591 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-11 21:41:38,591 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-11 21:41:38,591 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-11 21:41:38,591 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-11 21:41:38,592 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-11 21:41:38,592 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-11 21:41:38,592 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-11 21:41:38,592 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-11 21:41:38,592 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-11 21:41:38,592 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-11 21:41:38,592 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-11 21:41:38,592 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-11 21:41:38,593 - DuckDbGetStatsTool - INFO - Found 1 data files in data/duckdb
2025-11-11 21:41:38,630 - DuckDbGetStatsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:41:38,632 - DuckDbGetStatsTool - INFO - Initialization complete: 4 views available
2025-11-11 21:41:38,632 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:41:38,632 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-11 21:41:38,632 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-11 21:41:38,632 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-11 21:41:38,632 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-11 21:41:38,633 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-11 21:41:38,633 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-11 21:41:38,633 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-11 21:41:38,633 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-11 21:41:38,633 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-11 21:41:38,633 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-11 21:41:38,639 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:41:38,639 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:41:38,639 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:41:38,639 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:41:38,639 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-11 21:41:38,639 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-11 21:41:38,639 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-11 21:41:38,639 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-11 21:41:38,639 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-11 21:41:38,640 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-11 21:41:38,640 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-11 21:41:38,643 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-11 21:41:38,643 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-11 21:41:38,643 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-11 21:41:38,643 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-11 21:41:38,643 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-11 21:41:38,643 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-11 21:41:38,643 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-11 21:41:38,643 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-11 21:41:38,644 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-11 21:41:38,644 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-11 21:41:38,644 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-11 21:41:38,644 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-11 21:41:38,644 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-11 21:41:38,644 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-11 21:41:38,644 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-11 21:41:38,644 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-11 21:41:38,645 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-11 21:41:38,645 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-11 21:41:38,645 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-11 21:41:38,645 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-11 21:41:38,646 - DuckDbListTablesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 21:41:38,681 - DuckDbListTablesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:41:38,682 - DuckDbListTablesTool - INFO - Initialization complete: 4 views available
2025-11-11 21:41:38,682 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:41:38,682 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-11 21:41:38,682 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-11 21:41:38,683 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-11 21:41:38,683 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-11 21:41:38,683 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-11 21:41:38,683 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-11 21:41:38,683 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-11 21:41:38,683 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-11 21:41:38,683 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-11 21:41:38,683 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-11 21:41:38,683 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-11 21:41:38,683 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-11 21:41:38,683 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-11 21:41:38,683 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-11 21:41:38,684 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-11 21:41:38,684 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-11 21:41:38,684 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-11 21:41:38,684 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-11 21:41:38,684 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-11 21:41:38,684 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-11 21:41:38,684 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-11 21:41:38,684 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-11 21:41:38,684 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-11 21:41:38,684 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-11 21:41:38,685 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-11 21:41:38,685 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-11 21:41:38,685 - DuckDbAggregateTool - INFO - Found 1 data files in data/duckdb
2025-11-11 21:41:38,721 - DuckDbAggregateTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:41:38,722 - DuckDbAggregateTool - INFO - Initialization complete: 4 views available
2025-11-11 21:41:38,722 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:41:38,722 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-11 21:41:38,722 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-11 21:41:38,723 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-11 21:41:38,723 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-11 21:41:38,723 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-11 21:41:38,723 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-11 21:41:38,723 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-11 21:41:38,723 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-11 21:41:38,723 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-11 21:41:38,723 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-11 21:41:38,724 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-11 21:41:38,724 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-11 21:41:38,724 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-11 21:41:38,724 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-11 21:41:38,730 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:41:38,730 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:41:38,730 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:41:38,730 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:41:38,730 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-11 21:41:38,730 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-11 21:41:38,730 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-11 21:41:38,730 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-11 21:41:38,730 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-11 21:41:38,730 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-11 21:41:38,730 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-11 21:41:38,730 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-11 21:41:38,730 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-11 21:41:38,730 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-11 21:41:38,731 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-11 21:41:38,731 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-11 21:41:38,731 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-11 21:41:38,731 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-11 21:41:38,731 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-11 21:41:38,731 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-11 21:41:38,731 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-11 21:41:38,731 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-11 21:41:38,731 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-11 21:41:38,731 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-11 21:41:38,731 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-11 21:41:38,731 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-11 21:41:38,732 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-11 21:41:38,732 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-11 21:41:38,732 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-11 21:41:38,732 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-11 21:41:38,732 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-11 21:41:38,732 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-11 21:41:38,732 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-11 21:41:38,732 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-11 21:41:38,732 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-11 21:41:38,733 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-11 21:41:38,733 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-11 21:41:38,733 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-11 21:41:38,733 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-11 21:41:38,733 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-11 21:41:38,733 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-11 21:41:38,733 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-11 21:41:38,733 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-11 21:41:38,734 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-11 21:41:38,734 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-11 21:41:38,734 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-11 21:41:38,734 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-11 21:41:38,734 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-11 21:41:38,734 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-11 21:41:38,734 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-11 21:41:38,734 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-11 21:41:38,734 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-11 21:41:38,734 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-11 21:41:38,734 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-11 21:41:38,734 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-11 21:41:38,735 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-11 21:41:38,735 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-11 21:41:38,735 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-11 21:41:38,735 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-11 21:41:38,735 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-11 21:41:38,735 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-11 21:41:38,735 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-11 21:41:38,735 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-11 21:41:38,736 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-11 21:41:38,736 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-11 21:41:38,737 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-11 21:41:38,737 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-11 21:41:38,737 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-11 21:41:38,737 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-11 21:41:38,737 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-11 21:41:38,737 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-11 21:41:38,737 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-11 21:41:38,737 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-11 21:41:38,737 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-11 21:41:38,737 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-11 21:41:38,744 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:41:38,744 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:41:38,744 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:41:38,744 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:41:38,744 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-11 21:41:38,744 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-11 21:41:38,744 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-11 21:41:38,744 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-11 21:41:38,744 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-11 21:41:38,744 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-11 21:41:38,744 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-11 21:41:38,745 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-11 21:41:38,745 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-11 21:41:38,745 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-11 21:41:38,745 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-11 21:41:38,745 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-11 21:41:38,745 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-11 21:41:38,745 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-11 21:41:38,745 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-11 21:41:38,745 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-11 21:41:38,745 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-11 21:41:38,746 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-11 21:41:38,746 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-11 21:41:38,746 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-11 21:41:38,746 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-11 21:41:38,746 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-11 21:41:38,746 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-11 21:41:38,746 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-11 21:41:38,746 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-11 21:41:38,746 - DuckDbQueryTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 21:41:38,781 - DuckDbQueryTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:41:38,783 - DuckDbQueryTool - INFO - Initialization complete: 4 views available
2025-11-11 21:41:38,783 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:41:38,783 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-11 21:41:38,783 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-11 21:41:38,783 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-11 21:41:38,783 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-11 21:41:38,784 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-11 21:41:38,784 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-11 21:41:38,784 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-11 21:41:38,784 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-11 21:41:38,784 - DuckDbRefreshViewsTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 21:41:38,818 - DuckDbRefreshViewsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 21:41:38,820 - DuckDbRefreshViewsTool - INFO - Initialization complete: 4 views available
2025-11-11 21:41:38,820 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:41:38,820 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-11 21:41:38,820 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-11 21:41:38,820 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-11 21:41:38,820 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-11 21:41:38,820 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-11 21:41:38,820 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-11 21:41:38,827 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:41:38,827 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:41:38,827 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:41:38,827 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:41:38,827 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-11 21:41:38,827 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-11 21:41:38,827 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-11 21:41:38,827 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-11 21:41:38,827 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-11 21:41:38,827 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-11 21:41:38,827 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-11 21:41:38,827 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-11 21:41:38,827 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-11 21:41:38,827 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-11 21:41:38,827 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-11 21:41:38,828 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-11 21:41:38,828 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-11 21:41:38,828 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-11 21:41:38,828 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-11 21:41:38,828 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-11 21:41:38,836 - root - INFO - All routes registered successfully
2025-11-11 21:41:38,841 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.68.51:8000
2025-11-11 21:41:38,841 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-11-11 21:41:39,281 - root - INFO - WebSocket client connected: DXT9G0WLqdOzE2YqAAAC
2025-11-11 21:41:39,281 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:41:39] "GET /socket.io/?EIO=4&transport=polling&t=PfryA_C HTTP/1.1" 200 -
2025-11-11 21:41:39,284 - root - INFO - WebSocket client disconnected: DXT9G0WLqdOzE2YqAAAC
2025-11-11 21:41:39,288 - root - INFO - WebSocket client connected: QphGiPVH3GakPeycAAAD
2025-11-11 21:41:39,288 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:41:39] "POST /socket.io/?EIO=4&transport=polling&t=PfryA_K&sid=XRWP9DGCnYOKcBiCAAAB HTTP/1.1" 200 -
2025-11-11 21:41:39,289 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:41:39] "GET /socket.io/?EIO=4&transport=polling&t=PfryA_L&sid=XRWP9DGCnYOKcBiCAAAB HTTP/1.1" 200 -
2025-11-11 21:41:39,293 - root - INFO - WebSocket client connected: 1wrOL34rRfBdBq3dAAAF
2025-11-11 21:41:39,295 - root - INFO - WebSocket client disconnected: QphGiPVH3GakPeycAAAD
2025-11-11 21:41:39,295 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:41:39] "POST /socket.io/?EIO=4&transport=polling&t=PfryA_S&sid=XRWP9DGCnYOKcBiCAAAB HTTP/1.1" 200 -
2025-11-11 21:41:39,295 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:41:39] "GET /socket.io/?EIO=4&transport=polling&t=PfryA_R&sid=XRWP9DGCnYOKcBiCAAAB HTTP/1.1" 200 -
2025-11-11 21:41:39,296 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:41:39] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:41:39,297 - root - INFO - WebSocket client disconnected: 1wrOL34rRfBdBq3dAAAF
2025-11-11 21:41:39,299 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:41:39,300 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:41:39] "POST /socket.io/?EIO=4&transport=polling&t=PfryA_Y&sid=XRWP9DGCnYOKcBiCAAAB HTTP/1.1" 200 -
2025-11-11 21:41:39,300 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:41:39] "GET /socket.io/?EIO=4&transport=polling&t=PfryA_X&sid=XRWP9DGCnYOKcBiCAAAB HTTP/1.1" 200 -
2025-11-11 21:41:39,311 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:41:39] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:41:39,312 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:41:44,085 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:41:44] "GET /health HTTP/1.1" 200 -
2025-11-11 21:42:12,345 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:42:12] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 21:42:12,366 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:42:12] "GET /login?next=http://localhost:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 21:42:12,397 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:42:12] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:42:12,397 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:42:12] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:42:12,425 - root - INFO - WebSocket client connected: Qohw97wC_W40Io2eAAAH
2025-11-11 21:42:12,427 - root - INFO - WebSocket client disconnected: Qohw97wC_W40Io2eAAAH
2025-11-11 21:42:12,439 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:42:12] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:42:12,439 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:42:16,696 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 21:42:16,696 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 21:42:16,697 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:42:16] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 21:42:16,723 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:42:16] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 21:42:16,746 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:42:16] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:42:16,746 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:42:16] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:42:16,818 - root - INFO - WebSocket client connected: HzPtWuVnLPafHjQzAAAJ
2025-11-11 21:42:16,821 - root - INFO - WebSocket client disconnected: HzPtWuVnLPafHjQzAAAJ
2025-11-11 21:42:16,834 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:42:16] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:42:16,835 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:42:20,058 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:42:20] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 21:42:20,078 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:42:20] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:42:20,079 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:42:20] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:42:20,098 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:42:20] "GET /socket.io/?EIO=4&transport=polling&t=PfryKz0 HTTP/1.1" 200 -
2025-11-11 21:42:20,099 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:42:20] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 21:42:20,102 - root - INFO - WebSocket client connected: EiPDaKfWIILpcgFWAAAL
2025-11-11 21:42:20,102 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:42:20] "POST /socket.io/?EIO=4&transport=polling&t=PfryKz3&sid=gW-iQXd96oEpfgHSAAAK HTTP/1.1" 200 -
2025-11-11 21:42:20,103 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:42:20] "GET /socket.io/?EIO=4&transport=polling&t=PfryKz4&sid=gW-iQXd96oEpfgHSAAAK HTTP/1.1" 200 -
2025-11-11 21:42:20,108 - root - INFO - Client EiPDaKfWIILpcgFWAAAL joined session room: sess-f6nmwjba
2025-11-11 21:42:20,114 - root - INFO - WebSocket client connected: Ji5Ht1oh-FeKUO0JAAAN
2025-11-11 21:42:20,305 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:42:20] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 21:45:37,695 - agent.session_manager - INFO - [SessionManager] Registered session sess-f6nmwjba
2025-11-11 21:45:37,695 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'how many limti do we have with value above 1 million in any currency'
2025-11-11 21:45:37,695 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-f6nmwjba
2025-11-11 21:45:37,697 - agent.state_manager - INFO - Loaded session state for sess-f6nmwjba
2025-11-11 21:45:37,697 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 1 turns
2025-11-11 21:45:37,697 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 1 conversation turns
2025-11-11 21:45:37,703 - agent.state_manager - INFO - Saved session state for sess-f6nmwjba (user: admin)
2025-11-11 21:45:37,703 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 21:45:37,704 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 21:45:37,704 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 21:45:37,705 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=1, conv_history(str)=5420
2025-11-11 21:45:37,705 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 21:45:37,705 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 21:45:37,705 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 21:45:37,708 - agent.state_manager - INFO - Saved session state for sess-f6nmwjba (user: admin)
2025-11-11 21:45:37,708 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 21:45:40,688 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:45:40,702 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain the full details of the two breached limits, including all columns and comprehensive information. Since the previous results returned the complete row data for breached limits, any follow-up analysis or filtering can be done using the existing result set without needing a new database query.
2025-11-11 21:45:40,702 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 21:45:40,702 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 21:45:40,702 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 21:45:40,704 - agent.state_manager - INFO - Saved session state for sess-f6nmwjba (user: admin)
2025-11-11 21:45:44,474 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:45:44,477 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 21:45:44,477 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 21:45:44,478 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 21:45:44,482 - agent.state_manager - INFO - Saved session state for sess-f6nmwjba (user: admin)
2025-11-11 21:45:44,483 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 21:45:44,483 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 21:45:44,483 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 21:45:44,483 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 21:45:44,484 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 21:45:44,484 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 21:45:44,484 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 21:45:44,484 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 21:45:44,484 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 21:45:44,484 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 21:45:44,484 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 5420 characters
2025-11-11 21:45:44,485 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 21:45:44,485 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 21:45:44,485 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 21:45:44,485 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 21:45:44,485 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 21:45:44,485 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 21:45:44,485 - tools.impl.nl_to_sql_planner - INFO -     User Query: Show me breached limits (utilization >= 1.0)
2025-11-11 21:45:44,485 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 21:45:44,485 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 21:45:44,485 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE utilization >= 1.0 AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-11 21:45:44,485 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 21:45:44,485 - tools.impl.nl_to_sql_planner - INFO -     Result Table (2 rows):
2025-11-11 21:45:44,485 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region
2025-11-11 21:45:44,485 - tools.impl.nl_to_sql_planner - INFO -     ... (4820 more characters)
2025-11-11 21:45:44,485 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 21:45:47,915 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:45:49,774 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:45:51,709 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 21:45:51,709 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-11 21:45:51,709 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 21:45:51,709 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 5420
2025-11-11 21:45:51,709 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-11 21:45:51,710 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 2 SQL code blocks, using LAST (most recent)
2025-11-11 21:45:51,710 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-11 21:45:51,710 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT * FROM limits_data 
WHERE utilization >= 1.0 
AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC...
2025-11-11 21:45:51,710 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 126 characters
2025-11-11 21:45:51,710 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-11 21:45:51,710 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-11 21:45:51,710 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 126 characters
2025-11-11 21:45:51,710 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT * FROM limits_data 
WHERE utilization >= 1.0 
AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 21:45:51,710 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT * FROM limits_data 
WHERE utilization >= 1.0 
AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY utilization DESC
2025-11-11 21:45:51,710 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 21:45:51,712 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 21:45:51,712 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: how many limti do we have with value above 1 million in any currency
2025-11-11 21:45:51,712 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10551 chars
2025-11-11 21:45:51,712 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 28037 chars
2025-11-11 21:45:51,712 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 21:45:51,712 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 21:45:54,340 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:45:56,507 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 415 chars
2025-11-11 21:45:56,507 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT COUNT(*) AS limit_count FROM limits_data WHERE exposure_amt > 1000000 AND date = (SELECT MAX(date) FROM limits_data)",
    "explanation": "Counted limits with exposure amount greater than 1 million across all currencies on the latest date. Used MAX(date) to get most recent snapshot. Assumed 'value' means exposure_amt. No specific currency filter applied.",
    "target_table": "limits_data"
}
2025-11-11 21:45:56,507 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 21:45:56,507 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 21:45:56,507 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT COUNT(*) AS limit_count FROM limits_data WHERE exposure_amt > 1000000 AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 21:45:56,507 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT COUNT(*) AS limit_count FROM limits_data WHERE exposure_amt > 1000000 AND date = (SELECT MAX(date) FROM limits_data)
2025-11-11 21:45:56,508 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 21:45:56,508 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 21:45:56,508 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 21:45:56,511 - agent.state_manager - INFO - Saved session state for sess-f6nmwjba (user: admin)
2025-11-11 21:45:56,511 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 21:45:56,511 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 21:45:56,512 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 21:45:56,514 - agent.state_manager - INFO - Saved session state for sess-f6nmwjba (user: admin)
2025-11-11 21:45:56,514 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT COUNT(*) AS limit_count FROM limits_data WHERE exposure_amt > 1000000 AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 21:45:56,514 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 123 chars
2025-11-11 21:45:56,514 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT COUNT(*) AS limit_count FROM limits_data WHERE exposure_amt > 1000000 AND date = (SELECT MAX(date) FROM limits_data)
2025-11-11 21:45:56,515 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT COUNT(*) AS limit_count FROM limits_data WHERE exposure_amt > 1000000 AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 21:45:56,515 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT COUNT(*) AS limit_count FROM limits_data WHERE exposure_amt > 1000000 AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 21:45:56,515 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 21:45:56,515 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT COUNT(*) AS limit_count FROM limits_data WHERE exposure_amt > 1000000 AND date = (SELECT MAX(date) FROM limits_data)...
2025-11-11 21:45:56,638 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 21:45:56,638 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 21:45:56,638 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 21:45:56,640 - agent.state_manager - INFO - Saved session state for sess-f6nmwjba (user: admin)
2025-11-11 21:45:56,641 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=1, columns=1, rows=1, sql=SELECT COUNT(*) AS limit_count FROM limits_data WHERE exposure_amt > 1000000 AND date = (SELECT MAX(
2025-11-11 21:45:56,641 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 21:45:56,641 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 21:45:56,641 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT COUNT(*) AS limit_count FROM limits_data WHERE exposure_amt > 1000000 AND date = (SELECT MAX(
2025-11-11 21:45:56,641 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=1, columns=1, rows=1, query_length=123
2025-11-11 21:45:56,641 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 21:45:56,641 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 21:45:56,641 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 583 chars
2025-11-11 21:45:57,211 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:46:02,916 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1172 chars
2025-11-11 21:46:02,917 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 21:46:02,917 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 21:46:02,918 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 39332 chars
2025-11-11 21:46:10,927 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 21:46:10,928 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1119 chars
2025-11-11 21:46:10,929 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=1, columns=1, rows=1, query=SELECT COUNT(*) AS limit_count FROM limits_data WHERE exposure_amt > 1000000 AND date = (SELECT MAX(
2025-11-11 21:46:10,929 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=1, columns=1, rows=1, has_query=True
2025-11-11 21:46:10,929 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT COUNT(*) AS limit_count FROM limits_data WHERE exposure_amt > 1000000 AND date = (SELECT MAX(...
2025-11-11 21:46:10,929 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT COUNT(*) AS limit_count FROM limits_data WHERE exposure_amt > 1000000 AND date = (SELECT MAX(...
2025-11-11 21:46:10,929 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 21:46:10,929 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 21:46:10,929 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 21:46:10,931 - agent.state_manager - INFO - Saved session state for sess-f6nmwjba (user: admin)
2025-11-11 21:46:10,931 - agent.streaming_agent - INFO - Agent completed for session sess-f6nmwjba: 33226.661ms, 8 steps
2025-11-11 21:46:10,931 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=1, columns=1, rows=1
2025-11-11 21:46:10,931 - agent.session_manager - INFO - [SessionManager] Unregistered session sess-f6nmwjba
2025-11-11 21:51:43,960 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:51:43] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 21:51:43,985 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:51:43] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:51:43,988 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:51:43] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:51:44,052 - root - INFO - WebSocket client connected: W1YxAZ-TJVCbNegCAAAP
2025-11-11 21:51:45,308 - root - INFO - WebSocket client disconnected: W1YxAZ-TJVCbNegCAAAP
2025-11-11 21:51:45,320 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:51:45] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 21:51:45,321 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:51:45] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:51:45,322 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:51:45,340 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:51:45] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:51:45,341 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:51:45] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:51:45,356 - root - INFO - WebSocket client connected: kYKYEQ3tTYTBeM3qAAAR
2025-11-11 21:51:49,019 - root - INFO - WebSocket client disconnected: kYKYEQ3tTYTBeM3qAAAR
2025-11-11 21:51:49,031 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:51:49] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:51:49,033 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:51:49,038 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:51:49] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 21:51:49,061 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:51:49] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:51:49,063 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:51:49] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:51:49,095 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:51:49] "GET /socket.io/?EIO=4&transport=polling&t=Pfr-VtX HTTP/1.1" 200 -
2025-11-11 21:51:49,097 - root - INFO - WebSocket client connected: MBHJjnYyPkljGmk0AAAU
2025-11-11 21:51:49,097 - root - INFO - WebSocket client connected: Yr6ajVlEmLvwjNPhAAAV
2025-11-11 21:51:49,097 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:51:49] "POST /socket.io/?EIO=4&transport=polling&t=Pfr-Vte&sid=77H0RzvFpc2bI4BQAAAS HTTP/1.1" 200 -
2025-11-11 21:51:49,098 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:51:49] "GET /socket.io/?EIO=4&transport=polling&t=Pfr-Vte.0&sid=77H0RzvFpc2bI4BQAAAS HTTP/1.1" 200 -
2025-11-11 21:51:49,099 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:51:49] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 21:51:49,102 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:51:49] "POST /socket.io/?EIO=4&transport=polling&t=Pfr-Vti.0&sid=77H0RzvFpc2bI4BQAAAS HTTP/1.1" 200 -
2025-11-11 21:51:49,102 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:51:49] "GET /socket.io/?EIO=4&transport=polling&t=Pfr-Vti&sid=77H0RzvFpc2bI4BQAAAS HTTP/1.1" 200 -
2025-11-11 21:51:49,103 - root - INFO - Client MBHJjnYyPkljGmk0AAAU joined session room: sess-f6nmwjba
2025-11-11 21:51:49,103 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:51:49] "POST /socket.io/?EIO=4&transport=polling&t=Pfr-Vtk.0&sid=77H0RzvFpc2bI4BQAAAS HTTP/1.1" 200 -
2025-11-11 21:51:49,103 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:51:49] "GET /socket.io/?EIO=4&transport=polling&t=Pfr-Vtk&sid=77H0RzvFpc2bI4BQAAAS HTTP/1.1" 200 -
2025-11-11 21:51:49,111 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:51:49] "GET /socket.io/?EIO=4&transport=polling&t=Pfr-Vtm&sid=77H0RzvFpc2bI4BQAAAS HTTP/1.1" 200 -
2025-11-11 21:51:49,297 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:51:49] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 21:52:31,541 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-11 21:52:31,556 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-11 21:52:31,556 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-11 21:52:31,557 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-11 21:52:31,557 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-11 21:52:31,580 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:52:31,580 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:52:31,580 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:52:31,580 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:52:31,580 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-11 21:52:31,580 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-11 21:52:31,580 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-11 21:52:31,582 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-11 21:52:31,582 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-11 21:52:31,582 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-11 21:52:31,582 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-11 21:52:31,583 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-11 21:52:31,583 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-11 21:52:31,583 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-11 21:52:31,583 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-11 21:52:31,584 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-11 21:52:31,584 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-11 21:52:31,585 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-11 21:52:31,585 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-11 21:52:31,595 - DuckDbDescribeTableTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 49117) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 21:52:31,595 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:52:31,595 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-11 21:52:31,595 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-11 21:52:31,596 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-11 21:52:31,596 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-11 21:52:31,814 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-11 21:52:31,814 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-11 21:52:31,815 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-11 21:52:31,815 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-11 21:52:31,816 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-11 21:52:31,816 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-11 21:52:31,816 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-11 21:52:31,816 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-11 21:52:31,816 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-11 21:52:31,816 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-11 21:52:31,821 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-11 21:52:31,821 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-11 21:52:31,821 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-11 21:52:31,822 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-11 21:52:31,822 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-11 21:52:31,822 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-11 21:52:31,823 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-11 21:52:31,823 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-11 21:52:31,824 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-11 21:52:31,824 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-11 21:52:31,825 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-11 21:52:31,825 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-11 21:52:31,825 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-11 21:52:31,825 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-11 21:52:31,826 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-11 21:52:31,827 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-11 21:52:31,829 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-11 21:52:31,829 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-11 21:52:31,830 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-11 21:52:31,830 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-11 21:52:31,831 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-11 21:52:31,831 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-11 21:52:31,832 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-11 21:52:31,832 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-11 21:52:31,832 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-11 21:52:31,833 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-11 21:52:31,833 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-11 21:52:31,833 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-11 21:52:31,836 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-11 21:52:31,836 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-11 21:52:31,836 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-11 21:52:31,836 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-11 21:52:31,836 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-11 21:52:31,836 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-11 21:52:31,836 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-11 21:52:31,836 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-11 21:52:31,843 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:52:31,844 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:52:31,844 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:52:31,844 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:52:31,844 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-11 21:52:31,844 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-11 21:52:31,844 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-11 21:52:31,844 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-11 21:52:31,844 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-11 21:52:31,844 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-11 21:52:31,844 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-11 21:52:31,845 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-11 21:52:31,845 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-11 21:52:31,845 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-11 21:52:31,846 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-11 21:52:31,846 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-11 21:52:31,846 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-11 21:52:31,846 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-11 21:52:31,846 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-11 21:52:31,851 - DuckDbListFilesTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 49117) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 21:52:31,851 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:52:31,851 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-11 21:52:31,851 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-11 21:52:31,851 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-11 21:52:31,851 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-11 21:52:31,852 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-11 21:52:31,852 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-11 21:52:31,852 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-11 21:52:31,852 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-11 21:52:31,852 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-11 21:52:31,852 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-11 21:52:31,852 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-11 21:52:31,852 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-11 21:52:31,852 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-11 21:52:31,853 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-11 21:52:31,853 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-11 21:52:31,853 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-11 21:52:31,853 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-11 21:52:31,853 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-11 21:52:31,853 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-11 21:52:31,853 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-11 21:52:31,853 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-11 21:52:31,853 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-11 21:52:31,854 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-11 21:52:31,854 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-11 21:52:31,854 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-11 21:52:31,854 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-11 21:52:31,854 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-11 21:52:31,854 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-11 21:52:31,854 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-11 21:52:31,854 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-11 21:52:31,858 - DuckDbGetStatsTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 49117) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 21:52:31,858 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:52:31,858 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-11 21:52:31,858 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-11 21:52:31,858 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-11 21:52:31,858 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-11 21:52:31,858 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-11 21:52:31,858 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-11 21:52:31,858 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-11 21:52:31,858 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-11 21:52:31,858 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-11 21:52:31,859 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-11 21:52:31,865 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:52:31,865 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:52:31,865 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:52:31,865 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:52:31,865 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-11 21:52:31,865 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-11 21:52:31,865 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-11 21:52:31,865 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-11 21:52:31,865 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-11 21:52:31,866 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-11 21:52:31,866 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-11 21:52:31,869 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-11 21:52:31,869 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-11 21:52:31,869 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-11 21:52:31,869 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-11 21:52:31,869 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-11 21:52:31,869 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-11 21:52:31,870 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-11 21:52:31,870 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-11 21:52:31,870 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-11 21:52:31,870 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-11 21:52:31,870 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-11 21:52:31,870 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-11 21:52:31,870 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-11 21:52:31,870 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-11 21:52:31,870 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-11 21:52:31,870 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-11 21:52:31,871 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-11 21:52:31,871 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-11 21:52:31,871 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-11 21:52:31,871 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-11 21:52:31,874 - DuckDbListTablesTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 49117) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 21:52:31,875 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:52:31,875 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-11 21:52:31,875 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-11 21:52:31,875 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-11 21:52:31,875 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-11 21:52:31,875 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-11 21:52:31,875 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-11 21:52:31,875 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-11 21:52:31,875 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-11 21:52:31,875 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-11 21:52:31,875 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-11 21:52:31,875 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-11 21:52:31,876 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-11 21:52:31,876 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-11 21:52:31,876 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-11 21:52:31,876 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-11 21:52:31,876 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-11 21:52:31,876 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-11 21:52:31,876 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-11 21:52:31,876 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-11 21:52:31,876 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-11 21:52:31,876 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-11 21:52:31,877 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-11 21:52:31,877 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-11 21:52:31,877 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-11 21:52:31,877 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-11 21:52:31,877 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-11 21:52:31,881 - DuckDbAggregateTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 49117) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 21:52:31,882 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:52:31,882 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-11 21:52:31,882 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-11 21:52:31,882 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-11 21:52:31,882 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-11 21:52:31,882 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-11 21:52:31,882 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-11 21:52:31,882 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-11 21:52:31,882 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-11 21:52:31,882 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-11 21:52:31,883 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-11 21:52:31,883 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-11 21:52:31,883 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-11 21:52:31,883 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-11 21:52:31,883 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-11 21:52:31,890 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:52:31,890 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:52:31,890 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:52:31,890 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:52:31,890 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-11 21:52:31,890 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-11 21:52:31,890 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-11 21:52:31,890 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-11 21:52:31,890 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-11 21:52:31,890 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-11 21:52:31,890 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-11 21:52:31,890 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-11 21:52:31,890 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-11 21:52:31,891 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-11 21:52:31,891 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-11 21:52:31,891 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-11 21:52:31,891 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-11 21:52:31,891 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-11 21:52:31,891 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-11 21:52:31,891 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-11 21:52:31,891 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-11 21:52:31,891 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-11 21:52:31,891 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-11 21:52:31,892 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-11 21:52:31,892 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-11 21:52:31,892 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-11 21:52:31,892 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-11 21:52:31,892 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-11 21:52:31,892 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-11 21:52:31,892 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-11 21:52:31,892 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-11 21:52:31,893 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-11 21:52:31,893 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-11 21:52:31,893 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-11 21:52:31,893 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-11 21:52:31,894 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-11 21:52:31,894 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-11 21:52:31,894 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-11 21:52:31,894 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-11 21:52:31,894 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-11 21:52:31,894 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-11 21:52:31,894 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-11 21:52:31,894 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-11 21:52:31,894 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-11 21:52:31,894 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-11 21:52:31,895 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-11 21:52:31,895 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-11 21:52:31,895 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-11 21:52:31,895 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-11 21:52:31,895 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-11 21:52:31,895 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-11 21:52:31,895 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-11 21:52:31,895 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-11 21:52:31,895 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-11 21:52:31,895 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-11 21:52:31,895 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-11 21:52:31,895 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-11 21:52:31,896 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-11 21:52:31,896 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-11 21:52:31,896 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-11 21:52:31,896 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-11 21:52:31,896 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-11 21:52:31,897 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-11 21:52:31,897 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-11 21:52:31,897 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-11 21:52:31,897 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-11 21:52:31,897 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-11 21:52:31,897 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-11 21:52:31,897 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-11 21:52:31,898 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-11 21:52:31,898 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-11 21:52:31,898 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-11 21:52:31,898 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-11 21:52:31,898 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-11 21:52:31,898 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-11 21:52:31,905 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:52:31,905 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:52:31,905 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:52:31,905 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:52:31,905 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-11 21:52:31,905 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-11 21:52:31,905 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-11 21:52:31,906 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-11 21:52:31,906 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-11 21:52:31,906 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-11 21:52:31,906 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-11 21:52:31,906 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-11 21:52:31,906 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-11 21:52:31,907 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-11 21:52:31,907 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-11 21:52:31,907 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-11 21:52:31,907 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-11 21:52:31,907 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-11 21:52:31,907 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-11 21:52:31,907 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-11 21:52:31,907 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-11 21:52:31,908 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-11 21:52:31,908 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-11 21:52:31,908 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-11 21:52:31,908 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-11 21:52:31,909 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-11 21:52:31,909 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-11 21:52:31,909 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-11 21:52:31,909 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-11 21:52:31,913 - DuckDbQueryTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 49117) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 21:52:31,913 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:52:31,913 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-11 21:52:31,913 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-11 21:52:31,913 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-11 21:52:31,913 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-11 21:52:31,913 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-11 21:52:31,913 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-11 21:52:31,914 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-11 21:52:31,914 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-11 21:52:31,917 - DuckDbRefreshViewsTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 49117) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 21:52:31,917 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 21:52:31,917 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-11 21:52:31,917 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-11 21:52:31,917 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-11 21:52:31,917 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-11 21:52:31,917 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-11 21:52:31,917 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-11 21:52:31,924 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 21:52:31,924 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 21:52:31,924 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 21:52:31,924 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 21:52:31,924 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-11 21:52:31,924 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-11 21:52:31,924 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-11 21:52:31,924 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-11 21:52:31,924 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-11 21:52:31,924 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-11 21:52:31,925 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-11 21:52:31,925 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-11 21:52:31,925 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-11 21:52:31,925 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-11 21:52:31,925 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-11 21:52:31,925 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-11 21:52:31,925 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-11 21:52:31,926 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-11 21:52:31,926 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-11 21:52:31,926 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-11 21:52:31,932 - root - INFO - All routes registered successfully
2025-11-11 21:52:32,922 - DuckDbRefreshViewsTool - INFO - Auto-refresh stopped
2025-11-11 21:52:33,917 - DuckDbQueryTool - INFO - Auto-refresh stopped
2025-11-11 21:52:34,788 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:52:34] "GET /health HTTP/1.1" 200 -
2025-11-11 21:52:34,893 - DuckDbAggregateTool - INFO - Auto-refresh stopped
2025-11-11 21:52:35,894 - DuckDbListTablesTool - INFO - Auto-refresh stopped
2025-11-11 21:52:36,882 - DuckDbGetStatsTool - INFO - Auto-refresh stopped
2025-11-11 21:52:37,871 - DuckDbListFilesTool - INFO - Auto-refresh stopped
2025-11-11 21:52:38,631 - DuckDbDescribeTableTool - INFO - Auto-refresh stopped
2025-11-11 21:55:37,485 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:37] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 21:55:37,553 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:37] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:55:37,554 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:37] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:55:37,592 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:37] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_Nfs HTTP/1.1" 200 -
2025-11-11 21:55:37,596 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:37] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 21:55:37,600 - root - INFO - WebSocket client connected: GQIjNkgHQzX4kkQFAAAY
2025-11-11 21:55:37,602 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:37] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_Nfy&sid=rYH_7mSoUK_25ZpfAAAW HTTP/1.1" 200 -
2025-11-11 21:55:37,602 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:37] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_Nfz&sid=rYH_7mSoUK_25ZpfAAAW HTTP/1.1" 200 -
2025-11-11 21:55:37,603 - root - INFO - WebSocket client connected: nGxsf6sJ9Us33OhsAAAZ
2025-11-11 21:55:37,606 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:37] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_Ng4&sid=rYH_7mSoUK_25ZpfAAAW HTTP/1.1" 200 -
2025-11-11 21:55:37,606 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:37] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_Ng3&sid=rYH_7mSoUK_25ZpfAAAW HTTP/1.1" 200 -
2025-11-11 21:55:37,608 - root - INFO - Client GQIjNkgHQzX4kkQFAAAY joined session room: sess-f6nmwjba
2025-11-11 21:55:37,608 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:37] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_Ng6.0&sid=rYH_7mSoUK_25ZpfAAAW HTTP/1.1" 200 -
2025-11-11 21:55:37,608 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:37] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_Ng6&sid=rYH_7mSoUK_25ZpfAAAW HTTP/1.1" 200 -
2025-11-11 21:55:37,610 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:37] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_Ng9&sid=rYH_7mSoUK_25ZpfAAAW HTTP/1.1" 200 -
2025-11-11 21:55:37,799 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:37] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 21:55:39,217 - root - INFO - WebSocket client disconnected: nGxsf6sJ9Us33OhsAAAZ
2025-11-11 21:55:39,214 - root - INFO - WebSocket client disconnected: GQIjNkgHQzX4kkQFAAAY
2025-11-11 21:55:39,220 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:39] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 21:55:39,220 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:39] "GET /socket.io/?EIO=4&transport=websocket&sid=rYH_7mSoUK_25ZpfAAAW HTTP/1.1" 200 -
2025-11-11 21:55:39,225 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:39] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:55:39,226 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:55:39,242 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:39] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:55:39,243 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:39] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:55:39,251 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:39] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_O3n HTTP/1.1" 200 -
2025-11-11 21:55:39,253 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:39] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 21:55:39,257 - root - INFO - WebSocket client connected: Rikm3cjXqpOFyoPSAAAc
2025-11-11 21:55:39,258 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:39] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_O3s&sid=wqpVh5E-iu6MBPU7AAAa HTTP/1.1" 200 -
2025-11-11 21:55:39,259 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:39] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_O3t&sid=wqpVh5E-iu6MBPU7AAAa HTTP/1.1" 200 -
2025-11-11 21:55:39,260 - root - INFO - WebSocket client connected: 86JL3fMX3-X2M_aNAAAd
2025-11-11 21:55:39,263 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:39] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_O3y.0&sid=wqpVh5E-iu6MBPU7AAAa HTTP/1.1" 200 -
2025-11-11 21:55:39,263 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:39] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_O3y&sid=wqpVh5E-iu6MBPU7AAAa HTTP/1.1" 200 -
2025-11-11 21:55:39,265 - root - INFO - Client Rikm3cjXqpOFyoPSAAAc joined session room: sess-f6nmwjba
2025-11-11 21:55:39,266 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:39] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_O40.0&sid=wqpVh5E-iu6MBPU7AAAa HTTP/1.1" 200 -
2025-11-11 21:55:39,266 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:39] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_O40&sid=wqpVh5E-iu6MBPU7AAAa HTTP/1.1" 200 -
2025-11-11 21:55:39,270 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:39] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_O42&sid=wqpVh5E-iu6MBPU7AAAa HTTP/1.1" 200 -
2025-11-11 21:55:39,458 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:39] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 21:55:48,481 - root - INFO - WebSocket client disconnected: Rikm3cjXqpOFyoPSAAAc
2025-11-11 21:55:48,481 - root - INFO - WebSocket client disconnected: 86JL3fMX3-X2M_aNAAAd
2025-11-11 21:55:48,482 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:48] "GET /socket.io/?EIO=4&transport=websocket&sid=wqpVh5E-iu6MBPU7AAAa HTTP/1.1" 200 -
2025-11-11 21:55:48,485 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:48] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 21:55:48,490 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:48] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:55:48,491 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:55:48,505 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:48] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:55:48,506 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:48] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:55:48,520 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:48] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_QKb HTTP/1.1" 200 -
2025-11-11 21:55:48,522 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:48] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 21:55:48,525 - root - INFO - WebSocket client connected: tSRNfSlhEXaYVYveAAAg
2025-11-11 21:55:48,525 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:48] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_QKf&sid=Sn_BXNvEKUcY2ZsmAAAe HTTP/1.1" 200 -
2025-11-11 21:55:48,526 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:48] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_QKg&sid=Sn_BXNvEKUcY2ZsmAAAe HTTP/1.1" 200 -
2025-11-11 21:55:48,526 - root - INFO - WebSocket client connected: Uv0U0HRZbjYRhqVGAAAh
2025-11-11 21:55:48,529 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:48] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_QKl.0&sid=Sn_BXNvEKUcY2ZsmAAAe HTTP/1.1" 200 -
2025-11-11 21:55:48,530 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:48] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_QKl&sid=Sn_BXNvEKUcY2ZsmAAAe HTTP/1.1" 200 -
2025-11-11 21:55:48,532 - root - INFO - Client tSRNfSlhEXaYVYveAAAg joined session room: sess-f6nmwjba
2025-11-11 21:55:48,532 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:48] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_QKo.0&sid=Sn_BXNvEKUcY2ZsmAAAe HTTP/1.1" 200 -
2025-11-11 21:55:48,532 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:48] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_QKo&sid=Sn_BXNvEKUcY2ZsmAAAe HTTP/1.1" 200 -
2025-11-11 21:55:48,536 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:48] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_QKr&sid=Sn_BXNvEKUcY2ZsmAAAe HTTP/1.1" 200 -
2025-11-11 21:55:48,726 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:48] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 21:55:53,909 - root - INFO - WebSocket client disconnected: tSRNfSlhEXaYVYveAAAg
2025-11-11 21:55:53,909 - root - INFO - WebSocket client disconnected: Uv0U0HRZbjYRhqVGAAAh
2025-11-11 21:55:53,910 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:53] "GET /socket.io/?EIO=4&transport=websocket&sid=Sn_BXNvEKUcY2ZsmAAAe HTTP/1.1" 200 -
2025-11-11 21:55:53,921 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:53] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:55:53,922 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:55:55,713 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:55] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 21:55:55,777 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:55] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:55:55,779 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:55] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:55:55,796 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:55] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_S6I HTTP/1.1" 200 -
2025-11-11 21:55:55,798 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:55] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 21:55:55,815 - root - INFO - WebSocket client connected: SjbpzhA41cAsKDf0AAAj
2025-11-11 21:55:55,816 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:55] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_S6b&sid=6SlkJP3lsWsMM4DlAAAi HTTP/1.1" 200 -
2025-11-11 21:55:55,817 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:55] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_S6b.0&sid=6SlkJP3lsWsMM4DlAAAi HTTP/1.1" 200 -
2025-11-11 21:55:55,820 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:55] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_S6g&sid=6SlkJP3lsWsMM4DlAAAi HTTP/1.1" 200 -
2025-11-11 21:55:55,821 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:55] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_S6g.0&sid=6SlkJP3lsWsMM4DlAAAi HTTP/1.1" 200 -
2025-11-11 21:55:55,824 - root - INFO - Client SjbpzhA41cAsKDf0AAAj joined session room: sess-f6nmwjba
2025-11-11 21:55:55,829 - root - INFO - WebSocket client connected: Tg1eC1qudHs6IRu7AAAl
2025-11-11 21:55:56,002 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:56] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 21:55:56,439 - root - INFO - WebSocket client disconnected: Tg1eC1qudHs6IRu7AAAl
2025-11-11 21:55:56,440 - root - INFO - WebSocket client disconnected: SjbpzhA41cAsKDf0AAAj
2025-11-11 21:55:56,440 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:56] "GET /socket.io/?EIO=4&transport=websocket&sid=6SlkJP3lsWsMM4DlAAAi HTTP/1.1" 200 -
2025-11-11 21:55:56,452 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:56] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:55:56,454 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:55:56,476 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:56] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 21:55:56,534 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:56] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:55:56,535 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:56] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:55:56,574 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:56] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_SIR HTTP/1.1" 200 -
2025-11-11 21:55:56,576 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:56] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 21:55:56,581 - root - INFO - WebSocket client connected: tQ3P-IupI3tlvXA8AAAo
2025-11-11 21:55:56,582 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:56] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_SIX&sid=8u1WLxaBCEqxW_tHAAAm HTTP/1.1" 200 -
2025-11-11 21:55:56,582 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:56] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_SIY&sid=8u1WLxaBCEqxW_tHAAAm HTTP/1.1" 200 -
2025-11-11 21:55:56,583 - root - INFO - WebSocket client connected: zlpanybGGaj0U9agAAAp
2025-11-11 21:55:56,586 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:56] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_SIe&sid=8u1WLxaBCEqxW_tHAAAm HTTP/1.1" 200 -
2025-11-11 21:55:56,586 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:56] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_SId&sid=8u1WLxaBCEqxW_tHAAAm HTTP/1.1" 200 -
2025-11-11 21:55:56,589 - root - INFO - Client tQ3P-IupI3tlvXA8AAAo joined session room: sess-f6nmwjba
2025-11-11 21:55:56,589 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:56] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_SIh.0&sid=8u1WLxaBCEqxW_tHAAAm HTTP/1.1" 200 -
2025-11-11 21:55:56,589 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:56] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_SIh&sid=8u1WLxaBCEqxW_tHAAAm HTTP/1.1" 200 -
2025-11-11 21:55:56,591 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:56] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_SIk&sid=8u1WLxaBCEqxW_tHAAAm HTTP/1.1" 200 -
2025-11-11 21:55:56,592 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:56] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_SIl&sid=8u1WLxaBCEqxW_tHAAAm HTTP/1.1" 200 -
2025-11-11 21:55:56,779 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:56] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 21:55:56,997 - root - INFO - WebSocket client disconnected: tQ3P-IupI3tlvXA8AAAo
2025-11-11 21:55:56,997 - root - INFO - WebSocket client disconnected: zlpanybGGaj0U9agAAAp
2025-11-11 21:55:56,998 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:56] "GET /socket.io/?EIO=4&transport=websocket&sid=8u1WLxaBCEqxW_tHAAAm HTTP/1.1" 200 -
2025-11-11 21:55:57,010 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:55:57,012 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:55:57,032 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 21:55:57,085 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:55:57,087 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:55:57,125 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_SR1 HTTP/1.1" 200 -
2025-11-11 21:55:57,128 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 21:55:57,130 - root - INFO - WebSocket client connected: _sq4DDirBU3Dyen2AAAs
2025-11-11 21:55:57,131 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_SR8&sid=qiC-6SDcAppJ6BlCAAAq HTTP/1.1" 200 -
2025-11-11 21:55:57,132 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_SR8.0&sid=qiC-6SDcAppJ6BlCAAAq HTTP/1.1" 200 -
2025-11-11 21:55:57,133 - root - INFO - WebSocket client connected: ZAkkXeVcVbSBO7uhAAAt
2025-11-11 21:55:57,135 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_SRD.0&sid=qiC-6SDcAppJ6BlCAAAq HTTP/1.1" 200 -
2025-11-11 21:55:57,136 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_SRD&sid=qiC-6SDcAppJ6BlCAAAq HTTP/1.1" 200 -
2025-11-11 21:55:57,138 - root - INFO - Client _sq4DDirBU3Dyen2AAAs joined session room: sess-f6nmwjba
2025-11-11 21:55:57,138 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_SRG.0&sid=qiC-6SDcAppJ6BlCAAAq HTTP/1.1" 200 -
2025-11-11 21:55:57,138 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_SRG&sid=qiC-6SDcAppJ6BlCAAAq HTTP/1.1" 200 -
2025-11-11 21:55:57,142 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_SRJ&sid=qiC-6SDcAppJ6BlCAAAq HTTP/1.1" 200 -
2025-11-11 21:55:57,329 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 21:55:57,563 - root - INFO - WebSocket client disconnected: _sq4DDirBU3Dyen2AAAs
2025-11-11 21:55:57,564 - root - INFO - WebSocket client disconnected: ZAkkXeVcVbSBO7uhAAAt
2025-11-11 21:55:57,566 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "GET /socket.io/?EIO=4&transport=websocket&sid=qiC-6SDcAppJ6BlCAAAq HTTP/1.1" 200 -
2025-11-11 21:55:57,578 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:55:57,579 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:55:57,600 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 21:55:57,702 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_Sa5 HTTP/1.1" 200 -
2025-11-11 21:55:57,707 - root - INFO - WebSocket client connected: 8-NCwwupWQXymaj5AAAw
2025-11-11 21:55:57,710 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_Sa8&sid=10TYrrcr8OCnW1SvAAAu HTTP/1.1" 200 -
2025-11-11 21:55:57,710 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_Sa9&sid=10TYrrcr8OCnW1SvAAAu HTTP/1.1" 200 -
2025-11-11 21:55:57,712 - root - INFO - WebSocket client connected: 2-uEr9k_rQqwbmD2AAAx
2025-11-11 21:55:57,713 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_SaF.0&sid=10TYrrcr8OCnW1SvAAAu HTTP/1.1" 200 -
2025-11-11 21:55:57,713 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_SaF&sid=10TYrrcr8OCnW1SvAAAu HTTP/1.1" 200 -
2025-11-11 21:55:57,716 - root - INFO - Client 8-NCwwupWQXymaj5AAAw joined session room: sess-f6nmwjba
2025-11-11 21:55:57,716 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_SaI.0&sid=10TYrrcr8OCnW1SvAAAu HTTP/1.1" 200 -
2025-11-11 21:55:57,717 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_SaI&sid=10TYrrcr8OCnW1SvAAAu HTTP/1.1" 200 -
2025-11-11 21:55:57,721 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_SaL&sid=10TYrrcr8OCnW1SvAAAu HTTP/1.1" 200 -
2025-11-11 21:55:57,910 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:57] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 21:55:58,048 - root - INFO - WebSocket client disconnected: 2-uEr9k_rQqwbmD2AAAx
2025-11-11 21:55:58,049 - root - INFO - WebSocket client disconnected: 8-NCwwupWQXymaj5AAAw
2025-11-11 21:55:58,049 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:58] "GET /socket.io/?EIO=4&transport=websocket&sid=10TYrrcr8OCnW1SvAAAu HTTP/1.1" 200 -
2025-11-11 21:55:58,061 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:55:58] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:55:58,062 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:56:03,637 - root - INFO - WebSocket client disconnected: EiPDaKfWIILpcgFWAAAL
2025-11-11 21:56:03,638 - root - INFO - WebSocket client disconnected: Ji5Ht1oh-FeKUO0JAAAN
2025-11-11 21:56:03,639 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:03] "GET /socket.io/?EIO=4&transport=websocket&sid=gW-iQXd96oEpfgHSAAAK HTTP/1.1" 200 -
2025-11-11 21:56:03,642 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:03] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 21:56:03,647 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:03] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:56:03,648 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:56:03,669 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:03] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 21:56:03,670 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:03] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 21:56:03,712 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:03] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_U1- HTTP/1.1" 200 -
2025-11-11 21:56:03,715 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:03] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 21:56:03,718 - root - INFO - WebSocket client connected: 56ek4QX_T0kP2U2gAAA0
2025-11-11 21:56:03,720 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:03] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_U22&sid=WxsaDR9heV-zUO3lAAAy HTTP/1.1" 200 -
2025-11-11 21:56:03,720 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:03] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_U23&sid=WxsaDR9heV-zUO3lAAAy HTTP/1.1" 200 -
2025-11-11 21:56:03,721 - root - INFO - WebSocket client connected: K0tPlFGkTwYzYIqrAAA1
2025-11-11 21:56:03,724 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:03] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_U2A.0&sid=WxsaDR9heV-zUO3lAAAy HTTP/1.1" 200 -
2025-11-11 21:56:03,724 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:03] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_U2A&sid=WxsaDR9heV-zUO3lAAAy HTTP/1.1" 200 -
2025-11-11 21:56:03,727 - root - INFO - Client 56ek4QX_T0kP2U2gAAA0 joined session room: sess-f6nmwjba
2025-11-11 21:56:03,727 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:03] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_U2D.0&sid=WxsaDR9heV-zUO3lAAAy HTTP/1.1" 200 -
2025-11-11 21:56:03,728 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:03] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_U2D&sid=WxsaDR9heV-zUO3lAAAy HTTP/1.1" 200 -
2025-11-11 21:56:03,729 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:03] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_U2H&sid=WxsaDR9heV-zUO3lAAAy HTTP/1.1" 200 -
2025-11-11 21:56:03,736 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:03] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-11-11 21:56:03,917 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:03] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 21:56:21,166 - root - INFO - WebSocket client disconnected: MBHJjnYyPkljGmk0AAAU
2025-11-11 21:56:21,169 - root - INFO - WebSocket client disconnected: Yr6ajVlEmLvwjNPhAAAV
2025-11-11 21:56:21,170 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:21] "GET /socket.io/?EIO=4&transport=websocket&sid=77H0RzvFpc2bI4BQAAAS HTTP/1.1" 200 -
2025-11-11 21:56:21,172 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:21] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 21:56:21,180 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:21] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:56:21,182 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:56:21,197 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:21] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:56:21,198 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:21] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:56:21,230 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:21] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_YJi HTTP/1.1" 200 -
2025-11-11 21:56:21,234 - root - INFO - WebSocket client connected: f54D8BW8pks8WYJkAAA4
2025-11-11 21:56:21,235 - root - INFO - WebSocket client connected: -3C67qzmCwGBzzSuAAA5
2025-11-11 21:56:21,235 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:21] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_YJm&sid=bO6uLjouV-4IbESJAAA2 HTTP/1.1" 200 -
2025-11-11 21:56:21,236 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:21] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_YJm.0&sid=bO6uLjouV-4IbESJAAA2 HTTP/1.1" 200 -
2025-11-11 21:56:21,237 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:21] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 21:56:21,239 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:21] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_YJs&sid=bO6uLjouV-4IbESJAAA2 HTTP/1.1" 200 -
2025-11-11 21:56:21,239 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:21] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_YJr&sid=bO6uLjouV-4IbESJAAA2 HTTP/1.1" 200 -
2025-11-11 21:56:21,243 - root - INFO - Client f54D8BW8pks8WYJkAAA4 joined session room: sess-f6nmwjba
2025-11-11 21:56:21,243 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:21] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_YJu.0&sid=bO6uLjouV-4IbESJAAA2 HTTP/1.1" 200 -
2025-11-11 21:56:21,244 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:21] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_YJu&sid=bO6uLjouV-4IbESJAAA2 HTTP/1.1" 200 -
2025-11-11 21:56:21,246 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:21] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_YJz&sid=bO6uLjouV-4IbESJAAA2 HTTP/1.1" 200 -
2025-11-11 21:56:21,439 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:21] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 21:56:26,121 - root - INFO - WebSocket client disconnected: f54D8BW8pks8WYJkAAA4
2025-11-11 21:56:26,121 - root - INFO - WebSocket client disconnected: -3C67qzmCwGBzzSuAAA5
2025-11-11 21:56:26,121 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:26] "GET /socket.io/?EIO=4&transport=websocket&sid=bO6uLjouV-4IbESJAAA2 HTTP/1.1" 200 -
2025-11-11 21:56:26,122 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:26] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 21:56:26,123 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 21:56:37,869 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:37] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 21:56:37,872 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:37] "GET /login?next=http://localhost:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 21:56:37,886 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:37] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 21:56:37,886 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:37] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 21:56:42,313 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 21:56:42,313 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 21:56:42,314 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:42] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 21:56:42,325 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:42] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 21:56:42,343 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:42] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:56:42,344 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:42] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:56:45,321 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:45] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 21:56:45,335 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:45] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 21:56:45,336 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:45] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:56:45,391 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:45] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_eDD HTTP/1.1" 200 -
2025-11-11 21:56:45,393 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:45] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 21:56:45,399 - root - INFO - WebSocket client connected: kyZS-eq4dX9sJG75AAA8
2025-11-11 21:56:45,400 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:45] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_eDK&sid=Yr7kiKg4x1xCb1aAAAA6 HTTP/1.1" 200 -
2025-11-11 21:56:45,401 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:45] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_eDL&sid=Yr7kiKg4x1xCb1aAAAA6 HTTP/1.1" 200 -
2025-11-11 21:56:45,402 - root - INFO - WebSocket client connected: QCAnF6Pjy73hA_8fAAA9
2025-11-11 21:56:45,405 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:45] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_eDQ&sid=Yr7kiKg4x1xCb1aAAAA6 HTTP/1.1" 200 -
2025-11-11 21:56:45,405 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:45] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_eDR&sid=Yr7kiKg4x1xCb1aAAAA6 HTTP/1.1" 200 -
2025-11-11 21:56:45,408 - root - INFO - Client kyZS-eq4dX9sJG75AAA8 joined session room: sess-ukq66s6n
2025-11-11 21:56:45,408 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:45] "POST /socket.io/?EIO=4&transport=polling&t=Pfr_eDU.0&sid=Yr7kiKg4x1xCb1aAAAA6 HTTP/1.1" 200 -
2025-11-11 21:56:45,408 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:45] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_eDU&sid=Yr7kiKg4x1xCb1aAAAA6 HTTP/1.1" 200 -
2025-11-11 21:56:45,411 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:45] "GET /socket.io/?EIO=4&transport=polling&t=Pfr_eDY&sid=Yr7kiKg4x1xCb1aAAAA6 HTTP/1.1" 200 -
2025-11-11 21:56:45,597 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:45] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 21:56:51,551 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:51] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 21:56:51,559 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 21:56:51] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 22:00:18,727 - root - INFO - WebSocket client disconnected: QCAnF6Pjy73hA_8fAAA9
2025-11-11 22:00:18,728 - root - INFO - WebSocket client disconnected: kyZS-eq4dX9sJG75AAA8
2025-11-11 22:00:18,731 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:00:18] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 22:00:18,731 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:00:18] "GET /socket.io/?EIO=4&transport=websocket&sid=Yr7kiKg4x1xCb1aAAAA6 HTTP/1.1" 200 -
2025-11-11 22:00:18,737 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:00:18] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 22:00:18,738 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 22:00:18,754 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:00:18] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 22:00:18,755 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:00:18] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 22:00:18,755 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:00:18] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 22:00:18,808 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:00:18] "GET /socket.io/?EIO=4&transport=polling&t=Pfs0SJr HTTP/1.1" 200 -
2025-11-11 22:00:18,810 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:00:18] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 22:00:18,818 - root - INFO - WebSocket client connected: vxVqhoO5IEhUPtTBAABA
2025-11-11 22:00:18,818 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:00:18] "POST /socket.io/?EIO=4&transport=polling&t=Pfs0SJz&sid=3mr7CbhXseU0Mm_tAAA- HTTP/1.1" 200 -
2025-11-11 22:00:18,819 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:00:18] "GET /socket.io/?EIO=4&transport=polling&t=Pfs0SJz.0&sid=3mr7CbhXseU0Mm_tAAA- HTTP/1.1" 200 -
2025-11-11 22:00:18,820 - root - INFO - WebSocket client connected: dEYTTrZG5A5o7dJlAABB
2025-11-11 22:00:18,822 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:00:18] "POST /socket.io/?EIO=4&transport=polling&t=Pfs0SK5&sid=3mr7CbhXseU0Mm_tAAA- HTTP/1.1" 200 -
2025-11-11 22:00:18,823 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:00:18] "GET /socket.io/?EIO=4&transport=polling&t=Pfs0SK4&sid=3mr7CbhXseU0Mm_tAAA- HTTP/1.1" 200 -
2025-11-11 22:00:18,827 - root - INFO - Client vxVqhoO5IEhUPtTBAABA joined session room: sess-ukq66s6n
2025-11-11 22:00:18,827 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:00:18] "POST /socket.io/?EIO=4&transport=polling&t=Pfs0SK9.0&sid=3mr7CbhXseU0Mm_tAAA- HTTP/1.1" 200 -
2025-11-11 22:00:18,828 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:00:18] "GET /socket.io/?EIO=4&transport=polling&t=Pfs0SK9&sid=3mr7CbhXseU0Mm_tAAA- HTTP/1.1" 200 -
2025-11-11 22:00:18,843 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:00:18] "GET /socket.io/?EIO=4&transport=polling&t=Pfs0SKD&sid=3mr7CbhXseU0Mm_tAAA- HTTP/1.1" 200 -
2025-11-11 22:00:19,014 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:00:19] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 22:00:38,995 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-11 22:00:39,009 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-11 22:00:39,009 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-11 22:00:39,011 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-11 22:00:39,011 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-11 22:00:39,031 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 22:00:39,031 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 22:00:39,031 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 22:00:39,031 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 22:00:39,031 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-11 22:00:39,031 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-11 22:00:39,031 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-11 22:00:39,032 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-11 22:00:39,032 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-11 22:00:39,032 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-11 22:00:39,032 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-11 22:00:39,033 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-11 22:00:39,033 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-11 22:00:39,034 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-11 22:00:39,034 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-11 22:00:39,034 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-11 22:00:39,034 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-11 22:00:39,035 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-11 22:00:39,035 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-11 22:00:39,040 - DuckDbDescribeTableTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 49117) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 22:00:39,040 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 22:00:39,041 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-11 22:00:39,041 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-11 22:00:39,041 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-11 22:00:39,041 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-11 22:00:39,226 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-11 22:00:39,226 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-11 22:00:39,227 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-11 22:00:39,227 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-11 22:00:39,227 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-11 22:00:39,227 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-11 22:00:39,228 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-11 22:00:39,228 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-11 22:00:39,228 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-11 22:00:39,228 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-11 22:00:39,231 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-11 22:00:39,231 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-11 22:00:39,231 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-11 22:00:39,231 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-11 22:00:39,232 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-11 22:00:39,232 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-11 22:00:39,233 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-11 22:00:39,233 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-11 22:00:39,233 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-11 22:00:39,233 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-11 22:00:39,233 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-11 22:00:39,233 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-11 22:00:39,234 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-11 22:00:39,234 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-11 22:00:39,234 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-11 22:00:39,234 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-11 22:00:39,235 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-11 22:00:39,235 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-11 22:00:39,235 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-11 22:00:39,235 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-11 22:00:39,236 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-11 22:00:39,236 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-11 22:00:39,237 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-11 22:00:39,237 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-11 22:00:39,237 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-11 22:00:39,237 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-11 22:00:39,237 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-11 22:00:39,237 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-11 22:00:39,240 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-11 22:00:39,240 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-11 22:00:39,241 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-11 22:00:39,241 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-11 22:00:39,241 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-11 22:00:39,241 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-11 22:00:39,241 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-11 22:00:39,241 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-11 22:00:39,247 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 22:00:39,247 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 22:00:39,247 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 22:00:39,247 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 22:00:39,247 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-11 22:00:39,247 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-11 22:00:39,247 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-11 22:00:39,247 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-11 22:00:39,247 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-11 22:00:39,248 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-11 22:00:39,248 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-11 22:00:39,248 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-11 22:00:39,248 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-11 22:00:39,248 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-11 22:00:39,248 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-11 22:00:39,249 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-11 22:00:39,249 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-11 22:00:39,249 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-11 22:00:39,249 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-11 22:00:39,252 - DuckDbListFilesTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 49117) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 22:00:39,252 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 22:00:39,252 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-11 22:00:39,252 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-11 22:00:39,252 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-11 22:00:39,252 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-11 22:00:39,252 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-11 22:00:39,252 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-11 22:00:39,252 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-11 22:00:39,252 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-11 22:00:39,252 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-11 22:00:39,252 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-11 22:00:39,253 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-11 22:00:39,253 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-11 22:00:39,253 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-11 22:00:39,253 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-11 22:00:39,254 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-11 22:00:39,254 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-11 22:00:39,254 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-11 22:00:39,254 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-11 22:00:39,254 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-11 22:00:39,254 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-11 22:00:39,254 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-11 22:00:39,254 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-11 22:00:39,254 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-11 22:00:39,254 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-11 22:00:39,255 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-11 22:00:39,255 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-11 22:00:39,255 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-11 22:00:39,255 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-11 22:00:39,255 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-11 22:00:39,255 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-11 22:00:39,258 - DuckDbGetStatsTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 49117) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 22:00:39,259 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 22:00:39,259 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-11 22:00:39,259 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-11 22:00:39,259 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-11 22:00:39,259 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-11 22:00:39,259 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-11 22:00:39,259 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-11 22:00:39,259 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-11 22:00:39,259 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-11 22:00:39,259 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-11 22:00:39,259 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-11 22:00:39,265 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 22:00:39,265 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 22:00:39,265 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 22:00:39,265 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 22:00:39,265 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-11 22:00:39,265 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-11 22:00:39,265 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-11 22:00:39,265 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-11 22:00:39,265 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-11 22:00:39,265 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-11 22:00:39,265 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-11 22:00:39,268 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-11 22:00:39,268 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-11 22:00:39,268 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-11 22:00:39,268 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-11 22:00:39,269 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-11 22:00:39,269 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-11 22:00:39,269 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-11 22:00:39,269 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-11 22:00:39,269 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-11 22:00:39,269 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-11 22:00:39,269 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-11 22:00:39,269 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-11 22:00:39,269 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-11 22:00:39,269 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-11 22:00:39,269 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-11 22:00:39,269 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-11 22:00:39,269 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-11 22:00:39,269 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-11 22:00:39,270 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-11 22:00:39,270 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-11 22:00:39,273 - DuckDbListTablesTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 49117) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 22:00:39,273 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 22:00:39,273 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-11 22:00:39,273 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-11 22:00:39,273 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-11 22:00:39,273 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-11 22:00:39,273 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-11 22:00:39,273 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-11 22:00:39,274 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-11 22:00:39,274 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-11 22:00:39,274 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-11 22:00:39,274 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-11 22:00:39,275 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-11 22:00:39,275 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-11 22:00:39,275 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-11 22:00:39,275 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-11 22:00:39,275 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-11 22:00:39,275 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-11 22:00:39,275 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-11 22:00:39,275 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-11 22:00:39,275 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-11 22:00:39,275 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-11 22:00:39,276 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-11 22:00:39,276 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-11 22:00:39,276 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-11 22:00:39,276 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-11 22:00:39,276 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-11 22:00:39,276 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-11 22:00:39,279 - DuckDbAggregateTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 49117) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 22:00:39,279 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 22:00:39,279 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-11 22:00:39,279 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-11 22:00:39,279 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-11 22:00:39,279 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-11 22:00:39,280 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-11 22:00:39,280 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-11 22:00:39,280 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-11 22:00:39,280 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-11 22:00:39,280 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-11 22:00:39,280 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-11 22:00:39,280 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-11 22:00:39,280 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-11 22:00:39,280 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-11 22:00:39,280 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-11 22:00:39,286 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 22:00:39,286 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 22:00:39,286 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 22:00:39,286 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 22:00:39,286 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-11 22:00:39,286 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-11 22:00:39,286 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-11 22:00:39,286 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-11 22:00:39,286 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-11 22:00:39,287 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-11 22:00:39,287 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-11 22:00:39,287 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-11 22:00:39,287 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-11 22:00:39,287 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-11 22:00:39,287 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-11 22:00:39,287 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-11 22:00:39,287 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-11 22:00:39,287 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-11 22:00:39,287 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-11 22:00:39,287 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-11 22:00:39,287 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-11 22:00:39,287 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-11 22:00:39,287 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-11 22:00:39,288 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-11 22:00:39,288 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-11 22:00:39,288 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-11 22:00:39,288 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-11 22:00:39,288 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-11 22:00:39,288 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-11 22:00:39,289 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-11 22:00:39,289 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-11 22:00:39,289 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-11 22:00:39,289 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-11 22:00:39,289 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-11 22:00:39,289 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-11 22:00:39,289 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-11 22:00:39,289 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-11 22:00:39,290 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-11 22:00:39,290 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-11 22:00:39,290 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-11 22:00:39,290 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-11 22:00:39,290 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-11 22:00:39,290 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-11 22:00:39,290 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-11 22:00:39,290 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-11 22:00:39,290 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-11 22:00:39,290 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-11 22:00:39,290 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-11 22:00:39,290 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-11 22:00:39,290 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-11 22:00:39,290 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-11 22:00:39,291 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-11 22:00:39,291 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-11 22:00:39,291 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-11 22:00:39,291 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-11 22:00:39,291 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-11 22:00:39,291 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-11 22:00:39,291 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-11 22:00:39,291 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-11 22:00:39,292 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-11 22:00:39,292 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-11 22:00:39,292 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-11 22:00:39,292 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-11 22:00:39,293 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-11 22:00:39,293 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-11 22:00:39,293 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-11 22:00:39,293 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-11 22:00:39,293 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-11 22:00:39,293 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-11 22:00:39,293 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-11 22:00:39,293 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-11 22:00:39,293 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-11 22:00:39,293 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-11 22:00:39,293 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-11 22:00:39,293 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-11 22:00:39,299 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 22:00:39,299 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 22:00:39,299 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 22:00:39,299 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 22:00:39,299 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-11 22:00:39,299 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-11 22:00:39,299 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-11 22:00:39,299 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-11 22:00:39,299 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-11 22:00:39,300 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-11 22:00:39,300 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-11 22:00:39,300 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-11 22:00:39,300 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-11 22:00:39,300 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-11 22:00:39,300 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-11 22:00:39,300 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-11 22:00:39,300 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-11 22:00:39,300 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-11 22:00:39,300 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-11 22:00:39,300 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-11 22:00:39,300 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-11 22:00:39,301 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-11 22:00:39,301 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-11 22:00:39,301 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-11 22:00:39,301 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-11 22:00:39,301 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-11 22:00:39,301 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-11 22:00:39,301 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-11 22:00:39,301 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-11 22:00:39,303 - DuckDbQueryTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 49117) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 22:00:39,304 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 22:00:39,304 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-11 22:00:39,304 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-11 22:00:39,304 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-11 22:00:39,304 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-11 22:00:39,304 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-11 22:00:39,304 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-11 22:00:39,304 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-11 22:00:39,304 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-11 22:00:39,307 - DuckDbRefreshViewsTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 49117) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 22:00:39,307 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 22:00:39,307 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-11 22:00:39,307 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-11 22:00:39,307 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-11 22:00:39,307 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-11 22:00:39,307 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-11 22:00:39,307 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-11 22:00:39,313 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 22:00:39,313 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 22:00:39,313 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 22:00:39,313 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 22:00:39,313 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-11 22:00:39,313 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-11 22:00:39,313 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-11 22:00:39,313 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-11 22:00:39,313 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-11 22:00:39,313 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-11 22:00:39,313 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-11 22:00:39,313 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-11 22:00:39,313 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-11 22:00:39,314 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-11 22:00:39,314 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-11 22:00:39,314 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-11 22:00:39,314 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-11 22:00:39,314 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-11 22:00:39,314 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-11 22:00:39,314 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-11 22:00:39,322 - root - INFO - All routes registered successfully
2025-11-11 22:00:40,173 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:00:40] "GET /health HTTP/1.1" 200 -
2025-11-11 22:00:40,311 - DuckDbRefreshViewsTool - INFO - Auto-refresh stopped
2025-11-11 22:00:41,312 - DuckDbQueryTool - INFO - Auto-refresh stopped
2025-11-11 22:00:42,294 - DuckDbAggregateTool - INFO - Auto-refresh stopped
2025-11-11 22:00:43,290 - DuckDbListTablesTool - INFO - Auto-refresh stopped
2025-11-11 22:00:44,281 - DuckDbGetStatsTool - INFO - Auto-refresh stopped
2025-11-11 22:00:45,270 - DuckDbListFilesTool - INFO - Auto-refresh stopped
2025-11-11 22:00:46,073 - DuckDbDescribeTableTool - INFO - Auto-refresh stopped
2025-11-11 22:06:10,485 - root - INFO - Client vxVqhoO5IEhUPtTBAABA joined session room: sess-9s8ttmif
2025-11-11 22:06:10,991 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:06:10] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 22:08:50,532 - agent.session_manager - INFO - [SessionManager] Registered session sess-9s8ttmif
2025-11-11 22:08:50,533 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'sdfsdf'
2025-11-11 22:08:50,533 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-9s8ttmif
2025-11-11 22:08:50,533 - agent.state_manager - WARNING - Session sess-9s8ttmif not found
2025-11-11 22:08:50,533 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 22:08:50,544 - agent.state_manager - INFO - Saved session state for sess-9s8ttmif (user: admin)
2025-11-11 22:08:50,544 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 22:08:50,544 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 22:08:50,544 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 22:08:50,545 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 22:08:50,545 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 22:08:50,545 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 22:08:50,545 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 22:08:50,548 - agent.state_manager - INFO - Saved session state for sess-9s8ttmif (user: admin)
2025-11-11 22:08:52,195 - agent.session_manager - INFO - [SessionManager] Cancelled session sess-9s8ttmif
2025-11-11 22:08:52,196 - root - INFO - Kill request received for session sess-9s8ttmif
2025-11-11 22:08:52,755 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 22:08:52,759 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 22:08:52,759 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 22:08:52,759 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 22:08:52,762 - agent.state_manager - INFO - Saved session state for sess-9s8ttmif (user: admin)
2025-11-11 22:08:52,762 - agent.streaming_agent - INFO - [StreamingAgent] Query cancelled for session sess-9s8ttmif
2025-11-11 22:08:52,762 - agent.streaming_agent - INFO - [StreamingAgent] Query cancelled, skipping end_node and conversation history save
2025-11-11 22:08:52,763 - agent.session_manager - INFO - [SessionManager] Unregistered session sess-9s8ttmif
2025-11-11 22:08:57,611 - agent.session_manager - INFO - [SessionManager] Registered session sess-9s8ttmif
2025-11-11 22:08:57,611 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'dgfghfgh'
2025-11-11 22:08:57,611 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-9s8ttmif
2025-11-11 22:08:57,612 - agent.state_manager - INFO - Loaded session state for sess-9s8ttmif
2025-11-11 22:08:57,612 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 0 turns
2025-11-11 22:08:57,612 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 22:08:57,616 - agent.state_manager - INFO - Saved session state for sess-9s8ttmif (user: admin)
2025-11-11 22:08:57,616 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 22:08:57,616 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 22:08:57,616 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 22:08:57,617 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 22:08:57,617 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 22:08:57,617 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 22:08:57,617 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 22:08:57,619 - agent.state_manager - INFO - Saved session state for sess-9s8ttmif (user: admin)
2025-11-11 22:08:59,051 - agent.session_manager - INFO - [SessionManager] Cancelled session sess-9s8ttmif
2025-11-11 22:08:59,051 - root - INFO - Kill request received for session sess-9s8ttmif
2025-11-11 22:08:59,819 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 22:08:59,822 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 22:08:59,822 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 22:08:59,822 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 22:08:59,825 - agent.state_manager - INFO - Saved session state for sess-9s8ttmif (user: admin)
2025-11-11 22:08:59,826 - agent.streaming_agent - INFO - [StreamingAgent] Query cancelled for session sess-9s8ttmif
2025-11-11 22:08:59,826 - agent.streaming_agent - INFO - [StreamingAgent] Query cancelled, skipping end_node and conversation history save
2025-11-11 22:08:59,826 - agent.session_manager - INFO - [SessionManager] Unregistered session sess-9s8ttmif
2025-11-11 22:09:05,203 - root - INFO - Client vxVqhoO5IEhUPtTBAABA joined session room: sess-fle4f8xx
2025-11-11 22:09:05,707 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:09:05] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 22:09:23,323 - agent.session_manager - INFO - [SessionManager] Registered session sess-fle4f8xx
2025-11-11 22:09:23,325 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'xfxff'
2025-11-11 22:09:23,325 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-fle4f8xx
2025-11-11 22:09:23,325 - agent.state_manager - WARNING - Session sess-fle4f8xx not found
2025-11-11 22:09:23,325 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 22:09:23,329 - agent.state_manager - INFO - Saved session state for sess-fle4f8xx (user: admin)
2025-11-11 22:09:23,329 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 22:09:23,329 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 22:09:23,330 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 22:09:23,330 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 22:09:23,330 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 22:09:23,330 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 22:09:23,331 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 22:09:23,333 - agent.state_manager - INFO - Saved session state for sess-fle4f8xx (user: admin)
2025-11-11 22:09:26,090 - agent.session_manager - INFO - [SessionManager] Cancelled session sess-fle4f8xx
2025-11-11 22:09:26,090 - root - INFO - Kill request received for session sess-fle4f8xx
2025-11-11 22:09:26,547 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 22:09:26,550 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 22:09:26,550 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 22:09:26,550 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 22:09:26,553 - agent.state_manager - INFO - Saved session state for sess-fle4f8xx (user: admin)
2025-11-11 22:09:26,553 - agent.streaming_agent - INFO - [StreamingAgent] Query cancelled for session sess-fle4f8xx
2025-11-11 22:09:26,553 - agent.streaming_agent - INFO - [StreamingAgent] Query cancelled, skipping end_node and conversation history save
2025-11-11 22:09:26,554 - agent.session_manager - INFO - [SessionManager] Unregistered session sess-fle4f8xx
2025-11-11 22:09:47,161 - agent.session_manager - INFO - [SessionManager] Registered session sess-fle4f8xx
2025-11-11 22:09:47,161 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'dfgdgfdgf'
2025-11-11 22:09:47,161 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-fle4f8xx
2025-11-11 22:09:47,162 - agent.state_manager - INFO - Loaded session state for sess-fle4f8xx
2025-11-11 22:09:47,162 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 0 turns
2025-11-11 22:09:47,162 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 22:09:47,165 - agent.state_manager - INFO - Saved session state for sess-fle4f8xx (user: admin)
2025-11-11 22:09:47,165 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 22:09:47,165 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 22:09:47,165 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 22:09:47,166 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 22:09:47,166 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 22:09:47,166 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 22:09:47,166 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 22:09:47,168 - agent.state_manager - INFO - Saved session state for sess-fle4f8xx (user: admin)
2025-11-11 22:09:49,688 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 22:09:49,691 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 22:09:49,691 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 22:09:49,691 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 22:09:49,694 - agent.state_manager - INFO - Saved session state for sess-fle4f8xx (user: admin)
2025-11-11 22:09:49,695 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 22:09:49,695 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 22:09:49,696 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 22:09:49,696 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 22:09:49,696 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 22:09:49,696 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 22:09:49,696 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 22:09:49,696 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 22:09:49,696 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 22:09:49,696 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 22:09:49,696 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 22:09:49,696 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 22:09:49,696 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 22:09:49,696 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 22:09:49,697 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 22:09:49,697 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 22:09:52,662 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 22:09:53,271 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 22:09:54,769 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 22:09:54,770 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 22:09:54,770 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 22:09:54,774 - agent.state_manager - INFO - Saved session state for sess-fle4f8xx (user: admin)
2025-11-11 22:09:54,774 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 22:09:54,775 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 22:09:54,775 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 22:09:54,778 - agent.state_manager - INFO - Saved session state for sess-fle4f8xx (user: admin)
2025-11-11 22:09:54,778 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: -- KNOWLEDGE QUESTION...
2025-11-11 22:09:54,778 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 21 chars
2025-11-11 22:09:54,778 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: -- KNOWLEDGE QUESTION
2025-11-11 22:09:54,778 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 22:09:54,778 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 22:09:54,779 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 22:09:54,781 - agent.state_manager - INFO - Saved session state for sess-fle4f8xx (user: admin)
2025-11-11 22:09:54,781 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=0, columns=0, rows=0, sql=-- KNOWLEDGE QUESTION
2025-11-11 22:09:54,781 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 22:09:54,782 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['columns', 'rows', 'row_count', 'query']
2025-11-11 22:09:54,782 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: -- KNOWLEDGE QUESTION
2025-11-11 22:09:54,782 - agent.graph_nodes - INFO - [END_NODE] Knowledge response detected: 'I apologize, but "dfgdgfdgf" is not a valid term in the business glossary. It appears to be a random...'
2025-11-11 22:09:54,782 - agent.graph_nodes - INFO - [END_NODE] Returning knowledge result with response length: 290
2025-11-11 22:09:54,782 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 22:09:54,782 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 22:09:54,782 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 22:09:54,785 - agent.state_manager - INFO - Saved session state for sess-fle4f8xx (user: admin)
2025-11-11 22:09:54,785 - agent.streaming_agent - INFO - Agent completed for session sess-fle4f8xx: 7618.995ms, 7 steps
2025-11-11 22:09:54,785 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=0, columns=0, rows=0
2025-11-11 22:09:54,785 - agent.session_manager - INFO - [SessionManager] Unregistered session sess-fle4f8xx
2025-11-11 22:10:23,481 - root - INFO - Client vxVqhoO5IEhUPtTBAABA joined session room: sess-d8g0xb01
2025-11-11 22:10:23,985 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:10:23] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 22:43:13,582 - root - INFO - WebSocket client disconnected: vxVqhoO5IEhUPtTBAABA
2025-11-11 22:43:13,583 - root - INFO - WebSocket client disconnected: dEYTTrZG5A5o7dJlAABB
2025-11-11 22:43:13,585 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:43:13] "GET /socket.io/?EIO=4&transport=websocket&sid=3mr7CbhXseU0Mm_tAAA- HTTP/1.1" 200 -
2025-11-11 22:43:13,586 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:43:13] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 22:43:13,592 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:43:13] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 22:43:13,593 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 22:43:13,608 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:43:13] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 22:43:13,609 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:43:13] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 22:43:13,637 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:43:13] "GET /socket.io/?EIO=4&transport=polling&t=PfsAGxa HTTP/1.1" 200 -
2025-11-11 22:43:13,643 - root - INFO - WebSocket client connected: eh4uxQgjb2uGEpQtAABE
2025-11-11 22:43:13,643 - root - INFO - WebSocket client connected: IKJXeMCzuRbiUugLAABF
2025-11-11 22:43:13,644 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:43:13] "POST /socket.io/?EIO=4&transport=polling&t=PfsAGxf&sid=Wid130NQnL2hLPn7AABC HTTP/1.1" 200 -
2025-11-11 22:43:13,644 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:43:13] "GET /socket.io/?EIO=4&transport=polling&t=PfsAGxf.0&sid=Wid130NQnL2hLPn7AABC HTTP/1.1" 200 -
2025-11-11 22:43:13,644 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:43:13] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 22:43:13,648 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:43:13] "POST /socket.io/?EIO=4&transport=polling&t=PfsAGxk.0&sid=Wid130NQnL2hLPn7AABC HTTP/1.1" 200 -
2025-11-11 22:43:13,648 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:43:13] "GET /socket.io/?EIO=4&transport=polling&t=PfsAGxk&sid=Wid130NQnL2hLPn7AABC HTTP/1.1" 200 -
2025-11-11 22:43:13,650 - root - INFO - Client eh4uxQgjb2uGEpQtAABE joined session room: sess-d8g0xb01
2025-11-11 22:43:13,651 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:43:13] "POST /socket.io/?EIO=4&transport=polling&t=PfsAGxn.0&sid=Wid130NQnL2hLPn7AABC HTTP/1.1" 200 -
2025-11-11 22:43:13,651 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:43:13] "GET /socket.io/?EIO=4&transport=polling&t=PfsAGxn&sid=Wid130NQnL2hLPn7AABC HTTP/1.1" 200 -
2025-11-11 22:43:13,652 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:43:13] "GET /socket.io/?EIO=4&transport=polling&t=PfsAGxq&sid=Wid130NQnL2hLPn7AABC HTTP/1.1" 200 -
2025-11-11 22:43:13,847 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:43:13] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 22:43:16,367 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:43:16] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 22:43:16,371 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:43:16] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 22:44:09,538 - root - INFO - WebSocket client disconnected: IKJXeMCzuRbiUugLAABF
2025-11-11 22:44:09,539 - root - INFO - WebSocket client disconnected: eh4uxQgjb2uGEpQtAABE
2025-11-11 22:44:09,539 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:09] "GET /socket.io/?EIO=4&transport=websocket&sid=Wid130NQnL2hLPn7AABC HTTP/1.1" 200 -
2025-11-11 22:44:09,542 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:09] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 22:44:09,546 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:09] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 22:44:09,547 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 22:44:09,567 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:09] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 22:44:09,567 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:09] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 22:44:09,567 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:09] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 22:44:09,638 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:09] "GET /socket.io/?EIO=4&transport=polling&t=PfsAUcY HTTP/1.1" 200 -
2025-11-11 22:44:09,653 - root - INFO - WebSocket client connected: qbZkW-6NjMtzztqXAABI
2025-11-11 22:44:09,655 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:09] "POST /socket.io/?EIO=4&transport=polling&t=PfsAUcf&sid=1Xy0iaNOcZMdirCiAABG HTTP/1.1" 200 -
2025-11-11 22:44:09,656 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:09] "GET /socket.io/?EIO=4&transport=polling&t=PfsAUcg&sid=1Xy0iaNOcZMdirCiAABG HTTP/1.1" 200 -
2025-11-11 22:44:09,657 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:09] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 22:44:09,659 - root - INFO - WebSocket client connected: 4grB71yC2cVFinHqAABJ
2025-11-11 22:44:09,660 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:09] "POST /socket.io/?EIO=4&transport=polling&t=PfsAUcv.0&sid=1Xy0iaNOcZMdirCiAABG HTTP/1.1" 200 -
2025-11-11 22:44:09,660 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:09] "GET /socket.io/?EIO=4&transport=polling&t=PfsAUcv&sid=1Xy0iaNOcZMdirCiAABG HTTP/1.1" 200 -
2025-11-11 22:44:09,664 - root - INFO - Client qbZkW-6NjMtzztqXAABI joined session room: sess-d8g0xb01
2025-11-11 22:44:09,666 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:09] "POST /socket.io/?EIO=4&transport=polling&t=PfsAUc-&sid=1Xy0iaNOcZMdirCiAABG HTTP/1.1" 200 -
2025-11-11 22:44:09,666 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:09] "GET /socket.io/?EIO=4&transport=polling&t=PfsAUcz&sid=1Xy0iaNOcZMdirCiAABG HTTP/1.1" 200 -
2025-11-11 22:44:09,839 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:09] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 22:44:17,538 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:17] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 22:44:17,544 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:17] "GET /login?next=http://localhost:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 22:44:17,696 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:17] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 22:44:17,697 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:17] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 22:44:17,740 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:17] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-11-11 22:44:17,740 - root - INFO - WebSocket client connected: Xq1d0azDesn_jFbtAABL
2025-11-11 22:44:17,742 - root - INFO - WebSocket client disconnected: Xq1d0azDesn_jFbtAABL
2025-11-11 22:44:17,754 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:17] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 22:44:17,756 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 22:44:22,440 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 22:44:22,440 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 22:44:22,441 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:22] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 22:44:22,456 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:22] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 22:44:22,467 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:22] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 22:44:22,468 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:22] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 22:44:22,529 - root - INFO - WebSocket client connected: HMo3rEEhKM5m1pBZAABN
2025-11-11 22:44:22,532 - root - INFO - WebSocket client disconnected: HMo3rEEhKM5m1pBZAABN
2025-11-11 22:44:22,544 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:22] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 22:44:22,545 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 22:44:28,136 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:28] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 22:44:28,144 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:28] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 22:44:28,158 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:28] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 22:44:28,179 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:28] "GET /socket.io/?EIO=4&transport=polling&t=PfsAZ8I HTTP/1.1" 200 -
2025-11-11 22:44:28,181 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:28] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 22:44:28,197 - root - INFO - WebSocket client connected: QSRXrxxDmn1BxtigAABP
2025-11-11 22:44:28,197 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:28] "POST /socket.io/?EIO=4&transport=polling&t=PfsAZ8Z&sid=N8NABjGEktxsHyrNAABO HTTP/1.1" 200 -
2025-11-11 22:44:28,197 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:28] "GET /socket.io/?EIO=4&transport=polling&t=PfsAZ8Z.0&sid=N8NABjGEktxsHyrNAABO HTTP/1.1" 200 -
2025-11-11 22:44:28,211 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:28] "POST /socket.io/?EIO=4&transport=polling&t=PfsAZ8o&sid=N8NABjGEktxsHyrNAABO HTTP/1.1" 200 -
2025-11-11 22:44:28,211 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:28] "GET /socket.io/?EIO=4&transport=polling&t=PfsAZ8c&sid=N8NABjGEktxsHyrNAABO HTTP/1.1" 200 -
2025-11-11 22:44:28,213 - root - INFO - Client QSRXrxxDmn1BxtigAABP joined session room: sess-h1hkrvda
2025-11-11 22:44:28,213 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:28] "POST /socket.io/?EIO=4&transport=polling&t=PfsAZ8q.0&sid=N8NABjGEktxsHyrNAABO HTTP/1.1" 200 -
2025-11-11 22:44:28,213 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:28] "GET /socket.io/?EIO=4&transport=polling&t=PfsAZ8q&sid=N8NABjGEktxsHyrNAABO HTTP/1.1" 200 -
2025-11-11 22:44:28,924 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:28] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 22:44:28,926 - root - INFO - WebSocket client connected: p4i-hZUxgmR4XkPcAABR
2025-11-11 22:44:28,955 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:28] "GET /socket.io/?EIO=4&transport=polling&t=PfsAZ8s&sid=N8NABjGEktxsHyrNAABO HTTP/1.1" 200 -
2025-11-11 22:44:33,440 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:33] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 22:44:33,447 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:33] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 22:44:44,629 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:44:44] "GET /health HTTP/1.1" 200 -
2025-11-11 22:45:04,123 - root - INFO - WebSocket client disconnected: p4i-hZUxgmR4XkPcAABR
2025-11-11 22:45:04,124 - root - INFO - WebSocket client disconnected: QSRXrxxDmn1BxtigAABP
2025-11-11 22:45:04,124 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:45:04] "GET /socket.io/?EIO=4&transport=websocket&sid=N8NABjGEktxsHyrNAABO HTTP/1.1" 200 -
2025-11-11 22:45:04,135 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:45:04] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 22:45:04,136 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 22:45:16,216 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:45:16] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 22:45:16,232 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:45:16] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 22:45:16,238 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:45:16] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 22:45:16,413 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:45:16] "GET /socket.io/?EIO=4&transport=polling&t=PfsAkvx HTTP/1.1" 200 -
2025-11-11 22:45:16,416 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:45:16] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 22:45:16,418 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:45:16] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-11-11 22:45:16,419 - root - INFO - WebSocket client connected: KCmA7VqT5PDhO-cVAABU
2025-11-11 22:45:16,420 - root - INFO - WebSocket client connected: IXY4xN0H96fvHSEfAABV
2025-11-11 22:45:16,421 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:45:16] "POST /socket.io/?EIO=4&transport=polling&t=PfsAkw0&sid=N8RiMIDOZaCyLN9lAABS HTTP/1.1" 200 -
2025-11-11 22:45:16,421 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:45:16] "GET /socket.io/?EIO=4&transport=polling&t=PfsAkw0.0&sid=N8RiMIDOZaCyLN9lAABS HTTP/1.1" 200 -
2025-11-11 22:45:16,425 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:45:16] "POST /socket.io/?EIO=4&transport=polling&t=PfsAkw6.0&sid=N8RiMIDOZaCyLN9lAABS HTTP/1.1" 200 -
2025-11-11 22:45:16,426 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:45:16] "GET /socket.io/?EIO=4&transport=polling&t=PfsAkw6&sid=N8RiMIDOZaCyLN9lAABS HTTP/1.1" 200 -
2025-11-11 22:45:16,428 - root - INFO - Client IXY4xN0H96fvHSEfAABV joined session room: sess-h1hkrvda
2025-11-11 22:45:16,428 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:45:16] "POST /socket.io/?EIO=4&transport=polling&t=PfsAkwA.0&sid=N8RiMIDOZaCyLN9lAABS HTTP/1.1" 200 -
2025-11-11 22:45:16,429 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:45:16] "GET /socket.io/?EIO=4&transport=polling&t=PfsAkwA&sid=N8RiMIDOZaCyLN9lAABS HTTP/1.1" 200 -
2025-11-11 22:45:16,620 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:45:16] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 22:45:20,605 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:45:20] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 22:45:20,613 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:45:20] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 22:45:57,925 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:45:57] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 22:45:57,928 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:45:57] "GET /login?next=http://localhost:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 22:45:57,990 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:45:57] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 22:45:58,020 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:45:58] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 22:46:03,695 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 22:46:03,695 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 22:46:03,697 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:03] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 22:46:03,708 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:03] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 22:46:03,720 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:03] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 22:46:03,720 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:03] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 22:46:07,426 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:07] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 22:46:07,434 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:07] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 22:46:07,453 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:07] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 22:46:07,496 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:07] "GET /socket.io/?EIO=4&transport=polling&t=PfsAxO5 HTTP/1.1" 200 -
2025-11-11 22:46:07,498 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:07] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 22:46:07,512 - root - INFO - WebSocket client connected: hxe3vHf3qnbdTig0AABX
2025-11-11 22:46:07,513 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:07] "POST /socket.io/?EIO=4&transport=polling&t=PfsAxOM&sid=rYVOV9cUcYe1abLiAABW HTTP/1.1" 200 -
2025-11-11 22:46:07,513 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:07] "GET /socket.io/?EIO=4&transport=polling&t=PfsAxON&sid=rYVOV9cUcYe1abLiAABW HTTP/1.1" 200 -
2025-11-11 22:46:07,516 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:07] "POST /socket.io/?EIO=4&transport=polling&t=PfsAxOR&sid=rYVOV9cUcYe1abLiAABW HTTP/1.1" 200 -
2025-11-11 22:46:07,516 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:07] "GET /socket.io/?EIO=4&transport=polling&t=PfsAxOQ&sid=rYVOV9cUcYe1abLiAABW HTTP/1.1" 200 -
2025-11-11 22:46:07,518 - root - INFO - Client hxe3vHf3qnbdTig0AABX joined session room: sess-ew5y1ns6
2025-11-11 22:46:07,518 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:07] "POST /socket.io/?EIO=4&transport=polling&t=PfsAxOT.0&sid=rYVOV9cUcYe1abLiAABW HTTP/1.1" 200 -
2025-11-11 22:46:07,519 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:07] "GET /socket.io/?EIO=4&transport=polling&t=PfsAxOT&sid=rYVOV9cUcYe1abLiAABW HTTP/1.1" 200 -
2025-11-11 22:46:08,096 - root - INFO - WebSocket client connected: 9CNBvKdZR5doBjoOAABZ
2025-11-11 22:46:08,098 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:08] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 22:46:08,126 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:08] "GET /socket.io/?EIO=4&transport=polling&t=PfsAxOV&sid=rYVOV9cUcYe1abLiAABW HTTP/1.1" 200 -
2025-11-11 22:46:16,038 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-11 22:46:16,057 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-11 22:46:16,057 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-11 22:46:16,059 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-11 22:46:16,059 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-11 22:46:16,083 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 22:46:16,083 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 22:46:16,083 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 22:46:16,083 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 22:46:16,083 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-11 22:46:16,083 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-11 22:46:16,083 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-11 22:46:16,084 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-11 22:46:16,084 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-11 22:46:16,085 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-11 22:46:16,085 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-11 22:46:16,085 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-11 22:46:16,085 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-11 22:46:16,086 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-11 22:46:16,086 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-11 22:46:16,087 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-11 22:46:16,087 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-11 22:46:16,088 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-11 22:46:16,088 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-11 22:46:16,093 - DuckDbDescribeTableTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 49117) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 22:46:16,093 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 22:46:16,093 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-11 22:46:16,093 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-11 22:46:16,094 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-11 22:46:16,094 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-11 22:46:16,345 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-11 22:46:16,345 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-11 22:46:16,346 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-11 22:46:16,346 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-11 22:46:16,347 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-11 22:46:16,347 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-11 22:46:16,347 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-11 22:46:16,347 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-11 22:46:16,348 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-11 22:46:16,348 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-11 22:46:16,351 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-11 22:46:16,351 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-11 22:46:16,351 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-11 22:46:16,351 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-11 22:46:16,352 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-11 22:46:16,352 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-11 22:46:16,352 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-11 22:46:16,352 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-11 22:46:16,353 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-11 22:46:16,353 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-11 22:46:16,353 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-11 22:46:16,353 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-11 22:46:16,353 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-11 22:46:16,353 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-11 22:46:16,354 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-11 22:46:16,354 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-11 22:46:16,354 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-11 22:46:16,355 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-11 22:46:16,355 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-11 22:46:16,355 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-11 22:46:16,355 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-11 22:46:16,355 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-11 22:46:16,356 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-11 22:46:16,356 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-11 22:46:16,356 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-11 22:46:16,356 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-11 22:46:16,357 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-11 22:46:16,357 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-11 22:46:16,359 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-11 22:46:16,359 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-11 22:46:16,359 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-11 22:46:16,359 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-11 22:46:16,360 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-11 22:46:16,360 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-11 22:46:16,360 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-11 22:46:16,360 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-11 22:46:16,367 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 22:46:16,367 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 22:46:16,367 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 22:46:16,367 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 22:46:16,367 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-11 22:46:16,367 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-11 22:46:16,367 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-11 22:46:16,368 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-11 22:46:16,368 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-11 22:46:16,368 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-11 22:46:16,368 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-11 22:46:16,368 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-11 22:46:16,368 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-11 22:46:16,369 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-11 22:46:16,369 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-11 22:46:16,369 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-11 22:46:16,369 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-11 22:46:16,370 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-11 22:46:16,370 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-11 22:46:16,373 - DuckDbListFilesTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 49117) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 22:46:16,373 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 22:46:16,373 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-11 22:46:16,373 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-11 22:46:16,373 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-11 22:46:16,373 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-11 22:46:16,373 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-11 22:46:16,373 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-11 22:46:16,373 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-11 22:46:16,373 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-11 22:46:16,374 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-11 22:46:16,374 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-11 22:46:16,374 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-11 22:46:16,374 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-11 22:46:16,374 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-11 22:46:16,374 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-11 22:46:16,374 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-11 22:46:16,374 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-11 22:46:16,375 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-11 22:46:16,375 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-11 22:46:16,375 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-11 22:46:16,375 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-11 22:46:16,375 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-11 22:46:16,375 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-11 22:46:16,375 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-11 22:46:16,375 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-11 22:46:16,376 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-11 22:46:16,376 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-11 22:46:16,376 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-11 22:46:16,376 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-11 22:46:16,376 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-11 22:46:16,376 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-11 22:46:16,379 - DuckDbGetStatsTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 49117) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 22:46:16,379 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 22:46:16,379 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-11 22:46:16,379 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-11 22:46:16,379 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-11 22:46:16,379 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-11 22:46:16,379 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-11 22:46:16,379 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-11 22:46:16,380 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-11 22:46:16,380 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-11 22:46:16,380 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-11 22:46:16,380 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-11 22:46:16,387 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 22:46:16,388 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 22:46:16,388 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 22:46:16,388 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 22:46:16,388 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-11 22:46:16,388 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-11 22:46:16,388 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-11 22:46:16,388 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-11 22:46:16,388 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-11 22:46:16,388 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-11 22:46:16,388 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-11 22:46:16,391 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-11 22:46:16,391 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-11 22:46:16,392 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-11 22:46:16,392 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-11 22:46:16,392 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-11 22:46:16,392 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-11 22:46:16,392 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-11 22:46:16,392 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-11 22:46:16,392 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-11 22:46:16,392 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-11 22:46:16,393 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-11 22:46:16,393 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-11 22:46:16,393 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-11 22:46:16,393 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-11 22:46:16,394 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-11 22:46:16,394 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-11 22:46:16,395 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-11 22:46:16,395 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-11 22:46:16,395 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-11 22:46:16,395 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-11 22:46:16,398 - DuckDbListTablesTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 49117) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 22:46:16,398 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 22:46:16,398 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-11 22:46:16,398 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-11 22:46:16,399 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-11 22:46:16,399 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-11 22:46:16,399 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-11 22:46:16,399 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-11 22:46:16,399 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-11 22:46:16,399 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-11 22:46:16,399 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-11 22:46:16,400 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-11 22:46:16,400 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-11 22:46:16,400 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-11 22:46:16,400 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-11 22:46:16,400 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-11 22:46:16,400 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-11 22:46:16,400 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-11 22:46:16,400 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-11 22:46:16,400 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-11 22:46:16,401 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-11 22:46:16,401 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-11 22:46:16,401 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-11 22:46:16,401 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-11 22:46:16,401 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-11 22:46:16,401 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-11 22:46:16,401 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-11 22:46:16,401 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-11 22:46:16,404 - DuckDbAggregateTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 49117) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 22:46:16,405 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 22:46:16,405 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-11 22:46:16,405 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-11 22:46:16,405 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-11 22:46:16,405 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-11 22:46:16,405 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-11 22:46:16,405 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-11 22:46:16,406 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-11 22:46:16,406 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-11 22:46:16,406 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-11 22:46:16,406 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-11 22:46:16,407 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-11 22:46:16,407 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-11 22:46:16,407 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-11 22:46:16,407 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-11 22:46:16,413 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 22:46:16,414 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 22:46:16,414 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 22:46:16,414 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 22:46:16,414 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-11 22:46:16,414 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-11 22:46:16,414 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-11 22:46:16,414 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-11 22:46:16,414 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-11 22:46:16,415 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-11 22:46:16,415 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-11 22:46:16,415 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-11 22:46:16,415 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-11 22:46:16,415 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-11 22:46:16,415 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-11 22:46:16,415 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-11 22:46:16,415 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-11 22:46:16,415 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-11 22:46:16,415 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-11 22:46:16,416 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-11 22:46:16,416 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-11 22:46:16,416 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-11 22:46:16,416 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-11 22:46:16,416 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-11 22:46:16,416 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-11 22:46:16,416 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-11 22:46:16,416 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-11 22:46:16,417 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-11 22:46:16,417 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-11 22:46:16,417 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-11 22:46:16,417 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-11 22:46:16,417 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-11 22:46:16,417 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-11 22:46:16,417 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-11 22:46:16,417 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-11 22:46:16,418 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-11 22:46:16,418 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-11 22:46:16,418 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-11 22:46:16,418 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-11 22:46:16,418 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-11 22:46:16,418 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-11 22:46:16,418 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-11 22:46:16,418 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-11 22:46:16,418 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-11 22:46:16,418 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-11 22:46:16,419 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-11 22:46:16,419 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-11 22:46:16,419 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-11 22:46:16,419 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-11 22:46:16,419 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-11 22:46:16,419 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-11 22:46:16,419 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-11 22:46:16,419 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-11 22:46:16,419 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-11 22:46:16,419 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-11 22:46:16,420 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-11 22:46:16,420 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-11 22:46:16,420 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-11 22:46:16,420 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-11 22:46:16,420 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-11 22:46:16,420 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-11 22:46:16,420 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-11 22:46:16,420 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-11 22:46:16,421 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-11 22:46:16,421 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-11 22:46:16,421 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-11 22:46:16,421 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-11 22:46:16,422 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-11 22:46:16,422 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-11 22:46:16,422 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-11 22:46:16,422 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-11 22:46:16,422 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-11 22:46:16,422 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-11 22:46:16,423 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-11 22:46:16,423 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-11 22:46:16,429 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 22:46:16,430 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 22:46:16,430 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 22:46:16,430 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 22:46:16,430 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-11 22:46:16,430 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-11 22:46:16,430 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-11 22:46:16,430 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-11 22:46:16,430 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-11 22:46:16,430 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-11 22:46:16,430 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-11 22:46:16,431 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-11 22:46:16,431 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-11 22:46:16,431 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-11 22:46:16,431 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-11 22:46:16,431 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-11 22:46:16,431 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-11 22:46:16,431 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-11 22:46:16,431 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-11 22:46:16,432 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-11 22:46:16,432 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-11 22:46:16,432 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-11 22:46:16,432 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-11 22:46:16,432 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-11 22:46:16,432 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-11 22:46:16,432 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-11 22:46:16,432 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-11 22:46:16,432 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-11 22:46:16,433 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-11 22:46:16,436 - DuckDbQueryTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 49117) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 22:46:16,436 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 22:46:16,436 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-11 22:46:16,436 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-11 22:46:16,436 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-11 22:46:16,436 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-11 22:46:16,436 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-11 22:46:16,436 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-11 22:46:16,437 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-11 22:46:16,437 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-11 22:46:16,439 - DuckDbRefreshViewsTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 49117) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-11 22:46:16,439 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 22:46:16,439 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-11 22:46:16,439 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-11 22:46:16,440 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-11 22:46:16,440 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-11 22:46:16,440 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-11 22:46:16,440 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-11 22:46:16,446 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 22:46:16,446 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 22:46:16,446 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 22:46:16,446 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 22:46:16,446 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-11 22:46:16,446 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-11 22:46:16,446 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-11 22:46:16,446 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-11 22:46:16,446 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-11 22:46:16,447 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-11 22:46:16,447 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-11 22:46:16,447 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-11 22:46:16,447 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-11 22:46:16,447 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-11 22:46:16,447 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-11 22:46:16,448 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-11 22:46:16,448 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-11 22:46:16,448 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-11 22:46:16,448 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-11 22:46:16,448 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-11 22:46:16,455 - root - INFO - All routes registered successfully
2025-11-11 22:46:17,441 - DuckDbRefreshViewsTool - INFO - Auto-refresh stopped
2025-11-11 22:46:18,446 - DuckDbQueryTool - INFO - Auto-refresh stopped
2025-11-11 22:46:19,420 - DuckDbAggregateTool - INFO - Auto-refresh stopped
2025-11-11 22:46:20,247 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:20] "GET /health HTTP/1.1" 200 -
2025-11-11 22:46:20,415 - DuckDbListTablesTool - INFO - Auto-refresh stopped
2025-11-11 22:46:21,398 - DuckDbGetStatsTool - INFO - Auto-refresh stopped
2025-11-11 22:46:22,396 - DuckDbListFilesTool - INFO - Auto-refresh stopped
2025-11-11 22:46:23,118 - DuckDbDescribeTableTool - INFO - Auto-refresh stopped
2025-11-11 22:46:34,690 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:34] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 22:46:34,870 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:34] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 22:46:34,870 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:34] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 22:46:34,922 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:34] "GET /socket.io/?EIO=4&transport=polling&t=PfsB24b HTTP/1.1" 200 -
2025-11-11 22:46:34,923 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:34] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 22:46:34,927 - root - INFO - WebSocket client connected: gYc68EHhR1HACdjGAABc
2025-11-11 22:46:34,928 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:34] "POST /socket.io/?EIO=4&transport=polling&t=PfsB24j&sid=J1-R2gTRYC1YtXEnAABa HTTP/1.1" 200 -
2025-11-11 22:46:34,929 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:34] "GET /socket.io/?EIO=4&transport=polling&t=PfsB24j.0&sid=J1-R2gTRYC1YtXEnAABa HTTP/1.1" 200 -
2025-11-11 22:46:34,930 - root - INFO - WebSocket client connected: D-_5ZUnORkNH-beeAABd
2025-11-11 22:46:34,937 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:34] "POST /socket.io/?EIO=4&transport=polling&t=PfsB24r&sid=J1-R2gTRYC1YtXEnAABa HTTP/1.1" 200 -
2025-11-11 22:46:34,937 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:34] "GET /socket.io/?EIO=4&transport=polling&t=PfsB24q&sid=J1-R2gTRYC1YtXEnAABa HTTP/1.1" 200 -
2025-11-11 22:46:34,943 - root - INFO - Client gYc68EHhR1HACdjGAABc joined session room: sess-f6nmwjba
2025-11-11 22:46:34,944 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:34] "POST /socket.io/?EIO=4&transport=polling&t=PfsB24x&sid=J1-R2gTRYC1YtXEnAABa HTTP/1.1" 200 -
2025-11-11 22:46:34,945 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:34] "GET /socket.io/?EIO=4&transport=polling&t=PfsB24w&sid=J1-R2gTRYC1YtXEnAABa HTTP/1.1" 200 -
2025-11-11 22:46:34,949 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:34] "GET /socket.io/?EIO=4&transport=polling&t=PfsB252&sid=J1-R2gTRYC1YtXEnAABa HTTP/1.1" 200 -
2025-11-11 22:46:35,122 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:35] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 22:46:39,102 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:39] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 22:46:39,108 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:39] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 22:46:43,754 - root - INFO - WebSocket client disconnected: D-_5ZUnORkNH-beeAABd
2025-11-11 22:46:43,756 - root - INFO - WebSocket client disconnected: gYc68EHhR1HACdjGAABc
2025-11-11 22:46:43,757 - root - INFO - WebSocket client disconnected: K0tPlFGkTwYzYIqrAAA1
2025-11-11 22:46:43,758 - root - INFO - WebSocket client disconnected: 56ek4QX_T0kP2U2gAAA0
2025-11-11 22:46:43,758 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:43] "GET /socket.io/?EIO=4&transport=websocket&sid=J1-R2gTRYC1YtXEnAABa HTTP/1.1" 200 -
2025-11-11 22:46:43,759 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:43] "GET /socket.io/?EIO=4&transport=websocket&sid=WxsaDR9heV-zUO3lAAAy HTTP/1.1" 200 -
2025-11-11 22:46:43,769 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:43] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 22:46:43,769 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:43] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 22:46:43,771 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 22:46:43,772 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 22:46:47,132 - root - INFO - WebSocket client disconnected: IXY4xN0H96fvHSEfAABV
2025-11-11 22:46:47,133 - root - INFO - WebSocket client disconnected: KCmA7VqT5PDhO-cVAABU
2025-11-11 22:46:47,133 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:47] "GET /socket.io/?EIO=4&transport=websocket&sid=N8RiMIDOZaCyLN9lAABS HTTP/1.1" 200 -
2025-11-11 22:46:47,139 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:47] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 22:46:47,141 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 22:46:51,097 - root - INFO - WebSocket client disconnected: hxe3vHf3qnbdTig0AABX
2025-11-11 22:46:51,097 - root - INFO - WebSocket client disconnected: 9CNBvKdZR5doBjoOAABZ
2025-11-11 22:46:51,098 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:51] "GET /socket.io/?EIO=4&transport=websocket&sid=rYVOV9cUcYe1abLiAABW HTTP/1.1" 200 -
2025-11-11 22:46:51,104 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:51] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 22:46:51,105 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 22:46:56,192 - root - INFO - WebSocket client disconnected: 4grB71yC2cVFinHqAABJ
2025-11-11 22:46:56,193 - root - INFO - WebSocket client disconnected: qbZkW-6NjMtzztqXAABI
2025-11-11 22:46:56,194 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:56] "GET /socket.io/?EIO=4&transport=websocket&sid=1Xy0iaNOcZMdirCiAABG HTTP/1.1" 200 -
2025-11-11 22:46:56,197 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:46:56] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 22:46:56,198 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 22:47:04,966 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:04] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 22:47:05,008 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:05] "GET /login?next=http://localhost:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 22:47:05,026 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:05] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 22:47:05,026 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:05] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 22:47:05,109 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:05] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-11-11 22:47:12,832 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 22:47:12,832 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 22:47:12,833 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:12] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 22:47:12,849 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:12] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 22:47:12,870 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:12] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 22:47:12,872 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:12] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 22:47:21,368 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:21] "[33mGET /agent HTTP/1.1[0m" 404 -
2025-11-11 22:47:21,380 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:21] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 22:47:21,381 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:21] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 22:47:24,403 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:24] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 22:47:24,419 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:24] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 22:47:24,422 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:24] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 22:47:24,479 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:24] "GET /socket.io/?EIO=4&transport=polling&t=PfsBEAz HTTP/1.1" 200 -
2025-11-11 22:47:24,482 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:24] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 22:47:24,485 - root - INFO - WebSocket client connected: n5kT6_yvKnHxN902AABg
2025-11-11 22:47:24,486 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:24] "POST /socket.io/?EIO=4&transport=polling&t=PfsBEB3&sid=toDnhw1QdUj7XLmwAABe HTTP/1.1" 200 -
2025-11-11 22:47:24,486 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:24] "GET /socket.io/?EIO=4&transport=polling&t=PfsBEB3.0&sid=toDnhw1QdUj7XLmwAABe HTTP/1.1" 200 -
2025-11-11 22:47:24,492 - root - INFO - WebSocket client connected: AWYI12zitYVBnL-BAABh
2025-11-11 22:47:24,493 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:24] "POST /socket.io/?EIO=4&transport=polling&t=PfsBEBC&sid=toDnhw1QdUj7XLmwAABe HTTP/1.1" 200 -
2025-11-11 22:47:24,494 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:24] "GET /socket.io/?EIO=4&transport=polling&t=PfsBEBB&sid=toDnhw1QdUj7XLmwAABe HTTP/1.1" 200 -
2025-11-11 22:47:24,495 - root - INFO - Client n5kT6_yvKnHxN902AABg joined session room: sess-lmfiztht
2025-11-11 22:47:24,495 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:24] "POST /socket.io/?EIO=4&transport=polling&t=PfsBEBE.0&sid=toDnhw1QdUj7XLmwAABe HTTP/1.1" 200 -
2025-11-11 22:47:24,495 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:24] "GET /socket.io/?EIO=4&transport=polling&t=PfsBEBE&sid=toDnhw1QdUj7XLmwAABe HTTP/1.1" 200 -
2025-11-11 22:47:24,687 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:24] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 22:47:31,583 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:31] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 22:47:31,588 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:31] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 22:47:55,230 - root - INFO - WebSocket client disconnected: AWYI12zitYVBnL-BAABh
2025-11-11 22:47:55,231 - root - INFO - WebSocket client disconnected: n5kT6_yvKnHxN902AABg
2025-11-11 22:47:55,231 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:55] "GET /socket.io/?EIO=4&transport=websocket&sid=toDnhw1QdUj7XLmwAABe HTTP/1.1" 200 -
2025-11-11 22:47:55,234 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:55] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 22:47:55,238 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:55] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 22:47:55,241 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 22:47:55,248 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:55] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 22:47:55,252 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:55] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 22:47:55,263 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:55] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 22:47:55,299 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:55] "GET /socket.io/?EIO=4&transport=polling&t=PfsBLiT HTTP/1.1" 200 -
2025-11-11 22:47:55,307 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:55] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 22:47:55,315 - root - INFO - WebSocket client connected: VwZKIV7QIMpnsaAxAABk
2025-11-11 22:47:55,316 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:55] "POST /socket.io/?EIO=4&transport=polling&t=PfsBLic&sid=x8-Khj4AYajiDJBXAABi HTTP/1.1" 200 -
2025-11-11 22:47:55,317 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:55] "GET /socket.io/?EIO=4&transport=polling&t=PfsBLic.0&sid=x8-Khj4AYajiDJBXAABi HTTP/1.1" 200 -
2025-11-11 22:47:55,325 - root - INFO - WebSocket client connected: EhJVQYs7eYyl0LozAABl
2025-11-11 22:47:55,332 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:55] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-11-11 22:47:55,341 - root - INFO - Client VwZKIV7QIMpnsaAxAABk joined session room: sess-lmfiztht
2025-11-11 22:47:55,500 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:47:55] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 22:48:28,239 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-11 22:48:28,254 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-11 22:48:28,254 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-11 22:48:28,255 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-11 22:48:28,255 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-11 22:48:28,275 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 22:48:28,275 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 22:48:28,275 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 22:48:28,275 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 22:48:28,275 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-11 22:48:28,275 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-11 22:48:28,275 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-11 22:48:28,276 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-11 22:48:28,276 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-11 22:48:28,277 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-11 22:48:28,277 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-11 22:48:28,277 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-11 22:48:28,277 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-11 22:48:28,278 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-11 22:48:28,278 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-11 22:48:28,279 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-11 22:48:28,279 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-11 22:48:28,280 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-11 22:48:28,280 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-11 22:48:28,593 - DuckDbDescribeTableTool - INFO - Found 1 data files in data/duckdb
2025-11-11 22:48:28,631 - DuckDbDescribeTableTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 22:48:28,639 - DuckDbDescribeTableTool - INFO - Initialization complete: 4 views available
2025-11-11 22:48:28,639 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 22:48:28,639 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-11 22:48:28,639 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-11 22:48:28,640 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-11 22:48:28,640 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-11 22:48:28,836 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-11 22:48:28,836 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-11 22:48:28,837 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-11 22:48:28,837 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-11 22:48:28,838 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-11 22:48:28,838 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-11 22:48:28,838 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-11 22:48:28,838 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-11 22:48:28,838 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-11 22:48:28,838 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-11 22:48:28,841 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-11 22:48:28,841 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-11 22:48:28,841 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-11 22:48:28,841 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-11 22:48:28,842 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-11 22:48:28,842 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-11 22:48:28,842 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-11 22:48:28,842 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-11 22:48:28,842 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-11 22:48:28,842 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-11 22:48:28,843 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-11 22:48:28,843 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-11 22:48:28,843 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-11 22:48:28,843 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-11 22:48:28,844 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-11 22:48:28,844 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-11 22:48:28,844 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-11 22:48:28,844 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-11 22:48:28,844 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-11 22:48:28,844 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-11 22:48:28,845 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-11 22:48:28,845 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-11 22:48:28,846 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-11 22:48:28,846 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-11 22:48:28,846 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-11 22:48:28,846 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-11 22:48:28,846 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-11 22:48:28,846 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-11 22:48:28,848 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-11 22:48:28,848 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-11 22:48:28,849 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-11 22:48:28,849 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-11 22:48:28,849 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-11 22:48:28,849 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-11 22:48:28,849 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-11 22:48:28,849 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-11 22:48:28,855 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 22:48:28,855 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 22:48:28,855 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 22:48:28,855 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 22:48:28,856 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-11 22:48:28,856 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-11 22:48:28,856 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-11 22:48:28,856 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-11 22:48:28,856 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-11 22:48:28,856 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-11 22:48:28,856 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-11 22:48:28,857 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-11 22:48:28,857 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-11 22:48:28,857 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-11 22:48:28,857 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-11 22:48:28,858 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-11 22:48:28,858 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-11 22:48:28,858 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-11 22:48:28,858 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-11 22:48:28,858 - DuckDbListFilesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 22:48:28,895 - DuckDbListFilesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 22:48:28,897 - DuckDbListFilesTool - INFO - Initialization complete: 4 views available
2025-11-11 22:48:28,897 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 22:48:28,897 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-11 22:48:28,897 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-11 22:48:28,897 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-11 22:48:28,897 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-11 22:48:28,898 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-11 22:48:28,898 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-11 22:48:28,898 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-11 22:48:28,898 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-11 22:48:28,898 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-11 22:48:28,898 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-11 22:48:28,898 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-11 22:48:28,898 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-11 22:48:28,899 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-11 22:48:28,899 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-11 22:48:28,899 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-11 22:48:28,899 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-11 22:48:28,900 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-11 22:48:28,900 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-11 22:48:28,900 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-11 22:48:28,900 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-11 22:48:28,900 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-11 22:48:28,900 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-11 22:48:28,900 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-11 22:48:28,900 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-11 22:48:28,901 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-11 22:48:28,901 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-11 22:48:28,901 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-11 22:48:28,901 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-11 22:48:28,901 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-11 22:48:28,901 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-11 22:48:28,901 - DuckDbGetStatsTool - INFO - Found 1 data files in data/duckdb
2025-11-11 22:48:28,938 - DuckDbGetStatsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 22:48:28,939 - DuckDbGetStatsTool - INFO - Initialization complete: 4 views available
2025-11-11 22:48:28,939 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 22:48:28,939 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-11 22:48:28,939 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-11 22:48:28,940 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-11 22:48:28,940 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-11 22:48:28,940 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-11 22:48:28,940 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-11 22:48:28,940 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-11 22:48:28,940 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-11 22:48:28,940 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-11 22:48:28,940 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-11 22:48:28,946 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 22:48:28,946 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 22:48:28,946 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 22:48:28,946 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 22:48:28,946 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-11 22:48:28,946 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-11 22:48:28,946 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-11 22:48:28,947 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-11 22:48:28,947 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-11 22:48:28,947 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-11 22:48:28,947 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-11 22:48:28,950 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-11 22:48:28,950 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-11 22:48:28,950 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-11 22:48:28,950 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-11 22:48:28,950 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-11 22:48:28,951 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-11 22:48:28,951 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-11 22:48:28,951 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-11 22:48:28,951 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-11 22:48:28,951 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-11 22:48:28,951 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-11 22:48:28,951 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-11 22:48:28,952 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-11 22:48:28,952 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-11 22:48:28,952 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-11 22:48:28,952 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-11 22:48:28,953 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-11 22:48:28,953 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-11 22:48:28,953 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-11 22:48:28,953 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-11 22:48:28,953 - DuckDbListTablesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 22:48:28,990 - DuckDbListTablesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 22:48:28,991 - DuckDbListTablesTool - INFO - Initialization complete: 4 views available
2025-11-11 22:48:28,991 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 22:48:28,991 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-11 22:48:28,991 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-11 22:48:28,992 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-11 22:48:28,992 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-11 22:48:28,992 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-11 22:48:28,992 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-11 22:48:28,992 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-11 22:48:28,992 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-11 22:48:28,993 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-11 22:48:28,993 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-11 22:48:28,993 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-11 22:48:28,993 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-11 22:48:28,993 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-11 22:48:28,993 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-11 22:48:28,993 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-11 22:48:28,994 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-11 22:48:28,994 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-11 22:48:28,994 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-11 22:48:28,994 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-11 22:48:28,994 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-11 22:48:28,994 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-11 22:48:28,994 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-11 22:48:28,994 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-11 22:48:28,994 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-11 22:48:28,995 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-11 22:48:28,995 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-11 22:48:28,995 - DuckDbAggregateTool - INFO - Found 1 data files in data/duckdb
2025-11-11 22:48:29,032 - DuckDbAggregateTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 22:48:29,034 - DuckDbAggregateTool - INFO - Initialization complete: 4 views available
2025-11-11 22:48:29,034 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 22:48:29,034 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-11 22:48:29,034 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-11 22:48:29,034 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-11 22:48:29,034 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-11 22:48:29,034 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-11 22:48:29,034 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-11 22:48:29,035 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-11 22:48:29,035 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-11 22:48:29,035 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-11 22:48:29,035 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-11 22:48:29,035 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-11 22:48:29,035 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-11 22:48:29,035 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-11 22:48:29,035 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-11 22:48:29,041 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 22:48:29,041 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 22:48:29,041 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 22:48:29,041 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 22:48:29,041 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-11 22:48:29,041 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-11 22:48:29,041 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-11 22:48:29,042 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-11 22:48:29,042 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-11 22:48:29,042 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-11 22:48:29,042 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-11 22:48:29,042 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-11 22:48:29,042 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-11 22:48:29,042 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-11 22:48:29,042 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-11 22:48:29,042 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-11 22:48:29,042 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-11 22:48:29,043 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-11 22:48:29,043 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-11 22:48:29,043 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-11 22:48:29,043 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-11 22:48:29,043 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-11 22:48:29,043 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-11 22:48:29,043 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-11 22:48:29,043 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-11 22:48:29,043 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-11 22:48:29,043 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-11 22:48:29,044 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-11 22:48:29,044 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-11 22:48:29,044 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-11 22:48:29,044 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-11 22:48:29,044 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-11 22:48:29,044 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-11 22:48:29,044 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-11 22:48:29,044 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-11 22:48:29,045 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-11 22:48:29,045 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-11 22:48:29,045 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-11 22:48:29,045 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-11 22:48:29,045 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-11 22:48:29,045 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-11 22:48:29,045 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-11 22:48:29,045 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-11 22:48:29,046 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-11 22:48:29,046 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-11 22:48:29,046 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-11 22:48:29,046 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-11 22:48:29,046 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-11 22:48:29,046 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-11 22:48:29,046 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-11 22:48:29,046 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-11 22:48:29,046 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-11 22:48:29,046 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-11 22:48:29,046 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-11 22:48:29,046 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-11 22:48:29,047 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-11 22:48:29,047 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-11 22:48:29,047 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-11 22:48:29,047 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-11 22:48:29,047 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-11 22:48:29,047 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-11 22:48:29,047 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-11 22:48:29,047 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-11 22:48:29,048 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-11 22:48:29,048 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-11 22:48:29,049 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-11 22:48:29,049 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-11 22:48:29,049 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-11 22:48:29,049 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-11 22:48:29,049 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-11 22:48:29,049 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-11 22:48:29,049 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-11 22:48:29,049 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-11 22:48:29,049 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-11 22:48:29,049 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-11 22:48:29,055 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 22:48:29,055 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 22:48:29,055 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 22:48:29,055 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 22:48:29,055 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-11 22:48:29,055 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-11 22:48:29,055 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-11 22:48:29,055 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-11 22:48:29,055 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-11 22:48:29,055 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-11 22:48:29,055 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-11 22:48:29,056 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-11 22:48:29,056 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-11 22:48:29,056 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-11 22:48:29,056 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-11 22:48:29,056 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-11 22:48:29,056 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-11 22:48:29,056 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-11 22:48:29,056 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-11 22:48:29,056 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-11 22:48:29,056 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-11 22:48:29,056 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-11 22:48:29,057 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-11 22:48:29,057 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-11 22:48:29,057 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-11 22:48:29,057 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-11 22:48:29,057 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-11 22:48:29,057 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-11 22:48:29,057 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-11 22:48:29,057 - DuckDbQueryTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 22:48:29,091 - DuckDbQueryTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 22:48:29,093 - DuckDbQueryTool - INFO - Initialization complete: 4 views available
2025-11-11 22:48:29,093 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 22:48:29,093 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-11 22:48:29,093 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-11 22:48:29,093 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-11 22:48:29,093 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-11 22:48:29,093 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-11 22:48:29,093 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-11 22:48:29,093 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-11 22:48:29,093 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-11 22:48:29,094 - DuckDbRefreshViewsTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 22:48:29,129 - DuckDbRefreshViewsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 22:48:29,131 - DuckDbRefreshViewsTool - INFO - Initialization complete: 4 views available
2025-11-11 22:48:29,131 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 22:48:29,131 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-11 22:48:29,131 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-11 22:48:29,131 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-11 22:48:29,131 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-11 22:48:29,131 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-11 22:48:29,131 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-11 22:48:29,137 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 22:48:29,137 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 22:48:29,137 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 22:48:29,137 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 22:48:29,137 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-11 22:48:29,137 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-11 22:48:29,137 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-11 22:48:29,138 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-11 22:48:29,138 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-11 22:48:29,138 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-11 22:48:29,138 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-11 22:48:29,138 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-11 22:48:29,138 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-11 22:48:29,138 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-11 22:48:29,138 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-11 22:48:29,138 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-11 22:48:29,138 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-11 22:48:29,138 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-11 22:48:29,138 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-11 22:48:29,139 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-11 22:48:29,147 - root - INFO - All routes registered successfully
2025-11-11 22:48:29,151 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.68.51:8000
2025-11-11 22:48:29,151 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-11-11 22:48:29,257 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:29] "GET /socket.io/?EIO=4&transport=polling&t=PfsBT_7 HTTP/1.1" 200 -
2025-11-11 22:48:29,260 - root - INFO - WebSocket client connected: 7Wv6Yu0O16vnSvF0AAAB
2025-11-11 22:48:29,260 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:29] "POST /socket.io/?EIO=4&transport=polling&t=PfsBT_A&sid=hKx_uDd3BQRUyvQ1AAAA HTTP/1.1" 200 -
2025-11-11 22:48:29,261 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:29] "GET /socket.io/?EIO=4&transport=polling&t=PfsBT_B&sid=hKx_uDd3BQRUyvQ1AAAA HTTP/1.1" 200 -
2025-11-11 22:48:29,263 - root - INFO - WebSocket client disconnected: 7Wv6Yu0O16vnSvF0AAAB
2025-11-11 22:48:29,264 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:29] "GET /socket.io/?EIO=4&transport=websocket&sid=hKx_uDd3BQRUyvQ1AAAA HTTP/1.1" 200 -
2025-11-11 22:48:30,268 - root - INFO - WebSocket client connected: N-WSmMW4gtG-pCCqAAAD
2025-11-11 22:48:30,272 - root - INFO - WebSocket client disconnected: N-WSmMW4gtG-pCCqAAAD
2025-11-11 22:48:30,286 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:30] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 22:48:30,290 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 22:48:30,809 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:30] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 22:48:30,829 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:30] "GET /login?next=http://localhost:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 22:48:30,840 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:30] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 22:48:30,841 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:30] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 22:48:32,613 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:32] "[32mHEAD /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 22:48:35,939 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 22:48:35,939 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 22:48:35,940 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:35] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 22:48:35,956 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:35] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 22:48:35,968 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:35] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 22:48:35,968 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:35] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 22:48:40,391 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:40] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 22:48:40,406 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:40] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 22:48:40,406 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:40] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 22:48:40,460 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:40] "GET /socket.io/?EIO=4&transport=polling&t=PfsBWkB HTTP/1.1" 200 -
2025-11-11 22:48:40,463 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:40] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 22:48:40,465 - root - INFO - WebSocket client connected: lewAPBFOpGTD2hZrAAAG
2025-11-11 22:48:40,466 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:40] "POST /socket.io/?EIO=4&transport=polling&t=PfsBWkE&sid=wb-RVEZ4R5xFl6F6AAAE HTTP/1.1" 200 -
2025-11-11 22:48:40,466 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:40] "GET /socket.io/?EIO=4&transport=polling&t=PfsBWkE.0&sid=wb-RVEZ4R5xFl6F6AAAE HTTP/1.1" 200 -
2025-11-11 22:48:40,468 - root - INFO - WebSocket client connected: sWVE0A9TKsZWLs6DAAAH
2025-11-11 22:48:40,469 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:40] "POST /socket.io/?EIO=4&transport=polling&t=PfsBWkK&sid=wb-RVEZ4R5xFl6F6AAAE HTTP/1.1" 200 -
2025-11-11 22:48:40,469 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:40] "GET /socket.io/?EIO=4&transport=polling&t=PfsBWkJ&sid=wb-RVEZ4R5xFl6F6AAAE HTTP/1.1" 200 -
2025-11-11 22:48:40,471 - root - INFO - Client lewAPBFOpGTD2hZrAAAG joined session room: sess-7luvwc7m
2025-11-11 22:48:40,471 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:40] "POST /socket.io/?EIO=4&transport=polling&t=PfsBWkM.0&sid=wb-RVEZ4R5xFl6F6AAAE HTTP/1.1" 200 -
2025-11-11 22:48:40,471 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:40] "GET /socket.io/?EIO=4&transport=polling&t=PfsBWkM&sid=wb-RVEZ4R5xFl6F6AAAE HTTP/1.1" 200 -
2025-11-11 22:48:40,476 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:40] "GET /socket.io/?EIO=4&transport=polling&t=PfsBWkO&sid=wb-RVEZ4R5xFl6F6AAAE HTTP/1.1" 200 -
2025-11-11 22:48:40,669 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:48:40] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 22:49:27,480 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:49:27] "GET /health HTTP/1.1" 200 -
2025-11-11 22:49:43,814 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:49:43] "GET /health HTTP/1.1" 200 -
2025-11-11 22:52:29,052 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:52:29] "GET /health HTTP/1.1" 200 -
2025-11-11 22:52:37,933 - root - INFO - WebSocket client disconnected: sWVE0A9TKsZWLs6DAAAH
2025-11-11 22:52:37,934 - root - INFO - WebSocket client disconnected: lewAPBFOpGTD2hZrAAAG
2025-11-11 22:52:37,934 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:52:37] "GET /socket.io/?EIO=4&transport=websocket&sid=wb-RVEZ4R5xFl6F6AAAE HTTP/1.1" 200 -
2025-11-11 22:52:37,936 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:52:37] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 22:52:37,940 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:52:37] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 22:52:37,941 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 22:52:37,949 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:52:37] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 22:52:37,950 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:52:37] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 22:52:37,967 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:52:37] "GET /socket.io/?EIO=4&transport=polling&t=PfsCQjD HTTP/1.1" 200 -
2025-11-11 22:52:37,969 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:52:37] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 22:52:37,971 - root - INFO - WebSocket client connected: PXK9X0FkETnIBk-WAAAK
2025-11-11 22:52:37,972 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:52:37] "POST /socket.io/?EIO=4&transport=polling&t=PfsCQjH&sid=yveDaTOqiekBjpfJAAAI HTTP/1.1" 200 -
2025-11-11 22:52:37,973 - root - INFO - WebSocket client connected: saH87z56XEPCfOidAAAL
2025-11-11 22:52:37,973 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:52:37] "GET /socket.io/?EIO=4&transport=polling&t=PfsCQjH.0&sid=yveDaTOqiekBjpfJAAAI HTTP/1.1" 200 -
2025-11-11 22:52:37,976 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:52:37] "POST /socket.io/?EIO=4&transport=polling&t=PfsCQjM.0&sid=yveDaTOqiekBjpfJAAAI HTTP/1.1" 200 -
2025-11-11 22:52:37,976 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:52:37] "GET /socket.io/?EIO=4&transport=polling&t=PfsCQjM&sid=yveDaTOqiekBjpfJAAAI HTTP/1.1" 200 -
2025-11-11 22:52:37,978 - root - INFO - Client PXK9X0FkETnIBk-WAAAK joined session room: sess-7luvwc7m
2025-11-11 22:52:37,978 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:52:37] "POST /socket.io/?EIO=4&transport=polling&t=PfsCQjP.0&sid=yveDaTOqiekBjpfJAAAI HTTP/1.1" 200 -
2025-11-11 22:52:37,979 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:52:37] "GET /socket.io/?EIO=4&transport=polling&t=PfsCQjP&sid=yveDaTOqiekBjpfJAAAI HTTP/1.1" 200 -
2025-11-11 22:52:37,982 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:52:37] "GET /socket.io/?EIO=4&transport=polling&t=PfsCQjS&sid=yveDaTOqiekBjpfJAAAI HTTP/1.1" 200 -
2025-11-11 22:52:38,176 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:52:38] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 22:52:47,989 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:52:47] "GET /health HTTP/1.1" 200 -
2025-11-11 22:54:57,843 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:54:57] "GET /health HTTP/1.1" 200 -
2025-11-11 22:55:03,501 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:55:03] "[32mGET /api/agent/config-files?type=data_dict HTTP/1.1[0m" 302 -
2025-11-11 22:55:03,860 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:55:03] "[32mGET /api/agent/config-files?type=welcome HTTP/1.1[0m" 302 -
2025-11-11 22:55:04,315 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:55:04] "[32mGET /api/agent/config-files?type=agent_prompts HTTP/1.1[0m" 302 -
2025-11-11 22:55:40,684 - root - INFO - WebSocket client disconnected: PXK9X0FkETnIBk-WAAAK
2025-11-11 22:55:40,684 - root - INFO - WebSocket client disconnected: saH87z56XEPCfOidAAAL
2025-11-11 22:55:40,685 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:55:40] "GET /socket.io/?EIO=4&transport=websocket&sid=yveDaTOqiekBjpfJAAAI HTTP/1.1" 200 -
2025-11-11 22:55:40,687 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:55:40] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 22:55:40,691 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:55:40] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 22:55:40,692 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 22:55:40,702 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:55:40] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 22:55:40,702 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:55:40] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 22:55:40,734 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:55:40] "GET /socket.io/?EIO=4&transport=polling&t=PfsD7Ky HTTP/1.1" 200 -
2025-11-11 22:55:40,738 - root - INFO - WebSocket client connected: -cH5ywdZiHJBAhhFAAAO
2025-11-11 22:55:40,738 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:55:40] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 22:55:40,739 - root - INFO - WebSocket client connected: hwNsGT5uEWCGkdpxAAAP
2025-11-11 22:55:40,739 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:55:40] "POST /socket.io/?EIO=4&transport=polling&t=PfsD7L1&sid=LuuFn_8lpAjJd9sRAAAM HTTP/1.1" 200 -
2025-11-11 22:55:40,740 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:55:40] "GET /socket.io/?EIO=4&transport=polling&t=PfsD7L1.0&sid=LuuFn_8lpAjJd9sRAAAM HTTP/1.1" 200 -
2025-11-11 22:55:40,743 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:55:40] "POST /socket.io/?EIO=4&transport=polling&t=PfsD7L5.0&sid=LuuFn_8lpAjJd9sRAAAM HTTP/1.1" 200 -
2025-11-11 22:55:40,743 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:55:40] "GET /socket.io/?EIO=4&transport=polling&t=PfsD7L5&sid=LuuFn_8lpAjJd9sRAAAM HTTP/1.1" 200 -
2025-11-11 22:55:40,745 - root - INFO - Client hwNsGT5uEWCGkdpxAAAP joined session room: sess-7luvwc7m
2025-11-11 22:55:40,745 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:55:40] "POST /socket.io/?EIO=4&transport=polling&t=PfsD7L8.0&sid=LuuFn_8lpAjJd9sRAAAM HTTP/1.1" 200 -
2025-11-11 22:55:40,746 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:55:40] "GET /socket.io/?EIO=4&transport=polling&t=PfsD7L8&sid=LuuFn_8lpAjJd9sRAAAM HTTP/1.1" 200 -
2025-11-11 22:55:40,748 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:55:40] "GET /socket.io/?EIO=4&transport=polling&t=PfsD7LA&sid=LuuFn_8lpAjJd9sRAAAM HTTP/1.1" 200 -
2025-11-11 22:55:40,943 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:55:40] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 22:56:21,407 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:56:21] "GET /api/agent/welcome-message?file=queryagent_planner.json HTTP/1.1" 200 -
2025-11-11 22:56:59,077 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:56:59] "GET /health HTTP/1.1" 200 -
2025-11-11 22:57:27,705 - root - INFO - WebSocket client disconnected: -cH5ywdZiHJBAhhFAAAO
2025-11-11 22:57:27,706 - root - INFO - WebSocket client disconnected: hwNsGT5uEWCGkdpxAAAP
2025-11-11 22:57:27,706 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:57:27] "GET /socket.io/?EIO=4&transport=websocket&sid=LuuFn_8lpAjJd9sRAAAM HTTP/1.1" 200 -
2025-11-11 22:57:27,709 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:57:27] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 22:57:27,712 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:57:27] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 22:57:27,713 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 22:57:27,722 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:57:27] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 22:57:27,722 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:57:27] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 22:57:27,744 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:57:27] "GET /socket.io/?EIO=4&transport=polling&t=PfsDXS- HTTP/1.1" 200 -
2025-11-11 22:57:27,746 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:57:27] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 22:57:27,748 - root - INFO - WebSocket client connected: TuACkR8e5GbNTjx2AAAS
2025-11-11 22:57:27,748 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:57:27] "POST /socket.io/?EIO=4&transport=polling&t=PfsDXT2&sid=7TwD33b5Ztr23M1xAAAQ HTTP/1.1" 200 -
2025-11-11 22:57:27,749 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:57:27] "GET /socket.io/?EIO=4&transport=polling&t=PfsDXT2.0&sid=7TwD33b5Ztr23M1xAAAQ HTTP/1.1" 200 -
2025-11-11 22:57:27,750 - root - INFO - WebSocket client connected: hPSzy_RZBDQuL8mFAAAT
2025-11-11 22:57:27,754 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:57:27] "POST /socket.io/?EIO=4&transport=polling&t=PfsDXT7.0&sid=7TwD33b5Ztr23M1xAAAQ HTTP/1.1" 200 -
2025-11-11 22:57:27,754 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:57:27] "GET /socket.io/?EIO=4&transport=polling&t=PfsDXT7&sid=7TwD33b5Ztr23M1xAAAQ HTTP/1.1" 200 -
2025-11-11 22:57:27,756 - root - INFO - Client TuACkR8e5GbNTjx2AAAS joined session room: sess-7luvwc7m
2025-11-11 22:57:27,757 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:57:27] "POST /socket.io/?EIO=4&transport=polling&t=PfsDXTB.0&sid=7TwD33b5Ztr23M1xAAAQ HTTP/1.1" 200 -
2025-11-11 22:57:27,758 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:57:27] "GET /socket.io/?EIO=4&transport=polling&t=PfsDXTB&sid=7TwD33b5Ztr23M1xAAAQ HTTP/1.1" 200 -
2025-11-11 22:57:27,760 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:57:27] "GET /socket.io/?EIO=4&transport=polling&t=PfsDXTF&sid=7TwD33b5Ztr23M1xAAAQ HTTP/1.1" 200 -
2025-11-11 22:57:27,951 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:57:27] "GET /api/agent/welcome-message?file=queryagent_planner.json HTTP/1.1" 200 -
2025-11-11 22:58:19,675 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:58:19] "GET /health HTTP/1.1" 200 -
2025-11-11 22:58:53,217 - root - INFO - WebSocket client disconnected: hPSzy_RZBDQuL8mFAAAT
2025-11-11 22:58:53,217 - root - INFO - WebSocket client disconnected: TuACkR8e5GbNTjx2AAAS
2025-11-11 22:58:53,217 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:58:53] "GET /socket.io/?EIO=4&transport=websocket&sid=7TwD33b5Ztr23M1xAAAQ HTTP/1.1" 200 -
2025-11-11 22:58:53,221 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:58:53] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 22:58:53,225 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:58:53] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 22:58:53,226 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 22:58:53,235 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:58:53] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 22:58:53,235 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:58:53] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 22:58:53,293 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:58:53] "GET /socket.io/?EIO=4&transport=polling&t=PfsDsLh HTTP/1.1" 200 -
2025-11-11 22:58:53,297 - root - INFO - WebSocket client connected: YCqpcmyamHZFPjbrAAAW
2025-11-11 22:58:53,298 - root - INFO - WebSocket client connected: rS-grKDzcIzC-qKDAAAX
2025-11-11 22:58:53,298 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:58:53] "POST /socket.io/?EIO=4&transport=polling&t=PfsDsLm&sid=JBz6PetR1ZQrfz8xAAAU HTTP/1.1" 200 -
2025-11-11 22:58:53,300 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:58:53] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 22:58:53,301 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:58:53] "GET /socket.io/?EIO=4&transport=polling&t=PfsDsLm.0&sid=JBz6PetR1ZQrfz8xAAAU HTTP/1.1" 200 -
2025-11-11 22:58:53,304 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:58:53] "POST /socket.io/?EIO=4&transport=polling&t=PfsDsLs.0&sid=JBz6PetR1ZQrfz8xAAAU HTTP/1.1" 200 -
2025-11-11 22:58:53,304 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:58:53] "GET /socket.io/?EIO=4&transport=polling&t=PfsDsLs&sid=JBz6PetR1ZQrfz8xAAAU HTTP/1.1" 200 -
2025-11-11 22:58:53,306 - root - INFO - Client rS-grKDzcIzC-qKDAAAX joined session room: sess-7luvwc7m
2025-11-11 22:58:53,306 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:58:53] "POST /socket.io/?EIO=4&transport=polling&t=PfsDsLv.0&sid=JBz6PetR1ZQrfz8xAAAU HTTP/1.1" 200 -
2025-11-11 22:58:53,307 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:58:53] "GET /socket.io/?EIO=4&transport=polling&t=PfsDsLv&sid=JBz6PetR1ZQrfz8xAAAU HTTP/1.1" 200 -
2025-11-11 22:58:53,501 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:58:53] "GET /api/agent/welcome-message?file=queryagent_planner.json HTTP/1.1" 200 -
2025-11-11 22:59:11,071 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:59:11] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 22:59:11,078 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:59:11] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 22:59:21,359 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 22:59:21] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:00:41,008 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:00:41] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:02:46,672 - root - INFO - WebSocket client disconnected: rS-grKDzcIzC-qKDAAAX
2025-11-11 23:02:46,673 - root - INFO - WebSocket client disconnected: YCqpcmyamHZFPjbrAAAW
2025-11-11 23:02:46,673 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:02:46] "GET /socket.io/?EIO=4&transport=websocket&sid=JBz6PetR1ZQrfz8xAAAU HTTP/1.1" 200 -
2025-11-11 23:02:46,675 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:02:46] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 23:02:46,680 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:02:46] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:02:46,681 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:02:46,690 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:02:46] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:02:46,690 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:02:46] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:02:46,697 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:02:46] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:02:46,733 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:02:46] "GET /socket.io/?EIO=4&transport=polling&t=PfsElLB HTTP/1.1" 200 -
2025-11-11 23:02:46,737 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:02:46] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 23:02:46,739 - root - INFO - WebSocket client connected: Frdge8gKDraMcHP_AAAa
2025-11-11 23:02:46,740 - root - INFO - WebSocket client connected: q_i3xGuGdId0h2_aAAAb
2025-11-11 23:02:46,740 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:02:46] "POST /socket.io/?EIO=4&transport=polling&t=PfsElLG&sid=30xGNcvutFtGSphOAAAY HTTP/1.1" 200 -
2025-11-11 23:02:46,741 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:02:46] "GET /socket.io/?EIO=4&transport=polling&t=PfsElLG.0&sid=30xGNcvutFtGSphOAAAY HTTP/1.1" 200 -
2025-11-11 23:02:46,744 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:02:46] "POST /socket.io/?EIO=4&transport=polling&t=PfsElLM.0&sid=30xGNcvutFtGSphOAAAY HTTP/1.1" 200 -
2025-11-11 23:02:46,744 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:02:46] "GET /socket.io/?EIO=4&transport=polling&t=PfsElLM&sid=30xGNcvutFtGSphOAAAY HTTP/1.1" 200 -
2025-11-11 23:02:46,746 - root - INFO - Client q_i3xGuGdId0h2_aAAAb joined session room: sess-7luvwc7m
2025-11-11 23:02:46,747 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:02:46] "POST /socket.io/?EIO=4&transport=polling&t=PfsElLP.0&sid=30xGNcvutFtGSphOAAAY HTTP/1.1" 200 -
2025-11-11 23:02:46,747 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:02:46] "GET /socket.io/?EIO=4&transport=polling&t=PfsElLP&sid=30xGNcvutFtGSphOAAAY HTTP/1.1" 200 -
2025-11-11 23:02:46,749 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:02:46] "GET /socket.io/?EIO=4&transport=polling&t=PfsElLT&sid=30xGNcvutFtGSphOAAAY HTTP/1.1" 200 -
2025-11-11 23:02:46,939 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:02:46] "GET /api/agent/welcome-message?file=queryagent_planner.json HTTP/1.1" 200 -
2025-11-11 23:03:19,269 - root - INFO - WebSocket client disconnected: q_i3xGuGdId0h2_aAAAb
2025-11-11 23:03:19,270 - root - INFO - WebSocket client disconnected: Frdge8gKDraMcHP_AAAa
2025-11-11 23:03:19,270 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:19] "GET /socket.io/?EIO=4&transport=websocket&sid=30xGNcvutFtGSphOAAAY HTTP/1.1" 200 -
2025-11-11 23:03:19,276 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:19] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:03:19,277 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:03:26,769 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:26] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 23:03:26,786 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:26] "GET /login?next=http://localhost:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 23:03:26,831 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:26] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:03:26,841 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:26] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:03:26,897 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:26] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-11-11 23:03:26,899 - root - INFO - WebSocket client connected: Yn0kO6BFF1sEMubEAAAd
2025-11-11 23:03:26,902 - root - INFO - WebSocket client disconnected: Yn0kO6BFF1sEMubEAAAd
2025-11-11 23:03:26,915 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:26] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:03:26,918 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:03:30,150 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:30] "GET /login?next=http://localhost:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 23:03:30,164 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:30] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:03:30,165 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:30] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:03:30,187 - root - INFO - WebSocket client connected: VuuMq-9yrNK_KH4qAAAf
2025-11-11 23:03:30,189 - root - INFO - WebSocket client disconnected: VuuMq-9yrNK_KH4qAAAf
2025-11-11 23:03:30,201 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:30] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:03:30,202 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:03:34,355 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 23:03:34,355 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 23:03:34,356 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:34] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 23:03:34,370 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:34] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 23:03:34,381 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:34] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:03:34,381 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:34] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:03:34,446 - root - INFO - WebSocket client connected: xvcfs96WFJ0qYLPQAAAh
2025-11-11 23:03:34,448 - root - INFO - WebSocket client disconnected: xvcfs96WFJ0qYLPQAAAh
2025-11-11 23:03:34,461 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:34] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:03:34,462 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:03:38,554 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:38] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 23:03:38,562 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:38] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:03:38,571 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:38] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:03:38,592 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:38] "GET /socket.io/?EIO=4&transport=polling&t=PfsEx_T HTTP/1.1" 200 -
2025-11-11 23:03:38,593 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:38] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 23:03:38,611 - root - INFO - WebSocket client connected: 8_4A6Euvg4QXN_AjAAAj
2025-11-11 23:03:38,612 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:38] "POST /socket.io/?EIO=4&transport=polling&t=PfsEx_m&sid=p3sPkASM4N4lAVIjAAAi HTTP/1.1" 200 -
2025-11-11 23:03:38,612 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:38] "GET /socket.io/?EIO=4&transport=polling&t=PfsEx_m.0&sid=p3sPkASM4N4lAVIjAAAi HTTP/1.1" 200 -
2025-11-11 23:03:38,615 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:38] "POST /socket.io/?EIO=4&transport=polling&t=PfsEx_s&sid=p3sPkASM4N4lAVIjAAAi HTTP/1.1" 200 -
2025-11-11 23:03:38,615 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:38] "GET /socket.io/?EIO=4&transport=polling&t=PfsEx_r&sid=p3sPkASM4N4lAVIjAAAi HTTP/1.1" 200 -
2025-11-11 23:03:38,617 - root - INFO - Client 8_4A6Euvg4QXN_AjAAAj joined session room: sess-h1hkrvda
2025-11-11 23:03:38,617 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:38] "POST /socket.io/?EIO=4&transport=polling&t=PfsEx_u.0&sid=p3sPkASM4N4lAVIjAAAi HTTP/1.1" 200 -
2025-11-11 23:03:38,618 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:38] "GET /socket.io/?EIO=4&transport=polling&t=PfsEx_u&sid=p3sPkASM4N4lAVIjAAAi HTTP/1.1" 200 -
2025-11-11 23:03:39,231 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:39] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:03:39,235 - root - INFO - WebSocket client connected: erxoYUs6ewhc536TAAAl
2025-11-11 23:03:39,245 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:39] "GET /socket.io/?EIO=4&transport=polling&t=PfsEx_w&sid=p3sPkASM4N4lAVIjAAAi HTTP/1.1" 200 -
2025-11-11 23:03:54,877 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:54] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:03:54,884 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:03:54] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:04:24,293 - root - INFO - WebSocket client disconnected: 8_4A6Euvg4QXN_AjAAAj
2025-11-11 23:04:24,294 - root - INFO - WebSocket client disconnected: erxoYUs6ewhc536TAAAl
2025-11-11 23:04:24,294 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:24] "GET /socket.io/?EIO=4&transport=websocket&sid=p3sPkASM4N4lAVIjAAAi HTTP/1.1" 200 -
2025-11-11 23:04:24,299 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:24] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 23:04:24,304 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:24] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:04:24,305 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:04:24,314 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:24] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:04:24,315 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:24] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:04:24,315 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:24] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:04:24,382 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:24] "GET /socket.io/?EIO=4&transport=polling&t=PfsF7As HTTP/1.1" 200 -
2025-11-11 23:04:24,387 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:24] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 23:04:24,388 - root - INFO - WebSocket client connected: DB5H9VMPFUTu71wSAAAo
2025-11-11 23:04:24,389 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:24] "POST /socket.io/?EIO=4&transport=polling&t=PfsF7B0&sid=l2EKfTHg8KVL7mnIAAAm HTTP/1.1" 200 -
2025-11-11 23:04:24,389 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:24] "GET /socket.io/?EIO=4&transport=polling&t=PfsF7B1&sid=l2EKfTHg8KVL7mnIAAAm HTTP/1.1" 200 -
2025-11-11 23:04:24,391 - root - INFO - WebSocket client connected: LlkLC2IsD5pKF6kAAAAp
2025-11-11 23:04:24,398 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:24] "POST /socket.io/?EIO=4&transport=polling&t=PfsF7BA&sid=l2EKfTHg8KVL7mnIAAAm HTTP/1.1" 200 -
2025-11-11 23:04:24,398 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:24] "GET /socket.io/?EIO=4&transport=polling&t=PfsF7B9&sid=l2EKfTHg8KVL7mnIAAAm HTTP/1.1" 200 -
2025-11-11 23:04:24,401 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:24] "GET /socket.io/?EIO=4&transport=polling&t=PfsF7BF&sid=l2EKfTHg8KVL7mnIAAAm HTTP/1.1" 200 -
2025-11-11 23:04:24,403 - root - INFO - Client DB5H9VMPFUTu71wSAAAo joined session room: sess-h1hkrvda
2025-11-11 23:04:24,403 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:24] "POST /socket.io/?EIO=4&transport=polling&t=PfsF7BH&sid=l2EKfTHg8KVL7mnIAAAm HTTP/1.1" 200 -
2025-11-11 23:04:24,583 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:24] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:04:34,727 - root - INFO - WebSocket client disconnected: DB5H9VMPFUTu71wSAAAo
2025-11-11 23:04:34,728 - root - INFO - WebSocket client disconnected: LlkLC2IsD5pKF6kAAAAp
2025-11-11 23:04:34,728 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:34] "GET /socket.io/?EIO=4&transport=websocket&sid=l2EKfTHg8KVL7mnIAAAm HTTP/1.1" 200 -
2025-11-11 23:04:34,736 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:34] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 23:04:34,740 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:34] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:04:34,741 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:04:34,753 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:34] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:04:34,754 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:34] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:04:34,760 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:34] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:04:34,819 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:34] "GET /socket.io/?EIO=4&transport=polling&t=PfsF9jo HTTP/1.1" 200 -
2025-11-11 23:04:34,820 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:34] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 23:04:34,825 - root - INFO - WebSocket client connected: pJQJEIA8RoU3H9u_AAAs
2025-11-11 23:04:34,825 - root - INFO - WebSocket client connected: 0iwALwUOVaiJF6K-AAAt
2025-11-11 23:04:34,825 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:34] "POST /socket.io/?EIO=4&transport=polling&t=PfsF9k5&sid=L3p5zSKiUr4TkYHMAAAq HTTP/1.1" 200 -
2025-11-11 23:04:34,826 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:34] "GET /socket.io/?EIO=4&transport=polling&t=PfsF9k6&sid=L3p5zSKiUr4TkYHMAAAq HTTP/1.1" 200 -
2025-11-11 23:04:34,830 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:34] "POST /socket.io/?EIO=4&transport=polling&t=PfsF9kC&sid=L3p5zSKiUr4TkYHMAAAq HTTP/1.1" 200 -
2025-11-11 23:04:34,830 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:34] "GET /socket.io/?EIO=4&transport=polling&t=PfsF9kB&sid=L3p5zSKiUr4TkYHMAAAq HTTP/1.1" 200 -
2025-11-11 23:04:34,833 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:34] "GET /socket.io/?EIO=4&transport=polling&t=PfsF9kF&sid=L3p5zSKiUr4TkYHMAAAq HTTP/1.1" 200 -
2025-11-11 23:04:34,834 - root - INFO - Client pJQJEIA8RoU3H9u_AAAs joined session room: sess-h1hkrvda
2025-11-11 23:04:34,834 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:34] "POST /socket.io/?EIO=4&transport=polling&t=PfsF9kG&sid=L3p5zSKiUr4TkYHMAAAq HTTP/1.1" 200 -
2025-11-11 23:04:34,839 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:34] "GET /socket.io/?EIO=4&transport=polling&t=PfsF9kL&sid=L3p5zSKiUr4TkYHMAAAq HTTP/1.1" 200 -
2025-11-11 23:04:35,009 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:35] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:04:41,679 - root - INFO - WebSocket client disconnected: pJQJEIA8RoU3H9u_AAAs
2025-11-11 23:04:41,679 - root - INFO - WebSocket client disconnected: 0iwALwUOVaiJF6K-AAAt
2025-11-11 23:04:41,680 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:41] "GET /socket.io/?EIO=4&transport=websocket&sid=L3p5zSKiUr4TkYHMAAAq HTTP/1.1" 200 -
2025-11-11 23:04:41,683 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:41] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 23:04:41,689 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:41] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:04:41,690 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:04:41,699 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:41] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:04:41,701 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:41] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:04:41,702 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:41] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:04:41,753 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:41] "GET /socket.io/?EIO=4&transport=polling&t=PfsFBQN HTTP/1.1" 200 -
2025-11-11 23:04:41,755 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:41] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 23:04:41,761 - root - INFO - WebSocket client connected: 87Etuo37YtFkVWOrAAAv
2025-11-11 23:04:41,762 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:41] "POST /socket.io/?EIO=4&transport=polling&t=PfsFBQU&sid=J9c_jRPulJpoCiMPAAAu HTTP/1.1" 200 -
2025-11-11 23:04:41,764 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:41] "GET /socket.io/?EIO=4&transport=polling&t=PfsFBQV&sid=J9c_jRPulJpoCiMPAAAu HTTP/1.1" 200 -
2025-11-11 23:04:41,783 - root - INFO - Client 87Etuo37YtFkVWOrAAAv joined session room: sess-h1hkrvda
2025-11-11 23:04:41,784 - root - INFO - WebSocket client connected: 94rhda80lGDdqJD7AAAx
2025-11-11 23:04:41,957 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:04:41] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:05:58,559 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:05:58] "GET /api/agent/welcome-message?file=queryagent_planner.json HTTP/1.1" 200 -
2025-11-11 23:06:00,760 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:06:00] "GET /api/agent/welcome-message?file=data_dictionary.json HTTP/1.1" 200 -
2025-11-11 23:07:01,151 - root - INFO - Client 87Etuo37YtFkVWOrAAAv joined session room: sess-23t4efie
2025-11-11 23:07:01,653 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:07:01] "GET /api/agent/welcome-message?file=data_dictionary.json HTTP/1.1" 200 -
2025-11-11 23:16:03,969 - root - INFO - WebSocket client disconnected: 87Etuo37YtFkVWOrAAAv
2025-11-11 23:16:03,969 - root - INFO - WebSocket client disconnected: 94rhda80lGDdqJD7AAAx
2025-11-11 23:16:03,970 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:16:03] "GET /socket.io/?EIO=4&transport=websocket&sid=J9c_jRPulJpoCiMPAAAu HTTP/1.1" 200 -
2025-11-11 23:16:03,979 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:16:03] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 23:16:03,981 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:16:03] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:16:03,982 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:16:03,992 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:16:03] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:16:03,992 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:16:03] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:16:03,999 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:16:03] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:16:04,052 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:16:04] "GET /socket.io/?EIO=4&transport=polling&t=PfsHn_4 HTTP/1.1" 200 -
2025-11-11 23:16:04,055 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:16:04] "GET /api/agent/config-files HTTP/1.1" 200 -
2025-11-11 23:16:04,057 - root - INFO - WebSocket client connected: r2Q8nUWNWSaKfU3gAAA0
2025-11-11 23:16:04,058 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:16:04] "POST /socket.io/?EIO=4&transport=polling&t=PfsHn_N&sid=nibDtS_JVDv-wOt4AAAy HTTP/1.1" 200 -
2025-11-11 23:16:04,058 - root - INFO - WebSocket client connected: pwtGVZovWBAn5BXQAAA1
2025-11-11 23:16:04,059 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:16:04] "GET /socket.io/?EIO=4&transport=polling&t=PfsHn_N.0&sid=nibDtS_JVDv-wOt4AAAy HTTP/1.1" 200 -
2025-11-11 23:16:04,063 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:16:04] "POST /socket.io/?EIO=4&transport=polling&t=PfsHn_T&sid=nibDtS_JVDv-wOt4AAAy HTTP/1.1" 200 -
2025-11-11 23:16:04,063 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:16:04] "GET /socket.io/?EIO=4&transport=polling&t=PfsHn_S&sid=nibDtS_JVDv-wOt4AAAy HTTP/1.1" 200 -
2025-11-11 23:16:04,068 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:16:04] "GET /socket.io/?EIO=4&transport=polling&t=PfsHn_Z&sid=nibDtS_JVDv-wOt4AAAy HTTP/1.1" 200 -
2025-11-11 23:16:04,070 - root - INFO - Client r2Q8nUWNWSaKfU3gAAA0 joined session room: sess-23t4efie
2025-11-11 23:16:04,070 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:16:04] "POST /socket.io/?EIO=4&transport=polling&t=PfsHn_Z.0&sid=nibDtS_JVDv-wOt4AAAy HTTP/1.1" 200 -
2025-11-11 23:16:04,244 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:16:04] "GET /api/agent/welcome-message?file=data_dictionary.json HTTP/1.1" 200 -
2025-11-11 23:16:07,853 - root - INFO - Client r2Q8nUWNWSaKfU3gAAA0 joined session room: sess-lkjwfigk
2025-11-11 23:16:08,356 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:16:08] "GET /api/agent/welcome-message?file=data_dictionary.json HTTP/1.1" 200 -
2025-11-11 23:17:15,995 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-11 23:17:16,013 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-11 23:17:16,013 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-11 23:17:16,015 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-11 23:17:16,015 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-11 23:17:16,036 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 23:17:16,036 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 23:17:16,036 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 23:17:16,036 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 23:17:16,036 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-11 23:17:16,036 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-11 23:17:16,036 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-11 23:17:16,037 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-11 23:17:16,037 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-11 23:17:16,038 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-11 23:17:16,038 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-11 23:17:16,038 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-11 23:17:16,038 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-11 23:17:16,039 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-11 23:17:16,039 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-11 23:17:16,040 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-11 23:17:16,040 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-11 23:17:16,040 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-11 23:17:16,041 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-11 23:17:16,333 - DuckDbDescribeTableTool - INFO - Found 1 data files in data/duckdb
2025-11-11 23:17:16,369 - DuckDbDescribeTableTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 23:17:16,375 - DuckDbDescribeTableTool - INFO - Initialization complete: 4 views available
2025-11-11 23:17:16,375 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 23:17:16,376 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-11 23:17:16,376 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-11 23:17:16,376 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-11 23:17:16,376 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-11 23:17:16,573 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-11 23:17:16,573 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-11 23:17:16,573 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-11 23:17:16,573 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-11 23:17:16,574 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-11 23:17:16,574 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-11 23:17:16,574 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-11 23:17:16,574 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-11 23:17:16,574 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-11 23:17:16,574 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-11 23:17:16,577 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-11 23:17:16,577 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-11 23:17:16,578 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-11 23:17:16,578 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-11 23:17:16,578 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-11 23:17:16,578 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-11 23:17:16,579 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-11 23:17:16,579 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-11 23:17:16,579 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-11 23:17:16,579 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-11 23:17:16,580 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-11 23:17:16,580 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-11 23:17:16,580 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-11 23:17:16,580 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-11 23:17:16,581 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-11 23:17:16,581 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-11 23:17:16,581 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-11 23:17:16,581 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-11 23:17:16,581 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-11 23:17:16,581 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-11 23:17:16,582 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-11 23:17:16,582 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-11 23:17:16,583 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-11 23:17:16,583 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-11 23:17:16,583 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-11 23:17:16,583 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-11 23:17:16,583 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-11 23:17:16,583 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-11 23:17:16,586 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-11 23:17:16,586 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-11 23:17:16,586 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-11 23:17:16,586 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-11 23:17:16,586 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-11 23:17:16,586 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-11 23:17:16,586 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-11 23:17:16,586 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-11 23:17:16,592 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 23:17:16,592 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 23:17:16,592 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 23:17:16,592 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 23:17:16,592 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-11 23:17:16,592 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-11 23:17:16,592 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-11 23:17:16,592 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-11 23:17:16,592 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-11 23:17:16,593 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-11 23:17:16,593 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-11 23:17:16,593 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-11 23:17:16,593 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-11 23:17:16,593 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-11 23:17:16,593 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-11 23:17:16,594 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-11 23:17:16,594 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-11 23:17:16,594 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-11 23:17:16,594 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-11 23:17:16,594 - DuckDbListFilesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 23:17:16,628 - DuckDbListFilesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 23:17:16,630 - DuckDbListFilesTool - INFO - Initialization complete: 4 views available
2025-11-11 23:17:16,630 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 23:17:16,630 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-11 23:17:16,630 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-11 23:17:16,630 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-11 23:17:16,630 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-11 23:17:16,630 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-11 23:17:16,630 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-11 23:17:16,631 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-11 23:17:16,631 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-11 23:17:16,632 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-11 23:17:16,632 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-11 23:17:16,632 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-11 23:17:16,632 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-11 23:17:16,632 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-11 23:17:16,632 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-11 23:17:16,632 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-11 23:17:16,632 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-11 23:17:16,632 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-11 23:17:16,632 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-11 23:17:16,633 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-11 23:17:16,633 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-11 23:17:16,633 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-11 23:17:16,633 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-11 23:17:16,633 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-11 23:17:16,633 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-11 23:17:16,633 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-11 23:17:16,633 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-11 23:17:16,634 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-11 23:17:16,634 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-11 23:17:16,634 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-11 23:17:16,634 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-11 23:17:16,634 - DuckDbGetStatsTool - INFO - Found 1 data files in data/duckdb
2025-11-11 23:17:16,669 - DuckDbGetStatsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 23:17:16,671 - DuckDbGetStatsTool - INFO - Initialization complete: 4 views available
2025-11-11 23:17:16,671 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 23:17:16,671 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-11 23:17:16,671 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-11 23:17:16,671 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-11 23:17:16,671 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-11 23:17:16,671 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-11 23:17:16,671 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-11 23:17:16,672 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-11 23:17:16,672 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-11 23:17:16,672 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-11 23:17:16,672 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-11 23:17:16,677 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 23:17:16,677 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 23:17:16,677 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 23:17:16,677 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 23:17:16,677 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-11 23:17:16,677 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-11 23:17:16,677 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-11 23:17:16,678 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-11 23:17:16,678 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-11 23:17:16,678 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-11 23:17:16,678 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-11 23:17:16,691 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-11 23:17:16,691 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-11 23:17:16,692 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-11 23:17:16,692 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-11 23:17:16,692 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-11 23:17:16,692 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-11 23:17:16,692 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-11 23:17:16,692 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-11 23:17:16,692 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-11 23:17:16,692 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-11 23:17:16,692 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-11 23:17:16,692 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-11 23:17:16,692 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-11 23:17:16,692 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-11 23:17:16,692 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-11 23:17:16,692 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-11 23:17:16,693 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-11 23:17:16,693 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-11 23:17:16,693 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-11 23:17:16,693 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-11 23:17:16,693 - DuckDbListTablesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 23:17:16,727 - DuckDbListTablesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 23:17:16,729 - DuckDbListTablesTool - INFO - Initialization complete: 4 views available
2025-11-11 23:17:16,729 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 23:17:16,729 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-11 23:17:16,729 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-11 23:17:16,729 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-11 23:17:16,729 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-11 23:17:16,729 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-11 23:17:16,729 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-11 23:17:16,730 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-11 23:17:16,730 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-11 23:17:16,730 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-11 23:17:16,730 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-11 23:17:16,731 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-11 23:17:16,731 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-11 23:17:16,731 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-11 23:17:16,731 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-11 23:17:16,731 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-11 23:17:16,731 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-11 23:17:16,731 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-11 23:17:16,731 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-11 23:17:16,731 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-11 23:17:16,731 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-11 23:17:16,732 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-11 23:17:16,732 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-11 23:17:16,732 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-11 23:17:16,732 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-11 23:17:16,732 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-11 23:17:16,732 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-11 23:17:16,733 - DuckDbAggregateTool - INFO - Found 1 data files in data/duckdb
2025-11-11 23:17:16,766 - DuckDbAggregateTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 23:17:16,767 - DuckDbAggregateTool - INFO - Initialization complete: 4 views available
2025-11-11 23:17:16,767 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 23:17:16,767 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-11 23:17:16,768 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-11 23:17:16,768 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-11 23:17:16,768 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-11 23:17:16,768 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-11 23:17:16,768 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-11 23:17:16,768 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-11 23:17:16,768 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-11 23:17:16,768 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-11 23:17:16,768 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-11 23:17:16,769 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-11 23:17:16,769 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-11 23:17:16,769 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-11 23:17:16,769 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-11 23:17:16,775 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 23:17:16,775 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 23:17:16,775 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 23:17:16,775 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 23:17:16,775 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-11 23:17:16,775 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-11 23:17:16,775 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-11 23:17:16,775 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-11 23:17:16,775 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-11 23:17:16,775 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-11 23:17:16,775 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-11 23:17:16,775 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-11 23:17:16,775 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-11 23:17:16,776 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-11 23:17:16,776 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-11 23:17:16,776 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-11 23:17:16,776 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-11 23:17:16,776 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-11 23:17:16,776 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-11 23:17:16,776 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-11 23:17:16,776 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-11 23:17:16,776 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-11 23:17:16,776 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-11 23:17:16,776 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-11 23:17:16,776 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-11 23:17:16,776 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-11 23:17:16,776 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-11 23:17:16,777 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-11 23:17:16,777 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-11 23:17:16,777 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-11 23:17:16,777 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-11 23:17:16,777 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-11 23:17:16,777 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-11 23:17:16,778 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-11 23:17:16,778 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-11 23:17:16,778 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-11 23:17:16,778 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-11 23:17:16,778 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-11 23:17:16,778 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-11 23:17:16,778 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-11 23:17:16,778 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-11 23:17:16,779 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-11 23:17:16,779 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-11 23:17:16,779 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-11 23:17:16,779 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-11 23:17:16,779 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-11 23:17:16,779 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-11 23:17:16,779 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-11 23:17:16,779 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-11 23:17:16,779 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-11 23:17:16,779 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-11 23:17:16,779 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-11 23:17:16,779 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-11 23:17:16,779 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-11 23:17:16,780 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-11 23:17:16,780 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-11 23:17:16,780 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-11 23:17:16,781 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-11 23:17:16,781 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-11 23:17:16,781 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-11 23:17:16,781 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-11 23:17:16,781 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-11 23:17:16,781 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-11 23:17:16,782 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-11 23:17:16,782 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-11 23:17:16,782 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-11 23:17:16,782 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-11 23:17:16,782 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-11 23:17:16,782 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-11 23:17:16,782 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-11 23:17:16,782 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-11 23:17:16,782 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-11 23:17:16,782 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-11 23:17:16,783 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-11 23:17:16,783 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-11 23:17:16,788 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 23:17:16,788 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 23:17:16,788 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 23:17:16,788 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 23:17:16,788 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-11 23:17:16,788 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-11 23:17:16,788 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-11 23:17:16,788 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-11 23:17:16,788 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-11 23:17:16,789 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-11 23:17:16,789 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-11 23:17:16,789 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-11 23:17:16,789 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-11 23:17:16,789 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-11 23:17:16,789 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-11 23:17:16,789 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-11 23:17:16,789 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-11 23:17:16,789 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-11 23:17:16,789 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-11 23:17:16,789 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-11 23:17:16,789 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-11 23:17:16,789 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-11 23:17:16,790 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-11 23:17:16,790 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-11 23:17:16,790 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-11 23:17:16,790 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-11 23:17:16,790 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-11 23:17:16,790 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-11 23:17:16,790 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-11 23:17:16,790 - DuckDbQueryTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 23:17:16,825 - DuckDbQueryTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 23:17:16,826 - DuckDbQueryTool - INFO - Initialization complete: 4 views available
2025-11-11 23:17:16,826 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 23:17:16,826 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-11 23:17:16,826 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-11 23:17:16,826 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-11 23:17:16,827 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-11 23:17:16,827 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-11 23:17:16,827 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-11 23:17:16,827 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-11 23:17:16,827 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-11 23:17:16,827 - DuckDbRefreshViewsTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 23:17:16,861 - DuckDbRefreshViewsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 23:17:16,862 - DuckDbRefreshViewsTool - INFO - Initialization complete: 4 views available
2025-11-11 23:17:16,862 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 23:17:16,862 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-11 23:17:16,862 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-11 23:17:16,863 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-11 23:17:16,863 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-11 23:17:16,863 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-11 23:17:16,863 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-11 23:17:16,868 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 23:17:16,868 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 23:17:16,868 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 23:17:16,868 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 23:17:16,868 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-11 23:17:16,868 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-11 23:17:16,868 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-11 23:17:16,869 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-11 23:17:16,869 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-11 23:17:16,869 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-11 23:17:16,869 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-11 23:17:16,869 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-11 23:17:16,869 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-11 23:17:16,869 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-11 23:17:16,869 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-11 23:17:16,869 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-11 23:17:16,869 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-11 23:17:16,870 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-11 23:17:16,870 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-11 23:17:16,870 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-11 23:17:16,878 - root - INFO - All routes registered successfully
2025-11-11 23:17:16,881 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.68.51:8000
2025-11-11 23:17:16,881 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-11-11 23:17:18,983 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:18] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 23:17:18,996 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:18] "GET /login?next=http://localhost:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 23:17:19,014 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:19] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 23:17:19,015 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:19] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 23:17:19,056 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:19] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:17:22,995 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 23:17:22,996 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 23:17:22,998 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:22] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 23:17:23,019 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:23] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 23:17:23,032 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:23] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:17:23,035 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:23] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:17:23,035 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:23] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:17:28,220 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:28] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 23:17:28,240 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:28] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:17:28,241 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:28] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:17:28,244 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:28] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:17:28,299 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:28] "GET /socket.io/?EIO=4&transport=polling&t=PfsI6ZK HTTP/1.1" 200 -
2025-11-11 23:17:28,300 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:28] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-11 23:17:28,301 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:28] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-11 23:17:28,303 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:28] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-11 23:17:28,304 - root - INFO - WebSocket client connected: YU4njg_imZtAsGtXAAAC
2025-11-11 23:17:28,305 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:28] "POST /socket.io/?EIO=4&transport=polling&t=PfsI6Zj&sid=FqtxTxTlXXnWk-79AAAA HTTP/1.1" 200 -
2025-11-11 23:17:28,306 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:28] "GET /socket.io/?EIO=4&transport=polling&t=PfsI6Zk&sid=FqtxTxTlXXnWk-79AAAA HTTP/1.1" 200 -
2025-11-11 23:17:28,307 - root - INFO - WebSocket client connected: QU7RNaZbmXf4xEjrAAAD
2025-11-11 23:17:28,312 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:28] "POST /socket.io/?EIO=4&transport=polling&t=PfsI6Zq&sid=FqtxTxTlXXnWk-79AAAA HTTP/1.1" 200 -
2025-11-11 23:17:28,312 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:28] "GET /socket.io/?EIO=4&transport=polling&t=PfsI6Zp&sid=FqtxTxTlXXnWk-79AAAA HTTP/1.1" 200 -
2025-11-11 23:17:28,316 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:28] "GET /socket.io/?EIO=4&transport=polling&t=PfsI6Zv&sid=FqtxTxTlXXnWk-79AAAA HTTP/1.1" 200 -
2025-11-11 23:17:28,317 - root - INFO - Client YU4njg_imZtAsGtXAAAC joined session room: sess-i62wd9p7
2025-11-11 23:17:28,318 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:28] "POST /socket.io/?EIO=4&transport=polling&t=PfsI6Zv.0&sid=FqtxTxTlXXnWk-79AAAA HTTP/1.1" 200 -
2025-11-11 23:17:28,485 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:28] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:17:43,356 - root - INFO - Client YU4njg_imZtAsGtXAAAC joined session room: sess-fij25jqe
2025-11-11 23:17:43,360 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:43] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-11 23:17:43,360 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:43] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-11 23:17:43,361 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:43] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-11 23:17:43,864 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:43] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:17:48,489 - root - INFO - Client YU4njg_imZtAsGtXAAAC joined session room: sess-o5f3wqd9
2025-11-11 23:17:48,494 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:48] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-11 23:17:48,495 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:48] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-11 23:17:48,495 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:48] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-11 23:17:48,994 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:17:48] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:17:58,557 - agent.session_manager - INFO - [SessionManager] Registered session sess-o5f3wqd9
2025-11-11 23:17:58,557 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 23:17:58,557 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-o5f3wqd9
2025-11-11 23:17:58,558 - agent.state_manager - WARNING - Session sess-o5f3wqd9 not found
2025-11-11 23:17:58,558 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 23:17:58,561 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:17:58,561 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 23:17:58,561 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 23:17:58,562 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 23:17:58,562 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 23:17:58,562 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 23:17:58,562 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 23:17:58,562 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 23:17:58,564 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:18:02,065 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:18:02,082 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 23:18:02,083 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 23:18:02,083 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 23:18:02,085 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:18:02,085 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 23:18:02,085 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 23:18:02,085 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 23:18:02,085 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 23:18:02,085 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 23:18:02,085 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 23:18:02,085 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 23:18:02,085 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 23:18:02,085 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 23:18:02,086 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 23:18:02,086 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 23:18:02,086 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 23:18:02,086 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 23:18:02,086 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 23:18:02,086 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 23:18:02,086 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 23:18:05,192 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:18:06,055 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:18:10,126 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-11 23:18:10,126 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-11 23:18:10,126 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-11 23:18:10,126 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 4155 chars
2025-11-11 23:18:10,126 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-11 23:18:10,126 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-11 23:18:11,277 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:18:13,442 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 426 chars
2025-11-11 23:18:13,442 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY exposure_amt DESC",
  "explanation": "Retrieved top primary limits for the most recent date, sorted by exposure amount in descending order. Assumptions: 'top' implies sorting by exposure, 'primary' means limit_class = 'Primary', and using the latest date by default.",
  "target_table": "limits_data"
}
2025-11-11 23:18:13,442 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-11 23:18:13,443 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-11 23:18:13,443 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY exposure_amt DESC...
2025-11-11 23:18:13,443 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY exposure_amt DESC
2025-11-11 23:18:13,444 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 23:18:13,444 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 23:18:13,444 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 23:18:13,447 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:18:13,448 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 23:18:13,448 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 23:18:13,448 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 23:18:13,452 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:18:13,453 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY exposure_amt DESC...
2025-11-11 23:18:13,453 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 129 chars
2025-11-11 23:18:13,453 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY exposure_amt DESC
2025-11-11 23:18:13,453 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY exposure_amt DESC...
2025-11-11 23:18:13,453 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY exposure_amt DESC...
2025-11-11 23:18:13,453 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-11 23:18:13,453 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY exposure_amt DESC...
2025-11-11 23:18:13,541 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 23:18:13,542 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 23:18:13,542 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 23:18:13,543 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:18:13,543 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 23:18:13,543 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 23:18:13,543 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-11 23:18:13,543 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 23:18:13,543 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=129
2025-11-11 23:18:13,543 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 23:18:13,543 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 23:18:13,544 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4841 chars
2025-11-11 23:18:14,527 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:18:23,585 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1566 chars
2025-11-11 23:18:23,585 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 23:18:23,586 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 23:18:23,587 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 38279 chars
2025-11-11 23:18:31,492 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:18:31,493 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1020 chars
2025-11-11 23:18:31,493 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-11 23:18:31,493 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-11 23:18:31,493 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 23:18:31,494 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-11 23:18:31,494 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 23:18:31,494 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 23:18:31,494 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 23:18:31,498 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:18:31,498 - agent.streaming_agent - INFO - Agent completed for session sess-o5f3wqd9: 32936.37300000001ms, 7 steps
2025-11-11 23:18:31,498 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-11 23:18:31,498 - agent.session_manager - INFO - [SessionManager] Unregistered session sess-o5f3wqd9
2025-11-11 23:20:25,380 - agent.session_manager - INFO - [SessionManager] Registered session sess-o5f3wqd9
2025-11-11 23:20:25,381 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'hi'
2025-11-11 23:20:25,381 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-o5f3wqd9
2025-11-11 23:20:25,382 - agent.state_manager - INFO - Loaded session state for sess-o5f3wqd9
2025-11-11 23:20:25,383 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 1 turns
2025-11-11 23:20:25,383 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 1 conversation turns
2025-11-11 23:20:25,388 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:20:25,388 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 23:20:25,389 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 23:20:25,389 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 23:20:25,389 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=1, conv_history(str)=5979
2025-11-11 23:20:25,389 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 23:20:25,389 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 23:20:25,389 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 23:20:25,392 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:20:25,392 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 23:20:28,527 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:20:28,530 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain all the columns and details needed to answer most follow-up queries about these primary limits. The result set includes comprehensive information like limit details, exposure amounts, utilization, regions, industries, and other metadata. Since the previous query returned full row details for the top primary limits, no additional database query is required to analyze or filter the existing data.
2025-11-11 23:20:28,531 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 23:20:28,531 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 23:20:28,531 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 23:20:28,536 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:20:30,147 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:20:30,150 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 23:20:30,150 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 23:20:30,151 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 23:20:30,155 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:20:30,156 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=0, columns=0, rows=0, sql=N/A
2025-11-11 23:20:30,156 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: False, has 'columns' key: False
2025-11-11 23:20:30,156 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=0, columns=0, rows=0, query_length=0
2025-11-11 23:20:30,156 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-11 23:20:30,156 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-11 23:20:30,158 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 318 chars
2025-11-11 23:20:30,762 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:20:34,738 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 677 chars
2025-11-11 23:20:34,738 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-11 23:20:34,738 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-11 23:20:34,739 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 38697 chars
2025-11-11 23:20:37,012 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:20:41,625 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 874 chars
2025-11-11 23:20:41,626 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=0, columns=0, rows=0, query=MISSING
2025-11-11 23:20:41,626 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=0, columns=0, rows=0, has_query=False
2025-11-11 23:20:41,626 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=N/A...
2025-11-11 23:20:41,626 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): N/A...
2025-11-11 23:20:41,631 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:20:41,631 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for end: data keys = ['raw_table', 'response', 'prompt_monitor', 'node_output', 'node_reasoning']
2025-11-11 23:20:41,632 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for end with 5 data keys
2025-11-11 23:20:41,632 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for end
2025-11-11 23:20:41,632 - agent.streaming_agent - INFO - Agent completed for session sess-o5f3wqd9: 16243.019ms, 4 steps
2025-11-11 23:20:41,632 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=0, columns=0, rows=0
2025-11-11 23:20:41,632 - agent.session_manager - INFO - [SessionManager] Unregistered session sess-o5f3wqd9
2025-11-11 23:20:41,869 - agent.session_manager - INFO - [SessionManager] Registered session sess-o5f3wqd9
2025-11-11 23:20:41,869 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'what is vega'
2025-11-11 23:20:41,869 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-o5f3wqd9
2025-11-11 23:20:41,872 - agent.state_manager - INFO - Loaded session state for sess-o5f3wqd9
2025-11-11 23:20:41,872 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 2 turns
2025-11-11 23:20:41,872 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 2 conversation turns
2025-11-11 23:20:41,877 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:20:41,877 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 23:20:41,877 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 23:20:41,877 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 23:20:41,877 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=2, conv_history(str)=7600
2025-11-11 23:20:41,878 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 23:20:41,878 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 23:20:41,878 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 23:20:41,881 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:20:41,881 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 23:20:44,294 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:20:44,295 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain the full details of the primary limits, including all columns like region_cd, exposure_amt, utilization, etc. No new database query is required to answer a follow-up query about these specific primary limits.
2025-11-11 23:20:44,296 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 23:20:44,296 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 23:20:44,296 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 23:20:44,303 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:20:47,370 - agent.session_manager - INFO - [SessionManager] Cancelled session sess-o5f3wqd9
2025-11-11 23:20:47,370 - root - INFO - Kill request received for session sess-o5f3wqd9
2025-11-11 23:20:47,749 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:20:47,751 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 23:20:47,751 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 23:20:47,752 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 23:20:47,757 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:20:47,757 - agent.streaming_agent - INFO - [StreamingAgent] Query cancelled for session sess-o5f3wqd9
2025-11-11 23:20:47,757 - agent.streaming_agent - INFO - [StreamingAgent] Query cancelled, skipping end_node and conversation history save
2025-11-11 23:20:47,757 - agent.session_manager - INFO - [SessionManager] Unregistered session sess-o5f3wqd9
2025-11-11 23:20:51,288 - agent.session_manager - INFO - [SessionManager] Registered session sess-o5f3wqd9
2025-11-11 23:20:51,288 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'what is vega'
2025-11-11 23:20:51,288 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-o5f3wqd9
2025-11-11 23:20:51,290 - agent.state_manager - INFO - Loaded session state for sess-o5f3wqd9
2025-11-11 23:20:51,290 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 2 turns
2025-11-11 23:20:51,290 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 2 conversation turns
2025-11-11 23:20:51,295 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:20:51,296 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 23:20:51,296 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 23:20:51,296 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 23:20:51,296 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=2, conv_history(str)=7600
2025-11-11 23:20:51,297 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 23:20:51,297 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 23:20:51,297 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 23:20:51,301 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:20:51,301 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 23:20:53,994 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:20:53,997 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query already returned full details of the primary limits, including all columns like region_cd, exposure_amt, utilization, etc. No additional database query is required to answer a follow-up query about these specific primary limits.
2025-11-11 23:20:53,997 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 23:20:53,998 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 23:20:53,998 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 23:20:54,003 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:20:57,374 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:20:57,378 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 23:20:57,378 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 23:20:57,378 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 23:20:57,383 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:20:57,384 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 23:20:57,384 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 23:20:57,385 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 23:20:57,385 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 23:20:57,385 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 23:20:57,385 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 23:20:57,385 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 23:20:57,385 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 23:20:57,385 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 23:20:57,385 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 23:20:57,385 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 7600 characters
2025-11-11 23:20:57,385 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 23:20:57,385 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 23:20:57,385 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 23:20:57,386 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 23:20:57,386 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 23:20:57,386 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 23:20:57,386 - tools.impl.nl_to_sql_planner - INFO -     User Query: top primary limits
2025-11-11 23:20:57,386 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 23:20:57,386 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 23:20:57,386 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY exposure_amt DESC
2025-11-11 23:20:57,386 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 23:20:57,386 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-11 23:20:57,386 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_i
2025-11-11 23:20:57,386 - tools.impl.nl_to_sql_planner - INFO -     ... (7000 more characters)
2025-11-11 23:20:57,386 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 23:21:00,446 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:21:01,163 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:21:03,644 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 23:21:03,645 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 23:21:03,646 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 23:21:03,651 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:21:03,652 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 23:21:03,652 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 23:21:03,652 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 23:21:03,657 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:21:03,658 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: -- KNOWLEDGE QUESTION...
2025-11-11 23:21:03,658 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 21 chars
2025-11-11 23:21:03,658 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: -- KNOWLEDGE QUESTION
2025-11-11 23:21:03,658 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 23:21:03,659 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 23:21:03,659 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 23:21:03,662 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:21:03,663 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=0, columns=0, rows=0, sql=-- KNOWLEDGE QUESTION
2025-11-11 23:21:03,663 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 23:21:03,663 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['columns', 'rows', 'row_count', 'query']
2025-11-11 23:21:03,663 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: -- KNOWLEDGE QUESTION
2025-11-11 23:21:03,663 - agent.graph_nodes - INFO - [END_NODE] Knowledge response detected: '**Vega**: Volatility sensitivity

**Usage**: In options and derivatives trading, Vega measures how m...'
2025-11-11 23:21:03,663 - agent.graph_nodes - INFO - [END_NODE] Returning knowledge result with response length: 497
2025-11-11 23:21:03,663 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 23:21:03,663 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 23:21:03,664 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 23:21:03,666 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:21:03,666 - agent.streaming_agent - INFO - Agent completed for session sess-o5f3wqd9: 12370.297ms, 8 steps
2025-11-11 23:21:03,667 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=0, columns=0, rows=0
2025-11-11 23:21:03,667 - agent.session_manager - INFO - [SessionManager] Unregistered session sess-o5f3wqd9
2025-11-11 23:21:21,032 - agent.session_manager - INFO - [SessionManager] Registered session sess-o5f3wqd9
2025-11-11 23:21:21,032 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'what tables do you have access to'
2025-11-11 23:21:21,032 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-o5f3wqd9
2025-11-11 23:21:21,034 - agent.state_manager - INFO - Loaded session state for sess-o5f3wqd9
2025-11-11 23:21:21,034 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 2 turns
2025-11-11 23:21:21,034 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 2 conversation turns
2025-11-11 23:21:21,040 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:21:21,041 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 23:21:21,041 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 23:21:21,041 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 23:21:21,041 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=2, conv_history(str)=7600
2025-11-11 23:21:21,041 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 23:21:21,041 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 23:21:21,041 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 23:21:21,045 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:21:21,045 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 23:21:23,692 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:21:23,695 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query already returned full details of the primary limits, including all columns like region_cd, exposure_amt, utilization, etc. No new database query is required to answer a follow-up query about these specific primary limits.
2025-11-11 23:21:23,695 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 23:21:23,695 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 23:21:23,695 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 23:21:23,701 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:21:26,866 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:21:26,869 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 23:21:26,869 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 23:21:26,870 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 23:21:26,875 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:21:26,876 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-11 23:21:26,876 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 23:21:26,876 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 23:21:26,876 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 23:21:26,876 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 23:21:26,877 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 23:21:26,877 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 23:21:26,877 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-11 23:21:26,877 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 23:21:26,877 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 23:21:26,877 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 7600 characters
2025-11-11 23:21:26,877 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-11 23:21:26,877 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-11 23:21:26,877 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 23:21:26,877 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 23:21:26,877 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 23:21:26,877 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 23:21:26,877 - tools.impl.nl_to_sql_planner - INFO -     User Query: top primary limits
2025-11-11 23:21:26,877 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-11 23:21:26,877 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-11 23:21:26,877 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY exposure_amt DESC
2025-11-11 23:21:26,877 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-11 23:21:26,877 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-11 23:21:26,878 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_i
2025-11-11 23:21:26,878 - tools.impl.nl_to_sql_planner - INFO -     ... (7000 more characters)
2025-11-11 23:21:26,878 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 23:21:29,836 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:21:30,552 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:21:34,305 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 23:21:34,305 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 23:21:34,305 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 23:21:34,311 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:21:34,311 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 23:21:34,311 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 23:21:34,311 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 23:21:34,317 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:21:34,317 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: -- KNOWLEDGE QUESTION...
2025-11-11 23:21:34,317 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 21 chars
2025-11-11 23:21:34,318 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: -- KNOWLEDGE QUESTION
2025-11-11 23:21:34,318 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 23:21:34,318 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 23:21:34,318 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 23:21:34,331 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:21:34,331 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=0, columns=0, rows=0, sql=-- KNOWLEDGE QUESTION
2025-11-11 23:21:34,332 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 23:21:34,332 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['columns', 'rows', 'row_count', 'query']
2025-11-11 23:21:34,332 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: -- KNOWLEDGE QUESTION
2025-11-11 23:21:34,332 - agent.graph_nodes - INFO - [END_NODE] Knowledge response detected: 'Based on the business glossary provided, I can see two tables:

1. **market_risk_limits_overview**: ...'
2025-11-11 23:21:34,333 - agent.graph_nodes - INFO - [END_NODE] Returning knowledge result with response length: 943
2025-11-11 23:21:34,333 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 23:21:34,333 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 23:21:34,333 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 23:21:34,335 - agent.state_manager - INFO - Saved session state for sess-o5f3wqd9 (user: admin)
2025-11-11 23:21:34,335 - agent.streaming_agent - INFO - Agent completed for session sess-o5f3wqd9: 13294.09ms, 8 steps
2025-11-11 23:21:34,335 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=0, columns=0, rows=0
2025-11-11 23:21:34,335 - agent.session_manager - INFO - [SessionManager] Unregistered session sess-o5f3wqd9
2025-11-11 23:21:47,087 - root - INFO - Client YU4njg_imZtAsGtXAAAC joined session room: sess-lstdnu45
2025-11-11 23:21:47,092 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:21:47] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-11 23:21:47,092 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:21:47] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-11 23:21:47,093 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:21:47] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-11 23:21:47,593 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:21:47] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:22:21,042 - agent.session_manager - INFO - [SessionManager] Registered session sess-lstdnu45
2025-11-11 23:22:21,042 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'which file do you have data_dictionary.json or data_dictionary_risk.json'
2025-11-11 23:22:21,042 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-lstdnu45
2025-11-11 23:22:21,042 - agent.state_manager - WARNING - Session sess-lstdnu45 not found
2025-11-11 23:22:21,042 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 23:22:21,046 - agent.state_manager - INFO - Saved session state for sess-lstdnu45 (user: admin)
2025-11-11 23:22:21,046 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 23:22:21,046 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 23:22:21,047 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 23:22:21,047 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 23:22:21,047 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 23:22:21,047 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 23:22:21,047 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 23:22:21,049 - agent.state_manager - INFO - Saved session state for sess-lstdnu45 (user: admin)
2025-11-11 23:22:24,356 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:22:24,358 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 23:22:24,358 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 23:22:24,358 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 23:22:24,359 - agent.state_manager - INFO - Saved session state for sess-lstdnu45 (user: admin)
2025-11-11 23:22:24,359 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 23:22:24,359 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 23:22:24,359 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 23:22:24,359 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 23:22:24,359 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 23:22:24,359 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 23:22:24,359 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 23:22:24,359 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 23:22:24,359 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 23:22:24,359 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 23:22:24,359 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 23:22:24,359 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 23:22:24,359 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 23:22:24,359 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 23:22:24,359 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 23:22:24,359 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 23:22:27,287 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:22:27,896 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:22:29,835 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 23:22:29,835 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 23:22:29,836 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 23:22:29,839 - agent.state_manager - INFO - Saved session state for sess-lstdnu45 (user: admin)
2025-11-11 23:22:29,840 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 23:22:29,840 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 23:22:29,840 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 23:22:29,844 - agent.state_manager - INFO - Saved session state for sess-lstdnu45 (user: admin)
2025-11-11 23:22:29,844 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: -- KNOWLEDGE QUESTION...
2025-11-11 23:22:29,844 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 21 chars
2025-11-11 23:22:29,844 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: -- KNOWLEDGE QUESTION
2025-11-11 23:22:29,845 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 23:22:29,845 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 23:22:29,845 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 23:22:29,847 - agent.state_manager - INFO - Saved session state for sess-lstdnu45 (user: admin)
2025-11-11 23:22:29,847 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=0, columns=0, rows=0, sql=-- KNOWLEDGE QUESTION
2025-11-11 23:22:29,848 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 23:22:29,848 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['columns', 'rows', 'row_count', 'query']
2025-11-11 23:22:29,848 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: -- KNOWLEDGE QUESTION
2025-11-11 23:22:29,848 - agent.graph_nodes - INFO - [END_NODE] Knowledge response detected: 'I apologize, but the user's query is not asking for a definition from the business glossary. The que...'
2025-11-11 23:22:29,848 - agent.graph_nodes - INFO - [END_NODE] Returning knowledge result with response length: 461
2025-11-11 23:22:29,848 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 23:22:29,849 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 23:22:29,849 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 23:22:29,851 - agent.state_manager - INFO - Saved session state for sess-lstdnu45 (user: admin)
2025-11-11 23:22:29,851 - agent.streaming_agent - INFO - Agent completed for session sess-lstdnu45: 8804.112ms, 7 steps
2025-11-11 23:22:29,851 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=0, columns=0, rows=0
2025-11-11 23:22:29,851 - agent.session_manager - INFO - [SessionManager] Unregistered session sess-lstdnu45
2025-11-11 23:23:03,210 - agent.session_manager - INFO - [SessionManager] Registered session sess-lstdnu45
2025-11-11 23:23:03,211 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'what does business glossary contain'
2025-11-11 23:23:03,211 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-lstdnu45
2025-11-11 23:23:03,215 - agent.state_manager - INFO - Loaded session state for sess-lstdnu45
2025-11-11 23:23:03,215 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 1 turns
2025-11-11 23:23:03,215 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 1 conversation turns
2025-11-11 23:23:03,221 - agent.state_manager - INFO - Saved session state for sess-lstdnu45 (user: admin)
2025-11-11 23:23:03,221 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 23:23:03,221 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 23:23:03,221 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 23:23:03,222 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=1, conv_history(str)=595
2025-11-11 23:23:03,222 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 23:23:03,222 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 23:23:03,222 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 23:23:03,225 - agent.state_manager - INFO - Saved session state for sess-lstdnu45 (user: admin)
2025-11-11 23:23:03,225 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-11 23:23:05,583 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:23:05,586 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=True, reasoning=The previous conversation did not provide any actual data or file contents. The response was about the inability to determine which file exists. Therefore, to answer any follow-up query about the file, a new query or data retrieval would be necessary.
2025-11-11 23:23:05,586 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-11 23:23:05,586 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-11 23:23:05,586 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-11 23:23:05,590 - agent.state_manager - INFO - Saved session state for sess-lstdnu45 (user: admin)
2025-11-11 23:23:09,002 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:23:09,004 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 23:23:09,005 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 23:23:09,005 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 23:23:09,008 - agent.state_manager - INFO - Saved session state for sess-lstdnu45 (user: admin)
2025-11-11 23:23:09,009 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=True, passing to planner
2025-11-11 23:23:09,009 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 23:23:09,009 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 23:23:09,009 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 23:23:09,009 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 23:23:09,009 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-11 23:23:09,009 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: True
2025-11-11 23:23:09,009 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü° NEW QUERY WITH CONTEXT (different data needed)
2025-11-11 23:23:09,009 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 23:23:09,010 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 23:23:09,010 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 595 characters
2025-11-11 23:23:09,010 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 23:23:09,010 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 23:23:09,010 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 23:23:09,010 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-11 23:23:09,010 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 23:23:09,010 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-11 23:23:09,010 - tools.impl.nl_to_sql_planner - INFO -     User Query: which file do you have data_dictionary.json or data_dictionary_risk.json
2025-11-11 23:23:09,010 - tools.impl.nl_to_sql_planner - INFO -     Agent Response: I apologize, but the user's query is not asking for a definition from the business glossary. The query is asking about which file is available: data_dictionary.json or data_dictionary_risk.json.
2025-11-11 23:23:09,010 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 23:23:09,011 - tools.impl.nl_to_sql_planner - INFO -     Based on the context provided, I cannot definitively answer which file exists. The business glossary does not contain information about file names. To determine which file is available, you would need to check the actual file system or ask the system administrator.
2025-11-11 23:23:09,011 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-11 23:23:09,011 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 23:23:11,348 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:23:11,931 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:23:15,907 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 23:23:15,908 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 23:23:15,909 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 23:23:15,912 - agent.state_manager - INFO - Saved session state for sess-lstdnu45 (user: admin)
2025-11-11 23:23:15,913 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 23:23:15,913 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 23:23:15,914 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 23:23:15,919 - agent.state_manager - INFO - Saved session state for sess-lstdnu45 (user: admin)
2025-11-11 23:23:15,920 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: -- KNOWLEDGE QUESTION...
2025-11-11 23:23:15,920 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 21 chars
2025-11-11 23:23:15,920 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: -- KNOWLEDGE QUESTION
2025-11-11 23:23:15,920 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 23:23:15,920 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 23:23:15,920 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 23:23:15,923 - agent.state_manager - INFO - Saved session state for sess-lstdnu45 (user: admin)
2025-11-11 23:23:15,923 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=0, columns=0, rows=0, sql=-- KNOWLEDGE QUESTION
2025-11-11 23:23:15,924 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 23:23:15,924 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['columns', 'rows', 'row_count', 'query']
2025-11-11 23:23:15,924 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: -- KNOWLEDGE QUESTION
2025-11-11 23:23:15,924 - agent.graph_nodes - INFO - [END_NODE] Knowledge response detected: '**Business Glossary**: A structured repository that contains definitions and mappings of business te...'
2025-11-11 23:23:15,924 - agent.graph_nodes - INFO - [END_NODE] Returning knowledge result with response length: 868
2025-11-11 23:23:15,924 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 23:23:15,925 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 23:23:15,925 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 23:23:15,927 - agent.state_manager - INFO - Saved session state for sess-lstdnu45 (user: admin)
2025-11-11 23:23:15,927 - agent.streaming_agent - INFO - Agent completed for session sess-lstdnu45: 12705.773000000001ms, 8 steps
2025-11-11 23:23:15,927 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=0, columns=0, rows=0
2025-11-11 23:23:15,927 - agent.session_manager - INFO - [SessionManager] Unregistered session sess-lstdnu45
2025-11-11 23:30:23,495 - root - INFO - WebSocket client disconnected: QU7RNaZbmXf4xEjrAAAD
2025-11-11 23:30:23,496 - root - INFO - WebSocket client disconnected: YU4njg_imZtAsGtXAAAC
2025-11-11 23:30:23,497 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:30:23] "GET /socket.io/?EIO=4&transport=websocket&sid=FqtxTxTlXXnWk-79AAAA HTTP/1.1" 200 -
2025-11-11 23:30:23,499 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:30:23] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 23:30:23,503 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:30:23] "GET /login?next=http://localhost:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 23:30:23,509 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:30:23] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:30:23,513 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:30:23,528 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:30:23] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 23:30:23,528 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:30:23] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 23:30:27,214 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 23:30:27,214 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 23:30:27,215 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:30:27] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 23:30:27,229 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:30:27] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 23:30:27,240 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:30:27] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:30:27,241 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:30:27] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:30:31,242 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:30:31] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 23:30:31,249 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:30:31] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:30:31,267 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:30:31] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:30:31,309 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:30:31] "GET /socket.io/?EIO=4&transport=polling&t=PfsL5kB HTTP/1.1" 200 -
2025-11-11 23:30:31,312 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:30:31] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-11 23:30:31,313 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:30:31] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-11 23:30:31,314 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:30:31] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-11 23:30:31,327 - root - INFO - WebSocket client connected: hox2ALlnCa_Y_EHwAAAF
2025-11-11 23:30:31,328 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:30:31] "POST /socket.io/?EIO=4&transport=polling&t=PfsL5kT&sid=pV_MawcU89eMG_iEAAAE HTTP/1.1" 200 -
2025-11-11 23:30:31,328 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:30:31] "GET /socket.io/?EIO=4&transport=polling&t=PfsL5kU&sid=pV_MawcU89eMG_iEAAAE HTTP/1.1" 200 -
2025-11-11 23:30:31,343 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:30:31] "POST /socket.io/?EIO=4&transport=polling&t=PfsL5kk&sid=pV_MawcU89eMG_iEAAAE HTTP/1.1" 200 -
2025-11-11 23:30:31,343 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:30:31] "GET /socket.io/?EIO=4&transport=polling&t=PfsL5ki&sid=pV_MawcU89eMG_iEAAAE HTTP/1.1" 200 -
2025-11-11 23:30:31,346 - root - INFO - Client hox2ALlnCa_Y_EHwAAAF joined session room: sess-ld412p2i
2025-11-11 23:30:31,346 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:30:31] "POST /socket.io/?EIO=4&transport=polling&t=PfsL5kn&sid=pV_MawcU89eMG_iEAAAE HTTP/1.1" 200 -
2025-11-11 23:30:31,346 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:30:31] "GET /socket.io/?EIO=4&transport=polling&t=PfsL5km&sid=pV_MawcU89eMG_iEAAAE HTTP/1.1" 200 -
2025-11-11 23:30:31,985 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:30:31] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:30:31,987 - root - INFO - WebSocket client connected: T-W5VrmGjhbxOlBNAAAH
2025-11-11 23:30:32,017 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:30:32] "GET /socket.io/?EIO=4&transport=polling&t=PfsL5kp&sid=pV_MawcU89eMG_iEAAAE HTTP/1.1" 200 -
2025-11-11 23:31:00,277 - agent.session_manager - INFO - [SessionManager] Registered session sess-ld412p2i
2025-11-11 23:31:00,278 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'what tables do you ahve access to as business gloassry'
2025-11-11 23:31:00,278 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-ld412p2i
2025-11-11 23:31:00,279 - agent.state_manager - WARNING - Session sess-ld412p2i not found
2025-11-11 23:31:00,279 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 23:31:00,283 - agent.state_manager - INFO - Saved session state for sess-ld412p2i (user: admin)
2025-11-11 23:31:00,283 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 23:31:00,283 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 23:31:00,284 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 23:31:00,284 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 23:31:00,284 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 23:31:00,284 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 23:31:00,284 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 23:31:00,286 - agent.state_manager - INFO - Saved session state for sess-ld412p2i (user: admin)
2025-11-11 23:31:04,105 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:31:04,108 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-11 23:31:04,108 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-11 23:31:04,108 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-11 23:31:04,112 - agent.state_manager - INFO - Saved session state for sess-ld412p2i (user: admin)
2025-11-11 23:31:04,112 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-11 23:31:04,112 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-11 23:31:04,113 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-11 23:31:04,113 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-11 23:31:04,113 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-11 23:31:04,113 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-11 23:31:04,113 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-11 23:31:04,113 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-11 23:31:04,113 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-11 23:31:04,113 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-11 23:31:04,113 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-11 23:31:04,113 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-11 23:31:04,113 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-11 23:31:04,113 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-11 23:31:04,114 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-11 23:31:04,114 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-11 23:31:07,222 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:31:08,098 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-11 23:31:11,136 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-11 23:31:11,136 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-11 23:31:11,137 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-11 23:31:11,140 - agent.state_manager - INFO - Saved session state for sess-ld412p2i (user: admin)
2025-11-11 23:31:11,140 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-11 23:31:11,140 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-11 23:31:11,140 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-11 23:31:11,144 - agent.state_manager - INFO - Saved session state for sess-ld412p2i (user: admin)
2025-11-11 23:31:11,144 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: -- KNOWLEDGE QUESTION...
2025-11-11 23:31:11,144 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 21 chars
2025-11-11 23:31:11,144 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: -- KNOWLEDGE QUESTION
2025-11-11 23:31:11,144 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-11 23:31:11,144 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-11 23:31:11,145 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-11 23:31:11,147 - agent.state_manager - INFO - Saved session state for sess-ld412p2i (user: admin)
2025-11-11 23:31:11,147 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=0, columns=0, rows=0, sql=-- KNOWLEDGE QUESTION
2025-11-11 23:31:11,148 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-11 23:31:11,148 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['columns', 'rows', 'row_count', 'query']
2025-11-11 23:31:11,148 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: -- KNOWLEDGE QUESTION
2025-11-11 23:31:11,148 - agent.graph_nodes - INFO - [END_NODE] Knowledge response detected: 'Based on the business glossary provided, there are two tables/entries:

1. **market_risk_limits_over...'
2025-11-11 23:31:11,148 - agent.graph_nodes - INFO - [END_NODE] Returning knowledge result with response length: 782
2025-11-11 23:31:11,148 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-11 23:31:11,148 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-11 23:31:11,149 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-11 23:31:11,151 - agent.state_manager - INFO - Saved session state for sess-ld412p2i (user: admin)
2025-11-11 23:31:11,151 - agent.streaming_agent - INFO - Agent completed for session sess-ld412p2i: 10867.266000000001ms, 7 steps
2025-11-11 23:31:11,151 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=0, columns=0, rows=0
2025-11-11 23:31:11,151 - agent.session_manager - INFO - [SessionManager] Unregistered session sess-ld412p2i
2025-11-11 23:31:31,102 - root - INFO - Client hox2ALlnCa_Y_EHwAAAF joined session room: sess-tgy92bm1
2025-11-11 23:31:31,107 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:31:31] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-11 23:31:31,107 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:31:31] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-11 23:31:31,108 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:31:31] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-11 23:31:31,610 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:31:31] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:40:47,587 - root - INFO - WebSocket client disconnected: T-W5VrmGjhbxOlBNAAAH
2025-11-11 23:40:47,588 - root - INFO - WebSocket client disconnected: hox2ALlnCa_Y_EHwAAAF
2025-11-11 23:40:47,588 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:47] "GET /socket.io/?EIO=4&transport=websocket&sid=pV_MawcU89eMG_iEAAAE HTTP/1.1" 200 -
2025-11-11 23:40:47,591 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:47] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 23:40:47,594 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:47] "GET /login?next=http://localhost:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 23:40:47,599 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:47] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:40:47,602 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:40:47,615 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:47] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 23:40:47,615 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:47] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 23:40:47,677 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:47] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-11-11 23:40:52,495 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 23:40:52,495 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 23:40:52,496 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:52] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 23:40:52,510 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:52] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 23:40:52,523 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:52] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:40:52,523 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:52] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:40:56,785 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:56] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 23:40:56,794 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:56] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:40:56,808 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:56] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:40:56,849 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:56] "GET /socket.io/?EIO=4&transport=polling&t=PfsNUSG HTTP/1.1" 200 -
2025-11-11 23:40:56,853 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:56] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-11 23:40:56,853 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:56] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-11 23:40:56,853 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:56] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-11 23:40:56,867 - root - INFO - WebSocket client connected: w7oRhTITqtLY9ru4AAAJ
2025-11-11 23:40:56,868 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:56] "POST /socket.io/?EIO=4&transport=polling&t=PfsNUSY&sid=WyWNcYV5fj3QdbGBAAAI HTTP/1.1" 200 -
2025-11-11 23:40:56,868 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:56] "GET /socket.io/?EIO=4&transport=polling&t=PfsNUSY.0&sid=WyWNcYV5fj3QdbGBAAAI HTTP/1.1" 200 -
2025-11-11 23:40:56,871 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:56] "POST /socket.io/?EIO=4&transport=polling&t=PfsNUSc&sid=WyWNcYV5fj3QdbGBAAAI HTTP/1.1" 200 -
2025-11-11 23:40:56,871 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:56] "GET /socket.io/?EIO=4&transport=polling&t=PfsNUSb&sid=WyWNcYV5fj3QdbGBAAAI HTTP/1.1" 200 -
2025-11-11 23:40:56,873 - root - INFO - Client w7oRhTITqtLY9ru4AAAJ joined session room: sess-co9nbmz7
2025-11-11 23:40:56,873 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:56] "POST /socket.io/?EIO=4&transport=polling&t=PfsNUSe.0&sid=WyWNcYV5fj3QdbGBAAAI HTTP/1.1" 200 -
2025-11-11 23:40:56,874 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:56] "GET /socket.io/?EIO=4&transport=polling&t=PfsNUSe&sid=WyWNcYV5fj3QdbGBAAAI HTTP/1.1" 200 -
2025-11-11 23:40:57,187 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:57] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:40:57,704 - root - INFO - WebSocket client connected: 3Q_QieThAD0Mt-mkAAAL
2025-11-11 23:40:57,707 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:40:57] "GET /socket.io/?EIO=4&transport=polling&t=PfsNUSg&sid=WyWNcYV5fj3QdbGBAAAI HTTP/1.1" 200 -
2025-11-11 23:41:08,314 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:08] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:41:08,320 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:08] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:41:51,755 - root - INFO - WebSocket client disconnected: w7oRhTITqtLY9ru4AAAJ
2025-11-11 23:41:51,755 - root - INFO - WebSocket client disconnected: 3Q_QieThAD0Mt-mkAAAL
2025-11-11 23:41:51,756 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:51] "GET /socket.io/?EIO=4&transport=websocket&sid=WyWNcYV5fj3QdbGBAAAI HTTP/1.1" 200 -
2025-11-11 23:41:51,767 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:51] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:41:51,769 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:41:55,576 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:55] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 23:41:55,652 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:55] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:41:55,662 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:55] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:41:55,731 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:55] "GET /socket.io/?EIO=4&transport=polling&t=PfsNiqH HTTP/1.1" 200 -
2025-11-11 23:41:55,734 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:55] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-11 23:41:55,735 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:55] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-11 23:41:55,736 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:55] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-11 23:41:55,752 - root - INFO - WebSocket client connected: CadMllr4HE2f10n_AAAO
2025-11-11 23:41:55,755 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:55] "POST /socket.io/?EIO=4&transport=polling&t=PfsNiqa&sid=pJ6yu16_zdYccJ_PAAAM HTTP/1.1" 200 -
2025-11-11 23:41:55,756 - root - INFO - WebSocket client connected: Ye9KDyF0LDgMmTJfAAAP
2025-11-11 23:41:55,756 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:55] "GET /socket.io/?EIO=4&transport=polling&t=PfsNiqb&sid=pJ6yu16_zdYccJ_PAAAM HTTP/1.1" 200 -
2025-11-11 23:41:55,760 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:55] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-11-11 23:41:55,761 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:55] "GET /socket.io/?EIO=4&transport=polling&t=PfsNiqj&sid=pJ6yu16_zdYccJ_PAAAM HTTP/1.1" 200 -
2025-11-11 23:41:55,761 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:55] "POST /socket.io/?EIO=4&transport=polling&t=PfsNiqk&sid=pJ6yu16_zdYccJ_PAAAM HTTP/1.1" 200 -
2025-11-11 23:41:55,764 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:55] "GET /socket.io/?EIO=4&transport=polling&t=PfsNiqp&sid=pJ6yu16_zdYccJ_PAAAM HTTP/1.1" 200 -
2025-11-11 23:41:55,764 - root - INFO - Client CadMllr4HE2f10n_AAAO joined session room: sess-co9nbmz7
2025-11-11 23:41:55,764 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:55] "POST /socket.io/?EIO=4&transport=polling&t=PfsNiqp.0&sid=pJ6yu16_zdYccJ_PAAAM HTTP/1.1" 200 -
2025-11-11 23:41:56,181 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:56] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:41:58,135 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:58] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 23:41:58,142 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:58] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:41:58,152 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:58] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:41:58,171 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:58] "GET /socket.io/?EIO=4&transport=polling&t=PfsNjQO HTTP/1.1" 200 -
2025-11-11 23:41:58,173 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:58] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-11 23:41:58,174 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:58] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-11 23:41:58,175 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:58] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-11 23:41:58,193 - root - INFO - WebSocket client connected: lBxL5lqXlKzFsYM5AAAR
2025-11-11 23:41:58,193 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:58] "POST /socket.io/?EIO=4&transport=polling&t=PfsNjQl&sid=FG6AfYr3ia67ISQkAAAQ HTTP/1.1" 200 -
2025-11-11 23:41:58,194 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:58] "GET /socket.io/?EIO=4&transport=polling&t=PfsNjQm&sid=FG6AfYr3ia67ISQkAAAQ HTTP/1.1" 200 -
2025-11-11 23:41:58,197 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:58] "POST /socket.io/?EIO=4&transport=polling&t=PfsNjQq&sid=FG6AfYr3ia67ISQkAAAQ HTTP/1.1" 200 -
2025-11-11 23:41:58,197 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:58] "GET /socket.io/?EIO=4&transport=polling&t=PfsNjQp&sid=FG6AfYr3ia67ISQkAAAQ HTTP/1.1" 200 -
2025-11-11 23:41:58,199 - root - INFO - Client lBxL5lqXlKzFsYM5AAAR joined session room: sess-co9nbmz7
2025-11-11 23:41:58,199 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:58] "POST /socket.io/?EIO=4&transport=polling&t=PfsNjQs.0&sid=FG6AfYr3ia67ISQkAAAQ HTTP/1.1" 200 -
2025-11-11 23:41:58,199 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:58] "GET /socket.io/?EIO=4&transport=polling&t=PfsNjQs&sid=FG6AfYr3ia67ISQkAAAQ HTTP/1.1" 200 -
2025-11-11 23:41:58,485 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:58] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:41:58,536 - root - INFO - WebSocket client connected: dKKsqIEQJlOJKSi7AAAT
2025-11-11 23:41:58,536 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:41:58] "GET /socket.io/?EIO=4&transport=polling&t=PfsNjQu&sid=FG6AfYr3ia67ISQkAAAQ HTTP/1.1" 200 -
2025-11-11 23:42:09,556 - root - INFO - WebSocket client disconnected: lBxL5lqXlKzFsYM5AAAR
2025-11-11 23:42:09,558 - root - INFO - WebSocket client disconnected: dKKsqIEQJlOJKSi7AAAT
2025-11-11 23:42:09,558 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:09] "GET /socket.io/?EIO=4&transport=websocket&sid=FG6AfYr3ia67ISQkAAAQ HTTP/1.1" 200 -
2025-11-11 23:42:09,564 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:09] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 23:42:09,569 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:09] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:42:09,571 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:42:09,582 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:09] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:42:09,582 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:09] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:42:09,599 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:09] "GET /socket.io/?EIO=4&transport=polling&t=PfsNmCz HTTP/1.1" 200 -
2025-11-11 23:42:09,602 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:09] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-11 23:42:09,603 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:09] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-11 23:42:09,605 - root - INFO - WebSocket client connected: 2OUNV91xCOldbzBEAAAW
2025-11-11 23:42:09,605 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:09] "POST /socket.io/?EIO=4&transport=polling&t=PfsNmD2&sid=VIbVeopWm24hLwBLAAAU HTTP/1.1" 200 -
2025-11-11 23:42:09,606 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:09] "GET /socket.io/?EIO=4&transport=polling&t=PfsNmD3&sid=VIbVeopWm24hLwBLAAAU HTTP/1.1" 200 -
2025-11-11 23:42:09,606 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:09] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-11 23:42:09,606 - root - INFO - WebSocket client connected: w0YJjHEhC7l3R_A0AAAX
2025-11-11 23:42:09,609 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:09] "POST /socket.io/?EIO=4&transport=polling&t=PfsNmD7.0&sid=VIbVeopWm24hLwBLAAAU HTTP/1.1" 200 -
2025-11-11 23:42:09,609 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:09] "GET /socket.io/?EIO=4&transport=polling&t=PfsNmD7&sid=VIbVeopWm24hLwBLAAAU HTTP/1.1" 200 -
2025-11-11 23:42:09,610 - root - INFO - Client 2OUNV91xCOldbzBEAAAW joined session room: sess-co9nbmz7
2025-11-11 23:42:09,610 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:09] "POST /socket.io/?EIO=4&transport=polling&t=PfsNmD9.0&sid=VIbVeopWm24hLwBLAAAU HTTP/1.1" 200 -
2025-11-11 23:42:09,611 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:09] "GET /socket.io/?EIO=4&transport=polling&t=PfsNmD9&sid=VIbVeopWm24hLwBLAAAU HTTP/1.1" 200 -
2025-11-11 23:42:09,617 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:09] "GET /socket.io/?EIO=4&transport=polling&t=PfsNmDB&sid=VIbVeopWm24hLwBLAAAU HTTP/1.1" 200 -
2025-11-11 23:42:09,805 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:09] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:42:12,292 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:12] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:42:12,296 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:12] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:42:25,381 - root - INFO - WebSocket client disconnected: CadMllr4HE2f10n_AAAO
2025-11-11 23:42:25,382 - root - INFO - WebSocket client disconnected: Ye9KDyF0LDgMmTJfAAAP
2025-11-11 23:42:25,383 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:25] "GET /socket.io/?EIO=4&transport=websocket&sid=pJ6yu16_zdYccJ_PAAAM HTTP/1.1" 200 -
2025-11-11 23:42:25,386 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:25] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:42:25,388 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:42:28,857 - root - INFO - WebSocket client disconnected: 2OUNV91xCOldbzBEAAAW
2025-11-11 23:42:28,862 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:28] "GET /socket.io/?EIO=4&transport=websocket&sid=VIbVeopWm24hLwBLAAAU HTTP/1.1" 200 -
2025-11-11 23:42:28,864 - root - INFO - WebSocket client disconnected: w0YJjHEhC7l3R_A0AAAX
2025-11-11 23:42:28,867 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:28] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 23:42:28,870 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:28] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:42:28,878 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:42:28,880 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:28] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 23:42:28,882 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:28] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 23:42:28,890 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:28] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:42:28,960 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:28] "GET /socket.io/?EIO=4&transport=polling&t=PfsNqxR HTTP/1.1" 200 -
2025-11-11 23:42:28,962 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:28] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-11 23:42:28,963 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:28] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-11 23:42:28,965 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:28] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-11 23:42:28,970 - root - INFO - WebSocket client connected: OlkejuFFqaENEWvHAAAZ
2025-11-11 23:42:28,971 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:28] "POST /socket.io/?EIO=4&transport=polling&t=PfsNqxc&sid=6mMKVWuEIzIG0o01AAAY HTTP/1.1" 200 -
2025-11-11 23:42:28,971 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:28] "GET /socket.io/?EIO=4&transport=polling&t=PfsNqxd&sid=6mMKVWuEIzIG0o01AAAY HTTP/1.1" 200 -
2025-11-11 23:42:28,974 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:28] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-11-11 23:42:28,978 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:28] "GET /socket.io/?EIO=4&transport=polling&t=PfsNqxm&sid=6mMKVWuEIzIG0o01AAAY HTTP/1.1" 200 -
2025-11-11 23:42:28,978 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:28] "POST /socket.io/?EIO=4&transport=polling&t=PfsNqxn&sid=6mMKVWuEIzIG0o01AAAY HTTP/1.1" 200 -
2025-11-11 23:42:28,979 - root - INFO - Client OlkejuFFqaENEWvHAAAZ joined session room: sess-co9nbmz7
2025-11-11 23:42:28,984 - root - INFO - WebSocket client connected: hmSn4kMUYw3_IlyLAAAb
2025-11-11 23:42:29,164 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:29] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:42:44,804 - root - INFO - WebSocket client disconnected: hmSn4kMUYw3_IlyLAAAb
2025-11-11 23:42:44,805 - root - INFO - WebSocket client disconnected: OlkejuFFqaENEWvHAAAZ
2025-11-11 23:42:44,805 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:44] "GET /socket.io/?EIO=4&transport=websocket&sid=6mMKVWuEIzIG0o01AAAY HTTP/1.1" 200 -
2025-11-11 23:42:44,808 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:44] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 23:42:44,811 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:44] "GET /login?next=http://localhost:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 23:42:44,816 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:44] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:42:44,818 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:42:44,832 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:44] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 23:42:44,835 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:44] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:42:44,836 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:44] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 23:42:44,889 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:44] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-11-11 23:42:50,457 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 23:42:50,457 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 23:42:50,459 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:50] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 23:42:50,472 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:50] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 23:42:50,489 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:50] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:42:50,491 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:50] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:42:50,492 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:50] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:42:55,279 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:55] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 23:42:55,299 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:55] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:42:55,306 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:55] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:42:55,308 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:55] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:42:55,337 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:55] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-11 23:42:55,338 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:55] "GET /socket.io/?EIO=4&transport=polling&t=PfsNxNa HTTP/1.1" 200 -
2025-11-11 23:42:55,345 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:55] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-11 23:42:55,346 - root - INFO - WebSocket client connected: ceb1cDAxlCUfFpUEAAAd
2025-11-11 23:42:55,347 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:55] "POST /socket.io/?EIO=4&transport=polling&t=PfsNxNj&sid=V7UxD2CuGUuQ3jRSAAAc HTTP/1.1" 200 -
2025-11-11 23:42:55,347 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:55] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-11 23:42:55,347 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:55] "GET /socket.io/?EIO=4&transport=polling&t=PfsNxNk&sid=V7UxD2CuGUuQ3jRSAAAc HTTP/1.1" 200 -
2025-11-11 23:42:55,354 - root - INFO - Client ceb1cDAxlCUfFpUEAAAd joined session room: sess-0g7njy77
2025-11-11 23:42:55,378 - root - INFO - WebSocket client connected: -VH_jItI86hodjwgAAAf
2025-11-11 23:42:55,540 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:42:55] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:43:16,695 - root - INFO - WebSocket client disconnected: -VH_jItI86hodjwgAAAf
2025-11-11 23:43:16,695 - root - INFO - WebSocket client disconnected: ceb1cDAxlCUfFpUEAAAd
2025-11-11 23:43:16,696 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:16] "GET /socket.io/?EIO=4&transport=websocket&sid=V7UxD2CuGUuQ3jRSAAAc HTTP/1.1" 200 -
2025-11-11 23:43:16,699 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:16] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 23:43:16,706 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:16] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:43:16,707 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:43:16,721 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:16] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:43:16,721 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:16] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:43:16,724 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:16] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:43:16,761 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:16] "GET /socket.io/?EIO=4&transport=polling&t=PfsO0cL HTTP/1.1" 200 -
2025-11-11 23:43:16,763 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:16] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-11 23:43:16,765 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:16] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-11 23:43:16,766 - root - INFO - WebSocket client connected: lxT5WBJmadikFA7HAAAi
2025-11-11 23:43:16,768 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:16] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-11 23:43:16,769 - root - INFO - WebSocket client connected: mVsRVjkxBkuZn5t8AAAj
2025-11-11 23:43:16,769 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:16] "POST /socket.io/?EIO=4&transport=polling&t=PfsO0cR&sid=lHZw4tWC66psPmOHAAAg HTTP/1.1" 200 -
2025-11-11 23:43:16,770 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:16] "GET /socket.io/?EIO=4&transport=polling&t=PfsO0cS&sid=lHZw4tWC66psPmOHAAAg HTTP/1.1" 200 -
2025-11-11 23:43:16,787 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:16] "POST /socket.io/?EIO=4&transport=polling&t=PfsO0cb.0&sid=lHZw4tWC66psPmOHAAAg HTTP/1.1" 200 -
2025-11-11 23:43:16,792 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:16] "GET /socket.io/?EIO=4&transport=polling&t=PfsO0cb&sid=lHZw4tWC66psPmOHAAAg HTTP/1.1" 200 -
2025-11-11 23:43:16,794 - root - INFO - Client lxT5WBJmadikFA7HAAAi joined session room: sess-0g7njy77
2025-11-11 23:43:16,965 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:16] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:43:17,545 - root - INFO - WebSocket client disconnected: mVsRVjkxBkuZn5t8AAAj
2025-11-11 23:43:17,545 - root - INFO - WebSocket client disconnected: lxT5WBJmadikFA7HAAAi
2025-11-11 23:43:17,546 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:17] "GET /socket.io/?EIO=4&transport=websocket&sid=lHZw4tWC66psPmOHAAAg HTTP/1.1" 200 -
2025-11-11 23:43:17,550 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:17] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 23:43:17,555 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:17] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:43:17,556 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:43:17,566 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:17] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:43:17,569 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:17] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:43:17,570 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:17] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:43:17,605 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:17] "GET /socket.io/?EIO=4&transport=polling&t=PfsO0pS HTTP/1.1" 200 -
2025-11-11 23:43:17,607 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:17] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-11 23:43:17,609 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:17] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-11 23:43:17,610 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:17] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-11 23:43:17,611 - root - INFO - WebSocket client connected: Aznei7xNDY6qyWhkAAAm
2025-11-11 23:43:17,611 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:17] "POST /socket.io/?EIO=4&transport=polling&t=PfsO0pc&sid=g4sRhqQGswU-w4AVAAAk HTTP/1.1" 200 -
2025-11-11 23:43:17,612 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:17] "GET /socket.io/?EIO=4&transport=polling&t=PfsO0pc.0&sid=g4sRhqQGswU-w4AVAAAk HTTP/1.1" 200 -
2025-11-11 23:43:17,615 - root - INFO - WebSocket client connected: M8uW_tKyFSNyNqKQAAAn
2025-11-11 23:43:17,618 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:17] "GET /socket.io/?EIO=4&transport=polling&t=PfsO0pj&sid=g4sRhqQGswU-w4AVAAAk HTTP/1.1" 200 -
2025-11-11 23:43:17,618 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:17] "POST /socket.io/?EIO=4&transport=polling&t=PfsO0pj.0&sid=g4sRhqQGswU-w4AVAAAk HTTP/1.1" 200 -
2025-11-11 23:43:17,622 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:17] "GET /socket.io/?EIO=4&transport=polling&t=PfsO0pq&sid=g4sRhqQGswU-w4AVAAAk HTTP/1.1" 200 -
2025-11-11 23:43:17,623 - root - INFO - Client Aznei7xNDY6qyWhkAAAm joined session room: sess-0g7njy77
2025-11-11 23:43:17,623 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:17] "POST /socket.io/?EIO=4&transport=polling&t=PfsO0pq.0&sid=g4sRhqQGswU-w4AVAAAk HTTP/1.1" 200 -
2025-11-11 23:43:17,803 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:17] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:43:29,683 - root - INFO - WebSocket client disconnected: M8uW_tKyFSNyNqKQAAAn
2025-11-11 23:43:29,684 - root - INFO - WebSocket client disconnected: Aznei7xNDY6qyWhkAAAm
2025-11-11 23:43:29,684 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:29] "GET /socket.io/?EIO=4&transport=websocket&sid=g4sRhqQGswU-w4AVAAAk HTTP/1.1" 200 -
2025-11-11 23:43:29,687 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:29] "GET /agent/chat?v=9&t=[timestamp]&nocache=1 HTTP/1.1" 200 -
2025-11-11 23:43:29,690 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:29] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:43:29,691 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:43:29,699 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:29] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:43:29,703 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:29] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:43:29,704 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:29] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:43:29,721 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:29] "GET /socket.io/?EIO=4&transport=polling&t=PfsO3ms HTTP/1.1" 200 -
2025-11-11 23:43:29,729 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:29] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-11 23:43:29,731 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:29] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-11 23:43:29,733 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:29] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-11 23:43:29,734 - root - INFO - WebSocket client connected: BKxVRPMNfivZtdzGAAAq
2025-11-11 23:43:29,735 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:29] "POST /socket.io/?EIO=4&transport=polling&t=PfsO3m-&sid=QckmrecpOWLfKaqZAAAo HTTP/1.1" 200 -
2025-11-11 23:43:29,735 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:29] "GET /socket.io/?EIO=4&transport=polling&t=PfsO3m_&sid=QckmrecpOWLfKaqZAAAo HTTP/1.1" 200 -
2025-11-11 23:43:29,736 - root - INFO - WebSocket client connected: ULm6ymu9PS2fH-C4AAAr
2025-11-11 23:43:29,741 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:29] "POST /socket.io/?EIO=4&transport=polling&t=PfsO3nB.0&sid=QckmrecpOWLfKaqZAAAo HTTP/1.1" 200 -
2025-11-11 23:43:29,741 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:29] "GET /socket.io/?EIO=4&transport=polling&t=PfsO3nB&sid=QckmrecpOWLfKaqZAAAo HTTP/1.1" 200 -
2025-11-11 23:43:29,746 - root - INFO - Client BKxVRPMNfivZtdzGAAAq joined session room: sess-0g7njy77
2025-11-11 23:43:29,746 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:29] "POST /socket.io/?EIO=4&transport=polling&t=PfsO3nG&sid=QckmrecpOWLfKaqZAAAo HTTP/1.1" 200 -
2025-11-11 23:43:29,746 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:29] "GET /socket.io/?EIO=4&transport=polling&t=PfsO3nF&sid=QckmrecpOWLfKaqZAAAo HTTP/1.1" 200 -
2025-11-11 23:43:29,927 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:29] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:43:59,082 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:59] "[32mGET /agent/chat?v=9&t=[timestamp]&nocache=1 HTTP/1.1[0m" 302 -
2025-11-11 23:43:59,084 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:59] "GET /login?next=http://localhost:8000/agent/chat?v%3D9%26t%3D[timestamp]%26nocache%3D1 HTTP/1.1" 200 -
2025-11-11 23:43:59,096 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:59] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 23:43:59,096 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:43:59] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 23:44:03,202 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 23:44:03,202 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 23:44:03,203 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:03] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 23:44:03,214 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:03] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 23:44:03,226 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:03] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:44:03,226 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:03] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:44:06,648 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:06] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 23:44:06,655 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:06] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:44:06,673 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:06] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:44:06,721 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:06] "GET /socket.io/?EIO=4&transport=polling&t=PfsOCo_ HTTP/1.1" 200 -
2025-11-11 23:44:06,724 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:06] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-11 23:44:06,724 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:06] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-11 23:44:06,724 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:06] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-11 23:44:06,738 - root - INFO - WebSocket client connected: QknIDG2BLh703mo5AAAt
2025-11-11 23:44:06,739 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:06] "POST /socket.io/?EIO=4&transport=polling&t=PfsOCpG&sid=5O3rL-wdQShfumokAAAs HTTP/1.1" 200 -
2025-11-11 23:44:06,739 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:06] "GET /socket.io/?EIO=4&transport=polling&t=PfsOCpH&sid=5O3rL-wdQShfumokAAAs HTTP/1.1" 200 -
2025-11-11 23:44:06,742 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:06] "POST /socket.io/?EIO=4&transport=polling&t=PfsOCpK.0&sid=5O3rL-wdQShfumokAAAs HTTP/1.1" 200 -
2025-11-11 23:44:06,742 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:06] "GET /socket.io/?EIO=4&transport=polling&t=PfsOCpK&sid=5O3rL-wdQShfumokAAAs HTTP/1.1" 200 -
2025-11-11 23:44:06,744 - root - INFO - Client QknIDG2BLh703mo5AAAt joined session room: sess-rmv06j1g
2025-11-11 23:44:06,744 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:06] "POST /socket.io/?EIO=4&transport=polling&t=PfsOCpN&sid=5O3rL-wdQShfumokAAAs HTTP/1.1" 200 -
2025-11-11 23:44:06,744 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:06] "GET /socket.io/?EIO=4&transport=polling&t=PfsOCpM&sid=5O3rL-wdQShfumokAAAs HTTP/1.1" 200 -
2025-11-11 23:44:07,183 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:07] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:44:07,622 - root - INFO - WebSocket client connected: Zk_NWSyX0-AxBEFBAAAv
2025-11-11 23:44:07,625 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:07] "GET /socket.io/?EIO=4&transport=polling&t=PfsOCpP&sid=5O3rL-wdQShfumokAAAs HTTP/1.1" 200 -
2025-11-11 23:44:11,807 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:11] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:44:11,811 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:11] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:44:56,223 - root - INFO - Client QknIDG2BLh703mo5AAAt joined session room: sess-818ogjip
2025-11-11 23:44:56,228 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:56] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-11 23:44:56,229 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:56] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-11 23:44:56,230 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:56] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-11 23:44:56,734 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:56] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:44:58,506 - root - INFO - WebSocket client disconnected: QknIDG2BLh703mo5AAAt
2025-11-11 23:44:58,507 - root - INFO - WebSocket client disconnected: Zk_NWSyX0-AxBEFBAAAv
2025-11-11 23:44:58,507 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:58] "GET /socket.io/?EIO=4&transport=websocket&sid=5O3rL-wdQShfumokAAAs HTTP/1.1" 200 -
2025-11-11 23:44:58,510 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:58] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 23:44:58,513 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:58] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:44:58,516 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:44:58,525 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:58] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:44:58,526 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:58] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:44:58,536 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:58] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:44:58,575 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:58] "GET /socket.io/?EIO=4&transport=polling&t=PfsOPTB HTTP/1.1" 200 -
2025-11-11 23:44:58,580 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:58] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-11 23:44:58,583 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:58] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-11 23:44:58,591 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:58] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-11 23:44:58,593 - root - INFO - WebSocket client connected: 3f5U9PxSWAl083HYAAAy
2025-11-11 23:44:58,594 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:58] "POST /socket.io/?EIO=4&transport=polling&t=PfsOPTT&sid=RbbJa7NUhaOLYvpIAAAw HTTP/1.1" 200 -
2025-11-11 23:44:58,595 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:58] "GET /socket.io/?EIO=4&transport=polling&t=PfsOPTU&sid=RbbJa7NUhaOLYvpIAAAw HTTP/1.1" 200 -
2025-11-11 23:44:58,597 - root - INFO - WebSocket client connected: l09L8j-evWZwKCHNAAAz
2025-11-11 23:44:58,600 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:58] "POST /socket.io/?EIO=4&transport=polling&t=PfsOPTb&sid=RbbJa7NUhaOLYvpIAAAw HTTP/1.1" 200 -
2025-11-11 23:44:58,600 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:58] "GET /socket.io/?EIO=4&transport=polling&t=PfsOPTa&sid=RbbJa7NUhaOLYvpIAAAw HTTP/1.1" 200 -
2025-11-11 23:44:58,604 - root - INFO - Client 3f5U9PxSWAl083HYAAAy joined session room: sess-818ogjip
2025-11-11 23:44:58,605 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:58] "POST /socket.io/?EIO=4&transport=polling&t=PfsOPTf.0&sid=RbbJa7NUhaOLYvpIAAAw HTTP/1.1" 200 -
2025-11-11 23:44:58,606 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:58] "GET /socket.io/?EIO=4&transport=polling&t=PfsOPTf&sid=RbbJa7NUhaOLYvpIAAAw HTTP/1.1" 200 -
2025-11-11 23:44:58,608 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:58] "GET /socket.io/?EIO=4&transport=polling&t=PfsOPTl&sid=RbbJa7NUhaOLYvpIAAAw HTTP/1.1" 200 -
2025-11-11 23:44:58,778 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:44:58] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:45:05,729 - root - INFO - WebSocket client disconnected: ULm6ymu9PS2fH-C4AAAr
2025-11-11 23:45:05,730 - root - INFO - WebSocket client disconnected: BKxVRPMNfivZtdzGAAAq
2025-11-11 23:45:05,730 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:05] "GET /socket.io/?EIO=4&transport=websocket&sid=QckmrecpOWLfKaqZAAAo HTTP/1.1" 200 -
2025-11-11 23:45:05,734 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:05] "GET /agent/chat?v=9&t=[timestamp]&nocache=1 HTTP/1.1" 200 -
2025-11-11 23:45:05,742 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:05] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:45:05,744 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:45:05,752 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:05] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:45:05,762 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:05] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-11 23:45:05,778 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:05] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-11 23:45:05,819 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:05] "GET /socket.io/?EIO=4&transport=polling&t=PfsOREM HTTP/1.1" 200 -
2025-11-11 23:45:05,828 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:05] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-11 23:45:05,830 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:05] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-11 23:45:05,836 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:05] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-11 23:45:05,837 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:05] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-11-11 23:45:05,837 - root - INFO - WebSocket client connected: JFt90YJTLnUfIVbYAAA2
2025-11-11 23:45:05,838 - root - INFO - WebSocket client connected: Esr0BaQkVgAErmpaAAA3
2025-11-11 23:45:05,839 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:05] "POST /socket.io/?EIO=4&transport=polling&t=PfsOREg&sid=9XmmS6Sgbs-sFXx_AAA0 HTTP/1.1" 200 -
2025-11-11 23:45:05,839 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:05] "GET /socket.io/?EIO=4&transport=polling&t=PfsOREh&sid=9XmmS6Sgbs-sFXx_AAA0 HTTP/1.1" 200 -
2025-11-11 23:45:05,841 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:05] "GET /socket.io/?EIO=4&transport=polling&t=PfsOREl&sid=9XmmS6Sgbs-sFXx_AAA0 HTTP/1.1" 200 -
2025-11-11 23:45:05,842 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:05] "POST /socket.io/?EIO=4&transport=polling&t=PfsOREm&sid=9XmmS6Sgbs-sFXx_AAA0 HTTP/1.1" 200 -
2025-11-11 23:45:05,843 - root - INFO - Client Esr0BaQkVgAErmpaAAA3 joined session room: sess-0g7njy77
2025-11-11 23:45:06,023 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:06] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:45:37,950 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-11 23:45:37,969 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-11 23:45:37,969 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-11 23:45:37,970 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-11 23:45:37,970 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-11 23:45:37,993 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 23:45:37,993 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 23:45:37,993 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 23:45:37,993 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 23:45:37,993 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-11 23:45:37,993 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-11 23:45:37,993 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-11 23:45:37,994 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-11 23:45:37,994 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-11 23:45:37,995 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-11 23:45:37,995 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-11 23:45:37,995 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-11 23:45:37,995 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-11 23:45:37,995 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-11 23:45:37,995 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-11 23:45:37,996 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-11 23:45:37,997 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-11 23:45:37,997 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-11 23:45:37,998 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-11 23:45:38,289 - DuckDbDescribeTableTool - INFO - Found 1 data files in data/duckdb
2025-11-11 23:45:38,327 - DuckDbDescribeTableTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 23:45:38,333 - DuckDbDescribeTableTool - INFO - Initialization complete: 4 views available
2025-11-11 23:45:38,334 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 23:45:38,334 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-11 23:45:38,334 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-11 23:45:38,335 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-11 23:45:38,335 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-11 23:45:38,552 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-11 23:45:38,552 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-11 23:45:38,553 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-11 23:45:38,553 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-11 23:45:38,554 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-11 23:45:38,554 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-11 23:45:38,554 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-11 23:45:38,554 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-11 23:45:38,554 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-11 23:45:38,554 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-11 23:45:38,557 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-11 23:45:38,557 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-11 23:45:38,558 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-11 23:45:38,558 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-11 23:45:38,558 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-11 23:45:38,558 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-11 23:45:38,559 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-11 23:45:38,559 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-11 23:45:38,559 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-11 23:45:38,559 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-11 23:45:38,560 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-11 23:45:38,560 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-11 23:45:38,560 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-11 23:45:38,560 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-11 23:45:38,561 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-11 23:45:38,561 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-11 23:45:38,561 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-11 23:45:38,561 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-11 23:45:38,561 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-11 23:45:38,562 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-11 23:45:38,562 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-11 23:45:38,562 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-11 23:45:38,563 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-11 23:45:38,563 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-11 23:45:38,563 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-11 23:45:38,563 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-11 23:45:38,564 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-11 23:45:38,564 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-11 23:45:38,567 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-11 23:45:38,567 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-11 23:45:38,567 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-11 23:45:38,567 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-11 23:45:38,567 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-11 23:45:38,567 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-11 23:45:38,567 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-11 23:45:38,567 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-11 23:45:38,573 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 23:45:38,574 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 23:45:38,574 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 23:45:38,574 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 23:45:38,574 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-11 23:45:38,574 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-11 23:45:38,574 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-11 23:45:38,574 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-11 23:45:38,574 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-11 23:45:38,574 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-11 23:45:38,574 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-11 23:45:38,575 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-11 23:45:38,575 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-11 23:45:38,575 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-11 23:45:38,575 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-11 23:45:38,576 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-11 23:45:38,576 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-11 23:45:38,576 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-11 23:45:38,576 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-11 23:45:38,576 - DuckDbListFilesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 23:45:38,612 - DuckDbListFilesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 23:45:38,613 - DuckDbListFilesTool - INFO - Initialization complete: 4 views available
2025-11-11 23:45:38,614 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 23:45:38,614 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-11 23:45:38,614 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-11 23:45:38,614 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-11 23:45:38,614 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-11 23:45:38,614 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-11 23:45:38,614 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-11 23:45:38,614 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-11 23:45:38,614 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-11 23:45:38,615 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-11 23:45:38,615 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-11 23:45:38,615 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-11 23:45:38,615 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-11 23:45:38,616 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-11 23:45:38,616 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-11 23:45:38,616 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-11 23:45:38,616 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-11 23:45:38,616 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-11 23:45:38,616 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-11 23:45:38,616 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-11 23:45:38,616 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-11 23:45:38,617 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-11 23:45:38,617 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-11 23:45:38,617 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-11 23:45:38,617 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-11 23:45:38,617 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-11 23:45:38,617 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-11 23:45:38,617 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-11 23:45:38,617 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-11 23:45:38,618 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-11 23:45:38,618 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-11 23:45:38,618 - DuckDbGetStatsTool - INFO - Found 1 data files in data/duckdb
2025-11-11 23:45:38,654 - DuckDbGetStatsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 23:45:38,655 - DuckDbGetStatsTool - INFO - Initialization complete: 4 views available
2025-11-11 23:45:38,656 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 23:45:38,656 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-11 23:45:38,656 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-11 23:45:38,656 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-11 23:45:38,656 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-11 23:45:38,656 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-11 23:45:38,656 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-11 23:45:38,656 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-11 23:45:38,656 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-11 23:45:38,656 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-11 23:45:38,657 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-11 23:45:38,663 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 23:45:38,663 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 23:45:38,663 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 23:45:38,663 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 23:45:38,663 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-11 23:45:38,663 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-11 23:45:38,663 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-11 23:45:38,663 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-11 23:45:38,663 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-11 23:45:38,663 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-11 23:45:38,663 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-11 23:45:38,679 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-11 23:45:38,679 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-11 23:45:38,679 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-11 23:45:38,679 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-11 23:45:38,679 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-11 23:45:38,679 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-11 23:45:38,680 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-11 23:45:38,680 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-11 23:45:38,680 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-11 23:45:38,680 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-11 23:45:38,680 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-11 23:45:38,680 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-11 23:45:38,680 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-11 23:45:38,680 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-11 23:45:38,680 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-11 23:45:38,680 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-11 23:45:38,680 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-11 23:45:38,680 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-11 23:45:38,681 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-11 23:45:38,681 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-11 23:45:38,681 - DuckDbListTablesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 23:45:38,716 - DuckDbListTablesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 23:45:38,717 - DuckDbListTablesTool - INFO - Initialization complete: 4 views available
2025-11-11 23:45:38,718 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 23:45:38,718 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-11 23:45:38,718 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-11 23:45:38,718 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-11 23:45:38,718 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-11 23:45:38,718 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-11 23:45:38,718 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-11 23:45:38,718 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-11 23:45:38,718 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-11 23:45:38,719 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-11 23:45:38,719 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-11 23:45:38,719 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-11 23:45:38,719 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-11 23:45:38,720 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-11 23:45:38,720 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-11 23:45:38,720 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-11 23:45:38,720 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-11 23:45:38,720 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-11 23:45:38,720 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-11 23:45:38,720 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-11 23:45:38,720 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-11 23:45:38,720 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-11 23:45:38,720 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-11 23:45:38,720 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-11 23:45:38,720 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-11 23:45:38,721 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-11 23:45:38,721 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-11 23:45:38,721 - DuckDbAggregateTool - INFO - Found 1 data files in data/duckdb
2025-11-11 23:45:38,756 - DuckDbAggregateTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 23:45:38,758 - DuckDbAggregateTool - INFO - Initialization complete: 4 views available
2025-11-11 23:45:38,758 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 23:45:38,758 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-11 23:45:38,758 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-11 23:45:38,758 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-11 23:45:38,758 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-11 23:45:38,758 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-11 23:45:38,758 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-11 23:45:38,759 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-11 23:45:38,759 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-11 23:45:38,759 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-11 23:45:38,759 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-11 23:45:38,759 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-11 23:45:38,759 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-11 23:45:38,759 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-11 23:45:38,759 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-11 23:45:38,765 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 23:45:38,765 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 23:45:38,765 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 23:45:38,765 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 23:45:38,765 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-11 23:45:38,765 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-11 23:45:38,765 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-11 23:45:38,766 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-11 23:45:38,766 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-11 23:45:38,766 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-11 23:45:38,766 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-11 23:45:38,766 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-11 23:45:38,766 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-11 23:45:38,766 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-11 23:45:38,766 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-11 23:45:38,766 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-11 23:45:38,766 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-11 23:45:38,767 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-11 23:45:38,767 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-11 23:45:38,767 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-11 23:45:38,767 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-11 23:45:38,767 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-11 23:45:38,767 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-11 23:45:38,767 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-11 23:45:38,767 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-11 23:45:38,767 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-11 23:45:38,767 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-11 23:45:38,767 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-11 23:45:38,767 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-11 23:45:38,768 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-11 23:45:38,768 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-11 23:45:38,768 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-11 23:45:38,768 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-11 23:45:38,769 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-11 23:45:38,769 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-11 23:45:38,769 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-11 23:45:38,769 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-11 23:45:38,769 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-11 23:45:38,769 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-11 23:45:38,769 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-11 23:45:38,769 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-11 23:45:38,770 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-11 23:45:38,770 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-11 23:45:38,770 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-11 23:45:38,770 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-11 23:45:38,770 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-11 23:45:38,770 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-11 23:45:38,770 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-11 23:45:38,770 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-11 23:45:38,770 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-11 23:45:38,770 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-11 23:45:38,770 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-11 23:45:38,770 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-11 23:45:38,771 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-11 23:45:38,771 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-11 23:45:38,771 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-11 23:45:38,771 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-11 23:45:38,771 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-11 23:45:38,771 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-11 23:45:38,771 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-11 23:45:38,771 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-11 23:45:38,772 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-11 23:45:38,772 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-11 23:45:38,773 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-11 23:45:38,773 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-11 23:45:38,773 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-11 23:45:38,773 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-11 23:45:38,773 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-11 23:45:38,773 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-11 23:45:38,773 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-11 23:45:38,773 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-11 23:45:38,773 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-11 23:45:38,773 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-11 23:45:38,773 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-11 23:45:38,773 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-11 23:45:38,779 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 23:45:38,779 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 23:45:38,779 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 23:45:38,779 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 23:45:38,779 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-11 23:45:38,779 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-11 23:45:38,779 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-11 23:45:38,780 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-11 23:45:38,780 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-11 23:45:38,780 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-11 23:45:38,780 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-11 23:45:38,780 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-11 23:45:38,780 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-11 23:45:38,780 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-11 23:45:38,780 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-11 23:45:38,780 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-11 23:45:38,780 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-11 23:45:38,781 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-11 23:45:38,781 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-11 23:45:38,781 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-11 23:45:38,781 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-11 23:45:38,781 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-11 23:45:38,781 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-11 23:45:38,781 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-11 23:45:38,781 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-11 23:45:38,781 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-11 23:45:38,781 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-11 23:45:38,781 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-11 23:45:38,781 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-11 23:45:38,782 - DuckDbQueryTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 23:45:38,818 - DuckDbQueryTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 23:45:38,820 - DuckDbQueryTool - INFO - Initialization complete: 4 views available
2025-11-11 23:45:38,820 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 23:45:38,820 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-11 23:45:38,820 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-11 23:45:38,820 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-11 23:45:38,820 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-11 23:45:38,820 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-11 23:45:38,820 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-11 23:45:38,821 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-11 23:45:38,821 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-11 23:45:38,821 - DuckDbRefreshViewsTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-11 23:45:38,856 - DuckDbRefreshViewsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-11 23:45:38,857 - DuckDbRefreshViewsTool - INFO - Initialization complete: 4 views available
2025-11-11 23:45:38,857 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-11 23:45:38,857 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-11 23:45:38,857 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-11 23:45:38,858 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-11 23:45:38,858 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-11 23:45:38,858 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-11 23:45:38,858 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-11 23:45:38,864 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-11 23:45:38,864 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-11 23:45:38,864 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-11 23:45:38,864 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-11 23:45:38,864 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-11 23:45:38,864 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-11 23:45:38,864 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-11 23:45:38,864 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-11 23:45:38,864 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-11 23:45:38,864 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-11 23:45:38,864 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-11 23:45:38,864 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-11 23:45:38,864 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-11 23:45:38,864 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-11 23:45:38,864 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-11 23:45:38,865 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-11 23:45:38,865 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-11 23:45:38,865 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-11 23:45:38,865 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-11 23:45:38,865 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-11 23:45:38,874 - root - INFO - All routes registered successfully
2025-11-11 23:45:38,885 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.68.51:8000
2025-11-11 23:45:38,885 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-11-11 23:45:39,183 - root - INFO - WebSocket client connected: 2UavqedYKaXqqFl_AAAB
2025-11-11 23:45:39,185 - root - INFO - WebSocket client disconnected: 2UavqedYKaXqqFl_AAAB
2025-11-11 23:45:39,199 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:39] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:45:39,201 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:45:40,183 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:40] "GET /socket.io/?EIO=4&transport=polling&t=PfsOZdF HTTP/1.1" 200 -
2025-11-11 23:45:40,184 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:40] "GET /socket.io/?EIO=4&transport=polling&t=PfsOZdE HTTP/1.1" 200 -
2025-11-11 23:45:40,194 - root - INFO - WebSocket client connected: YADHl9zmoykwC-4pAAAE
2025-11-11 23:45:40,196 - root - INFO - WebSocket client connected: q5d8EYAXPhAlHKVyAAAF
2025-11-11 23:45:40,197 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:40] "POST /socket.io/?EIO=4&transport=polling&t=PfsOZdS&sid=Gz2wD3bPv5qE-SPNAAAD HTTP/1.1" 200 -
2025-11-11 23:45:40,198 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:40] "POST /socket.io/?EIO=4&transport=polling&t=PfsOZdV&sid=QV-6u-i9b3vMqiUGAAAC HTTP/1.1" 200 -
2025-11-11 23:45:40,199 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:40] "GET /socket.io/?EIO=4&transport=polling&t=PfsOZdU&sid=Gz2wD3bPv5qE-SPNAAAD HTTP/1.1" 200 -
2025-11-11 23:45:40,200 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:40] "GET /socket.io/?EIO=4&transport=polling&t=PfsOZdW&sid=QV-6u-i9b3vMqiUGAAAC HTTP/1.1" 200 -
2025-11-11 23:45:40,205 - root - INFO - WebSocket client disconnected: YADHl9zmoykwC-4pAAAE
2025-11-11 23:45:40,208 - root - INFO - WebSocket client disconnected: q5d8EYAXPhAlHKVyAAAF
2025-11-11 23:45:40,209 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:40] "GET /socket.io/?EIO=4&transport=websocket&sid=Gz2wD3bPv5qE-SPNAAAD HTTP/1.1" 200 -
2025-11-11 23:45:40,210 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:40] "GET /socket.io/?EIO=4&transport=websocket&sid=QV-6u-i9b3vMqiUGAAAC HTTP/1.1" 200 -
2025-11-11 23:45:43,182 - root - INFO - WebSocket client connected: fvE43WRlUjg64oSpAAAH
2025-11-11 23:45:43,185 - root - INFO - WebSocket client disconnected: fvE43WRlUjg64oSpAAAH
2025-11-11 23:45:43,198 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:43] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:45:43,199 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:45:52,663 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:52] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-11 23:45:52,684 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:52] "GET /login?next=http://localhost:8000/agent/chat HTTP/1.1" 200 -
2025-11-11 23:45:52,702 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:52] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:45:52,703 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:52] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:45:52,706 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:52] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:45:52,732 - root - INFO - WebSocket client connected: ZaPoKiX0eDO3IRSLAAAJ
2025-11-11 23:45:52,735 - root - INFO - WebSocket client disconnected: ZaPoKiX0eDO3IRSLAAAJ
2025-11-11 23:45:52,748 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:52] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:45:52,748 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:45:57,106 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-11 23:45:57,107 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-11 23:45:57,108 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:57] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-11 23:45:57,128 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:57] "GET /dashboard HTTP/1.1" 200 -
2025-11-11 23:45:57,144 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:57] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:45:57,144 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:57] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:45:57,144 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:57] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:45:57,232 - root - INFO - WebSocket client connected: 2bwRvt6c0088mdzNAAAL
2025-11-11 23:45:57,234 - root - INFO - WebSocket client disconnected: 2bwRvt6c0088mdzNAAAL
2025-11-11 23:45:57,246 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:45:57] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:45:57,247 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:46:01,496 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:46:01] "GET /agent/chat HTTP/1.1" 200 -
2025-11-11 23:46:01,516 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:46:01] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:46:01,517 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:46:01] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:46:01,518 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:46:01] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:46:01,547 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:46:01] "GET /agent/chat?v=9&t=1762922761541&_=0.6378042132444182&nocache=1762922761541 HTTP/1.1" 200 -
2025-11-11 23:46:01,558 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:46:01] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:46:01,560 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:46:01] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:46:01,561 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:46:01] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:46:01,593 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:46:01] "GET /socket.io/?EIO=4&transport=polling&t=PfsOero HTTP/1.1" 200 -
2025-11-11 23:46:01,598 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:46:01] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-11 23:46:01,599 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:46:01] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-11 23:46:01,602 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:46:01] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-11 23:46:01,604 - root - INFO - WebSocket client connected: oHUxC9iS8kTaMIBWAAAO
2025-11-11 23:46:01,604 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:46:01] "POST /socket.io/?EIO=4&transport=polling&t=PfsOerx&sid=6E68KL5hRl_CoORFAAAM HTTP/1.1" 200 -
2025-11-11 23:46:01,605 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:46:01] "GET /socket.io/?EIO=4&transport=polling&t=PfsOery&sid=6E68KL5hRl_CoORFAAAM HTTP/1.1" 200 -
2025-11-11 23:46:01,607 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:46:01] "GET /api/agent/data-analysis-agents HTTP/1.1" 200 -
2025-11-11 23:46:01,609 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:46:01] "POST /socket.io/?EIO=4&transport=polling&t=PfsOes6.0&sid=6E68KL5hRl_CoORFAAAM HTTP/1.1" 200 -
2025-11-11 23:46:01,609 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:46:01] "GET /socket.io/?EIO=4&transport=polling&t=PfsOes6&sid=6E68KL5hRl_CoORFAAAM HTTP/1.1" 200 -
2025-11-11 23:46:01,623 - root - INFO - WebSocket client connected: QliwdraF8igepE2hAAAP
2025-11-11 23:46:01,624 - root - INFO - Client oHUxC9iS8kTaMIBWAAAO joined session room: sess-k4zg62iu
2025-11-11 23:46:01,624 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:46:01] "POST /socket.io/?EIO=4&transport=polling&t=PfsOesD.0&sid=6E68KL5hRl_CoORFAAAM HTTP/1.1" 200 -
2025-11-11 23:46:01,625 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:46:01] "GET /socket.io/?EIO=4&transport=polling&t=PfsOesD&sid=6E68KL5hRl_CoORFAAAM HTTP/1.1" 200 -
2025-11-11 23:46:01,626 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:46:01] "GET /api/agent/data-analysis-agents/mr_limits_analysis HTTP/1.1" 200 -
2025-11-11 23:46:01,631 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:46:01] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:46:38,915 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:46:38] "POST /api/agent/data-analysis-agents HTTP/1.1" 200 -
2025-11-11 23:46:40,837 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:46:40] "GET /api/agent/data-analysis-agents HTTP/1.1" 200 -
2025-11-11 23:46:40,850 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:46:40] "GET /api/agent/data-analysis-agents/mr_limits_analysis HTTP/1.1" 200 -
2025-11-11 23:46:40,854 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:46:40] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:47:02,656 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:47:02] "GET /api/agent/data-analysis-agents/dummy_one HTTP/1.1" 200 -
2025-11-11 23:47:02,663 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:47:02] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:47:08,384 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:47:08] "GET /api/agent/data-analysis-agents/mr_limits_analysis HTTP/1.1" 200 -
2025-11-11 23:47:08,391 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:47:08] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:47:15,535 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:47:15] "GET /api/agent/data-analysis-agents/dummy_one HTTP/1.1" 200 -
2025-11-11 23:47:15,541 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:47:15] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:49:08,314 - root - INFO - Client oHUxC9iS8kTaMIBWAAAO joined session room: sess-7mvtyntn
2025-11-11 23:49:08,321 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:49:08] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-11 23:49:08,322 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:49:08] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-11 23:49:08,323 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:49:08] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-11 23:49:08,824 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:49:08] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:59:46,444 - root - INFO - WebSocket client disconnected: QliwdraF8igepE2hAAAP
2025-11-11 23:59:46,445 - root - INFO - WebSocket client disconnected: oHUxC9iS8kTaMIBWAAAO
2025-11-11 23:59:46,445 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:59:46] "GET /socket.io/?EIO=4&transport=websocket&sid=6E68KL5hRl_CoORFAAAM HTTP/1.1" 200 -
2025-11-11 23:59:46,449 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:59:46] "GET /agent/chat?v=9&t=1762922761541&_=0.6378042132444182&nocache=1762922761541 HTTP/1.1" 200 -
2025-11-11 23:59:46,453 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:59:46] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-11 23:59:46,454 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-11 23:59:46,469 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:59:46] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-11 23:59:46,470 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:59:46] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-11 23:59:46,470 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:59:46] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-11 23:59:46,522 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:59:46] "GET /socket.io/?EIO=4&transport=polling&t=PfsRoFO HTTP/1.1" 200 -
2025-11-11 23:59:46,539 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:59:46] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-11 23:59:46,541 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:59:46] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-11 23:59:46,542 - root - INFO - WebSocket client connected: pGs_s0Rc19tolw_2AAAS
2025-11-11 23:59:46,544 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:59:46] "POST /socket.io/?EIO=4&transport=polling&t=PfsRoFY&sid=Jbtc1IJ0DilFsITVAAAQ HTTP/1.1" 200 -
2025-11-11 23:59:46,545 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:59:46] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-11 23:59:46,545 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:59:46] "GET /socket.io/?EIO=4&transport=polling&t=PfsRoFY.0&sid=Jbtc1IJ0DilFsITVAAAQ HTTP/1.1" 200 -
2025-11-11 23:59:46,546 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:59:46] "GET /api/agent/data-analysis-agents HTTP/1.1" 200 -
2025-11-11 23:59:46,547 - root - INFO - WebSocket client connected: IZTq8mByC_DbPqQ9AAAT
2025-11-11 23:59:46,554 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:59:46] "GET /socket.io/?EIO=4&transport=polling&t=PfsRoFq&sid=Jbtc1IJ0DilFsITVAAAQ HTTP/1.1" 200 -
2025-11-11 23:59:46,554 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:59:46] "POST /socket.io/?EIO=4&transport=polling&t=PfsRoFq.0&sid=Jbtc1IJ0DilFsITVAAAQ HTTP/1.1" 200 -
2025-11-11 23:59:46,555 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:59:46] "GET /api/agent/data-analysis-agents/dummy_one HTTP/1.1" 200 -
2025-11-11 23:59:46,557 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:59:46] "GET /socket.io/?EIO=4&transport=polling&t=PfsRoFx&sid=Jbtc1IJ0DilFsITVAAAQ HTTP/1.1" 200 -
2025-11-11 23:59:46,557 - root - INFO - Client pGs_s0Rc19tolw_2AAAS joined session room: sess-7mvtyntn
2025-11-11 23:59:46,557 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:59:46] "POST /socket.io/?EIO=4&transport=polling&t=PfsRoFx.0&sid=Jbtc1IJ0DilFsITVAAAQ HTTP/1.1" 200 -
2025-11-11 23:59:46,558 - werkzeug - INFO - 127.0.0.1 - - [11/Nov/2025 23:59:46] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-11 23:59:56,484 - agent.session_manager - INFO - [SessionManager] Registered session sess-7mvtyntn
2025-11-11 23:59:56,484 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-11 23:59:56,484 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-7mvtyntn
2025-11-11 23:59:56,484 - agent.state_manager - WARNING - Session sess-7mvtyntn not found
2025-11-11 23:59:56,484 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-11 23:59:56,486 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-11 23:59:56,486 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-11 23:59:56,486 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-11 23:59:56,487 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-11 23:59:56,487 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-11 23:59:56,487 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-11 23:59:56,488 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-11 23:59:56,488 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-11 23:59:56,490 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:00:00,760 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:00:00,779 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-12 00:00:00,780 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-12 00:00:00,780 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-12 00:00:00,782 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:00:00,783 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-12 00:00:00,783 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-12 00:00:00,783 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-12 00:00:00,783 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-12 00:00:00,783 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-12 00:00:00,783 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-12 00:00:00,783 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-12 00:00:00,783 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-12 00:00:00,783 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-12 00:00:00,783 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-12 00:00:00,783 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-12 00:00:00,784 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-12 00:00:00,784 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-12 00:00:00,784 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-12 00:00:00,784 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-12 00:00:00,784 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-12 00:00:03,525 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:00:04,173 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:00:06,391 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-12 00:00:06,391 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-12 00:00:06,391 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-12 00:00:06,391 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 1637 chars
2025-11-12 00:00:06,391 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-12 00:00:06,391 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-12 00:00:07,722 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:00:09,595 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 435 chars
2025-11-12 00:00:09,595 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY exposure_amt DESC",
  "explanation": "Retrieved top primary limits for the most recent date, sorted by exposure amount in descending order. Assumptions: 'top' implies sorting by exposure, 'primary' means filtering for primary limit class, and using the latest available date.",
  "target_table": "limits_data"
}
2025-11-12 00:00:09,595 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-12 00:00:09,596 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-12 00:00:09,596 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY exposure_amt DESC...
2025-11-12 00:00:09,596 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY exposure_amt DESC
2025-11-12 00:00:09,597 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-12 00:00:09,597 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-12 00:00:09,598 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-12 00:00:09,600 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:00:09,600 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-12 00:00:09,600 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-12 00:00:09,601 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-12 00:00:09,604 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:00:09,604 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY exposure_amt DESC...
2025-11-12 00:00:09,604 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 129 chars
2025-11-12 00:00:09,604 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY exposure_amt DESC
2025-11-12 00:00:09,605 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY exposure_amt DESC...
2025-11-12 00:00:09,605 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY exposure_amt DESC...
2025-11-12 00:00:09,605 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-12 00:00:09,605 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY exposure_amt DESC...
2025-11-12 00:00:09,695 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-12 00:00:09,695 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-12 00:00:09,695 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-12 00:00:09,696 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:00:09,696 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-12 00:00:09,696 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-12 00:00:09,696 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-12 00:00:09,696 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-12 00:00:09,697 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=129
2025-11-12 00:00:09,697 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-12 00:00:09,697 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-12 00:00:09,697 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4841 chars
2025-11-12 00:00:10,589 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:00:20,272 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1653 chars
2025-11-12 00:00:20,273 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-12 00:00:20,274 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-12 00:00:20,275 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 5712 chars
2025-11-12 00:00:25,713 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:00:25,715 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 802 chars
2025-11-12 00:00:25,716 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-12 00:00:25,716 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-12 00:00:25,716 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-12 00:00:25,716 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-12 00:00:25,717 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-12 00:00:25,717 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-12 00:00:25,717 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-12 00:00:25,723 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:00:25,723 - agent.streaming_agent - INFO - Agent completed for session sess-7mvtyntn: 29236.291999999998ms, 7 steps
2025-11-12 00:00:25,723 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-12 00:00:25,723 - agent.session_manager - INFO - [SessionManager] Unregistered session sess-7mvtyntn
2025-11-12 00:00:40,131 - agent.session_manager - INFO - [SessionManager] Registered session sess-7mvtyntn
2025-11-12 00:00:40,132 - agent.streaming_agent - INFO - [StreamingAgent] Query: '300121 how many records do we ahve fopr this one'
2025-11-12 00:00:40,132 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-7mvtyntn
2025-11-12 00:00:40,134 - agent.state_manager - INFO - Loaded session state for sess-7mvtyntn
2025-11-12 00:00:40,134 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 1 turns
2025-11-12 00:00:40,134 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 1 conversation turns
2025-11-12 00:00:40,137 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:00:40,138 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-12 00:00:40,138 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-12 00:00:40,138 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-12 00:00:40,138 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=1, conv_history(str)=5848
2025-11-12 00:00:40,139 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-12 00:00:40,139 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-12 00:00:40,139 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-12 00:00:40,141 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:00:40,141 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-12 00:00:43,260 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:00:43,262 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain all the columns and data needed to answer the follow-up query. The results include comprehensive details for the top primary limits, including full row information across 40+ columns. Since the previous query returned the complete dataset of primary limits, no additional database query is required to analyze or filter the existing results.
2025-11-12 00:00:43,262 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-12 00:00:43,263 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-12 00:00:43,263 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-12 00:00:43,267 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:00:46,737 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:00:46,740 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-12 00:00:46,740 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-12 00:00:46,740 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-12 00:00:46,743 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:00:46,744 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-12 00:00:46,744 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-12 00:00:46,745 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-12 00:00:46,745 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-12 00:00:46,745 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-12 00:00:46,745 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-12 00:00:46,745 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-12 00:00:46,745 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-12 00:00:46,745 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-12 00:00:46,745 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-12 00:00:46,745 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 5848 characters
2025-11-12 00:00:46,745 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-12 00:00:46,745 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-12 00:00:46,745 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-12 00:00:46,745 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-12 00:00:46,745 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-12 00:00:46,745 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-12 00:00:46,745 - tools.impl.nl_to_sql_planner - INFO -     User Query: top primary limits
2025-11-12 00:00:46,745 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-12 00:00:46,745 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-12 00:00:46,745 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY exposure_amt DESC
2025-11-12 00:00:46,746 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-12 00:00:46,746 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-12 00:00:46,746 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_i
2025-11-12 00:00:46,746 - tools.impl.nl_to_sql_planner - INFO -     ... (5248 more characters)
2025-11-12 00:00:46,746 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-12 00:00:50,322 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:00:51,550 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:00:53,413 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-12 00:00:53,414 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-12 00:00:53,414 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-12 00:00:53,414 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 5848
2025-11-12 00:00:53,414 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-12 00:00:53,415 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 2 SQL code blocks, using LAST (most recent)
2025-11-12 00:00:53,415 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-12 00:00:53,415 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY exposure_amt DESC...
2025-11-12 00:00:53,415 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 131 characters
2025-11-12 00:00:53,415 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-12 00:00:53,415 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-12 00:00:53,416 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 131 characters
2025-11-12 00:00:53,416 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY exposure_amt DESC
2025-11-12 00:00:53,416 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT * FROM limits_data 
WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) 
ORDER BY exposure_amt DESC
2025-11-12 00:00:53,416 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-12 00:00:53,417 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-12 00:00:53,417 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: 300121 how many records do we ahve fopr this one
2025-11-12 00:00:53,417 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10561 chars
2025-11-12 00:00:53,417 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 7482 chars
2025-11-12 00:00:53,417 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-12 00:00:53,417 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-12 00:00:54,826 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:00:56,783 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 353 chars
2025-11-12 00:00:56,784 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT COUNT(*) as record_count FROM limits_data WHERE limit_id = 300121",
    "explanation": "Counting records for specific limit_id 300121, which was previously identified as 'Canadian Options' in the Primary limits dataset. Assuming user wants total record count for this specific limit identifier.",
    "target_table": "limits_data"
}
2025-11-12 00:00:56,784 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-12 00:00:56,784 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-12 00:00:56,784 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT COUNT(*) as record_count FROM limits_data WHERE limit_id = 300121...
2025-11-12 00:00:56,784 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT COUNT(*) as record_count FROM limits_data WHERE limit_id = 300121
2025-11-12 00:00:56,785 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-12 00:00:56,785 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-12 00:00:56,785 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-12 00:00:56,790 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:00:56,790 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-12 00:00:56,793 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-12 00:00:56,793 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-12 00:00:56,798 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:00:56,798 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT COUNT(*) as record_count FROM limits_data WHERE limit_id = 300121...
2025-11-12 00:00:56,798 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 72 chars
2025-11-12 00:00:56,798 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT COUNT(*) as record_count FROM limits_data WHERE limit_id = 300121
2025-11-12 00:00:56,799 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT COUNT(*) as record_count FROM limits_data WHERE limit_id = 300121...
2025-11-12 00:00:56,799 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT COUNT(*) as record_count FROM limits_data WHERE limit_id = 300121...
2025-11-12 00:00:56,799 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-12 00:00:56,799 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT COUNT(*) as record_count FROM limits_data WHERE limit_id = 300121...
2025-11-12 00:00:56,867 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-12 00:00:56,867 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-12 00:00:56,867 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-12 00:00:56,868 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:00:56,868 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=1, columns=1, rows=1, sql=SELECT COUNT(*) as record_count FROM limits_data WHERE limit_id = 300121
2025-11-12 00:00:56,868 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-12 00:00:56,868 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-12 00:00:56,868 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT COUNT(*) as record_count FROM limits_data WHERE limit_id = 300121
2025-11-12 00:00:56,868 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=1, columns=1, rows=1, query_length=72
2025-11-12 00:00:56,868 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-12 00:00:56,868 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-12 00:00:56,869 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 513 chars
2025-11-12 00:00:57,432 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:01:01,450 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 883 chars
2025-11-12 00:01:01,450 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-12 00:01:01,451 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-12 00:01:01,451 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 6252 chars
2025-11-12 00:01:05,989 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:01:05,991 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 689 chars
2025-11-12 00:01:05,992 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=1, columns=1, rows=1, query=SELECT COUNT(*) as record_count FROM limits_data WHERE limit_id = 300121
2025-11-12 00:01:05,992 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=1, columns=1, rows=1, has_query=True
2025-11-12 00:01:05,992 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT COUNT(*) as record_count FROM limits_data WHERE limit_id = 300121...
2025-11-12 00:01:05,992 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT COUNT(*) as record_count FROM limits_data WHERE limit_id = 300121...
2025-11-12 00:01:05,992 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-12 00:01:05,993 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-12 00:01:05,993 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-12 00:01:05,999 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:01:05,999 - agent.streaming_agent - INFO - Agent completed for session sess-7mvtyntn: 25861.079ms, 8 steps
2025-11-12 00:01:06,000 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=1, columns=1, rows=1
2025-11-12 00:01:06,000 - agent.session_manager - INFO - [SessionManager] Unregistered session sess-7mvtyntn
2025-11-12 00:01:15,459 - agent.session_manager - INFO - [SessionManager] Registered session sess-7mvtyntn
2025-11-12 00:01:15,460 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'SELECT * FROM limits_data WHERE limit_id = 300121'
2025-11-12 00:01:15,460 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-7mvtyntn
2025-11-12 00:01:15,462 - agent.state_manager - INFO - Loaded session state for sess-7mvtyntn
2025-11-12 00:01:15,462 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 2 turns
2025-11-12 00:01:15,462 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 2 conversation turns
2025-11-12 00:01:15,466 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:01:15,466 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-12 00:01:15,466 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-12 00:01:15,466 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-12 00:01:15,467 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=2, conv_history(str)=7709
2025-11-12 00:01:15,467 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-12 00:01:15,467 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-12 00:01:15,467 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-12 00:01:15,470 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:01:15,470 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-12 00:01:18,175 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:01:18,177 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already showed 7 records for limit ID 300121, and the data was from the limits_data table. Since the new query is about this specific limit ID, the existing data can be used to answer any follow-up questions about these records without needing an additional database query.
2025-11-12 00:01:18,177 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-12 00:01:18,177 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-12 00:01:18,177 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-12 00:01:18,180 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:01:21,350 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:01:21,352 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-12 00:01:21,352 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-12 00:01:21,353 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-12 00:01:21,356 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:01:21,357 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-12 00:01:21,357 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-12 00:01:21,357 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-12 00:01:21,357 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-12 00:01:21,357 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-12 00:01:21,357 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-12 00:01:21,357 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-12 00:01:21,357 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-12 00:01:21,357 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-12 00:01:21,357 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-12 00:01:21,357 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 7709 characters
2025-11-12 00:01:21,357 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-12 00:01:21,358 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-12 00:01:21,358 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-12 00:01:21,358 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-12 00:01:21,358 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-12 00:01:21,358 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-12 00:01:21,358 - tools.impl.nl_to_sql_planner - INFO -     User Query: top primary limits
2025-11-12 00:01:21,358 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-12 00:01:21,358 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-12 00:01:21,358 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY exposure_amt DESC
2025-11-12 00:01:21,358 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-12 00:01:21,358 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-12 00:01:21,358 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_i
2025-11-12 00:01:21,359 - tools.impl.nl_to_sql_planner - INFO -     ... (7109 more characters)
2025-11-12 00:01:21,359 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-12 00:01:24,327 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:01:24,703 - agent.session_manager - INFO - [SessionManager] Registered session sess-7mvtyntn
2025-11-12 00:01:24,703 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'max min average of limit and exposure'
2025-11-12 00:01:24,704 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-7mvtyntn
2025-11-12 00:01:24,704 - agent.state_manager - INFO - Loaded session state for sess-7mvtyntn
2025-11-12 00:01:24,704 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 2 turns
2025-11-12 00:01:24,704 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 2 conversation turns
2025-11-12 00:01:24,705 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:01:24,705 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-12 00:01:24,705 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-12 00:01:24,706 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-12 00:01:24,706 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=2, conv_history(str)=7709
2025-11-12 00:01:24,706 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-12 00:01:24,706 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-12 00:01:24,706 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-12 00:01:24,707 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:01:24,707 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-12 00:01:25,404 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:01:27,088 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:01:27,091 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already showed 7 records for limit ID 300121, and the user is asking about the number of records for this specific limit ID. The COUNT query directly answered this question, so no additional database query is required.
2025-11-12 00:01:27,091 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-12 00:01:27,091 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-12 00:01:27,092 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-12 00:01:27,098 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:01:27,613 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-12 00:01:27,613 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-12 00:01:27,614 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-12 00:01:27,614 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 7709
2025-11-12 00:01:27,614 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-12 00:01:27,614 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 5 SQL code blocks, using LAST (most recent)
2025-11-12 00:01:27,614 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-12 00:01:27,614 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT * FROM limits_data WHERE limit_id = 300121...
2025-11-12 00:01:27,615 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 49 characters
2025-11-12 00:01:27,615 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-12 00:01:27,615 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-12 00:01:27,615 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 49 characters
2025-11-12 00:01:27,615 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT * FROM limits_data WHERE limit_id = 300121
2025-11-12 00:01:27,615 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT * FROM limits_data WHERE limit_id = 300121
2025-11-12 00:01:27,615 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-12 00:01:27,616 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-12 00:01:27,616 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: SELECT * FROM limits_data WHERE limit_id = 300121
2025-11-12 00:01:27,616 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10397 chars
2025-11-12 00:01:27,616 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 9344 chars
2025-11-12 00:01:27,616 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-12 00:01:27,616 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-12 00:01:29,235 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:01:30,714 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 294 chars
2025-11-12 00:01:30,715 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT * FROM limits_data WHERE limit_id = 300121",
    "explanation": "Direct retrieval of all records for limit_id 300121, preserving the exact filter from previous query. This will show all 7 records associated with this specific limit ID.",
    "target_table": "limits_data"
}
2025-11-12 00:01:30,715 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-12 00:01:30,715 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-12 00:01:30,715 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_id = 300121...
2025-11-12 00:01:30,716 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_id = 300121
2025-11-12 00:01:30,716 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-12 00:01:30,716 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-12 00:01:30,716 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-12 00:01:30,721 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:01:30,721 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-12 00:01:30,722 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-12 00:01:30,722 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-12 00:01:30,728 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:01:30,728 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_id = 300121...
2025-11-12 00:01:30,729 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 49 chars
2025-11-12 00:01:30,729 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_id = 300121
2025-11-12 00:01:30,729 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_id = 300121...
2025-11-12 00:01:30,729 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_id = 300121...
2025-11-12 00:01:30,729 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-12 00:01:30,729 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_id = 300121...
2025-11-12 00:01:30,796 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-12 00:01:30,796 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-12 00:01:30,797 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-12 00:01:30,798 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:01:30,798 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=7, columns=41, rows=7, sql=SELECT * FROM limits_data WHERE limit_id = 300121
2025-11-12 00:01:30,798 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-12 00:01:30,798 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-12 00:01:30,798 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_id = 300121
2025-11-12 00:01:30,799 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=7, columns=41, rows=7, query_length=49
2025-11-12 00:01:30,799 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-12 00:01:30,799 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-12 00:01:30,799 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 9643 chars
2025-11-12 00:01:30,904 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:01:30,904 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-12 00:01:30,905 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-12 00:01:30,905 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-12 00:01:30,907 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:01:30,907 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-12 00:01:30,907 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-12 00:01:30,907 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-12 00:01:30,907 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-12 00:01:30,907 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-12 00:01:30,907 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-12 00:01:30,907 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-12 00:01:30,907 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-12 00:01:30,907 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-12 00:01:30,907 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-12 00:01:30,907 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 7709 characters
2025-11-12 00:01:30,907 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-12 00:01:30,907 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-12 00:01:30,907 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-12 00:01:30,907 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-12 00:01:30,907 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-12 00:01:30,907 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-12 00:01:30,907 - tools.impl.nl_to_sql_planner - INFO -     User Query: top primary limits
2025-11-12 00:01:30,907 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-12 00:01:30,907 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-12 00:01:30,907 - tools.impl.nl_to_sql_planner - INFO -     SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY exposure_amt DESC
2025-11-12 00:01:30,907 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-12 00:01:30,907 - tools.impl.nl_to_sql_planner - INFO -     Result Table (3 rows):
2025-11-12 00:01:30,908 - tools.impl.nl_to_sql_planner - INFO -     Columns: date, letter_nm, limit_id, id1, id2, limit_class, limit_group, limit_type, limit_desc, meas_unit, aggr_func_cd, rating_floor, rating_ceiling, unofficial_flag, exposure_amt, Original_limit, effective_limit, utilization, grid_cc_id, grid_cell_id, curr_id, curr, sec_id, sec_desc, issuer_id, issuer_nm, ind_class_id, industry, region_id, region_cd, wl_i
2025-11-12 00:01:30,908 - tools.impl.nl_to_sql_planner - INFO -     ... (7109 more characters)
2025-11-12 00:01:30,908 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-12 00:01:32,100 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:01:34,091 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:01:35,215 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:01:37,841 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-12 00:01:37,841 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-12 00:01:37,841 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-12 00:01:37,841 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 7709
2025-11-12 00:01:37,842 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-12 00:01:37,842 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 5 SQL code blocks, using LAST (most recent)
2025-11-12 00:01:37,842 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-12 00:01:37,842 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT * FROM limits_data WHERE limit_id = 300121...
2025-11-12 00:01:37,842 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 49 characters
2025-11-12 00:01:37,842 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-12 00:01:37,842 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-12 00:01:37,842 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 49 characters
2025-11-12 00:01:37,842 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT * FROM limits_data WHERE limit_id = 300121
2025-11-12 00:01:37,842 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT * FROM limits_data WHERE limit_id = 300121
2025-11-12 00:01:37,842 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-12 00:01:37,843 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-12 00:01:37,843 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: max min average of limit and exposure
2025-11-12 00:01:37,843 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10397 chars
2025-11-12 00:01:37,843 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 9332 chars
2025-11-12 00:01:37,843 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-12 00:01:37,843 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-12 00:01:39,256 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:01:41,175 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1466 chars
2025-11-12 00:01:41,175 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-12 00:01:41,175 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-12 00:01:41,176 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 8208 chars
2025-11-12 00:01:41,848 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 554 chars
2025-11-12 00:01:41,848 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT MAX(exposure_amt) as max_exposure, MIN(exposure_amt) as min_exposure, AVG(exposure_amt) as avg_exposure, MAX(effective_limit) as max_limit, MIN(effective_limit) as min_limit, AVG(effective_limit) as avg_limit FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data)",
    "explanation": "Calculated max, min, and average for both exposure amount and effective limit using the most recent date. Assumed user wants overall metrics across all limits, not filtered by any sp
2025-11-12 00:01:41,848 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-12 00:01:41,849 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-12 00:01:41,849 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT MAX(exposure_amt) as max_exposure, MIN(exposure_amt) as min_exposure, AVG(exposure_amt) as avg_exposure, MAX(effective_limit) as max_limit, MIN(effective_limit) as min_limit, AVG(effective_limi...
2025-11-12 00:01:41,849 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT MAX(exposure_amt) as max_exposure, MIN(exposure_amt) as min_exposure, AVG(exposure_amt) as avg_exposure, MAX(effective_limit) as max_limit, MIN(effective_limit) as min_limit, AVG(effective_limit) as avg_limit FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data)
2025-11-12 00:01:41,849 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-12 00:01:41,850 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-12 00:01:41,850 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-12 00:01:41,854 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:01:41,855 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-12 00:01:41,855 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-12 00:01:41,855 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-12 00:01:41,859 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:01:41,859 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT MAX(exposure_amt) as max_exposure, MIN(exposure_amt) as min_exposure, AVG(exposure_amt) as avg_exposure, MAX(effective_limit) as max_limit, MIN(effective_limit) as min_limit, AVG(effective_limi...
2025-11-12 00:01:41,859 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 281 chars
2025-11-12 00:01:41,859 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT MAX(exposure_amt) as max_exposure, MIN(exposure_amt) as min_exposure, AVG(exposure_amt) as avg_exposure, MAX(effective_limit) as max_limit, MIN(effective_limit) as min_limit, AVG(effective_limit) as avg_limit FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data)
2025-11-12 00:01:41,859 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT MAX(exposure_amt) as max_exposure, MIN(exposure_amt) as min_exposure, AVG(exposure_amt) as avg_exposure, MAX(effective_limit) as max_limit, MIN(effective_limit) as min_limit, AVG(effective_limi...
2025-11-12 00:01:41,859 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT MAX(exposure_amt) as max_exposure, MIN(exposure_amt) as min_exposure, AVG(exposure_amt) as avg_exposure, MAX(effective_limit) as max_limit, MIN(effective_limit) as min_limit, AVG(effective_limi...
2025-11-12 00:01:41,859 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-12 00:01:41,860 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT MAX(exposure_amt) as max_exposure, MIN(exposure_amt) as min_exposure, AVG(exposure_amt) as avg_exposure, MAX(effective_limit) as max_limit, MIN(effective_limit) as min_limit, AVG(effective_limi...
2025-11-12 00:01:41,948 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-12 00:01:41,948 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-12 00:01:41,948 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-12 00:01:41,949 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:01:41,949 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=1, columns=6, rows=1, sql=SELECT MAX(exposure_amt) as max_exposure, MIN(exposure_amt) as min_exposure, AVG(exposure_amt) as av
2025-11-12 00:01:41,949 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-12 00:01:41,949 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-12 00:01:41,950 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT MAX(exposure_amt) as max_exposure, MIN(exposure_amt) as min_exposure, AVG(exposure_amt) as av
2025-11-12 00:01:41,950 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=1, columns=6, rows=1, query_length=281
2025-11-12 00:01:41,950 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-12 00:01:41,950 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-12 00:01:41,950 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 957 chars
2025-11-12 00:01:42,955 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:01:46,650 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:01:46,651 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 818 chars
2025-11-12 00:01:46,652 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=7, columns=41, rows=7, query=SELECT * FROM limits_data WHERE limit_id = 300121
2025-11-12 00:01:46,652 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=7, columns=41, rows=7, has_query=True
2025-11-12 00:01:46,652 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_id = 300121...
2025-11-12 00:01:46,652 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_id = 300121...
2025-11-12 00:01:46,652 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-12 00:01:46,652 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-12 00:01:46,653 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-12 00:01:46,661 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:01:46,661 - agent.streaming_agent - INFO - Agent completed for session sess-7mvtyntn: 31194.302ms, 8 steps
2025-11-12 00:01:46,661 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=7, columns=41, rows=7
2025-11-12 00:01:46,661 - agent.session_manager - INFO - [SessionManager] Unregistered session sess-7mvtyntn
2025-11-12 00:01:51,528 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1869 chars
2025-11-12 00:01:51,528 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-12 00:01:51,528 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-12 00:01:51,528 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 7778 chars
2025-11-12 00:01:57,291 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:01:57,294 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 862 chars
2025-11-12 00:01:57,294 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=1, columns=6, rows=1, query=SELECT MAX(exposure_amt) as max_exposure, MIN(exposure_amt) as min_exposure, AVG(exposure_amt) as av
2025-11-12 00:01:57,294 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=1, columns=6, rows=1, has_query=True
2025-11-12 00:01:57,295 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT MAX(exposure_amt) as max_exposure, MIN(exposure_amt) as min_exposure, AVG(exposure_amt) as av...
2025-11-12 00:01:57,295 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT MAX(exposure_amt) as max_exposure, MIN(exposure_amt) as min_exposure, AVG(exposure_amt) as av...
2025-11-12 00:01:57,295 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-12 00:01:57,296 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-12 00:01:57,296 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-12 00:01:57,306 - agent.state_manager - INFO - Saved session state for sess-7mvtyntn (user: admin)
2025-11-12 00:01:57,306 - agent.streaming_agent - INFO - Agent completed for session sess-7mvtyntn: 32600.516ms, 8 steps
2025-11-12 00:01:57,306 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=1, columns=6, rows=1
2025-11-12 00:05:31,984 - root - INFO - Client pGs_s0Rc19tolw_2AAAS joined session room: sess-2vvu1e42
2025-11-12 00:05:31,990 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:05:31] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-12 00:05:31,990 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:05:31] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-12 00:05:31,990 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:05:31] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-12 00:05:32,497 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:05:32] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-12 00:05:53,999 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:05:53] "POST /api/agent/data-analysis-agents HTTP/1.1" 200 -
2025-11-12 00:05:55,369 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:05:55] "GET /api/agent/data-analysis-agents HTTP/1.1" 200 -
2025-11-12 00:05:55,381 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:05:55] "GET /api/agent/data-analysis-agents/dummy_one HTTP/1.1" 200 -
2025-11-12 00:05:55,386 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:05:55] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-12 00:06:00,740 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:06:00] "GET /api/agent/data-analysis-agents/risk_agent HTTP/1.1" 200 -
2025-11-12 00:06:00,760 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:06:00] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-12 00:06:20,848 - agent.session_manager - INFO - [SessionManager] Registered session sess-2vvu1e42
2025-11-12 00:06:20,848 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'give me high level stats of the limits table i am the head of market risk'
2025-11-12 00:06:20,848 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-2vvu1e42
2025-11-12 00:06:20,848 - agent.state_manager - WARNING - Session sess-2vvu1e42 not found
2025-11-12 00:06:20,848 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-12 00:06:20,852 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:06:20,852 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-12 00:06:20,852 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-12 00:06:20,852 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-12 00:06:20,852 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-12 00:06:20,852 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-12 00:06:20,853 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-12 00:06:20,853 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-12 00:06:20,855 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:06:25,834 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:06:25,840 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-12 00:06:25,841 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-12 00:06:25,841 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-12 00:06:25,845 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:06:25,845 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-12 00:06:25,845 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-12 00:06:25,846 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-12 00:06:25,846 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-12 00:06:25,846 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-12 00:06:25,846 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-12 00:06:25,846 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-12 00:06:25,846 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-12 00:06:25,846 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-12 00:06:25,846 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-12 00:06:25,846 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-12 00:06:25,846 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-12 00:06:25,847 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-12 00:06:25,849 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-12 00:06:25,849 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-12 00:06:25,849 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-12 00:06:29,373 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:06:31,461 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:06:33,592 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-12 00:06:33,592 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: give me high level stats of the limits table i am the head of market risk
2025-11-12 00:06:33,592 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-12 00:06:33,592 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 34735 chars
2025-11-12 00:06:33,592 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-12 00:06:33,593 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-12 00:06:36,026 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:06:38,534 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 650 chars
2025-11-12 00:06:38,534 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT letter_nm, COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilization) AS avg_utilization, MAX(utilization) AS max_utilization FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY letter_nm ORDER BY total_exposure DESC",
  "explanation": "High-level summary of limits for the head of market risk. Provides a comprehensive overview showing total number of limits per desk, total exposure, average and maximum utilization for
2025-11-12 00:06:38,534 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-12 00:06:38,535 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-12 00:06:38,535 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT letter_nm, COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilization) AS avg_utilization, MAX(utilization) AS max_utilization FROM limits_data WHERE date = ...
2025-11-12 00:06:38,535 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT letter_nm, COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilization) AS avg_utilization, MAX(utilization) AS max_utilization FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY letter_nm ORDER BY total_exposure DESC
2025-11-12 00:06:38,535 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-12 00:06:38,536 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-12 00:06:38,536 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-12 00:06:38,540 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:06:38,540 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-12 00:06:38,541 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-12 00:06:38,541 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-12 00:06:38,543 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:06:38,543 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT letter_nm, COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilization) AS avg_utilization, MAX(utilization) AS max_utilization FROM limits_data WHERE date = ...
2025-11-12 00:06:38,543 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 283 chars
2025-11-12 00:06:38,543 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT letter_nm, COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilization) AS avg_utilization, MAX(utilization) AS max_utilization FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY letter_nm ORDER BY total_exposure DESC
2025-11-12 00:06:38,544 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT letter_nm, COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilization) AS avg_utilization, MAX(utilization) AS max_utilization FROM limits_data WHERE date = ...
2025-11-12 00:06:38,544 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT letter_nm, COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilization) AS avg_utilization, MAX(utilization) AS max_utilization FROM limits_data WHERE date = ...
2025-11-12 00:06:38,544 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-12 00:06:38,544 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT letter_nm, COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilization) AS avg_utilization, MAX(utilization) AS max_utilization FROM limits_data WHERE date = ...
2025-11-12 00:06:38,629 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-12 00:06:38,629 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-12 00:06:38,630 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-12 00:06:38,631 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:06:38,631 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=10, columns=5, rows=10, sql=SELECT letter_nm, COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG
2025-11-12 00:06:38,631 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-12 00:06:38,631 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-12 00:06:38,631 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT letter_nm, COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG
2025-11-12 00:06:38,631 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=10, columns=5, rows=10, query_length=283
2025-11-12 00:06:38,631 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-12 00:06:38,631 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-12 00:06:38,631 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 2590 chars
2025-11-12 00:06:39,356 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:06:48,149 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1755 chars
2025-11-12 00:06:48,149 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-12 00:06:48,150 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-12 00:06:48,151 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 51377 chars
2025-11-12 00:06:56,504 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:06:56,505 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1130 chars
2025-11-12 00:06:56,505 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=10, columns=5, rows=10, query=SELECT letter_nm, COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG
2025-11-12 00:06:56,505 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=10, columns=5, rows=10, has_query=True
2025-11-12 00:06:56,505 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT letter_nm, COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG...
2025-11-12 00:06:56,505 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT letter_nm, COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG...
2025-11-12 00:06:56,505 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-12 00:06:56,505 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-12 00:06:56,505 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-12 00:06:56,507 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:06:56,507 - agent.streaming_agent - INFO - Agent completed for session sess-2vvu1e42: 35654.664ms, 7 steps
2025-11-12 00:06:56,507 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=10, columns=5, rows=10
2025-11-12 00:06:56,507 - agent.session_manager - INFO - [SessionManager] Unregistered session sess-2vvu1e42
2025-11-12 00:07:38,870 - agent.session_manager - INFO - [SessionManager] Registered session sess-2vvu1e42
2025-11-12 00:07:38,872 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'i want overall stats across all limits on max date'
2025-11-12 00:07:38,872 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-2vvu1e42
2025-11-12 00:07:38,873 - agent.state_manager - INFO - Loaded session state for sess-2vvu1e42
2025-11-12 00:07:38,873 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 1 turns
2025-11-12 00:07:38,874 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 1 conversation turns
2025-11-12 00:07:38,879 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:07:38,879 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-12 00:07:38,880 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-12 00:07:38,880 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-12 00:07:38,880 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=1, conv_history(str)=4839
2025-11-12 00:07:38,881 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-12 00:07:38,881 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-12 00:07:38,881 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-12 00:07:38,884 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:07:38,884 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-12 00:07:41,358 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:07:41,359 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain all the high-level statistical information about limits, including total limits, exposure, and utilization by letter_nm (desk). Since the previous results provide comprehensive aggregated data, no additional database query is needed to analyze the existing information.
2025-11-12 00:07:41,360 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-12 00:07:41,360 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-12 00:07:41,360 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-12 00:07:41,364 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:07:45,885 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:07:45,888 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-12 00:07:45,889 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-12 00:07:45,890 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-12 00:07:45,894 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:07:45,894 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-12 00:07:45,894 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-12 00:07:45,895 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-12 00:07:45,895 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-12 00:07:45,895 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-12 00:07:45,895 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-12 00:07:45,895 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-12 00:07:45,895 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-12 00:07:45,895 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-12 00:07:45,895 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-12 00:07:45,895 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 4839 characters
2025-11-12 00:07:45,895 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-12 00:07:45,896 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-12 00:07:45,896 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-12 00:07:45,896 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-12 00:07:45,896 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-12 00:07:45,896 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-12 00:07:45,896 - tools.impl.nl_to_sql_planner - INFO -     User Query: give me high level stats of the limits table i am the head of market risk
2025-11-12 00:07:45,896 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-12 00:07:45,896 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-12 00:07:45,896 - tools.impl.nl_to_sql_planner - INFO -     SELECT letter_nm, COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilization) AS avg_utilization, MAX(utilization) AS max_utilization FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY letter_nm ORDER BY total_exposure DESC
2025-11-12 00:07:45,896 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-12 00:07:45,896 - tools.impl.nl_to_sql_planner - INFO -     Result Table (10 rows):
2025-11-12 00:07:45,896 - tools.impl.nl_to_sql_planner - INFO -     Columns: letter_nm, total_limits, total_exposure, avg_utilization, max_utilization
2025-11-12 00:07:45,896 - tools.impl.nl_to_sql_planner - INFO -     Data:
2025-11-12 00:07:45,897 - tools.impl.nl_to_sql_planner - INFO -       Row 1: letter_nm: China Fixed Income Trading | total_limit
2025-11-12 00:07:45,897 - tools.impl.nl_to_sql_planner - INFO -     ... (4239 more characters)
2025-11-12 00:07:45,897 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-12 00:07:49,550 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:07:51,903 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:07:54,423 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-12 00:07:54,423 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-12 00:07:54,423 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-12 00:07:54,423 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 4839
2025-11-12 00:07:54,423 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-12 00:07:54,424 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 2 SQL code blocks, using LAST (most recent)
2025-11-12 00:07:54,424 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-12 00:07:54,424 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT letter_nm, COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilization) AS avg_utilization, MAX(utilization) AS max_utilization 
FROM limits_data 
WHERE date = (SELECT MAX(date) FROM limits_data) 
GROUP BY letter_nm 
ORDER BY total_exposure DESC...
2025-11-12 00:07:54,424 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 287 characters
2025-11-12 00:07:54,424 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-12 00:07:54,424 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-12 00:07:54,424 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 287 characters
2025-11-12 00:07:54,424 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT letter_nm, COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilization) AS avg_utilization, MAX(utilization) AS max_utilization 
FROM limits_data 
WHERE date = (SELECT MAX(date) FROM limits_data) 
GROUP BY letter_nm 
ORDER BY total_exposure DESC
2025-11-12 00:07:54,425 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT letter_nm, COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilization) AS avg_utilization, MAX(utilization) AS max_utilization 
FROM limits_data 
WHERE date = (SELECT MAX(date) FROM limits_data) 
GROUP BY letter_nm 
ORDER BY total_exposure DESC
2025-11-12 00:07:54,425 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-12 00:07:54,427 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-12 00:07:54,427 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: i want overall stats across all limits on max date
2025-11-12 00:07:54,427 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 10873 chars
2025-11-12 00:07:54,427 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 39518 chars
2025-11-12 00:07:54,427 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-12 00:07:54,427 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-12 00:07:57,229 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:07:59,880 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 634 chars
2025-11-12 00:07:59,880 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilization) AS avg_utilization, MAX(utilization) AS max_utilization, MIN(utilization) AS min_utilization, COUNT(CASE WHEN utilization >= 1.0 THEN 1 END) AS breached_limits FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data)",
    "explanation": "Generates overall statistics across all limits for the most recent date. Calculates total number of unique limits, total exposure, aver
2025-11-12 00:07:59,880 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-12 00:07:59,881 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-12 00:07:59,881 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilization) AS avg_utilization, MAX(utilization) AS max_utilization, MIN(utilization) AS min_utilization, COU...
2025-11-12 00:07:59,881 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilization) AS avg_utilization, MAX(utilization) AS max_utilization, MIN(utilization) AS min_utilization, COUNT(CASE WHEN utilization >= 1.0 THEN 1 END) AS breached_limits FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data)
2025-11-12 00:07:59,882 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-12 00:07:59,882 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-12 00:07:59,882 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-12 00:07:59,886 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:07:59,887 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-12 00:07:59,888 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-12 00:07:59,888 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-12 00:07:59,891 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:07:59,898 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilization) AS avg_utilization, MAX(utilization) AS max_utilization, MIN(utilization) AS min_utilization, COU...
2025-11-12 00:07:59,898 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 328 chars
2025-11-12 00:07:59,898 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilization) AS avg_utilization, MAX(utilization) AS max_utilization, MIN(utilization) AS min_utilization, COUNT(CASE WHEN utilization >= 1.0 THEN 1 END) AS breached_limits FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data)
2025-11-12 00:07:59,898 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilization) AS avg_utilization, MAX(utilization) AS max_utilization, MIN(utilization) AS min_utilization, COU...
2025-11-12 00:07:59,898 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilization) AS avg_utilization, MAX(utilization) AS max_utilization, MIN(utilization) AS min_utilization, COU...
2025-11-12 00:07:59,898 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-12 00:07:59,898 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilization) AS avg_utilization, MAX(utilization) AS max_utilization, MIN(utilization) AS min_utilization, COU...
2025-11-12 00:07:59,979 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-12 00:07:59,979 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-12 00:07:59,979 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-12 00:07:59,980 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:07:59,980 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=1, columns=6, rows=1, sql=SELECT COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilizatio
2025-11-12 00:07:59,980 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-12 00:07:59,980 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-12 00:07:59,980 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilizatio
2025-11-12 00:07:59,980 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=1, columns=6, rows=1, query_length=328
2025-11-12 00:07:59,980 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-12 00:07:59,980 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-12 00:07:59,981 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 1054 chars
2025-11-12 00:08:00,608 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:08:07,929 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1685 chars
2025-11-12 00:08:07,929 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-12 00:08:07,930 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-12 00:08:07,931 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 53282 chars
2025-11-12 00:08:16,280 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:08:16,282 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1051 chars
2025-11-12 00:08:16,282 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=1, columns=6, rows=1, query=SELECT COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilizatio
2025-11-12 00:08:16,282 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=1, columns=6, rows=1, has_query=True
2025-11-12 00:08:16,282 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilizatio...
2025-11-12 00:08:16,282 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilizatio...
2025-11-12 00:08:16,283 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-12 00:08:16,283 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-12 00:08:16,283 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-12 00:08:16,291 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:08:16,291 - agent.streaming_agent - INFO - Agent completed for session sess-2vvu1e42: 37410.987ms, 8 steps
2025-11-12 00:08:16,291 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=1, columns=6, rows=1
2025-11-12 00:08:16,291 - agent.session_manager - INFO - [SessionManager] Unregistered session sess-2vvu1e42
2025-11-12 00:13:36,543 - tools.tools_registry - INFO - Tool configuration changed: parquet_agent.json
2025-11-12 00:13:36,543 - tools.tools_registry - INFO - Tool unregistered: parquet_agent
2025-11-12 00:13:36,558 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-12 00:13:36,558 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-12 00:14:16,602 - tools.tools_registry - INFO - Tool configuration changed: parquet_agent.json
2025-11-12 00:14:16,603 - tools.tools_registry - INFO - Tool unregistered: parquet_agent
2025-11-12 00:14:16,603 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-12 00:14:16,603 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-12 00:14:52,914 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-12 00:14:52,928 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-12 00:14:52,928 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-12 00:14:52,929 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-12 00:14:52,929 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-12 00:14:52,948 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-12 00:14:52,948 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-12 00:14:52,948 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-12 00:14:52,948 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-12 00:14:52,948 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-12 00:14:52,948 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-12 00:14:52,948 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-12 00:14:52,948 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-12 00:14:52,948 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-12 00:14:52,949 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-12 00:14:52,949 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-12 00:14:52,949 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-12 00:14:52,949 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-12 00:14:52,949 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-12 00:14:52,949 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-12 00:14:52,949 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-12 00:14:52,949 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-12 00:14:52,950 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-12 00:14:52,950 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-12 00:14:52,955 - DuckDbDescribeTableTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 98938) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-12 00:14:52,955 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:14:52,955 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-12 00:14:52,955 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-12 00:14:52,956 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-12 00:14:52,956 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-12 00:14:53,088 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-12 00:14:53,088 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-12 00:14:53,088 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-12 00:14:53,088 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-12 00:14:53,088 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-12 00:14:53,088 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-12 00:14:53,088 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-12 00:14:53,088 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-12 00:14:53,088 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-12 00:14:53,088 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-12 00:14:53,090 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-12 00:14:53,090 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-12 00:14:53,090 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-12 00:14:53,090 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-12 00:14:53,091 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-12 00:14:53,091 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-12 00:14:53,091 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-12 00:14:53,091 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-12 00:14:53,091 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-12 00:14:53,091 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-12 00:14:53,091 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-12 00:14:53,091 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-12 00:14:53,091 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-12 00:14:53,091 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-12 00:14:53,091 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-12 00:14:53,091 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-12 00:14:53,092 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-12 00:14:53,092 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-12 00:14:53,092 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-12 00:14:53,092 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-12 00:14:53,092 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-12 00:14:53,092 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-12 00:14:53,093 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-12 00:14:53,093 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-12 00:14:53,093 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-12 00:14:53,093 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-12 00:14:53,093 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-12 00:14:53,093 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-12 00:14:53,094 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-12 00:14:53,094 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-12 00:14:53,094 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-12 00:14:53,094 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-12 00:14:53,094 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-12 00:14:53,094 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-12 00:14:53,094 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-12 00:14:53,094 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-12 00:14:53,100 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-12 00:14:53,100 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-12 00:14:53,100 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-12 00:14:53,100 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-12 00:14:53,100 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-12 00:14:53,100 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-12 00:14:53,100 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-12 00:14:53,100 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-12 00:14:53,100 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-12 00:14:53,100 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-12 00:14:53,100 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-12 00:14:53,101 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-12 00:14:53,101 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-12 00:14:53,101 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-12 00:14:53,101 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-12 00:14:53,101 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-12 00:14:53,101 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-12 00:14:53,101 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-12 00:14:53,101 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-12 00:14:53,104 - DuckDbListFilesTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 98938) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-12 00:14:53,104 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:14:53,104 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-12 00:14:53,104 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-12 00:14:53,104 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-12 00:14:53,104 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-12 00:14:53,104 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-12 00:14:53,104 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-12 00:14:53,104 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-12 00:14:53,104 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-12 00:14:53,104 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-12 00:14:53,104 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-12 00:14:53,105 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-12 00:14:53,105 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-12 00:14:53,105 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-12 00:14:53,105 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-12 00:14:53,105 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-12 00:14:53,105 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-12 00:14:53,105 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-12 00:14:53,105 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-12 00:14:53,105 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-12 00:14:53,105 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-12 00:14:53,105 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-12 00:14:53,105 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-12 00:14:53,105 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-12 00:14:53,105 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-12 00:14:53,105 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-12 00:14:53,105 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-12 00:14:53,105 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-12 00:14:53,105 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-12 00:14:53,105 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-12 00:14:53,105 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-12 00:14:53,108 - DuckDbGetStatsTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 98938) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-12 00:14:53,108 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:14:53,108 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-12 00:14:53,108 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-12 00:14:53,108 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-12 00:14:53,108 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-12 00:14:53,108 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-12 00:14:53,108 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-12 00:14:53,108 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-12 00:14:53,108 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-12 00:14:53,108 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-12 00:14:53,108 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-12 00:14:53,114 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-12 00:14:53,114 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-12 00:14:53,114 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-12 00:14:53,114 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-12 00:14:53,114 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-12 00:14:53,114 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-12 00:14:53,114 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-12 00:14:53,114 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-12 00:14:53,114 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-12 00:14:53,114 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-12 00:14:53,114 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-12 00:14:53,115 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-12 00:14:53,115 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-12 00:14:53,116 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-12 00:14:53,116 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-12 00:14:53,116 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-12 00:14:53,116 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-12 00:14:53,116 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-12 00:14:53,116 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-12 00:14:53,116 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-12 00:14:53,116 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-12 00:14:53,116 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-12 00:14:53,116 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-12 00:14:53,116 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-12 00:14:53,116 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-12 00:14:53,116 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-12 00:14:53,116 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-12 00:14:53,116 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-12 00:14:53,116 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-12 00:14:53,116 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-12 00:14:53,116 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-12 00:14:53,119 - DuckDbListTablesTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 98938) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-12 00:14:53,119 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:14:53,119 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-12 00:14:53,119 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-12 00:14:53,119 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-12 00:14:53,119 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-12 00:14:53,119 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-12 00:14:53,119 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-12 00:14:53,119 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-12 00:14:53,119 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-12 00:14:53,119 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-12 00:14:53,119 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-12 00:14:53,119 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-12 00:14:53,119 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-12 00:14:53,119 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-12 00:14:53,119 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-12 00:14:53,119 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-12 00:14:53,120 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-12 00:14:53,120 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-12 00:14:53,120 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-12 00:14:53,120 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-12 00:14:53,120 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-12 00:14:53,120 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-12 00:14:53,120 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-12 00:14:53,120 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-12 00:14:53,120 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-12 00:14:53,120 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-12 00:14:53,120 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-12 00:14:53,123 - DuckDbAggregateTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 98938) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-12 00:14:53,123 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:14:53,123 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-12 00:14:53,123 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-12 00:14:53,123 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-12 00:14:53,123 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-12 00:14:53,123 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-12 00:14:53,123 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-12 00:14:53,123 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-12 00:14:53,123 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-12 00:14:53,123 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-12 00:14:53,123 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-12 00:14:53,123 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-12 00:14:53,123 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-12 00:14:53,123 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-12 00:14:53,123 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-12 00:14:53,128 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-12 00:14:53,129 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-12 00:14:53,129 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-12 00:14:53,129 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-12 00:14:53,129 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-12 00:14:53,129 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-12 00:14:53,130 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-12 00:14:53,131 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-12 00:14:53,131 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-12 00:14:53,131 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-12 00:14:53,131 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-12 00:14:53,131 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-12 00:14:53,131 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-12 00:14:53,131 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-12 00:14:53,131 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-12 00:14:53,131 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-12 00:14:53,131 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-12 00:14:53,131 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-12 00:14:53,131 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-12 00:14:53,131 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-12 00:14:53,131 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-12 00:14:53,131 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-12 00:14:53,131 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-12 00:14:53,137 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-12 00:14:53,137 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-12 00:14:53,137 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-12 00:14:53,137 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-12 00:14:53,137 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-12 00:14:53,137 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-12 00:14:53,137 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-12 00:14:53,137 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-12 00:14:53,137 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-12 00:14:53,137 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-12 00:14:53,137 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-12 00:14:53,137 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-12 00:14:53,137 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-12 00:14:53,137 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-12 00:14:53,137 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-12 00:14:53,137 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-12 00:14:53,138 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-12 00:14:53,138 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-12 00:14:53,138 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-12 00:14:53,138 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-12 00:14:53,138 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-12 00:14:53,138 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-12 00:14:53,138 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-12 00:14:53,138 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-12 00:14:53,138 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-12 00:14:53,138 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-12 00:14:53,138 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-12 00:14:53,138 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-12 00:14:53,138 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-12 00:14:53,140 - DuckDbQueryTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 98938) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-12 00:14:53,140 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:14:53,140 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-12 00:14:53,140 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-12 00:14:53,141 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-12 00:14:53,141 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-12 00:14:53,141 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-12 00:14:53,141 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-12 00:14:53,141 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-12 00:14:53,141 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-12 00:14:53,143 - DuckDbRefreshViewsTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 98938) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-12 00:14:53,143 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:14:53,143 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-12 00:14:53,143 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-12 00:14:53,143 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-12 00:14:53,143 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-12 00:14:53,143 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-12 00:14:53,143 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-12 00:14:53,148 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-12 00:14:53,149 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-12 00:14:53,149 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-12 00:14:53,149 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-12 00:14:53,149 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-12 00:14:53,149 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-12 00:14:53,149 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-12 00:14:53,149 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-12 00:14:53,149 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-12 00:14:53,149 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-12 00:14:53,149 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-12 00:14:53,149 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-12 00:14:53,149 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-12 00:14:53,149 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-12 00:14:53,149 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-12 00:14:53,149 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-12 00:14:53,149 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-12 00:14:53,149 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-12 00:14:53,149 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-12 00:14:53,149 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-12 00:14:53,158 - root - INFO - All routes registered successfully
2025-11-12 00:14:54,146 - DuckDbRefreshViewsTool - INFO - Auto-refresh stopped
2025-11-12 00:14:55,149 - DuckDbQueryTool - INFO - Auto-refresh stopped
2025-11-12 00:14:56,138 - DuckDbAggregateTool - INFO - Auto-refresh stopped
2025-11-12 00:14:57,133 - DuckDbListTablesTool - INFO - Auto-refresh stopped
2025-11-12 00:14:58,123 - DuckDbGetStatsTool - INFO - Auto-refresh stopped
2025-11-12 00:14:59,126 - DuckDbListFilesTool - INFO - Auto-refresh stopped
2025-11-12 00:14:59,984 - DuckDbDescribeTableTool - INFO - Auto-refresh stopped
2025-11-12 00:15:04,495 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-12 00:15:04,505 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-12 00:15:04,505 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-12 00:15:04,506 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-12 00:15:04,506 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-12 00:15:04,523 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-12 00:15:04,523 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-12 00:15:04,523 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-12 00:15:04,523 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-12 00:15:04,524 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-12 00:15:04,524 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-12 00:15:04,524 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-12 00:15:04,524 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-12 00:15:04,524 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-12 00:15:04,524 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-12 00:15:04,524 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-12 00:15:04,524 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-12 00:15:04,524 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-12 00:15:04,525 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-12 00:15:04,525 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-12 00:15:04,525 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-12 00:15:04,525 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-12 00:15:04,526 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-12 00:15:04,526 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-12 00:15:04,530 - DuckDbDescribeTableTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 98938) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-12 00:15:04,530 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:15:04,530 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-12 00:15:04,530 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-12 00:15:04,530 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-12 00:15:04,530 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-12 00:15:04,661 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-12 00:15:04,661 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-12 00:15:04,661 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-12 00:15:04,661 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-12 00:15:04,662 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-12 00:15:04,662 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-12 00:15:04,662 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-12 00:15:04,662 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-12 00:15:04,662 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-12 00:15:04,662 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-12 00:15:04,663 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-12 00:15:04,663 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-12 00:15:04,663 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-12 00:15:04,663 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-12 00:15:04,664 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-12 00:15:04,664 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-12 00:15:04,664 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-12 00:15:04,664 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-12 00:15:04,664 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-12 00:15:04,664 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-12 00:15:04,664 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-12 00:15:04,664 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-12 00:15:04,664 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-12 00:15:04,664 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-12 00:15:04,665 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-12 00:15:04,665 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-12 00:15:04,665 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-12 00:15:04,665 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-12 00:15:04,665 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-12 00:15:04,665 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-12 00:15:04,665 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-12 00:15:04,665 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-12 00:15:04,666 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-12 00:15:04,666 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-12 00:15:04,666 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-12 00:15:04,666 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-12 00:15:04,666 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-12 00:15:04,666 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-12 00:15:04,667 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-12 00:15:04,667 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-12 00:15:04,667 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-12 00:15:04,667 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-12 00:15:04,667 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-12 00:15:04,667 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-12 00:15:04,667 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-12 00:15:04,667 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-12 00:15:04,673 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-12 00:15:04,673 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-12 00:15:04,673 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-12 00:15:04,673 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-12 00:15:04,673 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-12 00:15:04,673 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-12 00:15:04,673 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-12 00:15:04,673 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-12 00:15:04,673 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-12 00:15:04,673 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-12 00:15:04,673 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-12 00:15:04,674 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-12 00:15:04,674 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-12 00:15:04,674 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-12 00:15:04,674 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-12 00:15:04,674 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-12 00:15:04,674 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-12 00:15:04,674 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-12 00:15:04,674 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-12 00:15:04,677 - DuckDbListFilesTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 98938) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-12 00:15:04,677 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:15:04,677 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-12 00:15:04,677 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-12 00:15:04,677 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-12 00:15:04,677 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-12 00:15:04,677 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-12 00:15:04,677 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-12 00:15:04,677 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-12 00:15:04,677 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-12 00:15:04,677 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-12 00:15:04,677 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-12 00:15:04,677 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-12 00:15:04,677 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-12 00:15:04,677 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-12 00:15:04,677 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-12 00:15:04,677 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-12 00:15:04,677 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-12 00:15:04,678 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-12 00:15:04,678 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-12 00:15:04,678 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-12 00:15:04,678 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-12 00:15:04,678 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-12 00:15:04,678 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-12 00:15:04,678 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-12 00:15:04,678 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-12 00:15:04,678 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-12 00:15:04,678 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-12 00:15:04,678 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-12 00:15:04,678 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-12 00:15:04,678 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-12 00:15:04,678 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-12 00:15:04,681 - DuckDbGetStatsTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 98938) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-12 00:15:04,681 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:15:04,681 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-12 00:15:04,681 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-12 00:15:04,681 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-12 00:15:04,681 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-12 00:15:04,681 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-12 00:15:04,681 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-12 00:15:04,681 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-12 00:15:04,681 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-12 00:15:04,681 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-12 00:15:04,681 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-12 00:15:04,687 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-12 00:15:04,687 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-12 00:15:04,687 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-12 00:15:04,687 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-12 00:15:04,687 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-12 00:15:04,687 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-12 00:15:04,687 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-12 00:15:04,687 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-12 00:15:04,687 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-12 00:15:04,687 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-12 00:15:04,687 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-12 00:15:04,688 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-12 00:15:04,688 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-12 00:15:04,688 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-12 00:15:04,688 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-12 00:15:04,688 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-12 00:15:04,688 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-12 00:15:04,689 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-12 00:15:04,689 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-12 00:15:04,689 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-12 00:15:04,689 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-12 00:15:04,689 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-12 00:15:04,689 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-12 00:15:04,689 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-12 00:15:04,689 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-12 00:15:04,689 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-12 00:15:04,689 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-12 00:15:04,689 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-12 00:15:04,689 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-12 00:15:04,689 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-12 00:15:04,689 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-12 00:15:04,692 - DuckDbListTablesTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 98938) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-12 00:15:04,692 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:15:04,692 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-12 00:15:04,692 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-12 00:15:04,692 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-12 00:15:04,692 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-12 00:15:04,692 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-12 00:15:04,692 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-12 00:15:04,692 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-12 00:15:04,692 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-12 00:15:04,692 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-12 00:15:04,692 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-12 00:15:04,692 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-12 00:15:04,692 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-12 00:15:04,692 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-12 00:15:04,692 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-12 00:15:04,692 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-12 00:15:04,692 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-12 00:15:04,692 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-12 00:15:04,692 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-12 00:15:04,692 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-12 00:15:04,692 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-12 00:15:04,692 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-12 00:15:04,692 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-12 00:15:04,693 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-12 00:15:04,693 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-12 00:15:04,693 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-12 00:15:04,693 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-12 00:15:04,695 - DuckDbAggregateTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 98938) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-12 00:15:04,695 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:15:04,695 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-12 00:15:04,695 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-12 00:15:04,695 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-12 00:15:04,696 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-12 00:15:04,696 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-12 00:15:04,696 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-12 00:15:04,696 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-12 00:15:04,696 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-12 00:15:04,696 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-12 00:15:04,696 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-12 00:15:04,696 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-12 00:15:04,696 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-12 00:15:04,696 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-12 00:15:04,696 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-12 00:15:04,701 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-12 00:15:04,701 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-12 00:15:04,701 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-12 00:15:04,701 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-12 00:15:04,701 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-12 00:15:04,701 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-12 00:15:04,701 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-12 00:15:04,702 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-12 00:15:04,702 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-12 00:15:04,702 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-12 00:15:04,702 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-12 00:15:04,702 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-12 00:15:04,702 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-12 00:15:04,702 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-12 00:15:04,702 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-12 00:15:04,702 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-12 00:15:04,702 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-12 00:15:04,702 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-12 00:15:04,702 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-12 00:15:04,702 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-12 00:15:04,702 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-12 00:15:04,702 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-12 00:15:04,702 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-12 00:15:04,702 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-12 00:15:04,702 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-12 00:15:04,702 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-12 00:15:04,702 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-12 00:15:04,702 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-12 00:15:04,702 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-12 00:15:04,702 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-12 00:15:04,702 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-12 00:15:04,702 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-12 00:15:04,703 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-12 00:15:04,704 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-12 00:15:04,704 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-12 00:15:04,704 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-12 00:15:04,704 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-12 00:15:04,704 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-12 00:15:04,704 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-12 00:15:04,704 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-12 00:15:04,704 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-12 00:15:04,704 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-12 00:15:04,704 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-12 00:15:04,704 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-12 00:15:04,704 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-12 00:15:04,704 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-12 00:15:04,704 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-12 00:15:04,704 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-12 00:15:04,704 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-12 00:15:04,704 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-12 00:15:04,710 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-12 00:15:04,710 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-12 00:15:04,710 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-12 00:15:04,710 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-12 00:15:04,710 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-12 00:15:04,710 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-12 00:15:04,710 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-12 00:15:04,711 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-12 00:15:04,711 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-12 00:15:04,711 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-12 00:15:04,711 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-12 00:15:04,711 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-12 00:15:04,711 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-12 00:15:04,711 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-12 00:15:04,711 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-12 00:15:04,711 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-12 00:15:04,711 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-12 00:15:04,711 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-12 00:15:04,711 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-12 00:15:04,711 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-12 00:15:04,711 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-12 00:15:04,711 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-12 00:15:04,711 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-12 00:15:04,711 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-12 00:15:04,711 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-12 00:15:04,711 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-12 00:15:04,711 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-12 00:15:04,712 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-12 00:15:04,712 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-12 00:15:04,714 - DuckDbQueryTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 98938) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-12 00:15:04,714 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:15:04,714 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-12 00:15:04,714 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-12 00:15:04,714 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-12 00:15:04,714 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-12 00:15:04,714 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-12 00:15:04,714 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-12 00:15:04,715 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-12 00:15:04,715 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-12 00:15:04,717 - DuckDbRefreshViewsTool - ERROR - Failed to initialize views from files: IO Error: Could not set lock on file "/Users/saadahmed/queryagent/sajhamcpserver/data/duckdb/duckdb_analytics.db": Conflicting lock is held in /opt/homebrew/Cellar/python@3.13/3.13.5/Frameworks/Python.framework/Versions/3.13/Resources/Python.app/Contents/MacOS/Python (PID 98938) by user saadahmed. See also https://duckdb.org/docs/stable/connect/concurrency
2025-11-12 00:15:04,717 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:15:04,717 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-12 00:15:04,717 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-12 00:15:04,717 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-12 00:15:04,717 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-12 00:15:04,717 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-12 00:15:04,717 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-12 00:15:04,723 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-12 00:15:04,723 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-12 00:15:04,723 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-12 00:15:04,723 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-12 00:15:04,723 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-12 00:15:04,723 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-12 00:15:04,723 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-12 00:15:04,723 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-12 00:15:04,723 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-12 00:15:04,723 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-12 00:15:04,723 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-12 00:15:04,723 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-12 00:15:04,723 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-12 00:15:04,723 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-12 00:15:04,723 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-12 00:15:04,723 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-12 00:15:04,723 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-12 00:15:04,723 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-12 00:15:04,723 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-12 00:15:04,724 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-12 00:15:04,733 - root - INFO - All routes registered successfully
2025-11-12 00:15:05,725 - DuckDbRefreshViewsTool - INFO - Auto-refresh stopped
2025-11-12 00:15:06,726 - DuckDbQueryTool - INFO - Auto-refresh stopped
2025-11-12 00:15:07,709 - DuckDbAggregateTool - INFO - Auto-refresh stopped
2025-11-12 00:15:07,710 - DuckDbListTablesTool - INFO - Auto-refresh stopped
2025-11-12 00:15:08,702 - DuckDbGetStatsTool - INFO - Auto-refresh stopped
2025-11-12 00:16:36,242 - root - INFO - WebSocket client disconnected: pGs_s0Rc19tolw_2AAAS
2025-11-12 00:16:36,243 - root - INFO - WebSocket client disconnected: IZTq8mByC_DbPqQ9AAAT
2025-11-12 00:16:36,243 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:16:36] "GET /socket.io/?EIO=4&transport=websocket&sid=Jbtc1IJ0DilFsITVAAAQ HTTP/1.1" 200 -
2025-11-12 00:16:36,247 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:16:36] "GET /agent/chat?v=9&t=1762922761541&_=0.6378042132444182&nocache=1762922761541 HTTP/1.1" 200 -
2025-11-12 00:16:36,254 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:16:36] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-12 00:16:36,256 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-12 00:16:36,274 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:16:36] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-12 00:16:36,274 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:16:36] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-12 00:16:36,330 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:16:36] "GET /socket.io/?EIO=4&transport=polling&t=PfsVene HTTP/1.1" 200 -
2025-11-12 00:16:36,334 - root - INFO - WebSocket client connected: gX2hBHZNJyOVisKcAAAV
2025-11-12 00:16:36,336 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:16:36] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-12 00:16:36,336 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:16:36] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-12 00:16:36,337 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:16:36] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-12 00:16:36,337 - root - INFO - WebSocket client connected: O1Bj6-G81rZ4VDA8AAAX
2025-11-12 00:16:36,338 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:16:36] "POST /socket.io/?EIO=4&transport=polling&t=PfsVenh&sid=l9_oPWOU8LW-e12TAAAU HTTP/1.1" 200 -
2025-11-12 00:16:36,338 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:16:36] "GET /socket.io/?EIO=4&transport=polling&t=PfsVeni&sid=l9_oPWOU8LW-e12TAAAU HTTP/1.1" 200 -
2025-11-12 00:16:36,340 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:16:36] "GET /api/agent/data-analysis-agents HTTP/1.1" 200 -
2025-11-12 00:16:36,342 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:16:36] "POST /socket.io/?EIO=4&transport=polling&t=PfsVenr&sid=l9_oPWOU8LW-e12TAAAU HTTP/1.1" 200 -
2025-11-12 00:16:36,342 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:16:36] "GET /socket.io/?EIO=4&transport=polling&t=PfsVenq&sid=l9_oPWOU8LW-e12TAAAU HTTP/1.1" 200 -
2025-11-12 00:16:36,343 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:16:36] "GET /api/agent/data-analysis-agents/risk_agent HTTP/1.1" 200 -
2025-11-12 00:16:36,344 - root - INFO - Client gX2hBHZNJyOVisKcAAAV joined session room: sess-2vvu1e42
2025-11-12 00:16:36,344 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:16:36] "POST /socket.io/?EIO=4&transport=polling&t=PfsVent.0&sid=l9_oPWOU8LW-e12TAAAU HTTP/1.1" 200 -
2025-11-12 00:16:36,345 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:16:36] "GET /socket.io/?EIO=4&transport=polling&t=PfsVent&sid=l9_oPWOU8LW-e12TAAAU HTTP/1.1" 200 -
2025-11-12 00:16:36,345 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:16:36] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-12 00:16:36,355 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:16:36] "GET /socket.io/?EIO=4&transport=polling&t=PfsVenv&sid=l9_oPWOU8LW-e12TAAAU HTTP/1.1" 200 -
2025-11-12 00:16:42,730 - agent.session_manager - INFO - [SessionManager] Registered session sess-2vvu1e42
2025-11-12 00:16:42,730 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'top primary limits'
2025-11-12 00:16:42,730 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-2vvu1e42
2025-11-12 00:16:42,732 - agent.state_manager - INFO - Loaded session state for sess-2vvu1e42
2025-11-12 00:16:42,732 - agent.streaming_agent - INFO - [ConversationHistory] Built history with 2 turns
2025-11-12 00:16:42,732 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 2 conversation turns
2025-11-12 00:16:42,737 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:16:42,738 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-12 00:16:42,738 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-12 00:16:42,738 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-12 00:16:42,739 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=True, conv_history(list)=0, conv_history_raw(list)=2, conv_history(str)=8340
2025-11-12 00:16:42,739 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-12 00:16:42,739 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-12 00:16:42,739 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-12 00:16:42,743 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:16:42,743 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] Analyzing query: 
2025-11-12 00:16:45,553 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:16:45,556 - agent.graph_nodes - INFO - [CHECK_DATA_SUFFICIENCY] more_data_needed=False, reasoning=The previous query results already contain comprehensive overall statistics about the limits, including total limits, total exposure, utilization metrics, and breached limits. Since the previous query already provided aggregate statistics across all limits, no additional database query is needed to answer any follow-up questions about the overall limit statistics.
2025-11-12 00:16:45,556 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_data_sufficiency: data keys = ['is_followup', 'more_data_needed', 'node_output', 'node_reasoning']
2025-11-12 00:16:45,556 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_data_sufficiency with 4 data keys
2025-11-12 00:16:45,557 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_data_sufficiency
2025-11-12 00:16:45,560 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:16:48,831 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:16:48,833 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-12 00:16:48,833 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-12 00:16:48,833 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-12 00:16:48,842 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:16:48,843 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=True, more_data_needed=False, passing to planner
2025-11-12 00:16:48,844 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-12 00:16:48,844 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-12 00:16:48,844 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-12 00:16:48,844 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-12 00:16:48,844 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: True
2025-11-12 00:16:48,844 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-12 00:16:48,844 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üî¥ FILTER-ONLY (preserve previous query filters)
2025-11-12 00:16:48,844 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-12 00:16:48,844 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-12 00:16:48,844 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 8340 characters
2025-11-12 00:16:48,844 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: True
2025-11-12 00:16:48,844 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: True
2025-11-12 00:16:48,845 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-12 00:16:48,845 - tools.impl.nl_to_sql_planner - INFO -     Previous Conversation:
2025-11-12 00:16:48,845 - tools.impl.nl_to_sql_planner - INFO -     
2025-11-12 00:16:48,845 - tools.impl.nl_to_sql_planner - INFO -     Turn 1:
2025-11-12 00:16:48,845 - tools.impl.nl_to_sql_planner - INFO -     User Query: give me high level stats of the limits table i am the head of market risk
2025-11-12 00:16:48,845 - tools.impl.nl_to_sql_planner - INFO -     SQL Executed:
2025-11-12 00:16:48,845 - tools.impl.nl_to_sql_planner - INFO -     ```sql
2025-11-12 00:16:48,845 - tools.impl.nl_to_sql_planner - INFO -     SELECT letter_nm, COUNT(DISTINCT limit_id) AS total_limits, SUM(exposure_amt) AS total_exposure, AVG(utilization) AS avg_utilization, MAX(utilization) AS max_utilization FROM limits_data WHERE date = (SELECT MAX(date) FROM limits_data) GROUP BY letter_nm ORDER BY total_exposure DESC
2025-11-12 00:16:48,846 - tools.impl.nl_to_sql_planner - INFO -     ```
2025-11-12 00:16:48,846 - tools.impl.nl_to_sql_planner - INFO -     Result Table (10 rows):
2025-11-12 00:16:48,846 - tools.impl.nl_to_sql_planner - INFO -     Columns: letter_nm, total_limits, total_exposure, avg_utilization, max_utilization
2025-11-12 00:16:48,846 - tools.impl.nl_to_sql_planner - INFO -     Data:
2025-11-12 00:16:48,846 - tools.impl.nl_to_sql_planner - INFO -       Row 1: letter_nm: China Fixed Income Trading | total_limit
2025-11-12 00:16:48,846 - tools.impl.nl_to_sql_planner - INFO -     ... (7740 more characters)
2025-11-12 00:16:48,846 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-12 00:16:52,527 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:16:54,972 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:16:57,142 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-12 00:16:57,143 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç EXTRACTING PREVIOUS SQL (FILTER-ONLY MODE)
2025-11-12 00:16:57,143 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-12 00:16:57,143 - tools.impl.nl_to_sql_planner - INFO - ‚úì Conversation history is string, length: 8340
2025-11-12 00:16:57,143 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found '```sql' marker in conversation history
2025-11-12 00:16:57,143 - tools.impl.nl_to_sql_planner - INFO - ‚úì Found 4 SQL code blocks, using LAST (most recent)
2025-11-12 00:16:57,143 - tools.impl.nl_to_sql_planner - INFO - ‚úì SUCCESSFULLY extracted SQL using code block regex
2025-11-12 00:16:57,143 - tools.impl.nl_to_sql_planner - INFO -   Extracted SQL (first 300 chars): SELECT COUNT(DISTINCT limit_id) AS total_limits, 
       SUM(exposure_amt) AS total_exposure, 
       AVG(utilization) AS avg_utilization, 
       MAX(utilization) AS max_utilization, 
       MIN(utilization) AS min_utilization, 
       COUNT(CASE WHEN utilization >= 1.0 THEN 1 END) AS breached_limi...
2025-11-12 00:16:57,144 - tools.impl.nl_to_sql_planner - INFO -   Full SQL length: 370 characters
2025-11-12 00:16:57,144 - tools.impl.nl_to_sql_planner - INFO - 
‚úÖ EXTRACTION SUCCESSFUL!
2025-11-12 00:16:57,144 - tools.impl.nl_to_sql_planner - INFO -    Method: CODE_BLOCK_WITH_MARKERS_LAST
2025-11-12 00:16:57,144 - tools.impl.nl_to_sql_planner - INFO -    SQL Length: 370 characters
2025-11-12 00:16:57,144 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (first 500 chars): SELECT COUNT(DISTINCT limit_id) AS total_limits, 
       SUM(exposure_amt) AS total_exposure, 
       AVG(utilization) AS avg_utilization, 
       MAX(utilization) AS max_utilization, 
       MIN(utilization) AS min_utilization, 
       COUNT(CASE WHEN utilization >= 1.0 THEN 1 END) AS breached_limits 
FROM limits_data 
WHERE date = (SELECT MAX(date) FROM limits_data)
2025-11-12 00:16:57,144 - tools.impl.nl_to_sql_planner - INFO -    Full SQL (complete): SELECT COUNT(DISTINCT limit_id) AS total_limits, 
       SUM(exposure_amt) AS total_exposure, 
       AVG(utilization) AS avg_utilization, 
       MAX(utilization) AS max_utilization, 
       MIN(utilization) AS min_utilization, 
       COUNT(CASE WHEN utilization >= 1.0 THEN 1 END) AS breached_limits 
FROM limits_data 
WHERE date = (SELECT MAX(date) FROM limits_data)
2025-11-12 00:16:57,144 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-12 00:16:57,146 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-12 00:16:57,146 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: top primary limits
2025-11-12 00:16:57,146 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 11039 chars
2025-11-12 00:16:57,147 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 42987 chars
2025-11-12 00:16:57,147 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-12 00:16:57,147 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-12 00:17:00,400 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:17:02,492 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 433 chars
2025-11-12 00:17:02,492 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
    "explanation": "Retrieved top primary limits for the latest date, sorted by utilization in descending order. Assumed 'primary' means id2 LIKE '%PRIMARY%', used latest date filter, and sorted by utilization to show most utilized primary limits first.",
    "target_table": "limits_data"
}
2025-11-12 00:17:02,492 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-12 00:17:02,492 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-12 00:17:02,493 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-12 00:17:02,493 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-12 00:17:02,493 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-12 00:17:02,494 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-12 00:17:02,494 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-12 00:17:02,499 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:17:02,499 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-12 00:17:02,500 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-12 00:17:02,500 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-12 00:17:02,503 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:17:02,503 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-12 00:17:02,503 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 125 chars
2025-11-12 00:17:02,503 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-12 00:17:02,503 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-12 00:17:02,504 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-12 00:17:02,504 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-12 00:17:02,504 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-12 00:17:02,585 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-12 00:17:02,585 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-12 00:17:02,585 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-12 00:17:02,587 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:17:02,587 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=6, columns=41, rows=6, sql=SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' AND date = (SELECT MAX(date) FROM limits_data) 
2025-11-12 00:17:02,587 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-12 00:17:02,587 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-12 00:17:02,587 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' AND date = (SELECT MAX(date) FROM limits_data) 
2025-11-12 00:17:02,587 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=6, columns=41, rows=6, query_length=125
2025-11-12 00:17:02,587 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-12 00:17:02,587 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-12 00:17:02,588 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 8530 chars
2025-11-12 00:17:03,779 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:17:13,851 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1585 chars
2025-11-12 00:17:13,851 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-12 00:17:13,851 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-12 00:17:13,852 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 55569 chars
2025-11-12 00:17:22,826 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:17:22,827 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1123 chars
2025-11-12 00:17:22,827 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=6, columns=41, rows=6, query=SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' AND date = (SELECT MAX(date) FROM limits_data) 
2025-11-12 00:17:22,827 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=6, columns=41, rows=6, has_query=True
2025-11-12 00:17:22,827 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' AND date = (SELECT MAX(date) FROM limits_data) ...
2025-11-12 00:17:22,827 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE id2 LIKE '%PRIMARY%' AND date = (SELECT MAX(date) FROM limits_data) ...
2025-11-12 00:17:22,827 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-12 00:17:22,827 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-12 00:17:22,828 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-12 00:17:22,835 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:17:22,835 - agent.streaming_agent - INFO - Agent completed for session sess-2vvu1e42: 40096.68ms, 8 steps
2025-11-12 00:17:22,835 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=6, columns=41, rows=6
2025-11-12 00:17:22,835 - agent.session_manager - INFO - [SessionManager] Unregistered session sess-2vvu1e42
2025-11-12 00:20:43,150 - root - INFO - WebSocket client disconnected: O1Bj6-G81rZ4VDA8AAAX
2025-11-12 00:20:43,151 - root - INFO - WebSocket client disconnected: gX2hBHZNJyOVisKcAAAV
2025-11-12 00:20:43,153 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:20:43] "GET /socket.io/?EIO=4&transport=websocket&sid=l9_oPWOU8LW-e12TAAAU HTTP/1.1" 200 -
2025-11-12 00:20:43,155 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:20:43] "GET /agent/chat?v=9&t=1762922761541&_=0.6378042132444182&nocache=1762922761541 HTTP/1.1" 200 -
2025-11-12 00:20:43,159 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:20:43] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-12 00:20:43,160 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-12 00:20:43,174 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:20:43] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-12 00:20:43,174 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:20:43] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-12 00:20:43,201 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:20:43] "GET /socket.io/?EIO=4&transport=polling&t=PfsWb2_ HTTP/1.1" 200 -
2025-11-12 00:20:43,203 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:20:43] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-12 00:20:43,204 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:20:43] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-12 00:20:43,204 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:20:43] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-12 00:20:43,205 - root - INFO - WebSocket client connected: KauIxQX_yuNeEgdjAAAa
2025-11-12 00:20:43,207 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:20:43] "GET /api/agent/data-analysis-agents HTTP/1.1" 200 -
2025-11-12 00:20:43,207 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:20:43] "POST /socket.io/?EIO=4&transport=polling&t=PfsWb33&sid=xZgxoUYs97snL9XNAAAY HTTP/1.1" 200 -
2025-11-12 00:20:43,207 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:20:43] "GET /socket.io/?EIO=4&transport=polling&t=PfsWb33.0&sid=xZgxoUYs97snL9XNAAAY HTTP/1.1" 200 -
2025-11-12 00:20:43,208 - root - INFO - WebSocket client connected: EnxCBVdG8ArX9173AAAb
2025-11-12 00:20:43,210 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:20:43] "POST /socket.io/?EIO=4&transport=polling&t=PfsWb39&sid=xZgxoUYs97snL9XNAAAY HTTP/1.1" 200 -
2025-11-12 00:20:43,210 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:20:43] "GET /socket.io/?EIO=4&transport=polling&t=PfsWb38&sid=xZgxoUYs97snL9XNAAAY HTTP/1.1" 200 -
2025-11-12 00:20:43,211 - root - INFO - Client KauIxQX_yuNeEgdjAAAa joined session room: sess-2vvu1e42
2025-11-12 00:20:43,211 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:20:43] "POST /socket.io/?EIO=4&transport=polling&t=PfsWb3A.0&sid=xZgxoUYs97snL9XNAAAY HTTP/1.1" 200 -
2025-11-12 00:20:43,211 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:20:43] "GET /socket.io/?EIO=4&transport=polling&t=PfsWb3A&sid=xZgxoUYs97snL9XNAAAY HTTP/1.1" 200 -
2025-11-12 00:20:43,218 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:20:43] "GET /socket.io/?EIO=4&transport=polling&t=PfsWb3C&sid=xZgxoUYs97snL9XNAAAY HTTP/1.1" 200 -
2025-11-12 00:20:43,409 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:20:43] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-12 00:20:54,764 - agent.session_manager - INFO - [SessionManager] Registered session sess-2vvu1e42
2025-11-12 00:20:54,764 - agent.streaming_agent - INFO - [StreamingAgent] Query: 'limit with highest limit value'
2025-11-12 00:20:54,764 - agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-2vvu1e42
2025-11-12 00:20:54,765 - agent.state_manager - WARNING - Session sess-2vvu1e42 not found
2025-11-12 00:20:54,765 - agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-12 00:20:54,771 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:20:54,771 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-12 00:20:54,772 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-12 00:20:54,772 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-12 00:20:54,772 - agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-12 00:20:54,773 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-12 00:20:54,773 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-12 00:20:54,773 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-12 00:20:54,774 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:20:58,074 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:20:58,076 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-12 00:20:58,076 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-12 00:20:58,076 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-12 00:20:58,078 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:20:58,078 - agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-12 00:20:58,078 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-12 00:20:58,078 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-12 00:20:58,078 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-12 00:20:58,078 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-12 00:20:58,079 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-12 00:20:58,079 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-12 00:20:58,079 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-12 00:20:58,079 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-12 00:20:58,079 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-12 00:20:58,079 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-12 00:20:58,079 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-12 00:20:58,079 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-12 00:20:58,079 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-12 00:20:58,079 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-12 00:20:58,079 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-12 00:20:59,622 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:21:00,073 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:21:01,913 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-12 00:21:01,913 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: limit with highest limit value
2025-11-12 00:21:01,913 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 29 chars
2025-11-12 00:21:01,913 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 288 chars
2025-11-12 00:21:01,913 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-12 00:21:01,913 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-12 00:21:02,282 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:21:02,722 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 73 chars
2025-11-12 00:21:02,722 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
    "sql": "SELECT * FROM limits_data ORDER BY limit_id DESC LIMIT 1"
}
2025-11-12 00:21:02,723 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-12 00:21:02,723 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql']
2025-11-12 00:21:02,723 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data ORDER BY limit_id DESC LIMIT 1...
2025-11-12 00:21:02,723 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data ORDER BY limit_id DESC LIMIT 1
2025-11-12 00:21:02,723 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-12 00:21:02,723 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-12 00:21:02,723 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-12 00:21:02,724 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:21:02,724 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-12 00:21:02,724 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-12 00:21:02,724 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-12 00:21:02,724 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:21:02,724 - agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data ORDER BY limit_id DESC LIMIT 1...
2025-11-12 00:21:02,725 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 56 chars
2025-11-12 00:21:02,725 - agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data ORDER BY limit_id DESC LIMIT 1
2025-11-12 00:21:02,725 - agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data ORDER BY limit_id DESC LIMIT 1...
2025-11-12 00:21:02,725 - agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data ORDER BY limit_id DESC LIMIT 1...
2025-11-12 00:21:02,725 - agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-12 00:21:02,725 - agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data ORDER BY limit_id DESC LIMIT 1...
2025-11-12 00:21:02,769 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-12 00:21:02,769 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-12 00:21:02,769 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-12 00:21:02,770 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:21:02,770 - agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=1, columns=41, rows=1, sql=SELECT * FROM limits_data ORDER BY limit_id DESC LIMIT 1
2025-11-12 00:21:02,770 - agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-12 00:21:02,770 - agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-12 00:21:02,770 - agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data ORDER BY limit_id DESC LIMIT 1
2025-11-12 00:21:02,770 - agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=1, columns=41, rows=1, query_length=56
2025-11-12 00:21:02,770 - agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-12 00:21:02,770 - agent.graph_nodes - INFO - [END_NODE] Config prompt length: 0
2025-11-12 00:21:02,770 - agent.graph_nodes - INFO - [END_NODE] Using default system prompt (config was empty)
2025-11-12 00:21:02,770 - agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 5975 chars
2025-11-12 00:21:03,503 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:21:11,193 - agent.graph_nodes - INFO - [END_NODE] LLM response received: 1248 chars
2025-11-12 00:21:11,193 - agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-12 00:21:11,193 - agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 0
2025-11-12 00:21:11,193 - agent.graph_nodes - INFO - [END_NODE] Using default prompt_monitor system prompt (config was empty)
2025-11-12 00:21:11,193 - agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 5111 chars
2025-11-12 00:21:19,967 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:21:19,968 - agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1452 chars
2025-11-12 00:21:19,968 - agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=1, columns=41, rows=1, query=SELECT * FROM limits_data ORDER BY limit_id DESC LIMIT 1
2025-11-12 00:21:19,968 - agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=1, columns=41, rows=1, has_query=True
2025-11-12 00:21:19,968 - agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data ORDER BY limit_id DESC LIMIT 1...
2025-11-12 00:21:19,968 - agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data ORDER BY limit_id DESC LIMIT 1...
2025-11-12 00:21:19,968 - agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-12 00:21:19,968 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-12 00:21:19,968 - agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-12 00:21:19,972 - agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:21:19,972 - agent.streaming_agent - INFO - Agent completed for session sess-2vvu1e42: 25200.172ms, 7 steps
2025-11-12 00:21:19,972 - agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=1, columns=41, rows=1
2025-11-12 00:21:19,973 - agent.session_manager - INFO - [SessionManager] Unregistered session sess-2vvu1e42
2025-11-12 00:24:51,704 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-12 00:24:51,721 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-12 00:24:51,721 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-12 00:24:51,724 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-12 00:24:51,725 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-12 00:24:51,749 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-12 00:24:51,749 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-12 00:24:51,749 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-12 00:24:51,749 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-12 00:24:51,749 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-12 00:24:51,749 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-12 00:24:51,749 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-12 00:24:51,753 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-12 00:24:51,753 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-12 00:24:51,758 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-12 00:24:51,758 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-12 00:24:51,758 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-12 00:24:51,758 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-12 00:24:51,760 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-12 00:24:51,761 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-12 00:24:51,765 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-12 00:24:51,765 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-12 00:24:51,774 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-12 00:24:51,774 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-12 00:24:52,080 - DuckDbDescribeTableTool - INFO - Found 1 data files in data/duckdb
2025-11-12 00:24:52,118 - DuckDbDescribeTableTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-12 00:24:52,125 - DuckDbDescribeTableTool - INFO - Initialization complete: 4 views available
2025-11-12 00:24:52,125 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:24:52,125 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-12 00:24:52,125 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-12 00:24:52,129 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-12 00:24:52,129 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-12 00:24:52,357 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-12 00:24:52,357 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-12 00:24:52,360 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-12 00:24:52,360 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-12 00:24:52,364 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-12 00:24:52,364 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-12 00:24:52,364 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-12 00:24:52,364 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-12 00:24:52,364 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-12 00:24:52,364 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-12 00:24:52,371 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-12 00:24:52,371 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-12 00:24:52,371 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-12 00:24:52,371 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-12 00:24:52,376 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-12 00:24:52,376 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-12 00:24:52,377 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-12 00:24:52,377 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-12 00:24:52,382 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-12 00:24:52,382 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-12 00:24:52,382 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-12 00:24:52,382 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-12 00:24:52,385 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-12 00:24:52,385 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-12 00:24:52,388 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-12 00:24:52,388 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-12 00:24:52,392 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-12 00:24:52,392 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-12 00:24:52,392 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-12 00:24:52,392 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-12 00:24:52,395 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-12 00:24:52,395 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-12 00:24:52,399 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-12 00:24:52,399 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-12 00:24:52,399 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-12 00:24:52,399 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-12 00:24:52,399 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-12 00:24:52,399 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-12 00:24:52,410 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-12 00:24:52,410 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-12 00:24:52,410 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-12 00:24:52,410 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-12 00:24:52,411 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-12 00:24:52,411 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-12 00:24:52,411 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-12 00:24:52,411 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-12 00:24:52,418 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-12 00:24:52,418 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-12 00:24:52,418 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-12 00:24:52,418 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-12 00:24:52,418 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-12 00:24:52,418 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-12 00:24:52,418 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-12 00:24:52,418 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-12 00:24:52,418 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-12 00:24:52,419 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-12 00:24:52,419 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-12 00:24:52,421 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-12 00:24:52,421 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-12 00:24:52,422 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-12 00:24:52,422 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-12 00:24:52,422 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-12 00:24:52,422 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-12 00:24:52,422 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-12 00:24:52,422 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-12 00:24:52,423 - DuckDbListFilesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-12 00:24:52,459 - DuckDbListFilesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-12 00:24:52,461 - DuckDbListFilesTool - INFO - Initialization complete: 4 views available
2025-11-12 00:24:52,461 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:24:52,461 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-12 00:24:52,461 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-12 00:24:52,461 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-12 00:24:52,461 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-12 00:24:52,461 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-12 00:24:52,461 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-12 00:24:52,462 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-12 00:24:52,462 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-12 00:24:52,462 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-12 00:24:52,462 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-12 00:24:52,462 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-12 00:24:52,462 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-12 00:24:52,462 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-12 00:24:52,463 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-12 00:24:52,463 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-12 00:24:52,463 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-12 00:24:52,463 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-12 00:24:52,463 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-12 00:24:52,463 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-12 00:24:52,463 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-12 00:24:52,463 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-12 00:24:52,463 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-12 00:24:52,463 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-12 00:24:52,463 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-12 00:24:52,463 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-12 00:24:52,463 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-12 00:24:52,464 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-12 00:24:52,464 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-12 00:24:52,464 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-12 00:24:52,464 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-12 00:24:52,464 - DuckDbGetStatsTool - INFO - Found 1 data files in data/duckdb
2025-11-12 00:24:52,500 - DuckDbGetStatsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-12 00:24:52,502 - DuckDbGetStatsTool - INFO - Initialization complete: 4 views available
2025-11-12 00:24:52,502 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:24:52,502 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-12 00:24:52,502 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-12 00:24:52,502 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-12 00:24:52,502 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-12 00:24:52,503 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-12 00:24:52,503 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-12 00:24:52,503 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-12 00:24:52,503 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-12 00:24:52,503 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-12 00:24:52,503 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-12 00:24:52,509 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-12 00:24:52,509 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-12 00:24:52,509 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-12 00:24:52,509 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-12 00:24:52,509 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-12 00:24:52,509 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-12 00:24:52,509 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-12 00:24:52,509 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-12 00:24:52,509 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-12 00:24:52,510 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-12 00:24:52,510 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-12 00:24:52,512 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-12 00:24:52,512 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-12 00:24:52,512 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-12 00:24:52,513 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-12 00:24:52,513 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-12 00:24:52,513 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-12 00:24:52,513 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-12 00:24:52,513 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-12 00:24:52,513 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-12 00:24:52,513 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-12 00:24:52,513 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-12 00:24:52,513 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-12 00:24:52,513 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-12 00:24:52,513 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-12 00:24:52,514 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-12 00:24:52,514 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-12 00:24:52,514 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-12 00:24:52,514 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-12 00:24:52,515 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-12 00:24:52,515 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-12 00:24:52,515 - DuckDbListTablesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-12 00:24:52,550 - DuckDbListTablesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-12 00:24:52,552 - DuckDbListTablesTool - INFO - Initialization complete: 4 views available
2025-11-12 00:24:52,552 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:24:52,552 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-12 00:24:52,552 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-12 00:24:52,552 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-12 00:24:52,552 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-12 00:24:52,552 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-12 00:24:52,552 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-12 00:24:52,553 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-12 00:24:52,553 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-12 00:24:52,553 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-12 00:24:52,553 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-12 00:24:52,553 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-12 00:24:52,553 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-12 00:24:52,553 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-12 00:24:52,553 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-12 00:24:52,553 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-12 00:24:52,553 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-12 00:24:52,553 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-12 00:24:52,553 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-12 00:24:52,554 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-12 00:24:52,554 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-12 00:24:52,554 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-12 00:24:52,554 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-12 00:24:52,554 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-12 00:24:52,554 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-12 00:24:52,554 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-12 00:24:52,554 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-12 00:24:52,555 - DuckDbAggregateTool - INFO - Found 1 data files in data/duckdb
2025-11-12 00:24:52,591 - DuckDbAggregateTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-12 00:24:52,592 - DuckDbAggregateTool - INFO - Initialization complete: 4 views available
2025-11-12 00:24:52,592 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:24:52,592 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-12 00:24:52,592 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-12 00:24:52,593 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-12 00:24:52,593 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-12 00:24:52,593 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-12 00:24:52,593 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-12 00:24:52,593 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-12 00:24:52,593 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-12 00:24:52,593 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-12 00:24:52,593 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-12 00:24:52,593 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-12 00:24:52,593 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-12 00:24:52,593 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-12 00:24:52,593 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-12 00:24:52,599 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-12 00:24:52,599 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-12 00:24:52,599 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-12 00:24:52,599 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-12 00:24:52,599 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-12 00:24:52,599 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-12 00:24:52,599 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-12 00:24:52,600 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-12 00:24:52,600 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-12 00:24:52,600 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-12 00:24:52,600 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-12 00:24:52,600 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-12 00:24:52,600 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-12 00:24:52,600 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-12 00:24:52,600 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-12 00:24:52,600 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-12 00:24:52,600 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-12 00:24:52,601 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-12 00:24:52,601 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-12 00:24:52,601 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-12 00:24:52,601 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-12 00:24:52,601 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-12 00:24:52,601 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-12 00:24:52,601 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-12 00:24:52,601 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-12 00:24:52,601 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-12 00:24:52,601 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-12 00:24:52,601 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-12 00:24:52,601 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-12 00:24:52,602 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-12 00:24:52,602 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-12 00:24:52,602 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-12 00:24:52,602 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-12 00:24:52,602 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-12 00:24:52,602 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-12 00:24:52,602 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-12 00:24:52,602 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-12 00:24:52,603 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-12 00:24:52,603 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-12 00:24:52,603 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-12 00:24:52,603 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-12 00:24:52,603 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-12 00:24:52,603 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-12 00:24:52,603 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-12 00:24:52,604 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-12 00:24:52,604 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-12 00:24:52,604 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-12 00:24:52,604 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-12 00:24:52,604 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-12 00:24:52,604 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-12 00:24:52,604 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-12 00:24:52,604 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-12 00:24:52,604 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-12 00:24:52,604 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-12 00:24:52,604 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-12 00:24:52,605 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-12 00:24:52,605 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-12 00:24:52,605 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-12 00:24:52,605 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-12 00:24:52,605 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-12 00:24:52,605 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-12 00:24:52,605 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-12 00:24:52,605 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-12 00:24:52,608 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-12 00:24:52,608 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-12 00:24:52,608 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-12 00:24:52,608 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-12 00:24:52,608 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-12 00:24:52,608 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-12 00:24:52,608 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-12 00:24:52,608 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-12 00:24:52,608 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-12 00:24:52,608 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-12 00:24:52,608 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-12 00:24:52,608 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-12 00:24:52,614 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-12 00:24:52,614 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-12 00:24:52,614 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-12 00:24:52,614 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-12 00:24:52,614 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-12 00:24:52,614 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-12 00:24:52,614 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-12 00:24:52,615 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-12 00:24:52,615 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-12 00:24:52,615 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-12 00:24:52,615 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-12 00:24:52,615 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-12 00:24:52,615 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-12 00:24:52,615 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-12 00:24:52,615 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-12 00:24:52,615 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-12 00:24:52,616 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-12 00:24:52,616 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-12 00:24:52,616 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-12 00:24:52,616 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-12 00:24:52,616 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-12 00:24:52,616 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-12 00:24:52,616 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-12 00:24:52,616 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-12 00:24:52,616 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-12 00:24:52,616 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-12 00:24:52,616 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-12 00:24:52,616 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-12 00:24:52,616 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-12 00:24:52,617 - DuckDbQueryTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-12 00:24:52,652 - DuckDbQueryTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-12 00:24:52,654 - DuckDbQueryTool - INFO - Initialization complete: 4 views available
2025-11-12 00:24:52,654 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:24:52,654 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-12 00:24:52,654 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-12 00:24:52,654 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-12 00:24:52,654 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-12 00:24:52,654 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-12 00:24:52,654 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-12 00:24:52,654 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-12 00:24:52,654 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-12 00:24:52,655 - DuckDbRefreshViewsTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-12 00:24:52,690 - DuckDbRefreshViewsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-12 00:24:52,692 - DuckDbRefreshViewsTool - INFO - Initialization complete: 4 views available
2025-11-12 00:24:52,692 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:24:52,692 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-12 00:24:52,692 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-12 00:24:52,692 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-12 00:24:52,692 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-12 00:24:52,692 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-12 00:24:52,693 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-12 00:24:52,698 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-12 00:24:52,698 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-12 00:24:52,698 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-12 00:24:52,698 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-12 00:24:52,698 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-12 00:24:52,698 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-12 00:24:52,698 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-12 00:24:52,699 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-12 00:24:52,699 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-12 00:24:52,699 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-12 00:24:52,699 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-12 00:24:52,699 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-12 00:24:52,699 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-12 00:24:52,699 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-12 00:24:52,699 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-12 00:24:52,700 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-12 00:24:52,700 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-12 00:24:52,700 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-12 00:24:52,700 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-12 00:24:52,700 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-12 00:24:52,709 - root - INFO - All routes registered successfully
2025-11-12 00:24:52,713 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.68.51:8000
2025-11-12 00:24:52,713 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-11-12 00:24:53,244 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:24:53] "GET /socket.io/?EIO=4&transport=polling&t=PfsXY5v HTTP/1.1" 200 -
2025-11-12 00:24:53,250 - root - INFO - WebSocket client connected: uuVPw1I6iuCNR-UjAAAB
2025-11-12 00:24:53,251 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:24:53] "POST /socket.io/?EIO=4&transport=polling&t=PfsXY5-&sid=GAiUv7rXKdP9eTQeAAAA HTTP/1.1" 200 -
2025-11-12 00:24:53,251 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:24:53] "GET /socket.io/?EIO=4&transport=polling&t=PfsXY5_&sid=GAiUv7rXKdP9eTQeAAAA HTTP/1.1" 200 -
2025-11-12 00:24:53,257 - root - INFO - WebSocket client disconnected: uuVPw1I6iuCNR-UjAAAB
2025-11-12 00:24:53,257 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:24:53] "POST /socket.io/?EIO=4&transport=polling&t=PfsXY67.0&sid=GAiUv7rXKdP9eTQeAAAA HTTP/1.1" 200 -
2025-11-12 00:24:53,257 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:24:53] "GET /socket.io/?EIO=4&transport=polling&t=PfsXY67&sid=GAiUv7rXKdP9eTQeAAAA HTTP/1.1" 200 -
2025-11-12 00:24:53,259 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:24:53] "GET /socket.io/?EIO=4&transport=websocket&sid=GAiUv7rXKdP9eTQeAAAA HTTP/1.1" 200 -
2025-11-12 00:24:55,247 - root - INFO - WebSocket client connected: wfsrZsLgtOHht_isAAAD
2025-11-12 00:24:55,249 - root - INFO - WebSocket client disconnected: wfsrZsLgtOHht_isAAAD
2025-11-12 00:24:55,262 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:24:55] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-12 00:24:55,265 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-12 00:25:29,800 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:29] "[32mGET /agent/chat?v=9&t=1762922761541&_=0.6378042132444182&nocache=1762922761541 HTTP/1.1[0m" 302 -
2025-11-12 00:25:29,819 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:29] "GET /login?next=http://localhost:8000/agent/chat?v%3D9%26t%3D1762922761541%26_%3D0.6378042132444182%26nocache%3D1762922761541 HTTP/1.1" 200 -
2025-11-12 00:25:29,843 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:29] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-12 00:25:29,843 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:29] "GET /static/js/main.js HTTP/1.1" 200 -
2025-11-12 00:25:29,898 - root - INFO - WebSocket client connected: Pn44Qq0EmxIi8d2gAAAF
2025-11-12 00:25:29,900 - root - INFO - WebSocket client disconnected: Pn44Qq0EmxIi8d2gAAAF
2025-11-12 00:25:29,912 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:29] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-12 00:25:29,913 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-12 00:25:34,115 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-12 00:25:34,115 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-12 00:25:34,118 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:34] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-12 00:25:34,144 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:34] "GET /dashboard HTTP/1.1" 200 -
2025-11-12 00:25:34,155 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:34] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-12 00:25:34,155 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:34] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-12 00:25:34,220 - root - INFO - WebSocket client connected: jZnXIfapWDy3j4dnAAAH
2025-11-12 00:25:34,221 - root - INFO - WebSocket client disconnected: jZnXIfapWDy3j4dnAAAH
2025-11-12 00:25:34,233 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:34] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-12 00:25:34,234 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-12 00:25:37,904 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:37] "GET /agent/chat HTTP/1.1" 200 -
2025-11-12 00:25:37,910 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:37] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-12 00:25:37,930 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:37] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-12 00:25:37,970 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:37] "GET /socket.io/?EIO=4&transport=polling&t=PfsXj0n HTTP/1.1" 200 -
2025-11-12 00:25:37,971 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:37] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-12 00:25:37,971 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:37] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-12 00:25:37,972 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:37] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-12 00:25:37,973 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:37] "GET /api/agent/data-analysis-agents HTTP/1.1" 200 -
2025-11-12 00:25:37,991 - root - INFO - WebSocket client connected: z9plW57TlSGv8Jk9AAAJ
2025-11-12 00:25:37,991 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:37] "POST /socket.io/?EIO=4&transport=polling&t=PfsXj16&sid=LIO2XOtgM8qJPa63AAAI HTTP/1.1" 200 -
2025-11-12 00:25:37,991 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:37] "GET /socket.io/?EIO=4&transport=polling&t=PfsXj16.0&sid=LIO2XOtgM8qJPa63AAAI HTTP/1.1" 200 -
2025-11-12 00:25:38,007 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:38] "POST /socket.io/?EIO=4&transport=polling&t=PfsXj1M&sid=LIO2XOtgM8qJPa63AAAI HTTP/1.1" 200 -
2025-11-12 00:25:38,007 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:38] "GET /socket.io/?EIO=4&transport=polling&t=PfsXj1L&sid=LIO2XOtgM8qJPa63AAAI HTTP/1.1" 200 -
2025-11-12 00:25:38,011 - root - INFO - Client z9plW57TlSGv8Jk9AAAJ joined session room: sess-2vvu1e42
2025-11-12 00:25:38,012 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:38] "POST /socket.io/?EIO=4&transport=polling&t=PfsXj1P.0&sid=LIO2XOtgM8qJPa63AAAI HTTP/1.1" 200 -
2025-11-12 00:25:38,012 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:38] "GET /socket.io/?EIO=4&transport=polling&t=PfsXj1P&sid=LIO2XOtgM8qJPa63AAAI HTTP/1.1" 200 -
2025-11-12 00:25:38,245 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:38] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-12 00:25:38,506 - root - INFO - WebSocket client connected: WdZ1JrabPiy4Mw4qAAAL
2025-11-12 00:25:38,517 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:38] "GET /socket.io/?EIO=4&transport=polling&t=PfsXj1T&sid=LIO2XOtgM8qJPa63AAAI HTTP/1.1" 200 -
2025-11-12 00:25:50,944 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:50] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-12 00:25:50,955 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:25:50] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-12 00:27:12,236 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:27:12] "[32mGET /api/agent/config-files?type=data_dict HTTP/1.1[0m" 302 -
2025-11-12 00:29:49,587 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:29:49] "[32mGET /api/agent/config-files?type=data_dict HTTP/1.1[0m" 302 -
2025-11-12 00:30:48,584 - __main__ - INFO - Starting SAJHA MCP Server on 0.0.0.0:8000
2025-11-12 00:30:48,603 - core.auth_manager - INFO - Loaded 1 users from configuration
2025-11-12 00:30:48,603 - tools.tools_registry - INFO - Loading tools from config/tools
2025-11-12 00:30:48,604 - tools.tools_registry - INFO - Tool registered: yahoo_get_history
2025-11-12 00:30:48,605 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_history
2025-11-12 00:30:48,628 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-12 00:30:48,628 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-12 00:30:48,628 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-12 00:30:48,629 - SqlSelectSampleDataTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-12 00:30:48,629 - SqlSelectSampleDataTool - INFO - DuckDB connection initialized for sqlselect_sample_data
2025-11-12 00:30:48,629 - tools.tools_registry - INFO - Tool registered: sqlselect_sample_data
2025-11-12 00:30:48,629 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_sample_data
2025-11-12 00:30:48,629 - tools.tools_registry - INFO - Tool registered: boc_search_series
2025-11-12 00:30:48,629 - tools.tools_registry - INFO - Loaded custom tool: boc_search_series
2025-11-12 00:30:48,630 - tools.tools_registry - INFO - Tool registered: ecb_get_inflation
2025-11-12 00:30:48,630 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_inflation
2025-11-12 00:30:48,630 - tools.tools_registry - INFO - Tool registered: ecb_get_interest_rate
2025-11-12 00:30:48,630 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_interest_rate
2025-11-12 00:30:48,630 - tools.tools_registry - INFO - Tool registered: bdf_get_french_indicator
2025-11-12 00:30:48,630 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_french_indicator
2025-11-12 00:30:48,631 - tools.tools_registry - INFO - Tool registered: un_get_sdg_targets
2025-11-12 00:30:48,631 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_targets
2025-11-12 00:30:48,631 - tools.tools_registry - INFO - Tool registered: edgar_ownership_reports
2025-11-12 00:30:48,632 - tools.tools_registry - INFO - Loaded custom tool: edgar_ownership_reports
2025-11-12 00:30:48,932 - DuckDbDescribeTableTool - INFO - Found 1 data files in data/duckdb
2025-11-12 00:30:48,971 - DuckDbDescribeTableTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-12 00:30:48,979 - DuckDbDescribeTableTool - INFO - Initialization complete: 4 views available
2025-11-12 00:30:48,979 - DuckDbDescribeTableTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:30:48,979 - tools.tools_registry - INFO - Tool registered: duckdb_describe_table
2025-11-12 00:30:48,979 - tools.tools_registry - INFO - Loaded custom tool: duckdb_describe_table
2025-11-12 00:30:48,980 - tools.tools_registry - INFO - Tool registered: imf_get_weo_data
2025-11-12 00:30:48,980 - tools.tools_registry - INFO - Loaded custom tool: imf_get_weo_data
2025-11-12 00:30:49,193 - tools.tools_registry - INFO - Tool registered: query_result_evaluator
2025-11-12 00:30:49,193 - tools.tools_registry - INFO - Loaded custom tool: query_result_evaluator
2025-11-12 00:30:49,193 - tools.tools_registry - INFO - Tool registered: rbi_get_forex_reserves
2025-11-12 00:30:49,194 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_forex_reserves
2025-11-12 00:30:49,194 - tools.tools_registry - INFO - Tool registered: msdoc_get_word_metadata
2025-11-12 00:30:49,194 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_word_metadata
2025-11-12 00:30:49,195 - tools.tools_registry - INFO - Tool registered: imf_compare_countries
2025-11-12 00:30:49,195 - tools.tools_registry - INFO - Loaded custom tool: imf_compare_countries
2025-11-12 00:30:49,195 - tools.tools_registry - INFO - Tool registered: bdf_get_exchange_rate
2025-11-12 00:30:49,195 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_exchange_rate
2025-11-12 00:30:49,198 - tools.tools_registry - INFO - Tool registered: crawl_sitemap
2025-11-12 00:30:49,198 - tools.tools_registry - INFO - Loaded custom tool: crawl_sitemap
2025-11-12 00:30:49,198 - tools.tools_registry - INFO - Tool registered: crawl_url
2025-11-12 00:30:49,199 - tools.tools_registry - INFO - Loaded custom tool: crawl_url
2025-11-12 00:30:49,199 - tools.tools_registry - INFO - Tool registered: wb_search_indicators
2025-11-12 00:30:49,199 - tools.tools_registry - INFO - Loaded custom tool: wb_search_indicators
2025-11-12 00:30:49,200 - tools.tools_registry - INFO - Tool registered: wb_get_indicator_data
2025-11-12 00:30:49,200 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicator_data
2025-11-12 00:30:49,201 - tools.tools_registry - INFO - Tool registered: tavily_domain_search
2025-11-12 00:30:49,201 - tools.tools_registry - INFO - Loaded custom tool: tavily_domain_search
2025-11-12 00:30:49,201 - tools.tools_registry - INFO - Tool registered: ecb_search_series
2025-11-12 00:30:49,201 - tools.tools_registry - INFO - Loaded custom tool: ecb_search_series
2025-11-12 00:30:49,202 - tools.tools_registry - INFO - Tool registered: boj_get_policy_rate
2025-11-12 00:30:49,202 - tools.tools_registry - INFO - Loaded custom tool: boj_get_policy_rate
2025-11-12 00:30:49,202 - tools.tools_registry - INFO - Tool registered: fed_get_series
2025-11-12 00:30:49,202 - tools.tools_registry - INFO - Loaded custom tool: fed_get_series
2025-11-12 00:30:49,203 - tools.tools_registry - INFO - Tool registered: sec_search_company
2025-11-12 00:30:49,203 - tools.tools_registry - INFO - Loaded custom tool: sec_search_company
2025-11-12 00:30:49,203 - tools.tools_registry - INFO - Tool registered: edgar_filings_by_form
2025-11-12 00:30:49,203 - tools.tools_registry - INFO - Loaded custom tool: edgar_filings_by_form
2025-11-12 00:30:49,203 - tools.tools_registry - INFO - Tool registered: pboc_get_exchange_rate
2025-11-12 00:30:49,203 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_exchange_rate
2025-11-12 00:30:49,204 - tools.tools_registry - INFO - Tool registered: fbi_get_offense_data
2025-11-12 00:30:49,204 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_offense_data
2025-11-12 00:30:49,205 - tools.tools_registry - INFO - Tool registered: edgar_registration_statements
2025-11-12 00:30:49,205 - tools.tools_registry - INFO - Loaded custom tool: edgar_registration_statements
2025-11-12 00:30:49,205 - tools.tools_registry - INFO - Tool registered: ecb_get_common_indicators
2025-11-12 00:30:49,205 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_common_indicators
2025-11-12 00:30:49,208 - tools.tools_registry - INFO - Tool registered: ir_get_annual_reports
2025-11-12 00:30:49,208 - tools.tools_registry - INFO - Loaded custom tool: ir_get_annual_reports
2025-11-12 00:30:49,208 - tools.tools_registry - INFO - Tool registered: un_get_sdgs
2025-11-12 00:30:49,208 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdgs
2025-11-12 00:30:49,208 - tools.tools_registry - INFO - Tool registered: fbi_get_state_statistics
2025-11-12 00:30:49,208 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_state_statistics
2025-11-12 00:30:49,209 - tools.tools_registry - INFO - Tool registered: edgar_company_search
2025-11-12 00:30:49,209 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_search
2025-11-12 00:30:49,216 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-12 00:30:49,216 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-12 00:30:49,216 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-12 00:30:49,216 - SqlSelectGetSchemaTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-12 00:30:49,216 - SqlSelectGetSchemaTool - INFO - DuckDB connection initialized for sqlselect_get_schema
2025-11-12 00:30:49,216 - tools.tools_registry - INFO - Tool registered: sqlselect_get_schema
2025-11-12 00:30:49,216 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_get_schema
2025-11-12 00:30:49,216 - tools.tools_registry - INFO - Tool registered: edgar_foreign_issuers
2025-11-12 00:30:49,216 - tools.tools_registry - INFO - Loaded custom tool: edgar_foreign_issuers
2025-11-12 00:30:49,216 - tools.tools_registry - INFO - Tool registered: boj_get_price_index
2025-11-12 00:30:49,216 - tools.tools_registry - INFO - Loaded custom tool: boj_get_price_index
2025-11-12 00:30:49,217 - tools.tools_registry - INFO - Tool registered: wiki_search
2025-11-12 00:30:49,217 - tools.tools_registry - INFO - Loaded custom tool: wiki_search
2025-11-12 00:30:49,217 - tools.tools_registry - INFO - Tool registered: msdoc_read_word
2025-11-12 00:30:49,217 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_word
2025-11-12 00:30:49,217 - tools.tools_registry - INFO - Tool registered: query_safety_validator
2025-11-12 00:30:49,218 - tools.tools_registry - INFO - Loaded custom tool: query_safety_validator
2025-11-12 00:30:49,218 - tools.tools_registry - INFO - Tool registered: boj_get_jgb_yield
2025-11-12 00:30:49,218 - tools.tools_registry - INFO - Loaded custom tool: boj_get_jgb_yield
2025-11-12 00:30:49,218 - DuckDbListFilesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-12 00:30:49,257 - DuckDbListFilesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-12 00:30:49,258 - DuckDbListFilesTool - INFO - Initialization complete: 4 views available
2025-11-12 00:30:49,258 - DuckDbListFilesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:30:49,258 - tools.tools_registry - INFO - Tool registered: duckdb_list_files
2025-11-12 00:30:49,258 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_files
2025-11-12 00:30:49,259 - tools.tools_registry - INFO - Tool registered: imf_get_data
2025-11-12 00:30:49,259 - tools.tools_registry - INFO - Loaded custom tool: imf_get_data
2025-11-12 00:30:49,259 - tools.tools_registry - INFO - Tool registered: un_get_sdg_data
2025-11-12 00:30:49,259 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_data
2025-11-12 00:30:49,259 - tools.tools_registry - INFO - Tool registered: boc_get_exchange_rate
2025-11-12 00:30:49,259 - tools.tools_registry - INFO - Loaded custom tool: boc_get_exchange_rate
2025-11-12 00:30:49,259 - tools.tools_registry - INFO - Tool registered: boc_get_bond_yield
2025-11-12 00:30:49,259 - tools.tools_registry - INFO - Loaded custom tool: boc_get_bond_yield
2025-11-12 00:30:49,260 - tools.tools_registry - INFO - Tool registered: ecb_get_bond_yield
2025-11-12 00:30:49,260 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_bond_yield
2025-11-12 00:30:49,260 - tools.tools_registry - INFO - Tool registered: wb_get_country_data
2025-11-12 00:30:49,260 - tools.tools_registry - INFO - Loaded custom tool: wb_get_country_data
2025-11-12 00:30:49,260 - tools.tools_registry - INFO - Tool registered: edgar_filing_details
2025-11-12 00:30:49,261 - tools.tools_registry - INFO - Loaded custom tool: edgar_filing_details
2025-11-12 00:30:49,261 - tools.tools_registry - INFO - Tool registered: imf_get_bop_data
2025-11-12 00:30:49,261 - tools.tools_registry - INFO - Loaded custom tool: imf_get_bop_data
2025-11-12 00:30:49,261 - tools.tools_registry - INFO - Tool registered: fbi_search_agencies
2025-11-12 00:30:49,261 - tools.tools_registry - INFO - Loaded custom tool: fbi_search_agencies
2025-11-12 00:30:49,261 - tools.tools_registry - INFO - Tool registered: msdoc_list_files
2025-11-12 00:30:49,261 - tools.tools_registry - INFO - Loaded custom tool: msdoc_list_files
2025-11-12 00:30:49,261 - tools.tools_registry - INFO - Tool registered: msdoc_extract_text
2025-11-12 00:30:49,261 - tools.tools_registry - INFO - Loaded custom tool: msdoc_extract_text
2025-11-12 00:30:49,262 - tools.tools_registry - INFO - Tool registered: edgar_current_reports
2025-11-12 00:30:49,262 - tools.tools_registry - INFO - Loaded custom tool: edgar_current_reports
2025-11-12 00:30:49,262 - tools.tools_registry - INFO - Tool registered: fbi_compare_states
2025-11-12 00:30:49,262 - tools.tools_registry - INFO - Loaded custom tool: fbi_compare_states
2025-11-12 00:30:49,262 - tools.tools_registry - INFO - Tool registered: yahoo_get_quote
2025-11-12 00:30:49,262 - tools.tools_registry - INFO - Loaded custom tool: yahoo_get_quote
2025-11-12 00:30:49,262 - DuckDbGetStatsTool - INFO - Found 1 data files in data/duckdb
2025-11-12 00:30:49,300 - DuckDbGetStatsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-12 00:30:49,302 - DuckDbGetStatsTool - INFO - Initialization complete: 4 views available
2025-11-12 00:30:49,302 - DuckDbGetStatsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:30:49,302 - tools.tools_registry - INFO - Tool registered: duckdb_get_stats
2025-11-12 00:30:49,302 - tools.tools_registry - INFO - Loaded custom tool: duckdb_get_stats
2025-11-12 00:30:49,302 - tools.tools_registry - INFO - Tool registered: boj_get_exchange_rate
2025-11-12 00:30:49,302 - tools.tools_registry - INFO - Loaded custom tool: boj_get_exchange_rate
2025-11-12 00:30:49,303 - tools.tools_registry - INFO - Tool registered: sec_get_company_info
2025-11-12 00:30:49,303 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_info
2025-11-12 00:30:49,303 - tools.tools_registry - INFO - Tool registered: boc_get_common_indicators
2025-11-12 00:30:49,303 - tools.tools_registry - INFO - Loaded custom tool: boc_get_common_indicators
2025-11-12 00:30:49,303 - tools.tools_registry - INFO - Tool registered: boc_get_series
2025-11-12 00:30:49,303 - tools.tools_registry - INFO - Loaded custom tool: boc_get_series
2025-11-12 00:30:49,309 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-12 00:30:49,309 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-12 00:30:49,309 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-12 00:30:49,309 - SqlSelectExecuteQueryTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-12 00:30:49,309 - SqlSelectExecuteQueryTool - INFO - DuckDB connection initialized for sqlselect_execute_query
2025-11-12 00:30:49,310 - tools.tools_registry - INFO - Tool registered: sqlselect_execute_query
2025-11-12 00:30:49,310 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_execute_query
2025-11-12 00:30:49,310 - tools.tools_registry - INFO - Tool registered: ecb_get_latest
2025-11-12 00:30:49,310 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_latest
2025-11-12 00:30:49,310 - tools.tools_registry - INFO - Tool registered: tavily_news_search
2025-11-12 00:30:49,310 - tools.tools_registry - INFO - Loaded custom tool: tavily_news_search
2025-11-12 00:30:49,313 - tools.tools_registry - INFO - Tool registered: parquet_agent
2025-11-12 00:30:49,313 - tools.tools_registry - INFO - Loaded custom tool: parquet_agent
2025-11-12 00:30:49,314 - tools.tools_registry - INFO - Tool registered: fbi_get_crime_trend
2025-11-12 00:30:49,314 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_crime_trend
2025-11-12 00:30:49,314 - tools.tools_registry - INFO - Tool registered: imf_get_databases
2025-11-12 00:30:49,314 - tools.tools_registry - INFO - Loaded custom tool: imf_get_databases
2025-11-12 00:30:49,314 - tools.tools_registry - INFO - Tool registered: edgar_frame_data
2025-11-12 00:30:49,314 - tools.tools_registry - INFO - Loaded custom tool: edgar_frame_data
2025-11-12 00:30:49,314 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel_sheet
2025-11-12 00:30:49,314 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel_sheet
2025-11-12 00:30:49,315 - tools.tools_registry - INFO - Tool registered: msdoc_read_excel
2025-11-12 00:30:49,315 - tools.tools_registry - INFO - Loaded custom tool: msdoc_read_excel
2025-11-12 00:30:49,315 - tools.tools_registry - INFO - Tool registered: check_robots_txt
2025-11-12 00:30:49,315 - tools.tools_registry - INFO - Loaded custom tool: check_robots_txt
2025-11-12 00:30:49,315 - tools.tools_registry - INFO - Tool registered: bdf_get_oat_yield
2025-11-12 00:30:49,315 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_oat_yield
2025-11-12 00:30:49,315 - tools.tools_registry - INFO - Tool registered: un_compare_trade
2025-11-12 00:30:49,315 - tools.tools_registry - INFO - Loaded custom tool: un_compare_trade
2025-11-12 00:30:49,316 - tools.tools_registry - INFO - Tool registered: imf_get_country_profile
2025-11-12 00:30:49,316 - tools.tools_registry - INFO - Loaded custom tool: imf_get_country_profile
2025-11-12 00:30:49,316 - DuckDbListTablesTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-12 00:30:49,355 - DuckDbListTablesTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-12 00:30:49,356 - DuckDbListTablesTool - INFO - Initialization complete: 4 views available
2025-11-12 00:30:49,357 - DuckDbListTablesTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:30:49,357 - tools.tools_registry - INFO - Tool registered: duckdb_list_tables
2025-11-12 00:30:49,357 - tools.tools_registry - INFO - Loaded custom tool: duckdb_list_tables
2025-11-12 00:30:49,357 - tools.tools_registry - INFO - Tool registered: fed_search_series
2025-11-12 00:30:49,357 - tools.tools_registry - INFO - Loaded custom tool: fed_search_series
2025-11-12 00:30:49,357 - tools.tools_registry - INFO - Tool registered: pboc_get_cgb_yield
2025-11-12 00:30:49,357 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_cgb_yield
2025-11-12 00:30:49,358 - tools.tools_registry - INFO - Tool registered: edgar_institutional_holdings
2025-11-12 00:30:49,358 - tools.tools_registry - INFO - Loaded custom tool: edgar_institutional_holdings
2025-11-12 00:30:49,358 - tools.tools_registry - INFO - Tool registered: tavily_research_search
2025-11-12 00:30:49,358 - tools.tools_registry - INFO - Loaded custom tool: tavily_research_search
2025-11-12 00:30:49,359 - tools.tools_registry - INFO - Tool registered: un_get_trade_data
2025-11-12 00:30:49,359 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_data
2025-11-12 00:30:49,359 - tools.tools_registry - INFO - Tool registered: rbi_get_policy_rate
2025-11-12 00:30:49,359 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_policy_rate
2025-11-12 00:30:49,359 - tools.tools_registry - INFO - Tool registered: imf_get_dataflows
2025-11-12 00:30:49,359 - tools.tools_registry - INFO - Loaded custom tool: imf_get_dataflows
2025-11-12 00:30:49,359 - tools.tools_registry - INFO - Tool registered: edgar_companies_by_sic
2025-11-12 00:30:49,359 - tools.tools_registry - INFO - Loaded custom tool: edgar_companies_by_sic
2025-11-12 00:30:49,359 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_sheets
2025-11-12 00:30:49,359 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_sheets
2025-11-12 00:30:49,360 - tools.tools_registry - INFO - Tool registered: edgar_amendments
2025-11-12 00:30:49,360 - tools.tools_registry - INFO - Loaded custom tool: edgar_amendments
2025-11-12 00:30:49,360 - tools.tools_registry - INFO - Tool registered: bdf_get_eurozone_indicator
2025-11-12 00:30:49,360 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_eurozone_indicator
2025-11-12 00:30:49,360 - tools.tools_registry - INFO - Tool registered: edgar_company_submissions
2025-11-12 00:30:49,360 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_submissions
2025-11-12 00:30:49,361 - DuckDbAggregateTool - INFO - Found 1 data files in data/duckdb
2025-11-12 00:30:49,397 - DuckDbAggregateTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-12 00:30:49,398 - DuckDbAggregateTool - INFO - Initialization complete: 4 views available
2025-11-12 00:30:49,398 - DuckDbAggregateTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:30:49,398 - tools.tools_registry - INFO - Tool registered: duckdb_aggregate
2025-11-12 00:30:49,398 - tools.tools_registry - INFO - Loaded custom tool: duckdb_aggregate
2025-11-12 00:30:49,399 - tools.tools_registry - INFO - Tool registered: sec_get_insider_trading
2025-11-12 00:30:49,399 - tools.tools_registry - INFO - Loaded custom tool: sec_get_insider_trading
2025-11-12 00:30:49,399 - tools.tools_registry - INFO - Tool registered: sec_get_financial_data
2025-11-12 00:30:49,399 - tools.tools_registry - INFO - Loaded custom tool: sec_get_financial_data
2025-11-12 00:30:49,399 - tools.tools_registry - INFO - Tool registered: ir_find_page
2025-11-12 00:30:49,399 - tools.tools_registry - INFO - Loaded custom tool: ir_find_page
2025-11-12 00:30:49,399 - tools.tools_registry - INFO - Tool registered: wb_get_income_levels
2025-11-12 00:30:49,399 - tools.tools_registry - INFO - Loaded custom tool: wb_get_income_levels
2025-11-12 00:30:49,400 - tools.tools_registry - INFO - Tool registered: get_page_info
2025-11-12 00:30:49,400 - tools.tools_registry - INFO - Loaded custom tool: get_page_info
2025-11-12 00:30:49,400 - tools.tools_registry - INFO - Tool registered: bdf_get_ecb_policy_rate
2025-11-12 00:30:49,400 - tools.tools_registry - INFO - Loaded custom tool: bdf_get_ecb_policy_rate
2025-11-12 00:30:49,406 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-12 00:30:49,406 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-12 00:30:49,406 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-12 00:30:49,406 - SqlSelectDescribeSourceTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-12 00:30:49,406 - SqlSelectDescribeSourceTool - INFO - DuckDB connection initialized for sqlselect_describe_source
2025-11-12 00:30:49,406 - tools.tools_registry - INFO - Tool registered: sqlselect_describe_source
2025-11-12 00:30:49,406 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_describe_source
2025-11-12 00:30:49,407 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_details
2025-11-12 00:30:49,407 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_details
2025-11-12 00:30:49,407 - tools.tools_registry - INFO - Tool registered: un_get_sdg_indicators
2025-11-12 00:30:49,407 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_indicators
2025-11-12 00:30:49,407 - tools.tools_registry - INFO - Tool registered: boc_get_latest
2025-11-12 00:30:49,407 - tools.tools_registry - INFO - Loaded custom tool: boc_get_latest
2025-11-12 00:30:49,407 - tools.tools_registry - INFO - Tool registered: rbi_get_inflation
2025-11-12 00:30:49,407 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_inflation
2025-11-12 00:30:49,407 - tools.tools_registry - INFO - Tool registered: ecb_get_series
2025-11-12 00:30:49,408 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_series
2025-11-12 00:30:49,408 - tools.tools_registry - INFO - Tool registered: pboc_get_lpr
2025-11-12 00:30:49,408 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_lpr
2025-11-12 00:30:49,408 - tools.tools_registry - INFO - Tool registered: boc_get_interest_rate
2025-11-12 00:30:49,408 - tools.tools_registry - INFO - Loaded custom tool: boc_get_interest_rate
2025-11-12 00:30:49,408 - tools.tools_registry - INFO - Tool registered: edgar_company_concept
2025-11-12 00:30:49,408 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_concept
2025-11-12 00:30:49,408 - tools.tools_registry - INFO - Tool registered: sec_get_company_facts
2025-11-12 00:30:49,408 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_facts
2025-11-12 00:30:49,408 - tools.tools_registry - INFO - Tool registered: ir_get_presentations
2025-11-12 00:30:49,408 - tools.tools_registry - INFO - Loaded custom tool: ir_get_presentations
2025-11-12 00:30:49,408 - tools.tools_registry - INFO - Tool registered: rbi_get_gsec_yield
2025-11-12 00:30:49,408 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_gsec_yield
2025-11-12 00:30:49,409 - tools.tools_registry - INFO - Tool registered: wiki_get_page
2025-11-12 00:30:49,409 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_page
2025-11-12 00:30:49,409 - tools.tools_registry - INFO - Tool registered: extract_links
2025-11-12 00:30:49,409 - tools.tools_registry - INFO - Loaded custom tool: extract_links
2025-11-12 00:30:49,409 - tools.tools_registry - INFO - Tool registered: fbi_get_participation_rate
2025-11-12 00:30:49,409 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_participation_rate
2025-11-12 00:30:49,409 - tools.tools_registry - INFO - Tool registered: rbi_get_exchange_rate
2025-11-12 00:30:49,410 - tools.tools_registry - INFO - Loaded custom tool: rbi_get_exchange_rate
2025-11-12 00:30:49,410 - tools.tools_registry - INFO - Tool registered: wb_get_lending_types
2025-11-12 00:30:49,410 - tools.tools_registry - INFO - Loaded custom tool: wb_get_lending_types
2025-11-12 00:30:49,410 - tools.tools_registry - INFO - Tool registered: wb_compare_countries
2025-11-12 00:30:49,410 - tools.tools_registry - INFO - Loaded custom tool: wb_compare_countries
2025-11-12 00:30:49,410 - tools.tools_registry - INFO - Tool registered: edgar_company_facts
2025-11-12 00:30:49,410 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_facts
2025-11-12 00:30:49,411 - tools.tools_registry - INFO - Tool registered: un_get_sdg_progress
2025-11-12 00:30:49,411 - tools.tools_registry - INFO - Loaded custom tool: un_get_sdg_progress
2025-11-12 00:30:49,411 - tools.tools_registry - INFO - Tool registered: pboc_get_forex_reserves
2025-11-12 00:30:49,411 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_forex_reserves
2025-11-12 00:30:49,411 - tools.tools_registry - INFO - Tool registered: fbi_get_national_statistics
2025-11-12 00:30:49,411 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_national_statistics
2025-11-12 00:30:49,411 - tools.tools_registry - INFO - Tool registered: ir_get_all_resources
2025-11-12 00:30:49,411 - tools.tools_registry - INFO - Loaded custom tool: ir_get_all_resources
2025-11-12 00:30:49,411 - tools.tools_registry - INFO - Tool registered: edgar_xbrl_frames_multi_concept
2025-11-12 00:30:49,411 - tools.tools_registry - INFO - Loaded custom tool: edgar_xbrl_frames_multi_concept
2025-11-12 00:30:49,411 - tools.tools_registry - INFO - Tool registered: ir_list_supported_companies
2025-11-12 00:30:49,411 - tools.tools_registry - INFO - Loaded custom tool: ir_list_supported_companies
2025-11-12 00:30:49,412 - tools.tools_registry - INFO - Tool registered: wb_get_indicators
2025-11-12 00:30:49,412 - tools.tools_registry - INFO - Loaded custom tool: wb_get_indicators
2025-11-12 00:30:49,412 - tools.tools_registry - INFO - Tool registered: msdoc_get_excel_metadata
2025-11-12 00:30:49,412 - tools.tools_registry - INFO - Loaded custom tool: msdoc_get_excel_metadata
2025-11-12 00:30:49,412 - tools.tools_registry - INFO - Tool registered: imf_get_ifs_data
2025-11-12 00:30:49,412 - tools.tools_registry - INFO - Loaded custom tool: imf_get_ifs_data
2025-11-12 00:30:49,412 - tools.tools_registry - INFO - Tool registered: wb_get_countries
2025-11-12 00:30:49,412 - tools.tools_registry - INFO - Loaded custom tool: wb_get_countries
2025-11-12 00:30:49,413 - tools.tools_registry - INFO - Tool registered: google_search
2025-11-12 00:30:49,413 - tools.tools_registry - INFO - Loaded custom tool: google_search
2025-11-12 00:30:49,413 - tools.tools_registry - INFO - Tool registered: fed_get_common_indicators
2025-11-12 00:30:49,413 - tools.tools_registry - INFO - Loaded custom tool: fed_get_common_indicators
2025-11-12 00:30:49,414 - tools.tools_registry - INFO - Tool registered: edgar_proxy_statements
2025-11-12 00:30:49,414 - tools.tools_registry - INFO - Loaded custom tool: edgar_proxy_statements
2025-11-12 00:30:49,414 - tools.tools_registry - INFO - Tool registered: pboc_get_money_supply
2025-11-12 00:30:49,414 - tools.tools_registry - INFO - Loaded custom tool: pboc_get_money_supply
2025-11-12 00:30:49,414 - tools.tools_registry - INFO - Tool registered: sec_get_company_filings
2025-11-12 00:30:49,414 - tools.tools_registry - INFO - Loaded custom tool: sec_get_company_filings
2025-11-12 00:30:49,414 - tools.tools_registry - INFO - Tool registered: tavily_web_search
2025-11-12 00:30:49,414 - tools.tools_registry - INFO - Loaded custom tool: tavily_web_search
2025-11-12 00:30:49,420 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-12 00:30:49,420 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-12 00:30:49,420 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-12 00:30:49,420 - SqlSelectListSourcesTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-12 00:30:49,420 - SqlSelectListSourcesTool - INFO - DuckDB connection initialized for sqlselect_list_sources
2025-11-12 00:30:49,420 - tools.tools_registry - INFO - Tool registered: sqlselect_list_sources
2025-11-12 00:30:49,420 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_list_sources
2025-11-12 00:30:49,420 - tools.tools_registry - INFO - Tool registered: boj_get_money_stock
2025-11-12 00:30:49,420 - tools.tools_registry - INFO - Loaded custom tool: boj_get_money_stock
2025-11-12 00:30:49,420 - tools.tools_registry - INFO - Tool registered: msdoc_search_excel
2025-11-12 00:30:49,420 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_excel
2025-11-12 00:30:49,420 - tools.tools_registry - INFO - Tool registered: yahoo_search_symbols
2025-11-12 00:30:49,420 - tools.tools_registry - INFO - Loaded custom tool: yahoo_search_symbols
2025-11-12 00:30:49,421 - tools.tools_registry - INFO - Tool registered: extract_content
2025-11-12 00:30:49,421 - tools.tools_registry - INFO - Loaded custom tool: extract_content
2025-11-12 00:30:49,421 - tools.tools_registry - INFO - Tool registered: wiki_get_summary
2025-11-12 00:30:49,421 - tools.tools_registry - INFO - Loaded custom tool: wiki_get_summary
2025-11-12 00:30:49,421 - tools.tools_registry - INFO - Tool registered: ir_get_documents
2025-11-12 00:30:49,421 - tools.tools_registry - INFO - Loaded custom tool: ir_get_documents
2025-11-12 00:30:49,421 - tools.tools_registry - INFO - Tool registered: edgar_company_tickers_by_exchange
2025-11-12 00:30:49,421 - tools.tools_registry - INFO - Loaded custom tool: edgar_company_tickers_by_exchange
2025-11-12 00:30:49,421 - tools.tools_registry - INFO - Tool registered: un_get_country_trade
2025-11-12 00:30:49,421 - tools.tools_registry - INFO - Loaded custom tool: un_get_country_trade
2025-11-12 00:30:49,421 - tools.tools_registry - INFO - Tool registered: ir_get_latest_earnings
2025-11-12 00:30:49,421 - tools.tools_registry - INFO - Loaded custom tool: ir_get_latest_earnings
2025-11-12 00:30:49,422 - tools.tools_registry - INFO - Tool registered: fbi_get_agency_statistics
2025-11-12 00:30:49,422 - tools.tools_registry - INFO - Loaded custom tool: fbi_get_agency_statistics
2025-11-12 00:30:49,422 - tools.tools_registry - INFO - Tool registered: edgar_mutual_fund_holdings
2025-11-12 00:30:49,422 - tools.tools_registry - INFO - Loaded custom tool: edgar_mutual_fund_holdings
2025-11-12 00:30:49,422 - DuckDbQueryTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-12 00:30:49,459 - DuckDbQueryTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-12 00:30:49,460 - DuckDbQueryTool - INFO - Initialization complete: 4 views available
2025-11-12 00:30:49,460 - DuckDbQueryTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:30:49,460 - tools.tools_registry - INFO - Tool registered: duckdb_query
2025-11-12 00:30:49,461 - tools.tools_registry - INFO - Loaded custom tool: duckdb_query
2025-11-12 00:30:49,461 - tools.tools_registry - INFO - Tool registered: ecb_get_exchange_rate
2025-11-12 00:30:49,461 - tools.tools_registry - INFO - Loaded custom tool: ecb_get_exchange_rate
2025-11-12 00:30:49,461 - tools.tools_registry - INFO - Tool registered: edgar_insider_transactions
2025-11-12 00:30:49,461 - tools.tools_registry - INFO - Loaded custom tool: edgar_insider_transactions
2025-11-12 00:30:49,461 - tools.tools_registry - INFO - Tool registered: msdoc_search_word
2025-11-12 00:30:49,461 - tools.tools_registry - INFO - Loaded custom tool: msdoc_search_word
2025-11-12 00:30:49,462 - DuckDbRefreshViewsTool - INFO - Found 1 data files in /Users/saadahmed/queryagent/sajhamcpserver/data/duckdb
2025-11-12 00:30:49,519 - DuckDbRefreshViewsTool - INFO - ‚úì Created view 'limits_data' from limits_data.csv (201 rows)
2025-11-12 00:30:49,520 - DuckDbRefreshViewsTool - INFO - Initialization complete: 4 views available
2025-11-12 00:30:49,521 - DuckDbRefreshViewsTool - INFO - Auto-refresh enabled: checking every 600 seconds
2025-11-12 00:30:49,521 - tools.tools_registry - INFO - Tool registered: duckdb_refresh_views
2025-11-12 00:30:49,521 - tools.tools_registry - INFO - Loaded custom tool: duckdb_refresh_views
2025-11-12 00:30:49,522 - tools.tools_registry - INFO - Tool registered: fed_get_latest
2025-11-12 00:30:49,522 - tools.tools_registry - INFO - Loaded custom tool: fed_get_latest
2025-11-12 00:30:49,523 - tools.tools_registry - INFO - Tool registered: edgar_financial_ratios
2025-11-12 00:30:49,523 - tools.tools_registry - INFO - Loaded custom tool: edgar_financial_ratios
2025-11-12 00:30:49,537 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/customers.csv
2025-11-12 00:30:49,537 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/orders.csv
2025-11-12 00:30:49,537 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/products.csv
2025-11-12 00:30:49,537 - SqlSelectCountRowsTool - WARNING - Data file not found: data/sqlselect/sales.csv
2025-11-12 00:30:49,537 - SqlSelectCountRowsTool - INFO - DuckDB connection initialized for sqlselect_count_rows
2025-11-12 00:30:49,538 - tools.tools_registry - INFO - Tool registered: sqlselect_count_rows
2025-11-12 00:30:49,538 - tools.tools_registry - INFO - Loaded custom tool: sqlselect_count_rows
2025-11-12 00:30:49,538 - tools.tools_registry - INFO - Tool registered: wb_get_regions
2025-11-12 00:30:49,538 - tools.tools_registry - INFO - Loaded custom tool: wb_get_regions
2025-11-12 00:30:49,539 - tools.tools_registry - INFO - Tool registered: sec_get_mutual_fund_holdings
2025-11-12 00:30:49,539 - tools.tools_registry - INFO - Loaded custom tool: sec_get_mutual_fund_holdings
2025-11-12 00:30:49,540 - tools.tools_registry - INFO - Tool registered: nl_to_sql_planner
2025-11-12 00:30:49,540 - tools.tools_registry - INFO - Loaded custom tool: nl_to_sql_planner
2025-11-12 00:30:49,540 - tools.tools_registry - INFO - Tool registered: un_get_trade_balance
2025-11-12 00:30:49,540 - tools.tools_registry - INFO - Loaded custom tool: un_get_trade_balance
2025-11-12 00:30:49,541 - tools.tools_registry - INFO - Tool registered: wb_get_topic_indicators
2025-11-12 00:30:49,541 - tools.tools_registry - INFO - Loaded custom tool: wb_get_topic_indicators
2025-11-12 00:30:49,541 - tools.tools_registry - INFO - Tool registered: extract_metadata
2025-11-12 00:30:49,541 - tools.tools_registry - INFO - Loaded custom tool: extract_metadata
2025-11-12 00:30:49,542 - tools.tools_registry - INFO - Started file monitoring for tool configurations
2025-11-12 00:30:49,566 - root - INFO - All routes registered successfully
2025-11-12 00:30:49,571 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.68.51:8000
2025-11-12 00:30:49,571 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-11-12 00:30:51,554 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:30:51] "[33mGET /api/health HTTP/1.1[0m" 404 -
2025-11-12 00:30:54,247 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:30:54] "GET /socket.io/?EIO=4&transport=polling&t=PfsYwEZ HTTP/1.1" 200 -
2025-11-12 00:30:54,249 - root - INFO - WebSocket client connected: Mer-4j2a6kMbk-nFAAAC
2025-11-12 00:30:54,253 - root - INFO - WebSocket client connected: G0MimEFf8gPfzQGsAAAD
2025-11-12 00:30:54,254 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:30:54] "POST /socket.io/?EIO=4&transport=polling&t=PfsYwEf&sid=jqQ4GVSav91hkjd-AAAB HTTP/1.1" 200 -
2025-11-12 00:30:54,254 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:30:54] "GET /socket.io/?EIO=4&transport=polling&t=PfsYwEh&sid=jqQ4GVSav91hkjd-AAAB HTTP/1.1" 200 -
2025-11-12 00:30:54,255 - root - INFO - WebSocket client disconnected: Mer-4j2a6kMbk-nFAAAC
2025-11-12 00:30:54,262 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:30:54] "GET /socket.io/?EIO=4&transport=polling&t=PfsYwEp&sid=jqQ4GVSav91hkjd-AAAB HTTP/1.1" 200 -
2025-11-12 00:30:54,263 - root - INFO - WebSocket client disconnected: G0MimEFf8gPfzQGsAAAD
2025-11-12 00:30:54,263 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:30:54] "POST /socket.io/?EIO=4&transport=polling&t=PfsYwEq&sid=jqQ4GVSav91hkjd-AAAB HTTP/1.1" 200 -
2025-11-12 00:30:54,267 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:30:54] "GET /socket.io/?EIO=4&transport=websocket&sid=jqQ4GVSav91hkjd-AAAB HTTP/1.1" 200 -
2025-11-12 00:30:54,270 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:30:54] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-12 00:30:54,272 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-12 00:31:07,597 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:07] "[32mGET /agent/chat HTTP/1.1[0m" 302 -
2025-11-12 00:31:07,601 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:07] "GET /login?next=http://localhost:8000/agent/chat HTTP/1.1" 200 -
2025-11-12 00:31:07,613 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:07] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-12 00:31:07,615 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:07] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-12 00:31:07,619 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:07] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-12 00:31:07,664 - root - INFO - WebSocket client connected: 3n9TwQmDHoZ6j17CAAAF
2025-11-12 00:31:07,667 - root - INFO - WebSocket client disconnected: 3n9TwQmDHoZ6j17CAAAF
2025-11-12 00:31:07,680 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:07] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-12 00:31:07,681 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-12 00:31:12,124 - core.auth_manager - INFO - Saved 1 users to configuration
2025-11-12 00:31:12,125 - core.auth_manager - INFO - User authenticated successfully: admin
2025-11-12 00:31:12,125 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:12] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-12 00:31:12,151 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:12] "GET /dashboard HTTP/1.1" 200 -
2025-11-12 00:31:12,168 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:12] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-12 00:31:12,169 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:12] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-12 00:31:12,169 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:12] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-12 00:31:12,265 - root - INFO - WebSocket client connected: yhF57tLyVf1-IP3RAAAH
2025-11-12 00:31:12,266 - root - INFO - WebSocket client disconnected: yhF57tLyVf1-IP3RAAAH
2025-11-12 00:31:12,278 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:12] "[35m[1mGET /socket.io/?EIO=4&transport=websocket HTTP/1.1[0m" 500 -
2025-11-12 00:31:12,279 - werkzeug - ERROR - Error on request:
Traceback (most recent call last):
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 370, in run_wsgi
    execute(self.server.app)
    ~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 336, in execute
    write(b"")
    ~~~~~^^^^^
  File "/Users/saadahmed/queryagent/sajhamcpserver/.venv/lib/python3.13/site-packages/werkzeug/serving.py", line 261, in write
    assert status_set is not None, "write() before start_response"
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError: write() before start_response
2025-11-12 00:31:15,157 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:15] "GET /agent/chat HTTP/1.1" 200 -
2025-11-12 00:31:15,176 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:15] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-12 00:31:15,178 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:15] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-12 00:31:15,180 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:15] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 -
2025-11-12 00:31:15,219 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:15] "GET /socket.io/?EIO=4&transport=polling&t=PfsY_MG HTTP/1.1" 200 -
2025-11-12 00:31:15,221 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:15] "GET /api/agent/config-files?type=agent_prompts HTTP/1.1" 200 -
2025-11-12 00:31:15,223 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:15] "GET /api/agent/config-files?type=welcome HTTP/1.1" 200 -
2025-11-12 00:31:15,224 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:15] "GET /api/agent/config-files?type=data_dict HTTP/1.1" 200 -
2025-11-12 00:31:15,227 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:15] "GET /api/agent/data-analysis-agents HTTP/1.1" 200 -
2025-11-12 00:31:15,228 - root - INFO - WebSocket client connected: TZ3H4s4MS4VPVdLuAAAJ
2025-11-12 00:31:15,230 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:15] "POST /socket.io/?EIO=4&transport=polling&t=PfsY_MN&sid=Ag25foiTpFqVxBhUAAAI HTTP/1.1" 200 -
2025-11-12 00:31:15,231 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:15] "GET /socket.io/?EIO=4&transport=polling&t=PfsY_MN.0&sid=Ag25foiTpFqVxBhUAAAI HTTP/1.1" 200 -
2025-11-12 00:31:15,232 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:15] "GET /api/agent/data-analysis-agents/risk_agent HTTP/1.1" 200 -
2025-11-12 00:31:15,234 - root - INFO - Client TZ3H4s4MS4VPVdLuAAAJ joined session room: sess-2vvu1e42
2025-11-12 00:31:15,235 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:15] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-12 00:31:15,262 - root - INFO - WebSocket client connected: VZmQr-Vrvk-qkyYBAAAL
2025-11-12 00:31:29,283 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:29] "GET /api/agent/data-analysis-agents/mr_limits_analysis HTTP/1.1" 200 -
2025-11-12 00:31:29,290 - werkzeug - INFO - 127.0.0.1 - - [12/Nov/2025 00:31:29] "GET /api/agent/welcome-message?file=agent_welcome_message.json HTTP/1.1" 200 -
2025-11-12 00:31:43,600 - external.agent.session_manager - INFO - [SessionManager] Registered session sess-2vvu1e42
2025-11-12 00:31:43,600 - external.agent.streaming_agent - INFO - [StreamingAgent] Query: 'primary limits all'
2025-11-12 00:31:43,600 - external.agent.streaming_agent - INFO - [StreamingAgent] Session ID: sess-2vvu1e42
2025-11-12 00:31:43,600 - external.agent.state_manager - WARNING - Session sess-2vvu1e42 not found
2025-11-12 00:31:43,600 - external.agent.streaming_agent - INFO - [StreamingAgent] Loaded 0 conversation turns
2025-11-12 00:31:43,604 - external.agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:31:43,604 - external.agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for invoke: data keys = ['session_id', 'has_table_schema', 'has_conversation_history', 'control', 'node_reasoning']
2025-11-12 00:31:43,604 - external.agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for invoke with 5 data keys
2025-11-12 00:31:43,605 - external.agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for invoke
2025-11-12 00:31:43,605 - external.agent.graph_nodes - INFO - [CHECK_FOLLOWUP] is_followup=False, conv_history(list)=0, conv_history_raw(list)=0, conv_history(str)=33
2025-11-12 00:31:43,605 - external.agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_followup: data keys = ['is_followup', 'conversation_history_length', 'node_output', 'node_reasoning']
2025-11-12 00:31:43,605 - external.agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_followup with 4 data keys
2025-11-12 00:31:43,605 - external.agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_followup
2025-11-12 00:31:43,607 - external.agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:31:47,199 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:31:47,218 - external.agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_structure: data keys = ['is_structured', 'node_output', 'node_reasoning']
2025-11-12 00:31:47,218 - external.agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_structure with 3 data keys
2025-11-12 00:31:47,219 - external.agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_structure
2025-11-12 00:31:47,220 - external.agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:31:47,221 - external.agent.graph_nodes - INFO - [CHECK_AMBIGUITY] is_followup=False, more_data_needed=False, passing to planner
2025-11-12 00:31:47,221 - tools.impl.nl_to_sql_planner - INFO - 
================================================================================
2025-11-12 00:31:47,221 - tools.impl.nl_to_sql_planner - INFO - [NLToSQLPlanner] üîç FOLLOW-UP QUERY DIAGNOSTICS
2025-11-12 00:31:47,221 - tools.impl.nl_to_sql_planner - INFO - ================================================================================
2025-11-12 00:31:47,221 - tools.impl.nl_to_sql_planner - INFO - üìä FLAG COMBINATION:
2025-11-12 00:31:47,221 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ is_followup: False
2025-11-12 00:31:47,221 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ more_data_needed: False
2025-11-12 00:31:47,221 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ MODE: üü¢ STANDARD NEW QUERY (not a follow-up)
2025-11-12 00:31:47,221 - tools.impl.nl_to_sql_planner - INFO - 
üìù CONVERSATION HISTORY ANALYSIS:
2025-11-12 00:31:47,221 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Type: <class 'str'>
2025-11-12 00:31:47,221 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Length: 33 characters
2025-11-12 00:31:47,221 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has '```sql' code block marker: False
2025-11-12 00:31:47,221 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Has 'SELECT' keyword: False
2025-11-12 00:31:47,221 - tools.impl.nl_to_sql_planner - INFO -   ‚Ä¢ Preview (first 600 chars):
2025-11-12 00:31:47,221 - tools.impl.nl_to_sql_planner - INFO -     No previous conversation history.
2025-11-12 00:31:47,221 - tools.impl.nl_to_sql_planner - INFO - ================================================================================

2025-11-12 00:31:50,372 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:31:52,388 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:31:54,127 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] üîµ Calling LLM for SQL generation
2025-11-12 00:31:54,127 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Query: primary limits all
2025-11-12 00:31:54,127 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] System prompt length: 9291 chars
2025-11-12 00:31:54,127 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] User prompt length: 34680 chars
2025-11-12 00:31:54,127 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Using streaming: True
2025-11-12 00:31:54,127 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Starting streaming response...
2025-11-12 00:31:56,924 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:31:58,600 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Streaming complete. Response length: 381 chars
2025-11-12 00:31:58,600 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Raw LLM response (first 500 chars): {
  "sql": "SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC",
  "explanation": "Retrieved all primary limits for the latest date, sorted by utilization in descending order. Applied 'Primary' filter since query mentioned 'primary limits' and was somewhat ambiguous.",
  "target_table": "limits_data"
}
2025-11-12 00:31:58,600 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Attempting to parse JSON...
2025-11-12 00:31:58,601 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ JSON parsed successfully. Keys: ['sql', 'explanation', 'target_table']
2025-11-12 00:31:58,601 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] Extracted SQL from JSON: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-12 00:31:58,601 - tools.impl.nl_to_sql_planner - INFO - [SQL_GENERATOR] ‚úÖ Successfully generated SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-12 00:31:58,602 - external.agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for check_ambiguity: data keys = ['is_ambiguous', 'clarification_questions', 'node_output', 'node_reasoning']
2025-11-12 00:31:58,602 - external.agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for check_ambiguity with 4 data keys
2025-11-12 00:31:58,602 - external.agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for check_ambiguity
2025-11-12 00:31:58,609 - external.agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:31:58,610 - external.agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for generate_sql: data keys = ['plan', 'plan_quality', 'plan_explain', 'node_output', 'node_reasoning']
2025-11-12 00:31:58,610 - external.agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for generate_sql with 5 data keys
2025-11-12 00:31:58,610 - external.agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for generate_sql
2025-11-12 00:31:58,615 - external.agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:31:58,615 - external.agent.graph_nodes - INFO - [EXECUTE_SQL] Retrieved plan_sql from state: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-12 00:31:58,615 - external.agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql length: 128 chars
2025-11-12 00:31:58,615 - external.agent.graph_nodes - INFO - [EXECUTE_SQL] Full plan_sql: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC
2025-11-12 00:31:58,616 - external.agent.graph_nodes - INFO - [EXECUTE_SQL] Plan SQL before safety validation: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-12 00:31:58,616 - external.agent.graph_nodes - INFO - [EXECUTE_SQL] Safety tool sanitized SQL: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-12 00:31:58,616 - external.agent.graph_nodes - INFO - [EXECUTE_SQL] SQL changed by safety tool: False
2025-11-12 00:31:58,616 - external.agent.graph_nodes - INFO - [EXECUTE_SQL] Final SQL to execute: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_data) ORDER BY utilization DESC...
2025-11-12 00:31:58,720 - external.agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for execute_sql: data keys = ['raw_table', 'execution_stats', 'node_output', 'node_reasoning']
2025-11-12 00:31:58,720 - external.agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for execute_sql with 4 data keys
2025-11-12 00:31:58,720 - external.agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for execute_sql
2025-11-12 00:31:58,721 - external.agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:31:58,721 - external.agent.graph_nodes - INFO - [END_NODE] Execution result check: row_count=3, columns=41, rows=3, sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-12 00:31:58,721 - external.agent.graph_nodes - INFO - [END_NODE] execution_result type: <class 'dict'>, has 'rows' key: True, has 'columns' key: True
2025-11-12 00:31:58,722 - external.agent.graph_nodes - INFO - [END_NODE] execution_result keys: ['query', 'columns', 'rows', 'row_count', 'execution_time_ms', 'limited']
2025-11-12 00:31:58,722 - external.agent.graph_nodes - INFO - [END_NODE] execution_result.query: SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-12 00:31:58,722 - external.agent.graph_nodes - INFO - [END_NODE] Raw table created: row_count=3, columns=41, rows=3, query_length=128
2025-11-12 00:31:58,722 - external.agent.graph_nodes - INFO - [END_NODE] LLM client available: True
2025-11-12 00:31:58,722 - external.agent.graph_nodes - INFO - [END_NODE] Config prompt length: 1921
2025-11-12 00:31:58,722 - external.agent.graph_nodes - INFO - [END_NODE] Calling LLM with prompt length: 4840 chars
2025-11-12 00:32:00,203 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:32:08,809 - external.agent.graph_nodes - INFO - [END_NODE] LLM response received: 1440 chars
2025-11-12 00:32:08,810 - external.agent.graph_nodes - INFO - [END_NODE] LLM client available for prompt monitor: True
2025-11-12 00:32:08,810 - external.agent.graph_nodes - INFO - [END_NODE] Config prompt_monitor length: 344
2025-11-12 00:32:08,811 - external.agent.graph_nodes - INFO - [END_NODE] Calling LLM for prompt monitor with prompt length: 51738 chars
2025-11-12 00:32:17,405 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 200 OK"
2025-11-12 00:32:17,407 - external.agent.graph_nodes - INFO - [END_NODE] LLM prompt monitor received: 1097 chars
2025-11-12 00:32:17,407 - external.agent.graph_nodes - INFO - [END_NODE] Before final_output: raw_table row_count=3, columns=41, rows=3, query=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat
2025-11-12 00:32:17,407 - external.agent.graph_nodes - INFO - [END_NODE] Final output raw_table: row_count=3, columns=41, rows=3, has_query=True
2025-11-12 00:32:17,407 - external.agent.graph_nodes - INFO - [END_NODE] Storing SQL in conversation history: plan_sql=SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-12 00:32:17,407 - external.agent.graph_nodes - INFO - [END_NODE] Executed SQL (may differ): SELECT * FROM limits_data WHERE limit_class = 'Primary' AND date = (SELECT MAX(date) FROM limits_dat...
2025-11-12 00:32:17,408 - external.agent.streaming_agent - INFO - [STREAMING_AGENT] Preparing node_data for synthesize: data keys = ['raw_table', 'node_output', 'node_reasoning']
2025-11-12 00:32:17,408 - external.agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:node_data for synthesize with 3 data keys
2025-11-12 00:32:17,408 - external.agent.streaming_agent - INFO - [STREAMING_AGENT] ‚úÖ Successfully emitted agent:node_data for synthesize
2025-11-12 00:32:17,416 - external.agent.state_manager - INFO - Saved session state for sess-2vvu1e42 (user: admin)
2025-11-12 00:32:17,417 - external.agent.streaming_agent - INFO - Agent completed for session sess-2vvu1e42: 33811.787000000004ms, 7 steps
2025-11-12 00:32:17,417 - external.agent.streaming_agent - INFO - [STREAMING_AGENT] Emitting agent:complete - raw_table row_count=3, columns=41, rows=3
2025-11-12 00:32:17,417 - external.agent.session_manager - INFO - [SessionManager] Unregistered session sess-2vvu1e42
