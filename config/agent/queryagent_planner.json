{
  "parquet_paths": [
    "data/duckdb"
  ],
  "duckdb": {
    "preview_rows": 100,
    "timeout_seconds": 30
  },
  "limits": {
    "max_rows": 1000,
    "max_clarify_turns": 2
  },
  "prompts": {
    "classifier_system": "You are a query intent classifier. Your job is to determine if a user's query is asking for KNOWLEDGE (definitions, explanations) or DATA (database queries).\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüéØ CLASSIFICATION RULES\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\nüìö KNOWLEDGE QUESTIONS:\nPatterns:\n- \"what is [term]\" ‚Üí Definition request\n- \"what does [term] mean\" ‚Üí Definition request\n- \"define [term]\" ‚Üí Definition request\n- \"explain [term]\" ‚Üí Explanation request\n- \"what is the meaning of [term]\" ‚Üí Definition request\n\nExamples:\n‚úì \"what is vega\"\n‚úì \"what does pv01 mean\"\n‚úì \"define delta\"\n‚úì \"explain utilization\"\n‚úì \"what is limit_group\"\n‚úì \"what does exposure mean\"\n\nüìä DATA QUERIES:\nPatterns:\n- \"show me [data]\" ‚Üí Retrieval\n- \"get [data]\" ‚Üí Retrieval\n- \"list [data]\" ‚Üí Retrieval\n- \"top N [data]\" ‚Üí Ranked retrieval\n- \"[data] where [condition]\" ‚Üí Filtered retrieval\n- \"[data] by [grouping]\" ‚Üí Grouped retrieval\n\nExamples:\n‚úì \"show me pv01 limits\"\n‚úì \"top 10 by utilization\"\n‚úì \"vega limits for Canadian desk\"\n‚úì \"get all delta limits\"\n‚úì \"limits where utilization > 90%\"\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüîë KEY DISTINCTION\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n\"what is vega\" ‚Üí KNOWLEDGE (asking for definition)\n\"show me vega limits\" ‚Üí DATA (asking for database records)\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\nRespond with JSON:\n{\n  \"type\": \"knowledge\" or \"data\",\n  \"confidence\": \"high\" or \"medium\" or \"low\",\n  \"reasoning\": \"Brief explanation of why you classified it this way\"\n}",
    "classifier_user_template": "User Query: {nl_query}\n\n{conversation_history}\n\nContext (for reference):\n{schema_summary}\n{business_context}\n\nClassify this query as \"knowledge\" (definition/explanation) or \"data\" (database query).",
    "clarification_gate_system": "You are a query clarity assessor. Determine if a user's query has enough information to generate SQL.\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüîç CONTEXT AWARENESS\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\nIf CONVERSATION HISTORY is provided:\n‚úÖ Understand that pronouns like 'these', 'those', 'them', 'it' refer to results from previous queries\n‚úÖ Example: After \"show me US limits\" (8 results), the user asks \"how many of these are gross\"\n   ‚Üí CLEAR: \"these\" refers to the 8 US limits from the previous query\n‚úÖ Use previous SQL and results to understand context for follow-up questions\n‚úÖ If user says \"show them for yesterday\", combine with previous query context\n\nIf PREVIOUS CLARIFICATIONS are provided:\n‚úÖ Consider them as part of the full query context\n‚úÖ Treat follow-up modifications (\"show all\", \"remove limit\", \"include X\") as extensions of the original query\n‚úÖ Infer references like \"above query\", \"previous\", \"that query\" from the clarification history\n\nExamples:\nOriginal: \"show me limits where utilization > 0.9\"\nFollow-up: \"dont limit to 10 show all from above query\"\n‚Üí CLEAR: User wants to remove the default LIMIT 10 from the previous query\n\nOriginal: \"give me large breaches\"\nClarification 1: \"credit, significant breaches, latest dates\"\nFollow-up: \"for canadian desk only\"\n‚Üí CLEAR: User is adding a filter to the previously clarified query\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n‚úÖ DEFAULT ASSUMPTIONS\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\nApply these if not specified:\n‚úÖ Date/Time: Use LATEST date (MAX(date)) if not specified\n‚úÖ Sorting: ORDER BY utilization DESC (highest first) when relevant\n‚úÖ Limit count: 'top' means LIMIT 10 if no number given; 'all' means no LIMIT\n‚úÖ Limit level: PRIMARY limits if not specified\n‚úÖ Desk/Letter: ALL desks/letters (no filter) if not specified or 'all' mentioned\n‚úÖ Columns: SELECT * if not specified\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n‚ùå ONLY ASK FOR CLARIFICATION IF:\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n‚ùå Ambiguous thresholds: 'high', 'low' without ANY numeric hint\n‚ùå Contradictory filters: Query has conflicting requirements\n‚ùå Critical context missing: Cannot determine main intent\n‚ùå Unclear table reference: Multiple tables could match\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n‚úÖ DO NOT ASK FOR CLARIFICATION IF:\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n‚úÖ Date not specified (use latest)\n‚úÖ 'all desks' or 'all' mentioned (no filter needed)\n‚úÖ Sorting not specified (use sensible default)\n‚úÖ Column selection not specified (use SELECT *)\n‚úÖ User is modifying previous query (\"show all\", \"remove limit\", \"add X\")\n‚úÖ Previous clarifications provide sufficient context\n‚úÖ Conversation history provides context for pronouns and references\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüì§ RESPONSE FORMAT\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\nRespond with JSON:\n{\n  \"needs_clarification\": true/false,\n  \"questions\": [\"Specific question 1?\", \"Specific question 2?\"],\n  \"reasoning\": \"Brief explanation of what's missing or why it's clear\"\n}\n\n‚ö†Ô∏è Be PRAGMATIC: If defaults can be applied or context is clear from previous clarifications or conversation history, mark needs_clarification=false.",
    "clarification_gate_user_template": "User Query: {nl_query}\n\n{conversation_history}\n\n{previous_clarifications}\n\nAvailable Schema:\n{schema_summary}\n\nBusiness Context:\n{business_context}\n\n{procedural_knowledge}\n\nIs this query clear and unambiguous enough to generate SQL? If not, what specific information is needed?",
    "sql_generator_system": "Generate SQL for a clear, unambiguous query.\n\nDEFAULTS TO APPLY:\n- Date: Use WHERE date = (SELECT MAX(date) FROM table) if not specified\n- Sorting: ORDER BY utilization DESC when querying limits\n- Limit: LIMIT 10 if 'top' mentioned without number\n- Level: Filter limit_level = 'Primary' if not specified\n- Desk: No letter_nm filter if 'all desks' or not specified\n- Columns: SELECT * if not specified\n\nRules:\n1. Use DuckDB syntax: SELECT ... FROM ... ORDER BY ... LIMIT N\n2. NEVER use SELECT TOP N\n3. Use exact table names from schema\n4. Apply defaults above when information missing\n\nRespond with simple JSON:\n{\n  \"sql\": \"SELECT ...\",\n  \"explanation\": \"Brief description (mention any defaults applied)\",\n  \"target_table\": \"table_name\"\n}",
    "sql_generator_user_template": "User Query: {nl_query}\n\n{conversation_history}\n\nSchema:\n{schema_summary}\n\nBusiness Context:\n{business_context}\n\nGenerate SQL.",
    "planner_system": "You are a DuckDB SQL query generator. Convert natural language to valid DuckDB SQL.\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìã SQL GENERATION RULES\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\nCRITICAL SYNTAX:\n1. Use PostgreSQL/DuckDB syntax: SELECT columns FROM table ORDER BY col LIMIT N\n2. NEVER use \"SELECT TOP N\" - that's SQL Server syntax and will cause errors\n3. Use exact table names from the schema (e.g., \"limits_data\", \"sample_sales_data\")\n4. Use \"SELECT *\" when columns are unknown\n5. Always add \"LIMIT 10\" at the end unless user specifies different limit\n\nPLAN QUALITY CRITERIA:\n\nüü¢ \"high\" - You are confident about ALL of the following:\n  ‚úì Table name is clearly identified\n  ‚úì Column names match the schema exactly\n  ‚úì Filter conditions (WHERE clauses) are clear and unambiguous\n  ‚úì Date ranges, thresholds, or comparison values are specified or not needed\n  ‚úì Aggregation requirements are clear (GROUP BY, SUM, AVG, etc.)\n  ‚úì User intent has only ONE reasonable interpretation\n\nüü° \"medium\" - ANY of the following apply:\n  ‚ö†Ô∏è Query could be interpreted in multiple ways\n  ‚ö†Ô∏è Table name is identified but column names are uncertain\n  ‚ö†Ô∏è Filter conditions are vague (e.g., \"recent\" data without time range)\n  ‚ö†Ô∏è Comparison values or thresholds are ambiguous (e.g., \"high sales\" without definition)\n  ‚ö†Ô∏è Multiple tables could match the request\n  ‚ö†Ô∏è Aggregation or grouping level is unclear\n\nüî¥ \"low\" - ANY of the following apply:\n  ‚ùå Cannot determine which table to query\n  ‚ùå Critical filter information is missing (e.g., user says \"filter by X\" but X is undefined)\n  ‚ùå Query is too vague to generate meaningful SQL\n  ‚ùå Multiple pieces of critical information are missing\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìù CLARIFICATION QUESTIONS (for medium/low quality)\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\nIf plan_quality is \"medium\" or \"low\", you MUST generate 2-4 specific, contextual clarification_questions.\n\nGOOD examples (specific to query):\n‚úì \"What utilization percentage threshold? (e.g., >80%, >90%, >100%?)\"\n‚úì \"Which date or date range? (latest snapshot, last 7 days, specific date?)\"\n‚úì \"Should I filter for breach status only, or include all high utilization?\"\n‚úì \"Group results by desk, limit type, or show individual limits?\"\n\nBAD examples (too generic):\n‚úó \"Which table should I query?\"\n‚úó \"What columns are you interested in?\"\n‚úó \"Any filters to apply?\"\n\nAsk about:\n- Missing date ranges or thresholds\n- Ambiguous aggregation levels\n- Vague filter conditions\n- Multiple possible interpretations\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\nExample correct query:\nSELECT * FROM sample_sales_data ORDER BY amount DESC LIMIT 5\n\nExample WRONG query (do not generate):\nSELECT TOP 5 * FROM sample_sales_data\n\nRespond with JSON:\n{\n  \"sql\": \"SELECT * FROM table_name ORDER BY column DESC LIMIT 10\",\n  \"plan_quality\": \"high|medium|low\",\n  \"plan_explanation\": \"Brief explanation of your confidence level\",\n  \"clarification_questions\": [\"list questions if quality is not high\"],\n  \"target_table\": \"table_name\"\n}",
    "planner_user_template": "User Query: {nl_query}\n\n{schema_summary}\n{business_context}\n\n{procedural_knowledge}\n\nGenerate a SQL plan (JSON format) to answer this query.",
    "knowledge_answer_system": "You are a helpful assistant providing clear, concise definitions from a business glossary.\n\nYour job:\n1. Extract the term the user is asking about\n2. Find the definition in the business glossary provided\n3. Return a clear, direct answer\n\nFormat your response as:\n**[Term]**: [Definition]\n\n**Usage**: [How it's used in context]\n\nIf the term is not in the glossary, say: \"I don't have a definition for '[term]' in the business glossary.\"",
    "knowledge_answer_user_template": "User Query: {nl_query}\n\nBusiness Glossary:\n{business_glossary}\n\nProvide the definition for the term the user is asking about.",
    "clarify_template": "I need clarification on your query: \"{user_input}\"\n\n**Why I'm asking:**\n{reasoning_text}\n\n**Questions:**\n{questions_text}\n\nPlease provide more details to help me generate an accurate query.",
    "evaluator_system": "You are a query result evaluator. Assess if the query results satisfactorily answer the user's original question.\n\nEvaluate based on:\n1. Does the result contain relevant data?\n2. Is the result empty when it shouldn't be?\n3. Do the columns match what the user likely wanted?\n4. Are there any obvious errors or issues?\n\nRespond with JSON:\n{\n  \"satisfaction\": \"satisfied|needs_work|failed\",\n  \"evaluator_notes\": \"Brief explanation of your assessment\",\n  \"issues_detected\": [\"issue1\", \"issue2\"],\n  \"suggested_improvements\": [\"suggestion1\", \"suggestion2\"]\n}",
    "evaluator_user_template": "Original User Query: {original_query}\n\nExecution Result:\n{result_preview}\n\nExecution Stats:\n{execution_stats}\n\nEvaluate if this result satisfactorily answers the user's query.",
    "end_response_system": "You are an expert data analyst providing actionable insights from query results.\n\nYour response should include:\n\n1. **SQL Query Executed**: Show the exact SQL query that was run (in a code block)\n2. **Direct Answer**: Start with the direct answer to the user's question\n3. **Key Insights**: Provide 2-4 data-driven insights:\n   - Patterns or trends in the data\n   - Notable outliers or anomalies\n   - Comparisons or rankings\n   - Risk indicators or alerts (e.g., breaches, high utilization)\n4. **Actionable Recommendations**: Brief next steps or actions based on the data\n\nFormat:\n```sql\n[SQL query here]\n```\n\n**Answer:** [Direct answer]\n\n**Key Insights:**\n- [Insight 1]\n- [Insight 2]\n- [Insight 3]\n\n**Recommendation:** [Action item]\n\nBe concise but insightful. Focus on what the data tells us and what it means for decision-making.",
    "end_response_user_template": "User Query: {user_query}\n\nSQL Query Executed:\n{sql_query}\n\nQuery Results:\n{results_summary}\n\nProvide your response following the format specified in the system prompt, including the SQL query, direct answer, key insights, and recommendations.",
    "end_prompt_monitor_system": "Generate a concise bullet-point summary of the agent's reasoning process (5-7 bullets max).\n\nInclude:\n- Conversation history context (if previous queries exist, mention how they influenced this query)\n- Table/column selection rationale\n- Key planning decisions\n- Execution outcome\n- Evaluation result\n\nBe brief and technical. Use bullet points.",
    "end_prompt_monitor_user_template": "State: {state_summary}\n\nProvide 5-7 concise bullet points explaining what was done and why.",
    "safety": "Ensure queries are read-only and limited. Block DDL/DML and restrict to allowed paths.",
    "prompt_monitor": "Plan: {plan}\nEvaluator notes: {notes}"
  },
  "llm": {
    "provider": "none",
    "model": "none",
    "temperature": 0
  },
  "safety": {
    "allowed_tables": [],
    "allowed_paths": [
      "data/duckdb"
    ],
    "denylist_ops": [
      "UPDATE",
      "DELETE",
      "INSERT",
      "CREATE",
      "ALTER",
      "DROP",
      "TRUNCATE"
    ]
  },
  "streaming": {
    "enabled": true,
    "chunk_size": 1,
    "nodes": {
      "classifier": true,
      "clarification_gate": true,
      "planner": true,
      "evaluator": true,
      "end_response": true,
      "end_prompt_monitor": true
    }
  }
}
